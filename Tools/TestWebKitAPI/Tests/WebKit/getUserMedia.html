<!DOCTYPE html>
<html>
    <head>
        <script>

            let stream = null;

            async function promptForCapture()
            {
                try {
                    await navigator.mediaDevices.enumerateDevices();
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: false, video: true })
                    video.srcObject = stream;
                    console.log("Got user media");
                } catch(error) {
                    console.log(`Failed with error: ${error}`);
                }
            }

            function stop(kind)
            {
                let activeTracks = [];
                stream.getTracks().forEach(track => {
                    if (!kind || track.kind == kind)
                        track.stop();
                    else
                        activeTracks.push(track);
                });

                if (!activeTracks.length) {
                    stream = null;
                    video.srcObject = null;
                }
            }

            function haveStream()
            {
                return stream !== null;
            }
        </script>
    <head>

    <body onload="promptForCapture()">
        <video id="video" controls></video>
        <p>
        <button onclick="stop()">Stop</button>
        </p>
    </body>
</html>
