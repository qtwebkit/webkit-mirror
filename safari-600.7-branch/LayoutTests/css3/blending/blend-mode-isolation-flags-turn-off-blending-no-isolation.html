<!DOCTYPE HTML>
<html>
    <head>
        <!-- This test will check if the isolation flag is on after removing mix-blend-mode
            from an element if the isolating element has other blending descendants. -->
        <style>
            div {
                width: 100px;
                height: 100px;
                /* This forces render layers, avoiding normal flow only issues */
                position: relative;
            }

            .stacking-context {
                isolation: isolate;
            }

            .blending {
                mix-blend-mode: difference;
            }
        </style>
    </head>
    <body>
        <div class="stacking-context" style="background-color: #00ff00; top: 50px;">
            <div class="stacking-context" style="background-color: #ffff00; left: 50px;">
                <div>
                    <div class="blending" style="background-color: #ff00ff;left:-25px; top: -50px;"></div>
                </div>
                <div>
                    <div id="target" class="blending" style="background-color: #ff00ff;left:-25px; top: -50px;"></div>
                </div>
            </div>
        </div>
        <script type="text/javascript">
            if (window.testRunner)
                window.testRunner.waitUntilDone();

            function change() {
                var target = document.getElementById("target");
                target.className = "";

                if (window.testRunner)
                    window.testRunner.notifyDone();
            }

            window.setTimeout("change()", 10);
        </script>
    </body>
</html>
