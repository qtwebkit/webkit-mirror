2017-08-14  Ms2ger  <Ms2ger@igalia.com>

        GTK-focused gardening.
        https://bugs.webkit.org/show_bug.cgi?id=175529

        Unreviewed test gardening.

        * http/wpt/css/css-pseudo-4/marker-font-properties-expected.html: Set line-height for more reliable rendering.
        * http/wpt/css/css-pseudo-4/marker-font-properties.html: Set line-height for more reliable rendering.
        * media/video-fullscreen-restriction-removed-expected.txt: DOMException's toString was changed in r219663; rebaseline. (The test is marked as flaky on mac.)
        * platform/gtk/TestExpectations:
        * platform/gtk/http/tests/dom/document-attributes-null-handling-expected.txt: SecurityError got a new message in r220376; rebaseline.
        * platform/gtk/imported/w3c/web-platform-tests/FileAPI/historical.https-expected.txt: Added: GTK does not yet enable the in-progress ServiceWorker implementation.
        * platform/gtk/imported/w3c/web-platform-tests/fetch/api/basic/scheme-about.any-expected.txt: TypeError got a new message in r220622; rebaseline.
        * platform/gtk/imported/w3c/web-platform-tests/fetch/api/basic/scheme-about.any.worker-expected.txt: Added: TypeError uses a different message on GTK.

2017-08-14  Ms2ger  <Ms2ger@igalia.com>

        [GTK] Update some test expectations.
        https://bugs.webkit.org/show_bug.cgi?id=175480

        Unreviewed test gardening.

        * platform/gtk/TestExpectations:
        * platform/gtk/imported/w3c/web-platform-tests/html/semantics/selectors/pseudo-classes/inrange-outofrange-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/webrtc/simplecall-expected.txt: Added.

2017-08-14  Antti Koivisto  <antti@apple.com>

        [Render Tree Mutation] First letter should not mutate the render tree while in layout.
        https://bugs.webkit.org/show_bug.cgi?id=163848
        <rdar://problem/33402718>

        Reviewed by Zalan Bujtas.

        * fast/text-autosizing/ios/first-letter-expected.html: Added.

            Turn into reftest for easier debugging and robustness.

        * imported/blink/fast/css/first-letter-range-insert-expected.txt:

            This is crash-or-assert test and the output change here doesn't matter.

        * platform/ios/fast/text-autosizing/ios/first-letter-expected.txt: Removed.
        * platform/mac/fast/text-autosizing/ios/first-letter-expected.txt: Removed.

2017-08-13  Manuel Rego Casasnovas  <rego@igalia.com>

        Composition underline color is always black
        https://bugs.webkit.org/show_bug.cgi?id=174675

        Reviewed by Ryosuke Niwa.

        Added new test to check that the composition underline
        is using the text color.
        The test hides the text and the caret, so it only shows
        the composition underline and checks against an -expected-mismatch
        that the color of the composition marker is different.

        * editing/composition-underline-color-expected-mismatch.html: Added.
        * editing/composition-underline-color.html: Added.

2017-08-10  Nan Wang  <n_wang@apple.com>

        Layout test accessibility/press-target-uses-text-descendant-node.html is flaky.
        https://bugs.webkit.org/show_bug.cgi?id=175272
        <rdar://problem/33756962>

        Since accessibilityPress is async, we shouldn't rely on the timeout.

        Reviewed by Chris Fleizach.

        * accessibility/press-target-uses-text-descendant-node.html:

2017-08-10  Nan Wang  <n_wang@apple.com>

        AX: crash at WebCore::AccessibilityObject::supportsARIALiveRegion() const + 24
        https://bugs.webkit.org/show_bug.cgi?id=175340
        <rdar://problem/33782159>

        Reviewed by Chris Fleizach.

        * accessibility/add-children-pseudo-element-expected.txt: Added.
        * accessibility/add-children-pseudo-element.html: Added.
        * accessibility/resources/svg-circle.svg: Added.

2017-08-10  Miguel Gomez  <magomez@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of several tests failing at r220516.

        * platform/gtk/TestExpectations:

2017-08-09  Nan Wang  <n_wang@apple.com>

        LayoutTest accessibility/presentation-role-iframe.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=175194

        Reviewed by Chris Fleizach.

        In the test we have no way to control which iframe will be loaded first.
        Output the logs at the end of the test so that they are in order.

        * accessibility/presentation-role-iframe.html:

2017-08-09  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r219334.
        https://bugs.webkit.org/show_bug.cgi?id=175398

        Caused bug 175023 (Requested by ap on #webkit).

        Reverted changeset:

        "[SVG] Leak in SVGAnimatedListPropertyTearOff"
        https://bugs.webkit.org/show_bug.cgi?id=172545
        http://trac.webkit.org/changeset/219334

2017-08-09  Kirill Ovchinnikov  <kirill.ovchinnikov@lge.com>

        Old subtitle track is not deleted on 'src' attribute change event
        https://bugs.webkit.org/show_bug.cgi?id=175031

        Reviewed by Eric Carlson.

        * media/track/text-track-src-change-expected.txt: Added.
        * media/track/text-track-src-change.html: Added.

2017-08-09  Ms2ger  <Ms2ger@igalia.com>

        [GTK] [WPE] Update expectations for global-constructors-attributes.html.
        https://bugs.webkit.org/show_bug.cgi?id=175373

        Unreviewed test gardening.

        * platform/gtk/js/dom/global-constructors-attributes-expected.txt:
        * platform/wpe/js/dom/global-constructors-attributes-expected.txt:

2017-08-08  Wenson Hsieh  <wenson_hsieh@apple.com>

        Unreviewed, rolling out r220393.

        This patch regresses the performance of WebPage::editorState.

        Reverted changeset:

        "[iOS WK2] WKWebView schedules nonstop layout after pressing
        cmb+b,i,u inside a contenteditable div"
        https://bugs.webkit.org/show_bug.cgi?id=175116
        http://trac.webkit.org/changeset/220393

2017-08-08  Chris Dumez  <cdumez@apple.com>

        [Beacon] Add support for CORS-preflighting for WK2 / NETWORK_SESSION
        https://bugs.webkit.org/show_bug.cgi?id=175264
        <rdar://problem/33547793>

        Reviewed by Youenn Fablet.

        Add layout test coverage.

        * http/wpt/beacon/cors/cors-preflight-arraybufferview-failure-expected.txt: Added.
        * http/wpt/beacon/cors/cors-preflight-arraybufferview-failure.html: Added.
        * http/wpt/beacon/cors/cors-preflight-arraybufferview-success-expected.txt: Added.
        * http/wpt/beacon/cors/cors-preflight-arraybufferview-success.html: Added.
        * http/wpt/beacon/cors/cors-preflight-blob-failure-expected.txt: Added.
        * http/wpt/beacon/cors/cors-preflight-blob-failure.html: Added.
        * http/wpt/beacon/cors/cors-preflight-blob-success-expected.txt: Added.
        * http/wpt/beacon/cors/cors-preflight-blob-success.html: Added.
        * http/wpt/beacon/cors/cors-preflight-cookie-expected.txt: Added.
        * http/wpt/beacon/cors/cors-preflight-cookie.html: Added.
        * http/wpt/beacon/resources/beacon-preflight.py: Added.
        (respondToCORSPreflight):
        (main):
        * http/wpt/beacon/resources/set-cookie.py: Added.
        (main):
        * platform/mac-wk1/TestExpectations:
        * platform/mac-wk2/TestExpectations:
        * platform/win/TestExpectations:

2017-08-08  Devin Rousso  <drousso@apple.com>

        Web Inspector: Canvas: support editing WebGL shaders
        https://bugs.webkit.org/show_bug.cgi?id=124211
        <rdar://problem/15448958>

        Reviewed by Matt Baker.

        * inspector/canvas/updateShader-expected.txt: Added.
        * inspector/canvas/updateShader.html: Added.

        * platform/win/TestExpectations:

2017-08-08  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/css/webkit-cursor-visibility-auto-hide.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=175195

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-08-08  Brent Fulgham  <bfulgham@apple.com>

        Sandbox flags do not support document.domain control
        https://bugs.webkit.org/show_bug.cgi?id=175281
        <rdar://problem/33778936>

        Reviewed by Chris Dumez.

        * fast/frames/resources/sandboxed-iframe-set-domain.html: Added.
        * fast/frames/sandboxed-iframe-domain.html: Added.
        * fast/frames/sandboxed-iframe-domain-expected.txt: Added.

2017-08-08  Matt Lewis  <jlewis3@apple.com>

        Skipping imported/w3c/IndexedDB-private-browsing/idbfactory_open12.html
        <rdar://problem/33555052>

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:
        * platform/mac-highsierra/TestExpectations:

2017-08-08  Ryan Haddad  <ryanhaddad@apple.com>

        Skip plugins/crash-restoring-plugin-page-from-page-cache.html on macOS debug.
        https://bugs.webkit.org/show_bug.cgi?id=175270

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-08-08  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/images/async-image-body-background-image.html as flaky on macOS.
        https://bugs.webkit.org/show_bug.cgi?id=175193

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-08-08  Jeremy Jones  <jeremyj@apple.com>

        Change fast seek logic to prevent ping-ponging.
        https://bugs.webkit.org/show_bug.cgi?id=175167
        rdar://problem/32936116

        Reviewed by Jer Noble.

        Test now requires forward fast seek result to be between current time and the target time,
        and a backward seek to be before the seek time.

        * media/video-fast-seek.html:
        * media/media-source/media-source-fastseek.html:

2017-08-08  Ms2ger  <Ms2ger@igalia.com>

        Remove obsolete failure expectations for event_loadedmetadata.html.
        https://bugs.webkit.org/show_bug.cgi?id=175027

        Unreviewed test gardening.

        * TestExpectations:

2017-08-08  John Wilander  <wilander@apple.com>

        Resource Load Statistics: Clear web processes' state on history removal
        https://bugs.webkit.org/show_bug.cgi?id=175271
        <rdar://problem/33756560>

        Reviewed by Chris Dumez.

        * http/tests/loading/resourceLoadStatistics/user-interaction-reported-after-website-data-removal-expected.txt: Added.
        * http/tests/loading/resourceLoadStatistics/user-interaction-reported-after-website-data-removal.html: Added.
        * platform/mac-wk2/TestExpectations:
            user-interaction-reported-after-website-data-removal.html marked as [ Pass ].

2017-08-08  Ryan Haddad  <ryanhaddad@apple.com>

        Fix baseline for http/tests/security/set-domain-remove-subdomain-for-ip-address.html.

        Unreviewed test gardening.

        * http/tests/security/set-domain-remove-subdomain-for-ip-address-expected.txt:

2017-08-08  Matt Lewis  <jlewis3@apple.com>

        Fixed rebaselined expectations for js/dom/global-constructors-attributes.html.
        https://bugs.webkit.org/show_bug.cgi?id=175201

        Unreviewed test gardening.

        * platform/mac-elcapitan-wk2/js/dom/global-constructors-attributes-expected.txt: Renamed from LayoutTests/platform/mac-elcapitan-wk2/js/dom/global-constructors-attributes-dedicated-worker-expected.txt.

2017-08-08  Brent Fulgham  <bfulgham@apple.com>

        Unreviewed test results fix after r220376.

        Rebaseline for new SecurityException message text.

        * fast/dom/Document/invalid-domain-change-throws-exception-expected.txt:
        * http/tests/dom/document-attributes-null-handling-expected.txt:
        * http/tests/security/set-domain-remove-subdomain-for-ip-address-expected.txt:
        * http/tests/security/xss-DENIED-invalid-domain-change-expected.txt:

2017-08-08  Javier Fernandez  <jfernandez@igalia.com>

        Not possible to remove the 'li' element inside the table cell
        https://bugs.webkit.org/show_bug.cgi?id=173148

        Reviewed by Ryosuke Niwa.

        Regression tests for different scenarios of list items removal.

        * editing/deleting/delete-list-items-in-table-cell-1-expected.txt: Added.
        * editing/deleting/delete-list-items-in-table-cell-1.html: Added.
        * editing/deleting/delete-list-items-in-table-cell-2-expected.txt: Added.
        * editing/deleting/delete-list-items-in-table-cell-2.html: Added.
        * editing/deleting/delete-list-items-in-table-cell-3-expected.txt: Added.
        * editing/deleting/delete-list-items-in-table-cell-3.html: Added.
        * editing/deleting/delete-list-items-in-table-cell-4-expected.txt: Added.
        * editing/deleting/delete-list-items-in-table-cell-4.html: Added.
        * editing/deleting/delete-list-items-in-table-cell-5-expected.txt: Added.
        * editing/deleting/delete-list-items-in-table-cell-5.html: Added.
        * editing/deleting/delete-list-items-in-table-cell-6-expected.txt: Added.
        * editing/deleting/delete-list-items-in-table-cell-6.html: Added.
        * editing/deleting/delete-list-items-in-table-cell-7-expected.txt: Added.
        * editing/deleting/delete-list-items-in-table-cell-7.html: Added.
        * editing/deleting/delete-list-items-in-table-cell-8-expected.txt: Added.
        * editing/deleting/delete-list-items-in-table-cell-8.html: Added.

2017-08-08  Wenson Hsieh  <wenson_hsieh@apple.com>

        [iOS WK2] WKWebView schedules nonstop layout after pressing cmb+b,i,u inside a contenteditable div
        https://bugs.webkit.org/show_bug.cgi?id=175116
        <rdar://problem/28279301>

        Reviewed by Darin Adler and Ryosuke Niwa.

        Rebaseline some iOS WK2 LayoutTest expectations. These tests currently expect an empty anonymous RenderBlock to
        be inserted into the render tree, but this is only a result of us adding and removing a temporary <span> when
        computing a RenderStyle in WebPage::editorState -- this patch removes these empty RenderBlocks, making these
        expectations' RenderTrees consistent with WebKit1.

        * platform/ios-wk2/editing/inserting/insert-div-024-expected.txt:
        * platform/ios-wk2/editing/inserting/insert-div-026-expected.txt:
        * platform/ios-wk2/editing/style/5084241-expected.txt:
        * platform/ios-wk2/editing/style/unbold-in-bold-expected.txt:

2017-08-07  Matt Lewis  <jlewis3@apple.com>

        Marked media/modern-media-controls/fullscreen-support/fullscreen-support-press.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=173946

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-08-07  Matt Lewis  <jlewis3@apple.com>

        Rebaselined js/dom/global-constructors-attributes.html on El Capitan.
        https://bugs.webkit.org/show_bug.cgi?id=175201

        Unreviewed test gardening.
        * platform/mac-elcapitan-wk2/js/dom/global-constructors-attributes-dedicated-worker-expected.txt: Added.

2017-08-07  Matt Lewis  <jlewis3@apple.com>

        Changed expectations for webrtc/video-rotation.html.
        https://bugs.webkit.org/show_bug.cgi?id=175305

        Unreviewed test gardening.

        * TestExpectations:

2017-08-07  Devin Rousso  <drousso@apple.com>

        Web Inspector: Preview Canvas path when viewing a recording
        https://bugs.webkit.org/show_bug.cgi?id=174967

        Reviewed by Brian Burg.

        * fast/canvas/2d.currentPoint-expected.txt: Added.
        * fast/canvas/2d.currentPoint.html: Added.
        * fast/canvas/2d.getPath.modification-expected.txt: Added.
        * fast/canvas/2d.getPath.modification.html: Added.
        * fast/canvas/2d.getPath.newobject-expected.txt: Added.
        * fast/canvas/2d.getPath.newobject.html: Added.
        * fast/canvas/2d.setPath-expected.txt: Added.
        * fast/canvas/2d.setPath.html: Added.

        * inspector/canvas/recording-2d-expected.txt:
        * inspector/canvas/recording-2d.html:
        Updated for additional deduplication in InitialState.

2017-08-07  Ryan Haddad  <ryanhaddad@apple.com>

        Skip workers/wasm-hashset-many.html and workers/wasm-hashset-many-2.html on El Capitan.
        https://bugs.webkit.org/show_bug.cgi?id=175102

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-08-07  Ryan Haddad  <ryanhaddad@apple.com>

        Marking imported/w3c/web-platform-tests/html/browsers/windows/noreferrer-window-name.html as failing on iOS.
        https://bugs.webkit.org/show_bug.cgi?id=175273

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-08-07  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline js/dom/global-constructors-attributes.html.

        Unreviewed test gardening.

        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-08-07  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r220299.

        This change caused LayoutTest inspector/dom-debugger/dom-
        breakpoints.html to fail.

        Reverted changeset:

        "Web Inspector: capture async stack trace when workers/main
        context posts a message"
        https://bugs.webkit.org/show_bug.cgi?id=167084
        http://trac.webkit.org/changeset/220299

2017-08-07  Ms2ger  <Ms2ger@igalia.com>

        Remove obsolete failure expectations for wpt browsers tests.
        https://bugs.webkit.org/show_bug.cgi?id=175073

        Unreviewed test gardening.

        * TestExpectations:

2017-08-05  Youenn Fablet  <youenn@apple.com>

        [Fetch API] Response should keep all ResourceResponse information
        https://bugs.webkit.org/show_bug.cgi?id=175099

        Reviewed by Sam Weinig.

        Updating test now that we are no longer cancelling the load in case of opaque responses.

        * http/tests/inspector/network/fetch-network-data-expected.txt:
        * http/tests/inspector/network/fetch-network-data.html:

2017-08-05  Carlos Garcia Campos  <cgarcia@igalia.com>

        getClientRects doesn't work with list box option elements
        https://bugs.webkit.org/show_bug.cgi?id=175016

        Reviewed by Darin Adler.

        Add new test to check list box option elements client rects.

        * fast/dom/HTMLSelectElement/listbox-items-client-rects-expected.txt: Added.
        * fast/dom/HTMLSelectElement/listbox-items-client-rects.html: Added.
        * platform/ios-simulator-wk2/fast/dom/HTMLSelectElement/listbox-items-client-rects-expected.txt: Added.

2017-08-04  Youenn Fablet  <youenn@apple.com>

        [Cache API] Add Cache and CacheStorage IDL definitions
        https://bugs.webkit.org/show_bug.cgi?id=175201

        Reviewed by Brady Eidson.

        * TestExpectations:
        * platform/ios-wk1/TestExpectations:
        * platform/mac-wk1/TestExpectations:
        * js/dom/global-constructors-attributes-dedicated-worker-expected.txt:
        * platform/mac-highsierra/js/dom/global-constructors-attributes-expected.txt:

2017-08-04  Brady Eidson  <beidson@apple.com>

        Have navigator.serviceWorker() actually return a ServiceWorkerContainer object.
        https://bugs.webkit.org/show_bug.cgi?id=175215

        Reviewed by Youenn Fablet.

        * platform/mac-wk1/imported/w3c/web-platform-tests/FileAPI/historical.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/FileAPI/historical.https-expected.txt.

2017-08-04  Chris Dumez  <cdumez@apple.com>

        Add test coverage for sendBeacon() keepalive flag
        https://bugs.webkit.org/show_bug.cgi?id=175212

        Reviewed by Youenn Fablet.

        * http/wpt/beacon/keepalive-after-navigation-expected.txt: Added.
        * http/wpt/beacon/keepalive-after-navigation.html: Added.
        * http/wpt/beacon/support/sendBeacon-onunload-iframe.html: Added.

2017-08-04  Chris Dumez  <cdumez@apple.com>

        [Beacon] Update sendBeacon to use the CachedResourceLoader
        https://bugs.webkit.org/show_bug.cgi?id=175192
        <rdar://problem/33725923>

        Reviewed by Youenn Fablet.

        Rebaseline a few tests now that the Origin header is properly set of our Beacon
        requests. This is a progression and matches the results from Blink.

        Our Content-Type header for ArrayBuffer / ArrayBufferView payloads has also
        changed. It is unclear which one is best but at least we are now consistent
        with Fetch.

        * http/tests/blink/sendbeacon/beacon-cookie-expected.txt:
        * http/tests/blink/sendbeacon/beacon-cross-origin-expected.txt:
        * http/tests/blink/sendbeacon/beacon-same-origin-expected.txt:
        * http/wpt/beacon/headers/header-content-type-same-origin.html:

2017-08-04  John Wilander  <wilander@apple.com>

        Resource Load Statistics: Report user interaction immediately, but only when needed
        https://bugs.webkit.org/show_bug.cgi?id=175090
        <rdar://problem/33685546>

        Reviewed by Chris Dumez.

        * http/tests/loading/resourceLoadStatistics/user-interaction-in-cross-origin-sub-frame.html:
            Now no longer needs to disable throttling since reports of
            user interaction happen immediately (when needed).
        * http/tests/loading/resourceLoadStatistics/user-interaction-only-reported-once-within-short-period-of-time-expected.txt: Added.
        * http/tests/loading/resourceLoadStatistics/user-interaction-only-reported-once-within-short-period-of-time.html: Added.
        * platform/mac-wk2/TestExpectations:
            user-interaction-only-reported-once-within-short-period-of-time.html marked as [ Pass ].

2017-08-04  Matt Baker  <mattbaker@apple.com>

        Web Inspector: capture async stack trace when workers/main context posts a message
        https://bugs.webkit.org/show_bug.cgi?id=167084
        <rdar://problem/30033673>

        Reviewed by Brian Burg.

        Add a test to check for asynchronous stack trace data when the debugger
        pauses inside a MessageEvent handler.

        * inspector/debugger/async-stack-trace-expected.txt:
        * inspector/debugger/async-stack-trace.html:
        * inspector/debugger/resources/postMessage-echo.html: Added.

2017-08-04  Chris Dumez  <cdumez@apple.com>

        LayoutTest imported/w3c/web-platform-tests/beacon/beacon-basic-string.html is a flaky failure (harness timeout)
        https://bugs.webkit.org/show_bug.cgi?id=175202

        Unreviewed, mark test as flaky.

        * TestExpectations:

2017-08-04  Devin Rousso  <drousso@apple.com>

        Web Inspector: add source view for WebGL shader programs
        https://bugs.webkit.org/show_bug.cgi?id=138593
        <rdar://problem/18936194>

        Reviewed by Matt Baker.

        * inspector/canvas/requestShaderSource-expected.txt: Added.
        * inspector/canvas/requestShaderSource.html: Added.

        * inspector/canvas/resources/shaderProgram-utilities.js:
        (linkProgram):
        (linkProgram.typeForScript):
        (linkProgram.createShaderFromScript):

        * platform/win/TestExpectations:

2017-08-04  Said Abou-Hallawa  <sabouhallawa@apple.com>

        RenderImageResourceStyleImage::image() should return the nullImage() if the image is not available
        https://bugs.webkit.org/show_bug.cgi?id=174874
        <rdar://problem/33530130>

        Reviewed by Simon Fraser.

        * fast/images/image-element-image-content-data-expected.txt: Added.
        * fast/images/image-element-image-content-data.html: Added.

2017-08-04  Matt Lewis  <jlewis3@apple.com>

        Rebaslining fast/text/font-selection-font-loading-api-parse.html for iOS 11.

        Unreviewed test gardening.

        * platform/ios-11/fast/text/font-selection-font-loading-api-parse-expected.txt:

2017-08-04  Chris Dumez  <cdumez@apple.com>

        PROGRESSION? Multiple imported/w3c/web-platform-tests/fetch/api/ test have started to fail.
        https://bugs.webkit.org/show_bug.cgi?id=175061

        Unreviewed, mark Fetch/Cors tests as failing on wk2 ElCapitan only, as those tests seem to be passing
        everywhere else.

        * platform/mac-wk2/TestExpectations:
        * platform/mac/TestExpectations:

2017-08-04  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r220268.

        This change caused assertion failures on macOS and iOS Debug
        WK2.

        Reverted changeset:

        "Resource Load Statistics: Report user interaction
        immediately, but only when needed"
        https://bugs.webkit.org/show_bug.cgi?id=175090
        http://trac.webkit.org/changeset/220268

2017-08-04  Chris Dumez  <cdumez@apple.com>

        Mark beacon-basic-string.html as slow.

        * TestExpectations:

2017-08-04  Brady Eidson  <beidson@apple.com>

        Enable ServiceWorkers at runtime for WebKitTestRunner.
        https://bugs.webkit.org/show_bug.cgi?id=175174

        Reviewed by Youenn Fablet.

        * fast/dom/navigator-detached-no-crash-expected.txt:
        * platform/mac-wk1/fast/dom/navigator-detached-no-crash-expected.txt: Copied from LayoutTests/fast/dom/navigator-detached-no-crash-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/background-fetch/interfaces-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/background-fetch/interfaces-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/background-fetch/interfaces-worker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/background-fetch/interfaces-worker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/policies/referrer-no-referrer-service-worker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/fetch/api/policies/referrer-no-referrer-service-worker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/policies/referrer-origin-service-worker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/fetch/api/policies/referrer-origin-service-worker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/policies/referrer-origin-when-cross-origin-service-worker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/fetch/api/policies/referrer-origin-when-cross-origin-service-worker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/policies/referrer-unsafe-url-service-worker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/fetch/api/policies/referrer-unsafe-url-service-worker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/html/webappapis/scripting/events/messageevent-constructor.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/html/webappapis/scripting/events/messageevent-constructor.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/html/webappapis/scripting/processing-model-2/integration-with-the-javascript-agent-formalism/canblock-serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/html/webappapis/scripting/processing-model-2/integration-with-the-javascript-agent-formalism/canblock-serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/byte-length-queuing-strategy.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/byte-length-queuing-strategy.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/count-queuing-strategy.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/count-queuing-strategy.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/piping/close-propagation-backward.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/piping/close-propagation-backward.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/piping/close-propagation-forward.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/piping/close-propagation-forward.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/piping/error-propagation-backward.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/piping/error-propagation-backward.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/piping/error-propagation-forward.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/piping/error-propagation-forward.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/piping/flow-control.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/piping/flow-control.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/piping/general.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/piping/general.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/piping/multiple-propagation.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/piping/multiple-propagation.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/piping/pipe-through.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/piping/pipe-through.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/piping/transform-streams.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/piping/transform-streams.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/readable-byte-streams/general.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/piping/general.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/readable-streams/bad-strategies.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/readable-streams/bad-strategies.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/readable-streams/bad-underlying-sources.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/readable-streams/bad-underlying-sources.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/readable-streams/brand-checks.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/readable-streams/brand-checks.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/readable-streams/cancel.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/readable-streams/cancel.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/readable-streams/count-queuing-strategy-integration.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/readable-streams/count-queuing-strategy-integration.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/readable-streams/default-reader.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/readable-streams/default-reader.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/readable-streams/floating-point-total-queue-size.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/readable-streams/floating-point-total-queue-size.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/readable-streams/garbage-collection.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/readable-streams/garbage-collection.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/readable-streams/general.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/piping/general.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/readable-streams/pipe-through.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/piping/pipe-through.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/readable-streams/readable-stream-reader.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/readable-streams/readable-stream-reader.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/readable-streams/tee.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/readable-streams/tee.serviceworker.https-expected.txt.
        * platform/mac-wk1/imported/w3c/web-platform-tests/streams/readable-streams/templated.serviceworker.https-expected.txt: Copied from LayoutTests/imported/w3c/web-platform-tests/streams/readable-streams/templated.serviceworker.https-expected.txt.
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-08-04  Zan Dobersek  <zdobersek@igalia.com>

        [EME][GStreamer] Register ClearKey CDMFactory
        https://bugs.webkit.org/show_bug.cgi?id=175136

        Reviewed by Xabier Rodriguez-Calvar.

        Update WPE baselines for EME ClearKey tests following some advancements in
        ClearKey support.

        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-events-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-events-session-closed-event-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-generate-request-disallowed-input-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-invalid-license-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-keystatuses-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-keystatuses-multiple-sessions-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-clear-encrypted-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-encrypted-clear-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-encrypted-clear-sources-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-events-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-multikey-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-multikey-sequential-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-multikey-sequential-readyState-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-multisession-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-setMediaKeys-after-src-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-setMediaKeys-after-update-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-setMediaKeys-immediately-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-setMediaKeys-onencrypted-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-two-videos-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-waitingforkey-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-requestmediakeysystemaccess-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-reset-src-after-setmediakeys-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-setmediakeys-again-after-playback-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-setmediakeys-again-after-resetting-src-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-setmediakeys-at-same-time-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-setmediakeys-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-setmediakeys-multiple-times-with-the-same-mediakeys-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-setmediakeys-to-multiple-video-elements-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-syntax-mediakeys-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-syntax-mediakeysession-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-syntax-mediakeysystemaccess-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-update-disallowed-input-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-waiting-for-a-key-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-not-callable-after-createsession-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-update-non-ascii-input-expected.txt:

2017-08-04  John Wilander  <wilander@apple.com>

        Resource Load Statistics: Report user interaction immediately, but only when needed
        https://bugs.webkit.org/show_bug.cgi?id=175090
        <rdar://problem/33685546>

        Reviewed by Chris Dumez.

        * http/tests/loading/resourceLoadStatistics/user-interaction-in-cross-origin-sub-frame.html:
            Now no longer needs to disable throttling since reports of
            user interaction happen immediately (when needed).
        * http/tests/loading/resourceLoadStatistics/user-interaction-only-reported-once-within-short-period-of-time-expected.txt: Added.
        * http/tests/loading/resourceLoadStatistics/user-interaction-only-reported-once-within-short-period-of-time.html: Added.
        * platform/mac-wk2/TestExpectations:
            user-interaction-only-reported-once-within-short-period-of-time.html marked as [ Pass ].

2017-08-04  Ms2ger  <Ms2ger@igalia.com>

        [GTK] Test gardening around MOUSE_CURSOR_SCALE.
        https://bugs.webkit.org/show_bug.cgi?id=109469

        Reviewed by Carlos Alberto Lopez Perez.

        Remove obsolete expectation for cursor-parsing-image-set.html; it may have
        started passing in r209396.

        Mark mouse-cursor-image-set.html as failing rather than using an incorrect
        -expected file.

        * platform/gtk/TestExpectations:
        * platform/gtk/fast/events/mouse-cursor-image-set-expected.txt: Removed.

2017-08-04  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed GTK+ gardening. Update test expectations and layout test baselines
        for Web Crypto tests now that the implementation is complete.

        * platform/gtk/TestExpectations:
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/encrypt_decrypt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/encrypt_decrypt/aes_cbc.worker-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/encrypt_decrypt/test_aes_cbc.https-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey/successes.worker-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/import_export: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/import_export/rsa_importKey.worker-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/import_export/test_rsa_importKey.https-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/sign_verify: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/sign_verify/rsa_pkcs.worker-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/sign_verify/rsa_pss.worker-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/sign_verify/test_rsa_pkcs.https-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/sign_verify/test_rsa_pss.https-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/wrapKey_unwrapKey: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/wrapKey_unwrapKey/test_wrapKey_unwrapKey.https-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/wrapKey_unwrapKey/wrapKey_unwrapKey.worker-expected.txt: Added.

2017-08-04  Frederic Wang  <fwang@igalia.com>

        ScrollingTreeOverflowScrollingNodeIOS uses the wrong fixed position rectangle
        https://bugs.webkit.org/show_bug.cgi?id=175135

        Reviewed by Simon Fraser.

        This patch adds a new test for a position:fixed element inside an overflow node inside an
        iframe. When scrolling the overflow node, the position of such an element should remain fixed
        relative to the inner frame. Before that change, ScrollingTreeOverflowScrollingNodeIOS used
        to take the main frame as a reference instead, causing the element to flicker and even to
        disappear when the user scrolls that overflow node. We add a reftest to verify that the
        element is visible and positioned at the correct location when the user scrolls.

        * fast/scrolling/ios/fixed-inside-overflow-inside-iframe-expected.html: Added.
        * fast/scrolling/ios/fixed-inside-overflow-inside-iframe.html: Added.

2017-08-04  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed WPE gardening. Update test expectations and layout test baselines
        for Web Crypto tests now that the implementation is complete.

        * platform/wpe/TestExpectations:
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey/successes.worker-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/import_export: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/import_export/rsa_importKey.worker-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/import_export/test_rsa_importKey.https-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/sign_verify: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/sign_verify/rsa_pkcs.worker-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/sign_verify/rsa_pss.worker-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/sign_verify/test_rsa_pkcs.https-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/sign_verify/test_rsa_pss.https-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/wrapKey_unwrapKey: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/wrapKey_unwrapKey/test_wrapKey_unwrapKey.https-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/wrapKey_unwrapKey/wrapKey_unwrapKey.worker-expected.txt: Added.

2017-08-03  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] Implement CryptoKeyEC PKCS#8 imports
        https://bugs.webkit.org/show_bug.cgi?id=173647

        Reviewed by Jiewen Tan.

        * platform/wpe/TestExpectations:
        Unskip passing Web Crypto tests that cover PKCS#8 imports of EC keys.

2017-08-03  Chris Dumez  <cdumez@apple.com>

        Fix parsing of <meta http-equiv=refresh> to allow time starting with a '.' without a leading 0
        https://bugs.webkit.org/show_bug.cgi?id=175132

        Reviewed by Darin Adler.

        * TestExpectations:
        Mark as flaky tests that used to not run because they were missing a subresource. Now that I imported
        this subresource, the tests run but are failing. When they fail, those tests are flaky due to the lines
        they log.

        * tests-options.json:

2017-08-03  Chris Dumez  <cdumez@apple.com>

        Multiple Layout tests from web-platform-tests/beacon/ are timing out.
        https://bugs.webkit.org/show_bug.cgi?id=175076
        <rdar://problem/33704752>

        Reviewed by Alexey Proskuryakov.

        * platform/ios-wk2/imported/w3c/web-platform-tests/fetch/api/basic/mode-no-cors-expected.txt: Removed.
        * platform/ios-wk2/imported/w3c/web-platform-tests/fetch/api/basic/mode-no-cors-worker-expected.txt: Removed.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any-expected.txt: Removed.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any.worker-expected.txt: Removed.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-no-preflight.any-expected.txt: Removed.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any-expected.txt: Removed.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any.worker-expected.txt: Removed.
        * platform/mac-wk2/imported/w3c/web-platform-tests/fetch/api/basic/mode-no-cors-expected.txt: Removed.
        * platform/mac-wk2/imported/w3c/web-platform-tests/fetch/api/basic/mode-no-cors-worker-expected.txt: Removed.
        Drop platform-specific expectations as those tests are now passing everywhere.

        * platform/wk2/TestExpectations:
        Unskip tests that are now passing.

2017-08-03  Matt Baker  <mattbaker@apple.com>

        Web Inspector: Instrument WebGLProgram created/deleted
        https://bugs.webkit.org/show_bug.cgi?id=175059

        Reviewed by Devin Rousso.

        Add tests for CanvasManager shader program events and ShaderProgram model object.
        WebGL and WebGL2 contexts are tested separately based on platform support.

        * inspector/canvas/resources/shaderProgram-utilities.js: Added.
        (createProgram):
        (deleteProgram):
        (deleteContext):
        (TestPage.registerInitializer.awaitProgramAdded):
        (TestPage.registerInitializer):
        (TestPage.registerInitializer.window.initializeTestSuite):
        (TestPage.registerInitializer.window.addSimpleTestCase):
        (TestPage.registerInitializer.window.addParentCanvasRemovedTestCase):

        * inspector/canvas/shaderProgram-add-remove-webgl-expected.txt: Added.
        * inspector/canvas/shaderProgram-add-remove-webgl.html: Added.
        * inspector/canvas/shaderProgram-add-remove-webgl2-expected.txt: Added.
        * inspector/canvas/shaderProgram-add-remove-webgl2.html: Added.

        * platform/gtk/TestExpectations:
        * platform/mac/TestExpectations:
        * platform/win/TestExpectations:

2017-08-03  Youenn Fablet  <youenn@apple.com>

        Import WPT service worker tests
        https://bugs.webkit.org/show_bug.cgi?id=175053

        Reviewed by Brady Eidson.

        * TestExpectations: skipping service worker tests.

2017-08-03  Ms2ger  <Ms2ger@igalia.com>

        Test gardening.
        https://bugs.webkit.org/show_bug.cgi?id=175137

        Unreviewed test gardening.

        * platform/gtk/TestExpectations:
        * platform/gtk/fast/images/async-image-multiple-clients-repaint-expected.txt: Added.
        * platform/gtk/fast/text/atsui-pointtooffset-calls-cg-expected.txt:
        * platform/win/TestExpectations:

2017-08-01  Sam Weinig  <sam@webkit.org>

        [WebIDL] Convert MutationCallback to be a normal generate callback
        https://bugs.webkit.org/show_bug.cgi?id=174140

        Reviewed by Darin Adler.

        * fast/dom/MutationObserver/mutation-observer-constructor-expected.txt:
        Update results for standard error messages.

2017-08-03  Chris Dumez  <cdumez@apple.com>

        Improve our support for referrer policies
        https://bugs.webkit.org/show_bug.cgi?id=175069
        <rdar://problem/33677313>

        Reviewed by Darin Adler.

        * http/tests/referrer-policy/origin-when-cross-origin/cross-origin-http-http-expected.txt: Added.
        * http/tests/referrer-policy/origin-when-cross-origin/cross-origin-http-http.html: Added.
        * http/tests/referrer-policy/origin-when-cross-origin/cross-origin-http.https-expected.txt: Added.
        * http/tests/referrer-policy/origin-when-cross-origin/cross-origin-http.https.html: Added.
        * http/tests/referrer-policy/origin-when-cross-origin/same-origin-expected.txt: Added.
        * http/tests/referrer-policy/origin-when-cross-origin/same-origin.html: Added.
        * http/tests/referrer-policy/resources/document.html: Added.
        * http/tests/referrer-policy/same-origin/cross-origin-http-http-expected.txt: Added.
        * http/tests/referrer-policy/same-origin/cross-origin-http-http.html: Added.
        * http/tests/referrer-policy/same-origin/cross-origin-http.https-expected.txt: Added.
        * http/tests/referrer-policy/same-origin/cross-origin-http.https.html: Added.
        * http/tests/referrer-policy/same-origin/same-origin-expected.txt: Added.
        * http/tests/referrer-policy/same-origin/same-origin.html: Added.
        * http/tests/referrer-policy/strict-origin-when-cross-origin/cross-origin-http-http-expected.txt: Added.
        * http/tests/referrer-policy/strict-origin-when-cross-origin/cross-origin-http-http.html: Added.
        * http/tests/referrer-policy/strict-origin-when-cross-origin/cross-origin-http.https-expected.txt: Added.
        * http/tests/referrer-policy/strict-origin-when-cross-origin/cross-origin-http.https.html: Added.
        * http/tests/referrer-policy/strict-origin-when-cross-origin/same-origin-expected.txt: Added.
        * http/tests/referrer-policy/strict-origin-when-cross-origin/same-origin.html: Added.
        * http/tests/referrer-policy/strict-origin/cross-origin-http-http-expected.txt: Added.
        * http/tests/referrer-policy/strict-origin/cross-origin-http-http.html: Added.
        * http/tests/referrer-policy/strict-origin/cross-origin-http.https-expected.txt: Added.
        * http/tests/referrer-policy/strict-origin/cross-origin-http.https.html: Added.
        * http/tests/referrer-policy/strict-origin/same-origin-expected.txt: Added.
        * http/tests/referrer-policy/strict-origin/same-origin.html: Added.
        Add layout test coverage.

        * http/tests/security/referrer-policy-invalid-expected.txt:
        Rebaseline test now that console message has changed.

2017-08-03  Daniel Bates  <dabates@apple.com>

        Support ::marker pseudo-element
        https://bugs.webkit.org/show_bug.cgi?id=141477

        Reviewed by David Hyatt.

        Add tests that check we respect ::marker when rendering the list item marker. I will
        submit all the tests in http/wpt/css/css-pseudo-4 to the Web Platform Tests repository
        shortly and then import them into the WebKit repository in a subsequent commit.

        * fast/lists/list-marker-with-display-expected.html: Added.
        * fast/lists/list-marker-with-display.html: Added.
        * http/wpt/css/css-pseudo-4/marker-and-other-pseudo-elements-expected.html: Added.
        * http/wpt/css/css-pseudo-4/marker-and-other-pseudo-elements.html: Added.
        * http/wpt/css/css-pseudo-4/marker-color-expected.html: Added.
        * http/wpt/css/css-pseudo-4/marker-color.html: Added.
        * http/wpt/css/css-pseudo-4/marker-font-properties-expected.html: Added.
        * http/wpt/css/css-pseudo-4/marker-font-properties.html: Added.
        * http/wpt/css/css-pseudo-4/marker-inherit-values-expected.html: Added.
        * http/wpt/css/css-pseudo-4/marker-inherit-values.html: Added.

2017-08-03  Ms2ger  <Ms2ger@igalia.com>

        [GTK] Remove obsolete failure expectation for narrow-non-breaking-space.html.
        https://bugs.webkit.org/show_bug.cgi?id=139493

        Unreviewed test gardening.

        It likely started passing in r205826 due to its change in Font.cpp.

        * platform/gtk/TestExpectations:

2017-08-03  Ms2ger  <Ms2ger@igalia.com>

        [GTK] Skip timezone-dependent Sputnik tests.
        https://bugs.webkit.org/show_bug.cgi?id=175120

        Unreviewed test gardening.

        These tests are skipped in the platform-neutral TestExpectations file because
        they only pass in Pacific Time (see bug 42625). There doesn't seem to be a
        reason for gtk to run them, and they do pass on the buildbot.

        * platform/gtk/TestExpectations:

2017-08-02  Devin Rousso  <drousso@apple.com>

        Web Inspector: add stack trace information for each RecordingAction
        https://bugs.webkit.org/show_bug.cgi?id=174663

        Reviewed by Joseph Pecoraro.

        * inspector/canvas/recording-2d-expected.txt:
        * inspector/canvas/recording-2d.html:
        * inspector/model/recording-expected.txt:
        * inspector/model/recording.html:

2017-08-02  Chris Dumez  <cdumez@apple.com>

        NetworkResourceLoader::setDefersLoading() may cause start() to be called multiple times
        https://bugs.webkit.org/show_bug.cgi?id=175109
        <rdar://problem/33363169>

        Reviewed by Brady Eidson.

        Extend test coverage to cover cacheable redirects to a resource that needs
        revalidation, similarly to the case in the radar.

        * http/tests/cache/disk-cache/disk-cache-redirect-expected.txt:
        * http/tests/cache/disk-cache/disk-cache-redirect.html:

2017-08-02  Youenn Fablet  <youenn@apple.com>

        HTTP tests with 'https' suffix are only run over HTTPS for WK2, not WK1
        https://bugs.webkit.org/show_bug.cgi?id=175089

        Reviewed by Chris Dumez.

        Removing no longer needed expectations.

        * platform/ios-wk1/http/tests/security/contentSecurityPolicy/upgrade-insecure-requests/iframe-upgrade.https-expected.txt: Removed.
        * platform/mac-wk1/http/tests/security/contentSecurityPolicy/upgrade-insecure-requests/iframe-upgrade.https-expected.txt: Removed.

2017-08-02  Matt Lewis  <jlewis3@apple.com>

        Marked http/tests/appcache/deferred-events-delete-while-raising-timer.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=175107

        Unreviewed test gardening.

        * TestExpectations:

2017-08-02  Matt Lewis  <jlewis3@apple.com>

        Removed bad expectations and marked test as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=175061

        Unreviewed test gardening.

        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/basic/mode-no-cors-expected.txt: Removed.
        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/basic/mode-no-cors-worker-expected.txt: Removed.
        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any-expected.txt: Removed.
        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any.worker-expected.txt: Removed.
        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/cors/cors-no-preflight.any-expected.txt: Removed.
        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/cors/cors-no-preflight.any.worker-expected.txt: Removed.
        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any-expected.txt: Removed.
        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any.worker-expected.txt: Removed.
        * platform/mac/TestExpectations:

2017-08-02  Andy Estes  <aestes@apple.com>

        REGRESSION (r207155): Unable to switch sheets when previewing Numbers '09 spreadsheets
        https://bugs.webkit.org/show_bug.cgi?id=175098
        <rdar://problem/31416763>

        Reviewed by Daniel Bates.

        * quicklook/multi-sheet-numbers-09-expected.txt: Added.
        * quicklook/multi-sheet-numbers-09.html: Added.
        * quicklook/resources/multi-sheet-numbers-09.numbers: Added.

2017-08-02  Chris Dumez  <cdumez@apple.com>

        Unreviewed, skip newly imported WPT that is slow in Debug builds.

        * TestExpectations:

2017-08-02  Joseph Pecoraro  <pecoraro@apple.com>

        inspector/runtime/CommandLineAPI-inspect.html is flaky.
        https://bugs.webkit.org/show_bug.cgi?id=175092

        Reviewed by Brian Burg.

        * inspector/runtime/CommandLineAPI-inspect-expected.txt:
        * inspector/runtime/CommandLineAPI-inspect.html:

2017-08-02  Chris Dumez  <cdumez@apple.com>

        Unreviewed, skip newly imported WPT HTTPS tests on WK2 only.

        The tests seem to work fine on WK1.

        * TestExpectations:
        * platform/wk2/TestExpectations:

2017-08-02  Matt Lewis  <jlewis3@apple.com>

        Unmarked imported/w3c/IndexedDB-private-browsing/idbfactory_open.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=174949

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-08-02  Chris Dumez  <cdumez@apple.com>

        Unreviewed, temporarily skip some HTTPS tests that time out on the bots.

        * TestExpectations:

2017-08-02  Matt Lewis  <jlewis3@apple.com>

        Added new expectations folders and moved expectations to correct folders.
        https://bugs.webkit.org/show_bug.cgi?id=175061

        Unreviewed gardening.
        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/basic/mode-no-cors-expected.txt: Renamed from LayoutTests/platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/basic/mode-no-cors-expected.txt.
        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/basic/mode-no-cors-worker-expected.txt: Renamed from LayoutTests/platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/basic/mode-no-cors-worker-expected.txt.
        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any-expected.txt: Renamed from LayoutTests/platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any-expected.txt.
        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any.worker-expected.txt: Renamed from LayoutTests/platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any.worker-expected.txt.
        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/cors/cors-no-preflight.any-expected.txt: Renamed from LayoutTests/platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/cors/cors-no-preflight.any-expected.txt.
        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/cors/cors-no-preflight.any.worker-expected.txt: Renamed from LayoutTests/platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/cors/cors-no-preflight.any.worker-expected.txt.
        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any-expected.txt: Renamed from LayoutTests/platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any-expected.txt.
        * platform/mac-elcapitan-wk2/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any.worker-expected.txt: Renamed from LayoutTests/platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any.worker-expected.txt.

2017-08-02  Ms2ger  <Ms2ger@igalia.com>

        Remove obsolete expectations for syntax-021.xml.
        https://bugs.webkit.org/show_bug.cgi?id=86142

        Reviewed by Sam Weinig.

        It may have started passing in r209396.

        * platform/gtk/TestExpectations:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:
        * platform/win/TestExpectations:

2017-08-02  Ms2ger  <Ms2ger@igalia.com>

        Remove overridden lines from win's TestExpectations.
        https://bugs.webkit.org/show_bug.cgi?id=175068

        Reviewed by Darin Adler.

        These lines cause lint errors and block any patch that touches the file from
        landing.

        * platform/win/TestExpectations:

2017-08-02  Ms2ger  <Ms2ger@igalia.com>

        [GTK] Layout test editing/pasteboard/copy-standalone-image.html failing
        https://bugs.webkit.org/show_bug.cgi?id=163184

        Unreviewed test gardening.

        Remove obsolete failure expectation for copy-standalone-image.html.

        The bug was fixed in r212428. (The test was also broken by both landings for
        bug 170956, until r216174 fixed it again.)

        * platform/gtk/TestExpectations:

2017-08-01  Chris Dumez  <cdumez@apple.com>

        Add initial support for navigator.sendBeacon
        https://bugs.webkit.org/show_bug.cgi?id=175007
        <rdar://problem/33547728>

        Reviewed by Sam Weinig.

        * fast/dom/navigator-detached-no-crash-expected.txt:
        Rebaseline test now that sendBeacon is exposed on navigator.

        * http/tests/blink/sendbeacon/beacon-cookie-expected.txt: Added.
        * http/tests/blink/sendbeacon/beacon-cookie.html: Added.
        * http/tests/blink/sendbeacon/beacon-cross-origin-expected.txt: Added.
        * http/tests/blink/sendbeacon/beacon-cross-origin-redirect-blob-expected.txt: Added.
        * http/tests/blink/sendbeacon/beacon-cross-origin-redirect-blob.html: Added.
        * http/tests/blink/sendbeacon/beacon-cross-origin-redirect-expected.txt: Added.
        * http/tests/blink/sendbeacon/beacon-cross-origin-redirect.html: Added.
        * http/tests/blink/sendbeacon/beacon-cross-origin.html: Added.
        * http/tests/blink/sendbeacon/beacon-cross-origin.https-expected.txt: Added.
        * http/tests/blink/sendbeacon/beacon-cross-origin.https.html: Added.
        * http/tests/blink/sendbeacon/beacon-detached-no-crash-expected.txt: Added.
        * http/tests/blink/sendbeacon/beacon-detached-no-crash.html: Added.
        * http/tests/blink/sendbeacon/beacon-same-origin-expected.txt: Added.
        * http/tests/blink/sendbeacon/beacon-same-origin.html: Added.
        * http/tests/blink/sendbeacon/connect-src-beacon-allowed-expected.txt: Added.
        * http/tests/blink/sendbeacon/connect-src-beacon-allowed.html: Added.
        * http/tests/blink/sendbeacon/resources/check-beacon.php: Added.
        * http/tests/blink/sendbeacon/resources/save-beacon.php: Added.
        Import more beacon test coverage from Blink.

        * http/wpt/beacon/connect-src-beacon-blocked.sub-expected.txt: Added.
        * http/wpt/beacon/connect-src-beacon-blocked.sub.html: Added.
        Improve test coverage for sendBeacon and CSP.

        * http/wpt/beacon/headers/header-content-type-same-origin-expected.txt: Added.
        * http/wpt/beacon/headers/header-content-type-same-origin.html: Added.
        Improve test coverage for sendBeacon with various types of payload. The test is done
        using same origin as we do not currently support sending some of those payloads cross
        origin yet.

        * imported/blink/fast/beacon/beacon-basic-expected.txt: Added.
        * imported/blink/fast/beacon/beacon-basic.html: Added.
        Import basic Beacon test coverage from Blink.

        * resources/window-postmessage-open-close.html: Added.
        * tests-options.json:

2017-08-01  Devin Rousso  <drousso@apple.com>

        Web Inspector: simplify WebInspector with WI
        https://bugs.webkit.org/show_bug.cgi?id=175058

        Reviewed by Joseph Pecoraro.

        * http/tests/inspector/**/*.html:
        * http/tests/websocket/tests/hybi/inspector/**/*.html:
        * inspector/**/*.html:

2017-08-01  Matt Lewis  <jlewis3@apple.com>

        Added expectations files for El Capitan.
        https://bugs.webkit.org/show_bug.cgi?id=175061

        Unreviewed test gardening.

        * platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/basic/mode-no-cors-expected.txt: Added.
        * platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/basic/mode-no-cors-worker-expected.txt: Added.
        * platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any-expected.txt: Added.
        * platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any.worker-expected.txt: Added.
        * platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/cors/cors-no-preflight.any-expected.txt: Added.
        * platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/cors/cors-no-preflight.any.worker-expected.txt: Added.
        * platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any-expected.txt: Added.
        * platform/mac-elcapitan/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any.worker-expected.txt: Added.

2017-08-01  Devin Rousso  <drousso@apple.com>

        Web Inspector: create Recording tab for displaying recordings
        https://bugs.webkit.org/show_bug.cgi?id=174484

        Reviewed by Joseph Pecoraro.

        * inspector/unit-tests/number-utilities-expected.txt:
        * inspector/unit-tests/number-utilities.html:

2017-08-01  Zalan Bujtas  <zalan@apple.com>

        REGRESSION (r217197): New Yorker website hangs for a long time on load, lots of blank tiles
        https://bugs.webkit.org/show_bug.cgi?id=175009
        <rdar://problem/33505791>

        Reviewed by Simon Fraser.

        * fast/frames/flattening/media-query-growing-content-expected.txt: Added.
        * fast/frames/flattening/media-query-growing-content.html: Added.
        * fast/frames/flattening/resources/media-query-min-height-with-flattening.html: Added.

2017-08-01  Youenn Fablet  <youenn@apple.com>

        Layout tests with 'https' suffix should be run over HTTPS
        https://bugs.webkit.org/show_bug.cgi?id=174992

        Reviewed by Chris Dumez.

        Updating test to allow display insecure content as otherwise the test would not complete now that it is run over HTTPS.
        Adding WK1 expected files as the warning message is not printed.

        * http/tests/security/contentSecurityPolicy/upgrade-insecure-requests/iframe-upgrade.https-expected.txt:
        * http/tests/security/contentSecurityPolicy/upgrade-insecure-requests/iframe-upgrade.https.html:
        * platform/ios-wk1/http/tests/security/contentSecurityPolicy/upgrade-insecure-requests/iframe-upgrade.https-expected.txt: Added.
        * platform/mac-wk1/http/tests/security/contentSecurityPolicy/upgrade-insecure-requests/iframe-upgrade.https-expected.txt: Added.

2017-08-01  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/IndexedDB-private-browsing/idbfactory_open.html as flaky.
        <rdar://problem/33555052>

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-08-01  Zan Dobersek  <zdobersek@igalia.com>

        [WebCrypto] Add PKCS#8 import test that covers `parameters` and `publicKey` values in ECPrivateKey
        https://bugs.webkit.org/show_bug.cgi?id=174420

        Reviewed by Darin Adler.

        Add test cases that cover testing of the optional ECParameters and publicKey bit string
        attributes in the ECPrivateKey ASN.1 structure that's embedded in the PKCS#8 PrivateKeyInfo
        ASN.1 structure.

        Per the spec, if the ECParameters attribute in the ECPrivateKey structure is present, the
        relevant curve object identifier should match the same curve identifier that's used in the
        ECParameters attribute of the AlgorithmIdentifier structure in PrivateKeyInfo. Both of these
        should of course match the curve that was specified for the import operation.

        For the publicKey bit string, the data contained there should be properly formatted for
        the specific curve, meaning it should be of proper curve-specific size and that it should
        use 0x04 as the leading byte, signalling an uncompressed EC point. On top of that the public
        key should have a valid value that positions it on the specified elliptic curve.

        These cases are covered for PKCS#8 key imports for P-256 and P-384 curves and for both ECDH
        and ECDSA algorithms in the newly-introduced tests. They are skipped on all platforms since
        no implementation in WebKit can pass them yet.

        * TestExpectations:
        * crypto/subtle/ecdh-import-pkcs8-key-p256-validate-ecprivatekey-parameters-publickey-expected.txt: Added.
        * crypto/subtle/ecdh-import-pkcs8-key-p256-validate-ecprivatekey-parameters-publickey.html: Added.
        * crypto/subtle/ecdh-import-pkcs8-key-p384-validate-ecprivatekey-parameters-publickey-expected.txt: Added.
        * crypto/subtle/ecdh-import-pkcs8-key-p384-validate-ecprivatekey-parameters-publickey.html: Added.
        * crypto/subtle/ecdsa-import-pkcs8-key-p256-validate-ecprivatekey-parameters-publickey-expected.txt: Added.
        * crypto/subtle/ecdsa-import-pkcs8-key-p256-validate-ecprivatekey-parameters-publickey.html: Added.
        * crypto/subtle/ecdsa-import-pkcs8-key-p384-validate-ecprivatekey-parameters-publickey-expected.txt: Added.
        * crypto/subtle/ecdsa-import-pkcs8-key-p384-validate-ecprivatekey-parameters-publickey.html: Added.

2017-08-01  Ms2ger  <Ms2ger@igalia.com>

        [GTK] Layout test fast/forms/content-with-margins-inside-button.html is failing
        https://bugs.webkit.org/show_bug.cgi?id=174610

        Reviewed by Darin Adler.

        Use an explicit text color for content-with-margins-inside-button.html.

        This makes the test pass in the GTK port.

        I also changed the formatting of the CSS to make it more readable.

        * fast/forms/content-with-margins-inside-button-expected.html:
        * fast/forms/content-with-margins-inside-button.html:
        * platform/gtk/TestExpectations:

2017-08-01  Ms2ger  <Ms2ger@igalia.com>

        Remove obsolete failure expectations for wpt XHR tests.
        https://bugs.webkit.org/show_bug.cgi?id=175024

        Reviewed by Darin Adler.

        * TestExpectations:
        * platform/gtk/TestExpectations:

2017-08-01  Ms2ger  <Ms2ger@igalia.com>

        Remove obsolete failure expectations for style-01.html.
        https://bugs.webkit.org/show_bug.cgi?id=175026

        Reviewed by Darin Adler.

        * TestExpectations:

2017-08-01  Ms2ger  <Ms2ger@igalia.com>

        Remove obsolete failure expectation for Document-characterSet-normalization.html.
        https://bugs.webkit.org/show_bug.cgi?id=175022

        Reviewed by Sam Weinig.

        The expectations were updated in r204605.

        * platform/gtk/TestExpectations:

2017-08-01  Ms2ger  <Ms2ger@igalia.com>

        Remove obsolete failure expectation for regional-indicators.html.
        https://bugs.webkit.org/show_bug.cgi?id=175021

        Reviewed by Sam Weinig.

        * platform/gtk/TestExpectations:

2017-08-01  Ms2ger  <Ms2ger@igalia.com>

        REGRESSION(r205909): Layout test editing/pasteboard/image-in-iframe.html is failing
        https://bugs.webkit.org/show_bug.cgi?id=163185

        Reviewed by Sam Weinig.

        Remove obsolete failure expectation for image-in-iframe.html.

        The bug was fixed in r212428. (The test was also broken by both landings for
        bug 170956, until r216174 fixed it again.)

        * platform/gtk/TestExpectations:

2017-08-01  Darin Adler  <darin@apple.com>

        REGRESSION (r220052): http/tests/media/video-play-stall.html times out
        https://bugs.webkit.org/show_bug.cgi?id=174988

        Reviewed by Sam Weinig.

        * TestExpectations: Stop skipping this test.

        * http/tests/media/video-play-stall.html: Use a 0-duration timeout to sidestep an
        issue where the test runner never thinks the test is done because of the stalled
        media loading, and times out. The behaviors here aren't great, but there is no
        reason to think that this confused state has any effect on web browsing; just on
        our test runners in a test that intentionally has a still loading video in it.

2017-08-01  Ms2ger  <Ms2ger@igalia.com>

        Correct the line numbers in GTK's scheme-about.any-expected.txt.
        https://bugs.webkit.org/show_bug.cgi?id=175017

        Reviewed by Sam Weinig.

        The code fix landed in r220050.

        * platform/gtk/imported/w3c/web-platform-tests/fetch/api/basic/scheme-about.any-expected.txt:

2017-07-31  Ms2ger  <Ms2ger@igalia.com>

        Remove some obsolete expected failures blamed on the threaded compositor.
        https://bugs.webkit.org/show_bug.cgi?id=174982

        Reviewed by Sergio Villar Senin.

        * platform/gtk/TestExpectations:

2017-07-31  Jiewen Tan  <jiewen_tan@apple.com>

        Unreviewed, test gardening

        * platform/mac-highsierra/TestExpectations:
        * platform/mac-highsierra/imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/test_pbkdf2_long_empty.https-expected.txt: Added.
        * platform/mac-highsierra/imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/test_pbkdf2_short_empty.https-expected.txt: Added.

2017-07-31  Matt Lewis  <jlewis3@apple.com>

        Skipped  http/tests/media/video-play-stall.html.
        https://bugs.webkit.org/show_bug.cgi?id=174988

        Unreviewed test gardening.
        * TestExpectations:

2017-07-31  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r220048.

        This revision caused multiple crashes in fast/images. See
        webkit.org/b/174990

        Reverted changeset:

        "RenderImageResourceStyleImage::image() should return the
        nullImage() if the image is not available"
        https://bugs.webkit.org/show_bug.cgi?id=174874
        http://trac.webkit.org/changeset/220048

2017-07-31  Per Arne Vollan  <pvollan@apple.com>

        Do not mark all web-platform tests as slow, as this increases time spent on layout tests.
        Only mark individual web-platform tests as slow.

        Unreviewed test gardening.

        * platform/win/TestExpectations:

2017-07-31  Yusuke Suzuki  <utatane.tea@gmail.com>

        [JSC] Support optional catch binding
        https://bugs.webkit.org/show_bug.cgi?id=174981

        Reviewed by Saam Barati.

        Rebaseline existing tests.

        * js/parser-syntax-check-expected.txt:
        * js/script-tests/parser-syntax-check.js:
        * sputnik/Conformance/12_Statement/12.14_The_try_Statement/S12.14_A16_T4-expected.txt:
        * sputnik/Conformance/12_Statement/12.14_The_try_Statement/S12.14_A16_T4.html:

2017-07-31  Per Arne Vollan  <pvollan@apple.com>

        Many web-platform tests are slow on Windows.

        Unreviewed test gardening, mark web-platform tests as slow.

        * platform/win/TestExpectations:

2017-07-31  Ms2ger  <Ms2ger@igalia.com>

        [GTK] Layout test fast/css/image-set-unprefixed.html is failing
        https://bugs.webkit.org/show_bug.cgi?id=163975

        Reviewed by Žan Doberšek.

        Remove obsolete expectation for image-set-unprefixed.html.

        It appears to have started passing with the test change in r209543.

        * platform/gtk/TestExpectations:

2017-07-31  Ms2ger  <Ms2ger@igalia.com>

        [GTK] Layout Tests fast/dom/{Element,Range}/getClientRects.html are failing
        https://bugs.webkit.org/show_bug.cgi?id=141700

        Reviewed by Sam Weinig.

        Add gtk-specific expectations for getClientRects tests.

        Since these expectations depend on text metrics, it is unsurprising that they
        are platform-dependent.

        * platform/gtk/TestExpectations:
        * platform/gtk/fast/dom/Element/getClientRects-expected.txt: Added.
        * platform/gtk/fast/dom/Range/getClientRects-expected.txt:

2017-07-30  Darin Adler  <darin@apple.com>

        Remove code in HTMLObjectElement attribute parsing that forces style resolution and layout
        https://bugs.webkit.org/show_bug.cgi?id=130653

        Reviewed by Antti Koivisto.

        * fast/text/international/embed-bidi-style-in-isolate-crash.html: Removed onerror attribute
        in the audio element in this test. The error event does fire during the test, which causes
        the test to fail. Before, the test was prematurely exiting before the load failed, preventing
        the test from failing, but also meaning we didn't finish running the test.

        * imported/blink/fast/dom/Window/open-window-features-fuzz.html: Use waitUntilDone and
        notifyDone to prevent the test from exiting prematurely. Use a URL that won't trigger loading
        outside the web browser; the URL is not what mattered to this test. Before, the test was
        prematurely exiting before the test ran. Note also, that I don't think this is testing
        much effectively; not sure we are getting any benefit from this test since before it was
        not really running to completion anyway.

        * media/event-queue-crash-expected.txt: Updated expectations to expect syntax error. Before
        there was a race and often the test exited before the syntax error could be logged.

        * platform/mac/TestExpectations: Removed flakiness expectation from the
        media/event-queue-crash.html test. What made it flaky was a race with the load event,
        and that race should be fixed by the change to FrameLoader::checkLoadCompleteForThisFrame.
        The same race existed on all platforms, not just Mac, so this flakiness expectation should
        be in the main TextExpectations file if anywhere. But I believe it is not needed at all.
        For media/modern-media-controls/media-documents/background-color-and-centering.html,
        added image failure expectation because under modern WebKit on Mac the image now captures
        the upper left hand corner of the controls overlay. Still seems to pass on iOS and the bug
        this was created for was iOS-specific, so should be OK for now.

        * webarchive/loading/video-in-webarchive-expected.txt: Updated. The old result shows evidence
        of a premature load event, fixed by the change to FrameLoader::checkLoadCompleteForThisFrame.

2017-07-30  Sam Weinig  <sam@webkit.org>

        [WebIDL] Remove JS builtin bindings for FetchRequest, DOMWindowFetch and WorkerGlobalScopeFetch
        https://bugs.webkit.org/show_bug.cgi?id=174974

        Reviewed by Darin Adler.

        * http/tests/inspector/network/fetch-network-data-expected.txt:
        Update results to have the correct line number for exceptions reported in the console.

2017-07-30  Said Abou-Hallawa  <sabouhallawa@apple.com>

        RenderImageResourceStyleImage::image() should return the nullImage() if the image is not available
        https://bugs.webkit.org/show_bug.cgi?id=174874
        <rdar://problem/33530130>

        Reviewed by Darin Adler.

        * fast/images/image-element-image-content-data-expected.txt: Added.
        * fast/images/image-element-image-content-data.html: Added.

2017-07-29  Nan Wang  <n_wang@apple.com>

        AX: findMatchingObjects doesn't work when the startObject is ignored
        https://bugs.webkit.org/show_bug.cgi?id=174965

        Reviewed by Chris Fleizach.

        * accessibility/mac/search-predicate-from-ignored-element-expected.txt: Added.
        * accessibility/mac/search-predicate-from-ignored-element.html: Added.

2017-07-29  Aaron Chu  <aaron_chu@apple.com>

        AX: FKA: Buttons need a visible focus indicator
        https://bugs.webkit.org/show_bug.cgi?id=171040
        <rdar://problem/30922548>

        Reviewed by Antoine Quint.

        * media/modern-media-controls/button/button-focus-state-expected.txt: Added.
        * media/modern-media-controls/button/button-focus-state.html: Added.
        * platform/ios-simulator/TestExpectations:
        * platform/mac-elcapitan/TestExpectations:

2017-07-28  Sam Weinig  <sam@webkit.org>

        [WebIDL] Remove JS builtin bindings for FetchHeaders
        https://bugs.webkit.org/show_bug.cgi?id=174905

        Reviewed by Alex Christensen.

        * fetch/header-constructor-is-array-expected.txt:
        * fetch/header-constructor-is-array.html:
        Update test to match spec. An array with out a prototype will not yield
        a valid Header as it is not iterable.

2017-07-28  Matt Baker  <mattbaker@apple.com>

        Web Inspector: capture an async stack trace when web content calls addEventListener
        https://bugs.webkit.org/show_bug.cgi?id=174739
        <rdar://problem/33468197>

        Reviewed by Brian Burg.

        Add test case checking that async stack traces are recorded for addEventListener.

        * inspector/debugger/async-stack-trace-expected.txt:
        * inspector/debugger/async-stack-trace.html:

2017-07-28  Matt Rajca  <mrajca@apple.com>

        Don't add autoplay restrictions to media elements created in response to user gestures.
        https://bugs.webkit.org/show_bug.cgi?id=174947

        Reviewed by Eric Carlson.

        Skip the test on iOS because "runWithKeyDown" does not work there.

        Jer: "Turns out the problem with iOS is that the WKTR EventSender is basically unwritten. It
        doesn't support sending mouse, key, or touch events, so our "do this during a user gesture"
        helper in video-test.js doesn't work."

        * media/video-create-with-user-gesture-expected.txt: Added.
        * media/video-create-with-user-gesture.html: Added.
        * platform/ios/TestExpectations:

2017-07-28  Per Arne Vollan  <pvollan@apple.com>

        The test imported/w3c/web-platform-tests/fetch/api/basic/accept-header.any.html is slow on Windows.

        Unreviewed test gardening, mark test as slow.

        * platform/win/TestExpectations:

2017-07-28  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r220016.

        Test needs to be unskipped due to configuration change in High
        Sierra.

        Reverted changeset:

        "Marked fast/images/pdf-as-image-with-annotations.html as
        image failure."
        http://trac.webkit.org/changeset/220016

2017-07-28  Matt Lewis  <jlewis3@apple.com>

        Marked fast/images/pdf-as-image-with-annotations.html as image failure.
        <rdar://problem/33550614>

        Unreviewed test gardening.

        * platform/mac-highsierra/TestExpectations:

2017-07-28  Matt Lewis  <jlewis3@apple.com>

        Marked multiple iimported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/ as failing.
        <rdar://problem/33548297>

        Unreviewed test gardening.

        * platform/mac-highsierra/TestExpectations:

2017-07-28  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/IndexedDB-private-browsing/idbfactory_open12.html as flaky.
        <rdar://problem/33555052>

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:
        * platform/mac-highsierra/TestExpectations:

2017-07-28  Myles C. Maxfield  <mmaxfield@apple.com>

        [macOS] Reeder's defaults font is Times instead of San Francisco
        https://bugs.webkit.org/show_bug.cgi?id=174885
        <rdar://problem/33462483>

        Reviewed by Simon Fraser.

        * fast/text/font-lookup-dot-prefix-case-sensitive-2-expected.html: Added.
        * fast/text/font-lookup-dot-prefix-case-sensitive-2.html: Added.
        * fast/text/font-lookup-dot-prefix-case-sensitive-expected-mismatch.html: Added.
        * fast/text/font-lookup-dot-prefix-case-sensitive.html: Added.

2017-07-28  Devin Rousso  <drousso@apple.com>

        Web Inspector: Record actions performed on CanvasRenderingContext2D
        https://bugs.webkit.org/show_bug.cgi?id=174482

        Reviewed by Joseph Pecoraro.

        * inspector/canvas/recording-2d-expected.txt: Added.
        * inspector/canvas/recording-2d.html: Added.
        * inspector/canvas/recording-expected.txt: Added.
        * inspector/canvas/recording.html: Added.
        Take a recording of all CanvasRenderingContext2D actions and dump the recorded JSON data.

2017-07-28  Per Arne Vollan  <pvollan@apple.com>

        The test imported/w3c/web-platform-tests/cors/allow-headers.htm is slow on Windows.

        Unreviewed test gardening, mark test as slow.

        * platform/win/TestExpectations:

2017-07-28  Myles C. Maxfield  <mmaxfield@apple.com>

        REGRESSION(r216944): Fallback fonts erroneously visible when the primary font is loading
        https://bugs.webkit.org/show_bug.cgi?id=174772
        <rdar://problem/33267643>

        Reviewed by Simon Fraser.

        * http/tests/webfont/font-loading-system-fallback-visibility-FontRanges-expected.html: Added.
        * http/tests/webfont/font-loading-system-fallback-visibility-FontRanges.html: Added.

2017-07-28  Per Arne Vollan  <pvollan@apple.com>

        REGRESSION(r125147): Layout Test svg/dom/SVGScriptElement/script-change-externalResourcesRequired-while-loading.svg is failing
        https://bugs.webkit.org/show_bug.cgi?id=93589

        Unreviewed test gardening, this test is also a flaky timeout on Windows.

        * platform/win/TestExpectations:

2017-07-28  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Implement EventSenderProxy in WTR
        https://bugs.webkit.org/show_bug.cgi?id=173419

        Reviewed by Žan Doberšek.

        Add the implementation of EventSenderProxy to the WTR. This
        allows us to extend the coverage of the test suite in WKWPE.

        * platform/wpe/TestExpectations: Unskip fast/events tests, marking failures
        that are related to features not yet implemented in WPE. Also remove other
        tests that are now passing thanks to having event injection.
        * platform/wpe/fast/dom/HTMLTableColElement/resize-table-using-col-width-expected.txt: Update.
        * platform/wpe/fast/dynamic/layer-hit-test-crash-expected.txt: Update.
        * platform/wpe/fast/events/clientXY-in-zoom-and-scroll-expected.txt: Added.
        * platform/wpe/ietestcenter/css3/bordersbackgrounds/background-attachment-local-scrolling-expected.txt: Update.

2017-07-27  Oleksandr Skachkov  <gskachkov@gmail.com>

        [ES] Add support finally to Promise
        https://bugs.webkit.org/show_bug.cgi?id=174503

        Reviewed by Yusuke Suzuki.

        * js/Promise-types-expected.txt:
        * js/script-tests/Promise-types.js:

2017-07-27  Aaron Chu  <aaron_chu@apple.com>

        AX: VoiceOver silent or skipping over time values on media player.
        https://bugs.webkit.org/show_bug.cgi?id=174324
        <rdar://problem/32021784>

        Reviewed by Antoine Quint.

        Added role attribute to modern media controls time lable class so that VoiceOver can access the time label when the media is playing.

        Updated time-label.html to test role attribute on mac. 
        Added ios-time-label.html to run time-label test without testing for role since accessibilityController does not expose a role property on iOS.

        * media/modern-media-controls/time-label/ios-time-label-expected.txt: Copied from LayoutTests/media/modern-media-controls/time-label/time-label-expected.txt.
        * media/modern-media-controls/time-label/ios-time-label.html: Copied from LayoutTests/media/modern-media-controls/time-label/time-label.html.
        * media/modern-media-controls/time-label/time-label-expected.txt:
        * media/modern-media-controls/time-label/time-label.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-07-27  Yusuke Suzuki  <utatane.tea@gmail.com>

        Hoist DOM binding attribute getter prologue into JavaScriptCore taking advantage of DOMJIT / CheckSubClass
        https://bugs.webkit.org/show_bug.cgi?id=171637

        Reviewed by Darin Adler.

        * js/dom/dom-getters-type-check-expected.txt: Added.
        * js/dom/dom-getters-type-check.html: Added.

2017-07-27  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] Key serialization support
        https://bugs.webkit.org/show_bug.cgi?id=173883

        Reviewed by Jiewen Tan.

        * platform/wpe/TestExpectations: Unskip the crypto/worker/ tests that
        utilize key serialization and are now passing.

2017-07-26  Arnaud Renevier  <a.renevier@sisa.samsung.com> and Fujii Hironori  <Hironori.Fujii@sony.com>

        Implement new TextMetrics, returned by canvas measureText()
        https://bugs.webkit.org/show_bug.cgi?id=82798

        Reviewed by Dean Jackson.

        Create a test that checks that:
             - ascent + descent is greater than zero
             - actualBoundingBoxLeft + actualBoundingBoxRight is somewhere
               quite close to width
             - when baseline is top, emHeightAscent is 0 (respectively
               bottom/emHeightDescent)
             - when baseline is hanging, hangingBaseline in 0 (respectively
               alphabetic and ideographic)
             - order of different vertical measures (for example,
               emHeightAscent is always higher that alphabeticBaseline)

        * fast/canvas/canvas-measureText-2-expected.txt: Added.
        * fast/canvas/canvas-measureText-2.html: Added.

2017-07-26  Matt Lewis  <jlewis3@apple.com>

        Marked Multiple imported/w3c/web-platform-tests/ as failing.
        <rdar://problem/33251388>

        Unreviewed test gardening.

        * platform/ios-11/TestExpectations:

2017-07-26  Matt Lewis  <jlewis3@apple.com>

        Rebaselined http/tests/quicklook/top-navigation-blocked-expected.txt.
        https://bugs.webkit.org/show_bug.cgi?id=174755
        
        Unreviewed test gardening.

        * platform/ios-11/http/tests/quicklook/top-navigation-blocked-expected.txt:

2017-07-26  Devin Rousso  <drousso@apple.com>

        Web Inspector: create protocol for recording Canvas contexts
        https://bugs.webkit.org/show_bug.cgi?id=174481

        Reviewed by Joseph Pecoraro.

        * inspector/model/recording-expected.txt: Added.
        * inspector/model/recording.html: Added.

2017-07-26  Ali Juma  <ajuma@chromium.org>

        Implement document.elementsFromPoint
        https://bugs.webkit.org/show_bug.cgi?id=153137

        Reviewed by Simon Fraser.

        * TestExpectations: Unskip a test.

2017-07-26  Brian Burg  <bburg@apple.com>

        Remove WEB_TIMING feature flag
        https://bugs.webkit.org/show_bug.cgi?id=174795

        Reviewed by Alex Christensen.

        * inspector/formatting/resources/javascript-tests/sample-normal-utilities-expected.js:
        (decodeBase64ToBlob):
        (timestamp): Deleted.
        * inspector/formatting/resources/javascript-tests/sample-normal-utilities.js:
        (decodeBase64ToBlob):
        (timestamp): Deleted.

2017-07-26  Matt Lewis  <jlewis3@apple.com>

        Rebaselined multiple fast/css/getComputedStyle.
        <rdar://problem/33416054>

        Unreviewed test gardening.

        * platform/mac-highsierra/fast/css/getComputedStyle/computed-style-expected.txt:
        * platform/mac-highsierra/fast/css/getComputedStyle/computed-style-without-renderer-expected.txt:

2017-07-26  Chris Dumez  <cdumez@apple.com>

        Pressing the Escape key should not be a valid user gesture to enter fullscreen
        https://bugs.webkit.org/show_bug.cgi?id=174864
        <rdar://problem/33009088>

        Reviewed by Geoffrey Garen.

        Add layout test coverage.

        * fullscreen/requestFullscreen-escape-key-expected.txt: Added.
        * fullscreen/requestFullscreen-escape-key.html: Added.

2017-07-26  Nan Wang  <n_wang@apple.com>

        AX: Incorrect range from index and length in contenteditable with <p> tags
        https://bugs.webkit.org/show_bug.cgi?id=174856

        Reviewed by Chris Fleizach.

        * accessibility/mac/range-for-contenteditable-newline-expected.txt:
        * accessibility/mac/range-for-contenteditable-newline.html:

2017-07-26  Ms2ger  <Ms2ger@igalia.com>

        Remove obsolete failure annotation for bad-charset-alias.html.
        https://bugs.webkit.org/show_bug.cgi?id=145048

        Reviewed by Carlos Garcia Campos.

        This appears to have been fixed in r204850.

        * platform/gtk/TestExpectations:

2017-07-26  Ms2ger  <Ms2ger@igalia.com>

        Remove obsolete failure expectations for 2d.fillStyle.parse.{rgb,rgba}-eof.
        https://bugs.webkit.org/show_bug.cgi?id=174857

        Reviewed by Žan Doberšek.

        These tests started passing in r209666.

        * platform/gtk/TestExpectations:

2017-07-26  Javier Fernandez  <jfernandez@igalia.com>

        InsertOrderedList command applied to table cells inserts an extra BR before the table
        https://bugs.webkit.org/show_bug.cgi?id=174593

        Reviewed by Darin Adler.

        Tests to verify that the insertOrderedList command works as expected when applied
        in table cells.

        * editing/inserting/insert-list-in-table-cell-01.html: Added.
        * editing/inserting/insert-list-in-table-cell-01-expected.txt: Added.
        * editing/inserting/insert-list-in-table-cell-02.html: Added.
        * editing/inserting/insert-list-in-table-cell-02-expected.txt: Added.
        * editing/inserting/insert-list-in-table-cell-03.html: Added.
        * editing/inserting/insert-list-in-table-cell-03-expected.txt: Added.
        * editing/inserting/insert-list-in-table-cell-04.html: Added.
        * editing/inserting/insert-list-in-table-cell-04-expected.txt: Added.
        * editing/inserting/insert-list-in-table-cell-05.html: Added.
        * editing/inserting/insert-list-in-table-cell-05-expected.txt: Added.
        * editing/inserting/insert-list-in-table-cell-06.html: Added.
        * editing/inserting/insert-list-in-table-cell-06-expected.txt: Added.
        * editing/inserting/insert-list-in-table-cell-07.html: Added.
        * editing/inserting/insert-list-in-table-cell-07-expected.txt: Added.
        * editing/inserting/insert-list-in-table-cell-08.html: Added.
        * editing/inserting/insert-list-in-table-cell-08-expected.txt: Added.

2017-07-26  Ms2ger  <Ms2ger@igalia.com>

        Fix an incorrect check in 2d.missingargs.html.
        https://bugs.webkit.org/show_bug.cgi?id=174854

        Reviewed by Carlos Garcia Campos.

        The check was introduced without explanation in r168302. This change reverts
        it to the previous, correct check.

        * canvas/philip/tests/2d.missingargs-expected.txt:
        * canvas/philip/tests/2d.missingargs.html:
        * platform/gtk/TestExpectations:
        * platform/ios/TestExpectations:
        * platform/mac/canvas/philip/tests/2d.missingargs-expected.txt: Removed.
        * platform/wpe/TestExpectations:

2017-07-26  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Enable KeyboardEvent key and code attributes
        https://bugs.webkit.org/show_bug.cgi?id=174822

        Reviewed by Žan Doberšek.

        * platform/wpe/TestExpectations: Mark
        fast/events/constructors/keyboard-event-constructor.html as passing.

2017-07-26  Zan Dobersek  <zdobersek@igalia.com>

        [WPE] WebGL2 support
        https://bugs.webkit.org/show_bug.cgi?id=174249

        Reviewed by Alex Christensen.

        * platform/wpe/TestExpectations:
        Unskip WebGL2 tests under the webgl/ directory. More tests under fast/canvas/webgl2/
        will be unskipped later.

2017-07-26  Nan Wang  <n_wang@apple.com>

        AX: should dispatch accessibilityPerformPressAction async on MacOS
        https://bugs.webkit.org/show_bug.cgi?id=174849

        Reviewed by Chris Fleizach.

        * accessibility/file-upload-button-with-axpress.html:
        * accessibility/mac/html5-input-number.html:
        * accessibility/mac/search-field-cancel-button.html:
        * accessibility/press-target-uses-text-descendant-node.html:
        * accessibility/press-targets-center-point.html:
        * accessibility/press-works-on-control-types.html:

2017-07-25  Andy Estes  <aestes@apple.com>

        [Apple Pay] Add "carteBancaire" as a supported payment network
        https://bugs.webkit.org/show_bug.cgi?id=174841
        <rdar://problem/31935596>

        Reviewed by Alex Christensen.

        * http/tests/ssl/applepay/ApplePaySession-expected.txt:
        * http/tests/ssl/applepay/ApplePaySession.html:
        * http/tests/ssl/applepay/ApplePaySessionV3.html:

2017-07-25  Matt Lewis  <jlewis3@apple.com>

        Marked multiple fast/ tests as crashing on High Sierra WK1.
        <rdar://problem/33522420>

        Unreviewed test gardening.

        * platform/mac-highsierra-wk1/TestExpectations:

2017-07-25  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/web-platform-tests/XMLHttpRequest/send-blob-with-no-mime-type.html as failing.
        <rdar://problem/33251388>

        Unreviewed test gardening.

        * platform/mac-highsierra/TestExpectations:

2017-07-25  Matt Lewis  <jlewis3@apple.com>

        Rebaselined the test http/tests/quicklook/top-navigation-blocked.html
        https://bugs.webkit.org/show_bug.cgi?id=174755

        Unreviewed test gardening.

        * http/tests/quicklook/top-navigation-blocked-expected.txt:

2017-07-25  Matt Lewis  <jlewis3@apple.com>

        Rebaselined missed test.
        https://bugs.webkit.org/show_bug.cgi?id=174734

        Unreviewed test gardening.

        * fast/events/touch/ios/touches-client-coords-after-zoom-expected.txt:

2017-07-25  Said Abou-Hallawa  <sabouhallawa@apple.com>

        Async image decoding for large images should be disabled after the first time a tile is painted
        https://bugs.webkit.org/show_bug.cgi?id=174451
        <rdar://problem/31246421>

        Reviewed by Simon Fraser.

        To test async image decoding for large images, we have to create the <img>
        element dynamically so we can listen to the load and webkitImageFrameReady
        events and know reliably when to end the test. But with this patch the async
        image decoding for large images will be disabled after the first paint. 
        That means async image decoding for large images will be disabled always
        unless we force the async image decoding till the image is painted for the
        first time. We use Internals::setLargeImageAsyncDecodingEnabledForTesting()
        to force the async image decoding. So painting an image in this case will
        require multiple paints; in all of them the async image decoding will be
        enabled. But this is okay because it resembles the case where the <img> is
        created from a static <img> tag in the HTML file.

        For new tests, where we want to make sure that mutating the DOM will not
        cause a flash, async image decoding will be forced till the image is drawn
        for the first time. After that the async image decoding is enabled but not
        forced.

        Disable new tests for WK1 because the async image decoding is always enabled
        because tiling does not necessarily exist in WK1 . But eventually the async
        image decoding for large images will be always disabled for WK1.

        * fast/images/async-image-background-change-expected.html: Added.
        * fast/images/async-image-background-change.html: Added.
        * fast/images/async-image-background-image-repeated.html:
        * fast/images/async-image-background-image.html:
        * fast/images/async-image-body-background-image.html:
        * fast/images/async-image-multiple-clients-repaint.html:
        * fast/images/async-image-src-change-expected.html: Added.
        * fast/images/async-image-src-change.html: Added.
        * fast/images/resources/green-400x400.png: Added.
        * fast/images/resources/red-100x100.png: Added.
        * fast/images/resources/red-400x400.png: Added.
        * fast/images/sprite-sheet-image-draw.html:
        * http/tests/multipart/multipart-async-image-expected.txt: Added.
        * http/tests/multipart/multipart-async-image.html: Added.
        * platform/ios-wk1/TestExpectations:
        * platform/mac-wk1/TestExpectations:

2017-07-25  Charlie Turner  <cturner@igalia.com>

        [GTK] Unreviewed test gardening
        https://bugs.webkit.org/show_bug.cgi?id=174820

        Unreviewed gardening.

        * platform/gtk/TestExpectations:

2017-07-25  Devin Rousso  <drousso@apple.com>
        Web Inspector: add context menu item for taking a screenshot of a node
        https://bugs.webkit.org/show_bug.cgi?id=174754

        Reviewed by Brian Burg.

        * inspector/unit-tests/number-utilities-expected.txt:
        * inspector/unit-tests/number-utilities.html:
        Add test for Number.zeroPad.

        Drive-by: Change tests to use expectEqual for better output on failure.

2017-07-25  Claudio Saavedra  <csaavedra@igalia.com>

        REGRESSION (r143068): fast/events/clientXY-in-zoom-and-scroll.html failing on GTK, Qt
        https://bugs.webkit.org/show_bug.cgi?id=110090

        Unreviewed gardening.

        This test only needed the expectation to be updated.

        * platform/gtk/TestExpectations: Remove test below.
        * platform/gtk/fast/events/clientXY-in-zoom-and-scroll-expected.txt: Added.

2017-07-24  Per Arne Vollan  <pvollan@apple.com>

        [Win] The tests fast/text/line-height-minimumFontSize*.html are failing.
        https://bugs.webkit.org/show_bug.cgi?id=174801

        Unreviewed test gardening, update test expectations for failing tests.

        * platform/win/TestExpectations:

2017-07-24  Matt Lewis  <jlewis3@apple.com>

        Marked tests as failures.
        <rdar://problem/33437597>
        
        Unreviewed test gardening.

        * platform/mac-highsierra/TestExpectations:

2017-07-24  Matt Lewis  <jlewis3@apple.com>

        Fixed typo in test expectations.
        https://bugs.webkit.org/show_bug.cgi?id=173010

        Unreviewed gardening.
        * platform/ios-simulator-wk2/TestExpectations:

2017-07-24  Per Arne Vollan  <pvollan@apple.com>

        [Win] Async image tests are failing.
        https://bugs.webkit.org/show_bug.cgi?id=174653

        Unreviewed test gardening, update test expectations for async image tests.

        * platform/win/TestExpectations:

2017-07-24  Simon Fraser  <simon.fraser@apple.com>

        Rebaseline this test. The previous result was generated using an older iOS SDK.

        * fast/events/ios/no-touch-events-when-stopping-momentum-scroll-in-mainframe-expected.txt:

2017-07-24  Per Arne Vollan  <pvollan@apple.com>

        Mark Skia font test as image only failure on Windows.

        Unreviewed test gardening.

        * platform/win/TestExpectations:

2017-07-24  Jeremy Jones  <jeremyj@apple.com>

        LayoutTest userscripts/user-script-audio-document.html failing on High Sierra
        https://bugs.webkit.org/show_bug.cgi?id=174726
        rdar://problem/30059973

        Reviewed by Alexey Proskuryakov.

        Underlying issue has been resolved.
        Re-enable test: userscripts/user-script-audio-document.html

        * platform/mac-highsierra/TestExpectations:

2017-07-24  Simon Fraser  <simon.fraser@apple.com>

        Fix typo (Timout -> Timeout).

        * platform/mac-wk2/TestExpectations:

2017-07-24  Jeremy Jones  <jeremyj@apple.com>

        5 wav media layoutTest timeouts on High Sierra
        https://bugs.webkit.org/show_bug.cgi?id=174725
        rdar://problem/30182218

        Reviewed by Andreas Kling.

        Underlying issue is fixed. Re-enable tests on High Sierra.

        media/audio-controls-timeline-in-media-document.html
        media/audio-data-url.html
        media/media-document-audio-controls-visible.html
        media/media-document-audio-repaint.html
        media/media-document-audio-size.html

        * platform/mac-highsierra/TestExpectations:

2017-07-24  Simon Fraser  <simon.fraser@apple.com>

        Revert "client" coordinates to be in scrolling coordinates
        https://bugs.webkit.org/show_bug.cgi?id=174734
        rdar://problem/33336930

        Reviewed by Tim Horton.
        
        Rebaseline.

        * fast/events/ios/no-touch-events-when-stopping-momentum-scroll-in-mainframe-expected.txt:
        * fast/visual-viewport/client-coordinates-relative-to-layout-viewport-expected.txt:
        * fast/visual-viewport/client-rects-relative-to-layout-viewport-expected.txt:
        * fast/visual-viewport/zoomed-fixed-expected.txt:
        * fast/visual-viewport/zoomed-fixed-header-and-footer-expected.txt:
        * fast/zooming/client-rect-in-fixed-zoomed-expected.txt:
        * platform/ios-wk2/fast/visual-viewport/client-rects-relative-to-layout-viewport-expected.txt:
        * platform/ios-wk2/imported/w3c/web-platform-tests/cssom-view/elementFromPoint-expected.txt: Added.
        * platform/ios/fast/visual-viewport/zoomed-fixed-expected.txt:
        * platform/ios/fast/visual-viewport/zoomed-fixed-header-and-footer-expected.txt:

2017-07-24  Matt Lewis  <jlewis3@apple.com>

        Marked tiled-drawing/scrolling/scroll-snap/scroll-snap-mandatory-mainframe-vertical.html as failure.
        https://bugs.webkit.org/show_bug.cgi?id=172148

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-07-23  Darin Adler  <darin@apple.com>

        Remove race from one plug-in test
        https://bugs.webkit.org/show_bug.cgi?id=130653

        Reviewed by Antti Koivisto.

        * plugins/plugin-remove-readystatechange.html: Updated test to use waitUntilDone/notifyDone
        rather than racing. Added a computation of offsetLeft to trigger layout and adding a long
        comment explaining why this is both needed and potentially insufficient in the long run.

2017-07-11  Frederic Wang  <fwang@igalia.com>

        Add attribute allow-top-navigation-by-user-activation to iframe sandbox
        https://bugs.webkit.org/show_bug.cgi?id=171327

        Reviewed by Chris Dumez.

        This patch adds tests to verify that a sandboxed iframe with the flag
        'allow-top-navigation-by-user-activation' or 'allow-top-navigation' can navigate the top
        level page, if navigation is triggered by a user gesture. This is based on a test from the
        Chromium repository.
        It also verifies that navigation fails when 'allow-top-navigation-by-user-activation' is
        absent, even when it is triggered by a user gesture.

        * http/tests/security/frameNavigation/resources/iframe-that-performs-parent-navigation-with-user-activation.html: Added. This is similar to iframe-that-performs-parent-navigation.html but it
        performs navigation of its parent using user activation.
        * http/tests/security/frameNavigation/sandbox-ALLOWED-top-navigation-with-user-gesture-1.html: Added.
        Test top navigation for a sandboxed frame with 'allow-top-navigation-by-user-activation'
        * http/tests/security/frameNavigation/sandbox-ALLOWED-top-navigation-with-user-gesture-1-expected.txt: Added.
        Add PASS expectation.
        * http/tests/security/frameNavigation/sandbox-ALLOWED-top-navigation-with-user-gesture-2.html: Added.
        Test top navigation for a sandboxed frame with 'allow-top-navigation'.
        * http/tests/security/frameNavigation/sandbox-ALLOWED-top-navigation-with-user-gesture-2-expected.txt: Added.
        Add PASS expectation.
        * http/tests/security/frameNavigation/sandbox-DENIED-top-navigation-with-user-gesture.html: Added.
        Test user-triggered navigation for a sandboxed frame without 'allow-top-navigation-by-user-activation'.
        * http/tests/security/frameNavigation/sandbox-DENIED-top-navigation-with-user-gesture-expected.txt: Added.
        Add reference with navigation failure.

2017-07-22  Chris Dumez  <cdumez@apple.com>

        Merge ExceptionBase into DOMException and drop custom toString
        https://bugs.webkit.org/show_bug.cgi?id=174755

        Reviewed by Sam Weinig.

        Rebaseline some tests now that DOMException's custom toString has been dropped
        and we rely on Error's toString. This causes the exception message to be
        slightly different.

        * fast/canvas/canvas-getImageData-invalid-result-buffer-crash-expected.txt:
        * fast/frames/sandboxed-iframe-history-denied-expected.txt:
        * fast/frames/sandboxed-iframe-navigation-top-denied-expected.txt:
        * fast/inspector-support/uncaught-dom1-exception-expected.txt:
        * fast/inspector-support/uncaught-dom3-exception-expected.txt:
        * fast/inspector-support/uncaught-dom8-exception-expected.txt:
        * fast/regions/selection/crash-deselect-expected.txt:
        * http/tests/security/listener/xss-JSTargetNode-onclick-addEventListener-expected.txt:
        * http/tests/security/listener/xss-JSTargetNode-onclick-shortcut-expected.txt:
        * http/tests/security/listener/xss-XMLHttpRequest-addEventListener-expected.txt:
        * http/tests/security/listener/xss-XMLHttpRequest-shortcut-expected.txt:
        * http/tests/security/listener/xss-window-onclick-addEventListener-expected.txt:
        * http/tests/security/listener/xss-window-onclick-shortcut-expected.txt:
        * http/tests/security/sandboxed-iframe-blocks-access-from-parent-expected.txt:
        * http/tests/security/sandboxed-iframe-modify-self-expected.txt:
        * http/tests/security/srcdoc-in-sandbox-cannot-access-parent-expected.txt:
        * http/tests/security/xss-DENIED-assign-location-hash-expected.txt:
        * http/tests/security/xss-DENIED-assign-location-host-expected.txt:
        * http/tests/security/xss-DENIED-assign-location-hostname-expected.txt:
        * http/tests/security/xss-DENIED-assign-location-nonstandardProperty-expected.txt:
        * http/tests/security/xss-DENIED-assign-location-pathname-expected.txt:
        * http/tests/security/xss-DENIED-assign-location-protocol-expected.txt:
        * http/tests/security/xss-DENIED-assign-location-reload-expected.txt:
        * http/tests/security/xss-DENIED-assign-location-search-expected.txt:
        * http/tests/security/xss-DENIED-frame-name-expected.txt:
        * http/tests/security/xss-DENIED-sandboxed-iframe-expected.txt:
        * http/tests/security/xss-DENIED-window-name-navigator-expected.txt:
        * inspector/debugger/command-line-api-exception-expected.txt:
        * inspector/debugger/regress-133182-expected.txt:
        * inspector/debugger/setPauseOnExceptions-all-expected.txt:
        * inspector/debugger/setPauseOnExceptions-none-expected.txt:
        * inspector/debugger/setPauseOnExceptions-uncaught-expected.txt:
        * platform/mac/fast/dynamic/015-expected.txt:

2017-07-21  Chris Dumez  <cdumez@apple.com>

        Drop IDBDatabaseException class
        https://bugs.webkit.org/show_bug.cgi?id=174743

        Reviewed by Darin Adler.

        Rebaseline test as the exception messages are slightly different.

        * storage/indexeddb/createIndex-after-failure-expected.txt:
        * storage/indexeddb/createIndex-after-failure-private-expected.txt:
        * storage/indexeddb/get-keyrange-expected.txt:
        * storage/indexeddb/get-keyrange-private-expected.txt:
        * storage/indexeddb/keypath-edges-expected.txt:
        * storage/indexeddb/keypath-edges-private-expected.txt:
        * storage/indexeddb/keyrange-expected.txt:
        * storage/indexeddb/keyrange-private-expected.txt:
        * storage/indexeddb/modern/idbdatabase-deleteobjectstore-failures-expected.txt:
        * storage/indexeddb/modern/idbdatabase-deleteobjectstore-failures-private-expected.txt:
        * storage/indexeddb/transaction-active-flag-expected.txt:
        * storage/indexeddb/transaction-active-flag-private-expected.txt:

2017-07-21  Per Arne Vollan  <pvollan@apple.com>

        Round-tripping stroke-width styles through getComputedStyle cause the text to gain a stroke.
        https://bugs.webkit.org/show_bug.cgi?id=174701

        Reviewed by Simon Fraser.

        * fast/css/round-trip-stroke-width-using-computed-style-expected.html: Added.
        * fast/css/round-trip-stroke-width-using-computed-style.html: Added.

2017-07-21  Nan Wang  <n_wang@apple.com>

        AX: Expose form validation on iOS as hint
        https://bugs.webkit.org/show_bug.cgi?id=174722
        <rdar://problem/33459761>

        Reviewed by Chris Fleizach.

        * accessibility/ios-simulator/form-control-validation-message-expected.txt: Added.
        * accessibility/ios-simulator/form-control-validation-message.html: Added.

2017-07-21  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: inspect(aFunction) should jump to function definition
        https://bugs.webkit.org/show_bug.cgi?id=149344
        <rdar://problem/11563607>

        Reviewed by Matt Baker.

        * inspector/runtime/CommandLineAPI-inspect-expected.txt: Added.
        * inspector/runtime/CommandLineAPI-inspect.html: Added.
        Add tests for the CommandLineAPI's inspect() and how it triggers the
        `Inspector.inspect` event with a RemoteObject and hints.

2017-07-21  Matt Lewis  <jlewis3@apple.com>

        Adjusted test expectations.
        https://bugs.webkit.org/show_bug.cgi?id=173861

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-07-21  Brady Eidson  <beidson@apple.com>

        Get rid of WebCore IconDatabase code.
        https://bugs.webkit.org/show_bug.cgi?id=174700

        Reviewed by Tim Horton.

        * fast/dom/icon-url-list-expected.txt:
        * fast/dom/icon-url-list.html:

2017-07-21  Chris Dumez  <cdumez@apple.com>

        Unreviewed, rebaseline test after r219708.

        * js/dom/global-constructors-attributes-expected.txt:
        * platform/gtk/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-highsierra-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-highsierra/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-yosemite/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:
        * platform/win/js/dom/global-constructors-attributes-expected.txt:

2017-07-21  Claudio Saavedra  <csaavedra@igalia.com>

        [GTK] Update test expectations after r219663

        Unreviewed gardening

        DOMException got its toString() removed so the output changes.

        * platform/gtk/crypto/subtle/aes-cbc-cfb-decrypt-malformed-parameters-expected.txt:
        * platform/gtk/crypto/subtle/aes-cbc-cfb-encrypt-malformed-parameters-expected.txt:
        * platform/gtk/crypto/subtle/aes-export-key-malformed-parameters-expected.txt:
        * platform/gtk/crypto/subtle/aes-generate-key-malformed-parameters-expected.txt:
        * platform/gtk/crypto/subtle/aes-import-key-malformed-parameters-expected.txt:
        * platform/gtk/crypto/subtle/rsa-generate-key-malformed-parameters-expected.txt:
        * platform/gtk/crypto/subtle/rsa-import-key-malformed-parameters-expected.txt:
        * platform/gtk/fast/mediastream/RTCPeerConnection-closed-state-expected.txt:
        * platform/gtk/fast/text/font-selection-font-loading-api-parse-expected.txt:
        * platform/gtk/http/tests/dom/document-attributes-null-handling-expected.txt:

2017-07-21  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Update expectation file

        Unreviewed gardening.

        Drop XPathException after r219708.

        * platform/wpe/js/dom/global-constructors-attributes-expected.txt:

2017-07-20  Antoine Quint  <graouts@apple.com>

        Turn tests at media/modern-media-controls/seek-forward-support back on
        https://bugs.webkit.org/show_bug.cgi?id=174690

        Reviewed by Dean Jackson.

        * platform/mac/TestExpectations:

2017-07-20  Antoine Quint  <graouts@apple.com>

        Turn tests at media/modern-media-controls/seek-backward-support back on
        https://bugs.webkit.org/show_bug.cgi?id=174689

        Reviewed by Dean Jackson.

        * platform/mac/TestExpectations:

2017-07-20  Antoine Quint  <graouts@apple.com>

        Turn tests at media/modern-media-controls/time-labels-support back on
        https://bugs.webkit.org/show_bug.cgi?id=174688

        Reviewed by Dean Jackson.

        * media/modern-media-controls/time-labels-support/elapsed-time-expected.txt:
        * media/modern-media-controls/time-labels-support/elapsed-time.html:
        * media/modern-media-controls/time-labels-support/remaining-time-expected.txt:
        * media/modern-media-controls/time-labels-support/remaining-time.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-07-20  Antoine Quint  <graouts@apple.com>

        Turn tests at media/modern-media-controls/status-support back on
        https://bugs.webkit.org/show_bug.cgi?id=174687

        Reviewed by Dean Jackson.

        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-07-20  Chris Dumez  <cdumez@apple.com>

        Drop legacy SVGException type
        https://bugs.webkit.org/show_bug.cgi?id=174695

        Reviewed by Darin Adler.

        Update existing tests to reflect behavior change.

        * fast/dom/Window/resources/window-properties.js:
        * js/dom/global-constructors-attributes-expected.txt:
        * platform/gtk/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-highsierra-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-highsierra/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-yosemite/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:
        * platform/win/js/dom/global-constructors-attributes-expected.txt:
        * platform/wpe/js/dom/global-constructors-attributes-expected.txt:
        * svg/animations/animate-marker-orient-from-angle-to-autostartreverse-expected.txt:
        * svg/custom/SVGException-expected.txt: Removed.
        * svg/custom/SVGException.html: Removed.
        * svg/custom/global-constructors-expected.txt:
        * svg/custom/global-constructors.html:
        * svg/custom/js-svg-constructors-expected.txt:
        * svg/custom/js-svg-constructors.svg:
        * svg/dom/SVGAnimatedEnumeration-SVGClipPathElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGComponentTransferFunctionElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGFEBlendElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGFEColorMatrixElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGFEConvolveMatrixElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGFEDisplacementMapElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGFEMorphologyElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGFETurbulenceElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGFilterElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGGradientElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGMarkerElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGMaskElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGPatternElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGTextContentElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGTextPathElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-expected.txt:
        * svg/dom/SVGException-obsolete-expected.txt: Added.
        * svg/dom/SVGException-obsolete.html: Added.
        * svg/dom/SVGMatrix-interface-expected.txt:
        * svg/dom/svglist-exception-on-out-bounds-error-expected.txt:
        * svg/filters/feBlend-invalid-mode-expected.txt:
        * svg/filters/feComponentTransfer-style-crash-expected.txt:
        * svg/filters/feDisplacementMap-crash-test-expected.txt:

2017-07-20  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r219700.

        This revision caused consistent timouts on iOS.

        Reverted changeset:

        "Turn tests at media/modern-media-controls/start-support back
        on"
        https://bugs.webkit.org/show_bug.cgi?id=174683
        http://trac.webkit.org/changeset/219700

2017-07-20  Chris Dumez  <cdumez@apple.com>

        Drop legacy XPathException type
        https://bugs.webkit.org/show_bug.cgi?id=174679

        Reviewed by Sam Weinig.

        Update existing tests to reflect behavior change.

        * dom/svg/level3/xpath/XPathEvaluator_createExpression_INVALID_EXPRESSION_ERR.js:
        (XPathEvaluator_createExpression_INVALID_EXPRESSION_ERR):
        * dom/svg/level3/xpath/XPathEvaluator_evaluate_INVALID_EXPRESSION_ERR.js:
        (XPathEvaluator_evaluate_INVALID_EXPRESSION_ERR):
        * dom/svg/level3/xpath/XPathEvaluator_evaluate_TYPE_ERR.js:
        (XPathEvaluator_evaluate_TYPE_ERR):
        * dom/svg/level3/xpath/XPathResult_TYPE_ERR.js:
        (XPathResult_TYPE_ERR):
        * fast/dom/DOMException/XPathException-expected.txt: Removed.
        * fast/dom/DOMException/XPathException.html: Removed.
        * fast/dom/DOMException/resources/XPathException.js: Removed.
        * fast/dom/Window/resources/window-properties.js:
        * fast/dom/Window/window-lookup-precedence-expected.txt:
        * fast/xpath/4XPath/Core/test_parser-expected.txt:
        * fast/xpath/invalid-functions-expected.txt:
        * fast/xpath/py-dom-xpath/expressions-expected.txt:
        * platform/gtk/fast/dom/Window/window-lookup-precedence-expected.txt:
        * platform/mac/fast/dom/Window/window-lookup-precedence-expected.txt:

2017-07-20  Chris Dumez  <cdumez@apple.com>

        Unreviewed, rolling out r219706.

        Broke iOS build

        Reverted changeset:

        "Drop legacy XPathException type"
        https://bugs.webkit.org/show_bug.cgi?id=174679
        http://trac.webkit.org/changeset/219706

2017-07-20  Chris Dumez  <cdumez@apple.com>

        Drop legacy XPathException type
        https://bugs.webkit.org/show_bug.cgi?id=174679

        Reviewed by Sam Weinig.

        Update existing tests to reflect behavior change.

        * dom/svg/level3/xpath/XPathEvaluator_createExpression_INVALID_EXPRESSION_ERR.js:
        (XPathEvaluator_createExpression_INVALID_EXPRESSION_ERR):
        * dom/svg/level3/xpath/XPathEvaluator_evaluate_INVALID_EXPRESSION_ERR.js:
        (XPathEvaluator_evaluate_INVALID_EXPRESSION_ERR):
        * dom/svg/level3/xpath/XPathEvaluator_evaluate_TYPE_ERR.js:
        (XPathEvaluator_evaluate_TYPE_ERR):
        * dom/svg/level3/xpath/XPathResult_TYPE_ERR.js:
        (XPathResult_TYPE_ERR):
        * fast/dom/DOMException/XPathException-expected.txt: Removed.
        * fast/dom/DOMException/XPathException.html: Removed.
        * fast/dom/DOMException/resources/XPathException.js: Removed.
        * fast/dom/Window/resources/window-properties.js:
        * fast/dom/Window/window-lookup-precedence-expected.txt:
        * fast/xpath/4XPath/Core/test_parser-expected.txt:
        * fast/xpath/invalid-functions-expected.txt:
        * fast/xpath/py-dom-xpath/expressions-expected.txt:
        * platform/gtk/fast/dom/Window/window-lookup-precedence-expected.txt:
        * platform/mac/fast/dom/Window/window-lookup-precedence-expected.txt:

2017-07-20  Matt Lewis  <jlewis3@apple.com>

        Rebaselined svg/css/getComputedStyle-basic.xhtml.
        
        Unreviewed test gardening.

        * platform/mac-highsierra/svg/css/getComputedStyle-basic-expected.txt:

2017-07-20  Antoine Quint  <graouts@apple.com>

        Turn tests at media/modern-media-controls/start-support back on
        https://bugs.webkit.org/show_bug.cgi?id=174683

        Reviewed by Dean Jackson.

        * media/modern-media-controls/start-support/start-support-click-to-start-expected.txt:
        * media/modern-media-controls/start-support/start-support-click-to-start.html:
        * media/modern-media-controls/start-support/start-support-fullscreen.html:
        * media/modern-media-controls/start-support/start-support-lowPowerMode-expected.txt:
        * media/modern-media-controls/start-support/start-support-lowPowerMode.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-07-20  Matt Lewis  <jlewis3@apple.com>

        Marked media/modern-media-controls/scrubber-support/scrubber-support-drag.html as flaky
        https://bugs.webkit.org/show_bug.cgi?id=174682

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-07-20  Chris Dumez  <cdumez@apple.com>

        Unreviewed, rebaseline test on all platforms after r219673.

        * js/dom/global-constructors-attributes-expected.txt:
        * platform/gtk/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-highsierra-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-highsierra/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-yosemite/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:
        * platform/win/js/dom/global-constructors-attributes-expected.txt:
        * platform/wpe/js/dom/global-constructors-attributes-expected.txt:

2017-07-20  Charlie Turner  <cturner@igalia.com>

        [GTK] Layout Test http/tests/media/hls/hls-progress.html is failing
        https://bugs.webkit.org/show_bug.cgi?id=141469

        Reviewed by Xabier Rodriguez-Calvar.

        Fixes the removed tests.

        * platform/gtk/TestExpectations:

2017-07-20  Michael Catanzaro  <mcatanzaro@igalia.com>

        Unreviewed GTK test gardening

        * platform/gtk/TestExpectations:

2017-07-20  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed WPE gardening. Updating test baselines after r219663.

        * platform/wpe/crypto/subtle/aes-cbc-cfb-decrypt-malformed-parameters-expected.txt:
        * platform/wpe/crypto/subtle/aes-cbc-cfb-encrypt-malformed-parameters-expected.txt:
        * platform/wpe/crypto/subtle/aes-export-key-malformed-parameters-expected.txt:
        * platform/wpe/crypto/subtle/aes-generate-key-malformed-parameters-expected.txt:
        * platform/wpe/crypto/subtle/aes-import-key-malformed-parameters-expected.txt:
        * platform/wpe/crypto/subtle/rsa-generate-key-malformed-parameters-expected.txt:
        * platform/wpe/crypto/subtle/rsa-import-key-malformed-parameters-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-destroy-persistent-license-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-persistent-license-events-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-persistent-license-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-persistent-usage-record-events-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-persistent-usage-record-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-retrieve-destroy-persistent-license-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-retrieve-persistent-license-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-retrieve-persistent-usage-record-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-clear-encrypted-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-encrypted-clear-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-encrypted-clear-sources-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-events-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-multikey-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-multikey-sequential-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-multikey-sequential-readyState-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-multisession-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-setMediaKeys-after-src-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-setMediaKeys-after-update-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-setMediaKeys-immediately-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-setMediaKeys-onencrypted-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-two-videos-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-waitingforkey-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-requestmediakeysystemaccess-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-reset-src-after-setmediakeys-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-setmediakeys-again-after-resetting-src-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-setmediakeys-multiple-times-with-the-same-mediakeys-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-unique-origin-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-not-callable-after-createsession-expected.txt:

2017-07-19  Simon Fraser  <simon.fraser@apple.com>

        getBoundingClientRects not updated for programmatic scrolls
        https://bugs.webkit.org/show_bug.cgi?id=174538
        rdar://problem/33049012

        Reviewed by Tim Horton.
        
        New results for these tests, reflecting the fact that programmatic scrolls now update
        the layout viewport.
        
        Clean up fast/dom/elementFromPoint-relative-to-viewport.html, and land an iOS expectation. The test
        uses eventSender.zoomPageOut() which is not expected to work correctly on iOS. It works when tested
        manually.

        * fast/dom/elementFromPoint-relative-to-viewport-expected.txt:
        * fast/dom/elementFromPoint-relative-to-viewport.html:
        * platform/ios-wk2/fast/dom/elementFromPoint-relative-to-viewport-expected.txt: Copied from LayoutTests/fast/dom/elementFromPoint-relative-to-viewport-expected.txt.
        * platform/ios-wk2/fast/visual-viewport/client-rects-relative-to-layout-viewport-expected.txt:
        * platform/ios-wk2/fast/visual-viewport/rtl-zoomed-rects-expected.txt:
        * platform/ios-wk2/fast/visual-viewport/zoomed-fixed-scroll-down-then-up-expected.txt:
        * platform/ios-wk2/fast/visual-viewport/zoomed-rects-expected.txt:
        * platform/ios/fast/visual-viewport/zoomed-fixed-expected.txt:
        * platform/ios/fast/visual-viewport/zoomed-fixed-header-and-footer-expected.txt:

2017-07-19  Myles C. Maxfield  <mmaxfield@apple.com>

        Setting the minimum font size preference doesn’t affect absolute line-height values, so lines overlap
        https://bugs.webkit.org/show_bug.cgi?id=174406
        <rdar://problem/10139227>

        Reviewed by Simon Fraser.

        * fast/text/line-height-minimumFontSize-autosize-expected.text: Added.
        * fast/text/line-height-minimumFontSize-autosize.html: Added.
        * fast/text/line-height-minimumFontSize-expected.txt: Added.
        * fast/text/line-height-minimumFontSize-text-zoom-expected.html: Added.
        * fast/text/line-height-minimumFontSize-text-zoom.html: Added.
        * fast/text/line-height-minimumFontSize-visual-expected.html: Added.
        * fast/text/line-height-minimumFontSize-visual.html: Added.
        * fast/text/line-height-minimumFontSize-zoom-expected.html: Added.
        * fast/text/line-height-minimumFontSize-zoom.html: Added.
        * fast/text/line-height-minimumFontSize.html: Added.

2017-07-18  Myles C. Maxfield  <mmaxfield@apple.com>

        Setting the minimum font size preference doesn’t affect absolute line-height values, so lines overlap
        https://bugs.webkit.org/show_bug.cgi?id=174406
        <rdar://problem/10139227>

        Reviewed by Simon Fraser.

        * fast/text/line-height-minimumFontSize-autosize-expected.text: Added.
        * fast/text/line-height-minimumFontSize-autosize.html: Added.
        * fast/text/line-height-minimumFontSize-expected.txt: Added.
        * fast/text/line-height-minimumFontSize-text-zoom-expected.html: Added.
        * fast/text/line-height-minimumFontSize-text-zoom.html: Added.
        * fast/text/line-height-minimumFontSize-visual-expected.html: Added.
        * fast/text/line-height-minimumFontSize-visual.html: Added.
        * fast/text/line-height-minimumFontSize-zoom-expected.html: Added.
        * fast/text/line-height-minimumFontSize-zoom.html: Added.
        * fast/text/line-height-minimumFontSize.html: Added.

2017-07-19  Chris Dumez  <cdumez@apple.com>

        DOMException should not have its own toString()
        https://bugs.webkit.org/show_bug.cgi?id=174630

        Reviewed by Sam Weinig.

        Rebaseline existing tests as the exception string is now slightly different.

2017-07-19  Antoine Quint  <graouts@apple.com>

        [iOS] REGRESSION: Scrubbing media using built-in controls does not pause media
        https://bugs.webkit.org/show_bug.cgi?id=174650
        <rdar://problem/33401877>

        Reviewed by Dean Jackson.

        Rebaseline and turn back on all the ScrubberSupport tests on macOS and iOS.

        * media/modern-media-controls/scrubber-support/ipad/scrubber-support-drag-expected.txt:
        * media/modern-media-controls/scrubber-support/ipad/scrubber-support-drag.html:
        * media/modern-media-controls/scrubber-support/scrubber-support-media-api-expected.txt:
        * media/modern-media-controls/scrubber-support/scrubber-support-media-api.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-07-19  Nan Wang  <n_wang@apple.com>

        AX: Web page reloaded when a node is labelling multiple childnodes
        https://bugs.webkit.org/show_bug.cgi?id=174655

        Reviewed by Chris Fleizach.

        * accessibility/mac/aria-labelledby-multiple-child-crash-expected.txt: Added.
        * accessibility/mac/aria-labelledby-multiple-child-crash.html: Added.

2017-07-19  Chris Dumez  <cdumez@apple.com>

        Make cross-origin properties enumerable
        https://bugs.webkit.org/show_bug.cgi?id=174576

        Reviewed by Darin Adler.

        Update / rebaseline some tests to reflect behavior change.

        * http/tests/security/cross-origin-descriptors-expected.txt:
        * http/tests/security/cross-origin-descriptors.html:
        * js/dom/getOwnPropertyDescriptor-expected.txt:
        * js/resources/getOwnPropertyDescriptor.js:

2017-07-19  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r219646.

        The test added are failing on all platforms

        Reverted changeset:

        "Setting the minimum font size preference doesn’t affect
        absolute line-height values, so lines overlap"
        https://bugs.webkit.org/show_bug.cgi?id=174406
        http://trac.webkit.org/changeset/219646

2017-07-19  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed WPE gardening.

        * platform/wpe/TestExpectations:
        Unskip a bunch of Web Crypto tests that are passing now that
        the underlying implementation has progressed.

2017-07-18  Myles C. Maxfield  <mmaxfield@apple.com>

        Setting the minimum font size preference doesn’t affect absolute line-height values, so lines overlap
        https://bugs.webkit.org/show_bug.cgi?id=174406
        <rdar://problem/10139227>

        Reviewed by Simon Fraser.

        * fast/text/line-height-minimumFontSize-autosize-expected.text: Added.
        * fast/text/line-height-minimumFontSize-autosize.html: Added.
        * fast/text/line-height-minimumFontSize-expected.txt: Added.
        * fast/text/line-height-minimumFontSize-text-zoom-expected.html: Added.
        * fast/text/line-height-minimumFontSize-text-zoom.html: Added.
        * fast/text/line-height-minimumFontSize-visual-expected.html: Added.
        * fast/text/line-height-minimumFontSize-visual.html: Added.
        * fast/text/line-height-minimumFontSize-zoom-expected.html: Added.
        * fast/text/line-height-minimumFontSize-zoom.html: Added.
        * fast/text/line-height-minimumFontSize.html: Added.

2017-07-18  Ali Juma  <ajuma@chromium.org>

        Align quirky number parsing with other browsers
        https://bugs.webkit.org/show_bug.cgi?id=155874

        Reviewed by Simon Fraser.

        * animations/animation-add-events-in-handler.html:
        * fast/css/animation-transition-duration-quirksmode-expected.txt: Added.
        * fast/css/animation-transition-duration-quirksmode.html: Added.

2017-07-18  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Modernize InjectedScriptSource
        https://bugs.webkit.org/show_bug.cgi?id=173890

        Reviewed by Brian Burg.

        * inspector/model/remote-object-expected.txt:
        * inspector/model/stack-trace-expected.txt:
        Now that we use classes, implicitly strict mode, the call frame
        for evaluate gets tail call eliminated.

2017-07-18  Ryosuke Niwa  <rniwa@webkit.org>

        REGRESSION(r218910): Crash when password field changes to text field
        https://bugs.webkit.org/show_bug.cgi?id=174560

        Reviewed by Zalan Bujtas.

        Added a regression test based on the test case provided by Daniel Bates.

        * accessibility/mac/input-type-change-crash-2-expected.txt: Added.
        * accessibility/mac/input-type-change-crash-2.html: Added.

2017-07-18  Matt Baker  <mattbaker@apple.com>

        Web Inspector: Refactoring: replace InspectorCanvasAgent::CanvasEntry with a helper class
        https://bugs.webkit.org/show_bug.cgi?id=174311

        Reviewed by Devin Rousso.

        Updated test expectations for new error strings.

        * inspector/canvas/css-canvas-clients-expected.txt:
        * inspector/canvas/requestContent-2d-expected.txt:
        * inspector/canvas/requestNode-expected.txt:
        * inspector/canvas/resolveCanvasContext-2d-expected.txt:

2017-07-18  Antoine Quint  <graouts@apple.com>

        Turn tests at media/modern-media-controls/playback-support back on
        https://bugs.webkit.org/show_bug.cgi?id=174639

        Reviewed by Dean Jackson.

        * media/modern-media-controls/playback-support/playback-support-button-click.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-07-18  Antoine Quint  <graouts@apple.com>

        Turn tests at media/modern-media-controls/pip-support back on
        https://bugs.webkit.org/show_bug.cgi?id=174636

        Reviewed by Dean Jackson.

        * media/modern-media-controls/pip-support/ipad/pip-support-tap.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac-elcapitan/TestExpectations:
        * platform/mac/TestExpectations:

2017-07-18  Matt Lewis  <jlewis3@apple.com>

        Marked http/tests/cache/disk-cache/redirect-chain-limits.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172662

        Unreviewed test gardening.

        * platform/wk2/TestExpectations:

2017-07-18  Matt Lewis  <jlewis3@apple.com>

        Marked http/tests/cache/disk-cache/disk-cache-vary-cookie.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172662

        Unreviewed test gardening.

        * platform/wk2/TestExpectations:

2017-07-18  Antoine Quint  <graouts@apple.com>

        [macOS] Mouse pointer does not hide during fullscreen playback
        https://bugs.webkit.org/show_bug.cgi?id=174638
        <rdar://problem/33244399>

        Reviewed by Dean Jackson.

        Add a test that checks that the "-webkit-cursor-visibility" is set to "auto-hide" when
        in fullscreen for the media controls container.

        * media/modern-media-controls/css/webkit-cursor-visibility-auto-hide-expected.txt: Added.
        * media/modern-media-controls/css/webkit-cursor-visibility-auto-hide.html: Added.
        * platform/ios-simulator/TestExpectations:

2017-07-18  Sam Weinig  <sam@webkit.org>

        [WebIDL] Remove custom bindings for MockContentFilterSettings
        https://bugs.webkit.org/show_bug.cgi?id=174606

        Reviewed by Andy Estes.

        * contentfiltering/allow-after-add-data.html:
        * contentfiltering/allow-after-finished-adding-data.html:
        * contentfiltering/allow-after-response.html:
        * contentfiltering/allow-after-will-send-request.html:
        * contentfiltering/allow-empty-document.html:
        * contentfiltering/allow-media-document.html:
        * contentfiltering/allow-never.html:
        * contentfiltering/block-after-add-data-then-allow-unblock.html:
        * contentfiltering/block-after-add-data-then-deny-unblock.html:
        * contentfiltering/block-after-add-data.html:
        * contentfiltering/block-after-finished-adding-data-then-allow-unblock.html:
        * contentfiltering/block-after-finished-adding-data-then-deny-unblock.html:
        * contentfiltering/block-after-finished-adding-data.html:
        * contentfiltering/block-after-response-then-allow-unblock.html:
        * contentfiltering/block-after-response-then-deny-unblock.html:
        * contentfiltering/block-after-response.html:
        * contentfiltering/block-after-will-send-request-then-allow-unblock.html:
        * contentfiltering/block-after-will-send-request-then-deny-unblock.html:
        * contentfiltering/block-after-will-send-request.html:
        * contentfiltering/block-never.html:
        * contentfiltering/modify-request-url.html:
        * contentfiltering/resources/contentfiltering.js:
        * http/tests/contentfiltering/allow-after-redirect.html:
        * http/tests/contentfiltering/block-after-redirect.html:
        * http/tests/contentfiltering/load-substitute-data-from-appcache.html:
        * http/tests/contentfiltering/modify-redirect-request-url.html:
        Update tests to use new MockContentFilterSettings enums rather than constants.

2017-07-18  Sam Weinig  <sam@webkit.org>

        [WebIDL] Replace some custom bindings code in JSCSSStyleDeclarationCustom.cpp with named getters/setters
        https://bugs.webkit.org/show_bug.cgi?id=174529

        Reviewed by Chris Dumez.

        * fast/dom/CSSStyleDeclaration/cssstyledeclaration-properties-descriptor-expected.txt:
        * fast/dom/CSSStyleDeclaration/cssstyledeclaration-properties-descriptor.html:
        Update test and result to match standard and other browsers. 

2017-07-18  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r219610.

        This caused an api failure on all platforms for the test
        SnapshotImageLargeAsyncDecoding

        Reverted changeset:

        "Async image decoding for large images should be disabled
        after the first time a tile is painted"
        https://bugs.webkit.org/show_bug.cgi?id=174451
        http://trac.webkit.org/changeset/219610

2017-07-18  Devin Rousso  <drousso@apple.com>

        Add CanvasRenderingContext2D::getTransform
        https://bugs.webkit.org/show_bug.cgi?id=174278

        Reviewed by Dean Jackson.

        * canvas/philip/tests/2d.missingargs.html:
        CanvasRenderingContext2D.prototype.setTransform no longer throws an error with no arguments.

        * fast/canvas/2d.getTransform.modification-expected.txt: Added.
        * fast/canvas/2d.getTransform.modification.html: Added.
        * fast/canvas/2d.getTransform.newobject-expected.txt: Added.
        * fast/canvas/2d.getTransform.newobject.html: Added.
        * fast/canvas/2d.setTransform.matrix-expected.txt: Added.
        * fast/canvas/2d.setTransform.matrix.html: Added.

2017-07-18  Matt Lewis  <jlewis3@apple.com>

        Rebaseline inspector/model/remote-object.html.
        https://bugs.webkit.org/show_bug.cgi?id=173991

        Unreviewed test gardening.

        * inspector/model/remote-object-expected.txt:

2017-07-18  Said Abou-Hallawa  <sabouhallawa@apple.com>

        Async image decoding for large images should be disabled after the first time a tile is painted
        https://bugs.webkit.org/show_bug.cgi?id=174451

        Reviewed by Simon Fraser.

        To test async image decoding for large images, we have to create the <img>
        element dynamically so we can listen to the load and webkitImageFrameReady
        events and know reliably when to end the test. But with this patch the async
        image decoding for large images will be disabled after the first paint. 
        That means async image decoding for large images will be disabled always
        unless we force the async image decoding till the image is painted for the
        first time. We use Internals::setLargeImageAsyncDecodingEnabledForTesting()
        to force the async image decoding. So painting an image in this case will
        require multiple paints; in all of them the async image decoding will be
        enabled. But this is okay because it resembles the case where the <img> is
        created from a static <img> tag in the HTML file.

        For new tests, where we want to make sure that mutating the DOM will not
        cause a flash, async image decoding will be forced till the image is drawn
        for the first time. After that the async image decoding is enabled but not
        forced.

        Disable new tests for WK1 because the async image decoding is always enabled
        because tiling does not necessarily exist in WK1 . But eventually the async
        image decoding for large images will be always disabled for WK1.

        * fast/images/async-image-background-change-expected.html: Added.
        * fast/images/async-image-background-change.html: Added.
        * fast/images/async-image-background-image-repeated.html:
        * fast/images/async-image-background-image.html:
        * fast/images/async-image-multiple-clients-repaint.html:
        * fast/images/async-image-src-change-expected.html: Added.
        * fast/images/async-image-src-change.html: Added.
        * fast/images/resources/green-400x400.png: Added.
        * fast/images/resources/red-100x100.png: Added.
        * fast/images/resources/red-400x400.png: Added.
        * http/tests/multipart/multipart-async-image-expected.txt: Added.
        * http/tests/multipart/multipart-async-image.html: Added.
        * platform/ios-wk1/TestExpectations:
        * platform/mac-wk1/TestExpectations:

2017-07-18  Michael Catanzaro  <mcatanzaro@igalia.com>

        Unreviewed GTK test gardening

        fast/forms/range/input-appearance-range-rtl.html is desired to fail.

        * platform/gtk/TestExpectations:

2017-07-18  Chris Dumez  <cdumez@apple.com>

        DOMException should have its properties on the prototype
        https://bugs.webkit.org/show_bug.cgi?id=174597

        Reviewed by Alex Christensen.

        Rebaseline inspector tests whose output changed slightly now that the
        DOMException have moved to the prototype.

        * inspector/debugger/setPauseOnExceptions-all-expected.txt:
        * inspector/debugger/setPauseOnExceptions-none-expected.txt:
        * inspector/debugger/setPauseOnExceptions-uncaught-expected.txt:

2017-07-17  Michael Catanzaro  <mcatanzaro@igalia.com>

        Unreviewed GTK test gardening

        * TestExpectations: Skip tests that are clearly intended to have Skip expectations.
        * platform/gtk/TestExpectations:
        * platform/gtk/crypto/subtle/aes-cbc-cfb-encrypt-malformed-parameters-expected.txt:

2017-07-17  Timothy Horton  <timothy_horton@apple.com>

        Page using safe area constant properties jumps to correct layout after resize
        https://bugs.webkit.org/show_bug.cgi?id=174598
        <rdar://problem/33364275>

        Reviewed by Simon Fraser.

        * fast/events/ios/rotation/safe-area-insets-during-safari-type-rotation-expected.txt: Added.
        * fast/events/ios/rotation/safe-area-insets-during-safari-type-rotation.html: Added.
        Add a test making sure that dynamic-viewport-update-based rotation
        updates safe area insets when needed.

2017-07-17  Matt Lewis  <jlewis3@apple.com>
        
        Fixed test expectations after r219518.
        https://bugs.webkit.org/show_bug.cgi?id=174472

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-07-17  Jeremy Jones  <jeremyj@apple.com>

        media element handle adding source immediately before src.
        https://bugs.webkit.org/show_bug.cgi?id=174284

        Reviewed by David Kilzer.

        Adds missing -expected and tests to make sure resulting currentSrc is correct.

        * TestExpectations:
        * media/video-source-before-src-expected.txt: Added.
        * media/video-source-before-src.html:

2017-07-17  Matt Lewis  <jlewis3@apple.com>

        Fixed test expectations after r219518.
        https://bugs.webkit.org/show_bug.cgi?id=174472

        Unreviewed test gardening.

        * platform/ios-wk1/TestExpectations:
        * platform/mac/TestExpectations:

2017-07-17  Chris Dumez  <cdumez@apple.com>

        fast/workers/worker-user-gesture.html crashes on iOS
        https://bugs.webkit.org/show_bug.cgi?id=174592

        Reviewed by Simon Fraser.

        Make sure the tap/click event is fully processed before finishing the test by using
        the promise returned by UIHelper.activateAt().

        * fast/workers/worker-user-gesture.html:

2017-07-17  Simon Fraser  <simon.fraser@apple.com>

        clientX/clientY on TouchEvent.touches are wrong
        https://bugs.webkit.org/show_bug.cgi?id=174561

        Reviewed by Tim Horton.

        * fast/events/touch/ios/touches-client-coords-after-zoom-expected.txt: Added.
        * fast/events/touch/ios/touches-client-coords-after-zoom.html: Added.

2017-07-17  Chris Dumez  <cdumez@apple.com>

        click event does not dispatch to parent when child target stops hit testing after mousedown
        https://bugs.webkit.org/show_bug.cgi?id=174564
        <rdar://problem/33340234>

        Reviewed by Simon Fraser.

        Add layout test coverage.

        * fast/events/mouse-click-different-mouseDown-mouseUp-nodes-expected.txt: Added.
        * fast/events/mouse-click-different-mouseDown-mouseUp-nodes.html: Added.

2017-07-17  Antoine Quint  <graouts@apple.com>

        REGRESSION: order of AirPlay and volume controls is inconsistent between <audio> and <video>
        https://bugs.webkit.org/show_bug.cgi?id=174581
        <rdar://problem/33297519>

        Reviewed by Sam Weinig.

        Update the audio controls layout test to match the new expectations.

        * media/modern-media-controls/audio/audio-controls-buttons-expected.txt:
        * media/modern-media-controls/audio/audio-controls-buttons.html:

2017-07-17  Antoine Quint  <graouts@apple.com>

        Media controls draw behind captions
        https://bugs.webkit.org/show_bug.cgi?id=174579
        <rdar://problem/33295427>

        Reviewed by Dean Jackson.

        Add a new test that checks the order in which order the captions and controls containers appear
        under the media shadow root.

        * media/modern-media-controls/media-controls/media-controls-display-above-captions-expected.txt: Added.
        * media/modern-media-controls/media-controls/media-controls-display-above-captions.html: Added.
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-07-16  Antoine Quint  <graouts@apple.com>

        Dismissing the captions panel using the mouse is too eager to remove the captions panel and media controls
        https://bugs.webkit.org/show_bug.cgi?id=174571
        <rdar://problem/33294968>

        Reviewed by Eric Carlson.

        Adding a method to show the tracks panel for a given shadow root and adding new tests to check the correct
        behavior when dismissing the tracks panel when clicking over the media element or outside the media element
        when it's paused.

        * media/modern-media-controls/resources/media-controls-utils.js:
        (pressOnElement):
        (pressAtPoint):
        (showTracksPanel):
        (finishMediaControlsTest): Deleted.
        * media/modern-media-controls/tracks-panel/tracks-panel-up-click-outside-media-does-not-dimiss-media-controls-when-media-is-paused-expected.txt: Added.
        * media/modern-media-controls/tracks-panel/tracks-panel-up-click-outside-media-does-not-dimiss-media-controls-when-media-is-paused.html: Added.
        * media/modern-media-controls/tracks-panel/tracks-panel-up-click-over-media-does-not-dimiss-media-controls-when-media-is-playing-expected.txt: Added.
        * media/modern-media-controls/tracks-panel/tracks-panel-up-click-over-media-does-not-dimiss-media-controls-when-media-is-playing.html: Added.
        * platform/mac/TestExpectations:

2017-07-16  Ali Juma  <ajuma@chromium.org>

        DisallowUserAgentShadowContent moves out of non-UA shadow roots
        https://bugs.webkit.org/show_bug.cgi?id=165647

        Reviewed by Ryosuke Niwa.

        * fast/dom/nodesFromRect/nodesFromRect-shadow-expected.txt: Added.
        * fast/dom/nodesFromRect/nodesFromRect-shadow.html: Added.
        * fast/dom/nodesFromRect/resources/nodesFromRect.js:
        (check):
        (checkShadowContent):
        (nodesFromRectAsString):

2017-07-16  Antoine Quint  <graouts@apple.com>

        Clicking edges of media control buttons changes visual state of button (pressed) but doesn't execute action
        https://bugs.webkit.org/show_bug.cgi?id=174565
        <rdar://problem/33294833>

        Reviewed by Dean Jackson.

        Add a new test where we click on the edge of a button and check that we trigger the Button's
        UI delegate. This test fails prior to this patch.

        * media/modern-media-controls/button/button-click-on-edges-expected.txt: Added.
        * media/modern-media-controls/button/button-click-on-edges.html: Added.
        * platform/ios-simulator/TestExpectations:

2017-07-15  Myles C. Maxfield  <mmaxfield@apple.com>

        line-height: <number> gets visually applied twice when text autosizing is in effect
        https://bugs.webkit.org/show_bug.cgi?id=174536
        <rdar://problem/33338259>

        Reviewed by Simon Fraser.

        * fast/text-autosizing/line-height-number-expected.html: Added.
        * fast/text-autosizing/line-height-number.html: Added.

2017-07-14  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] Implement CryptoKeyRSA PKCS#8 exports
        https://bugs.webkit.org/show_bug.cgi?id=173697

        Reviewed by Jiewen Tan.

        * platform/gtk/TestExpectations: Unskip the RSA PKCS#8 export tests

2017-07-14  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] Implement CryptoKeyRSA PKCS#8 imports
        https://bugs.webkit.org/show_bug.cgi?id=173696

        Reviewed by Jiewen Tan.

        * platform/gtk/TestExpectations: Unskip the RSA PKCS#8 import tests
        that are now passing.

2017-07-14  Chris Dumez  <cdumez@apple.com>

        Possible crash in ~UserGestureIndicator() when on non-main thread
        https://bugs.webkit.org/show_bug.cgi?id=174522
        <rdar://problem/30283071>

        Reviewed by Sam Weinig.

        Add layout test coverage.

        * fast/workers/worker-user-gesture-expected.txt: Added.
        * fast/workers/worker-user-gesture.html: Added.
        * fast/workers/worker-user-gesture.js: Added.
        (setInterval):

2017-07-14  Daniel Bates  <dabates@apple.com>

        REGRESSION (r219013): Compute source frame info for frameless document
        https://bugs.webkit.org/show_bug.cgi?id=174385
        <rdar://problem/33217736>

        Reviewed by Brady Eidson.

        * http/tests/navigation/resources/window-open-redirect-and-remove-opener.html: Added.
        * http/tests/navigation/window-open-redirect-and-remove-opener-expected.txt: Added.
        * http/tests/navigation/window-open-redirect-and-remove-opener.html: Added.

2017-07-14  Matt Lewis  <jlewis3@apple.com>

        Fixed expectations after Mac expectation change.
        https://trac.webkit.org/changeset/219507/webkit

        Unreviewed test gardening.

        * platform/wk2/TestExpectations:

2017-07-14  Youenn Fablet  <youenn@apple.com>

        WebRTC: silence data not sent for disabled audio track
        https://bugs.webkit.org/show_bug.cgi?id=174456
        <rdar://problem/33284623>

        Reviewed by Eric Carlson.

        * webrtc/audio-muted-stats-expected.txt: Added.
        * webrtc/audio-muted-stats.html: Added.
        * webrtc/audio-muted-stats2-expected.txt: Added.
        * webrtc/audio-muted-stats2.html: Added.

2017-07-14  Jonathan Bedard  <jbedard@apple.com>

        Add High Sierra test expectations
        https://bugs.webkit.org/show_bug.cgi?id=174518
        <rdar://problem/32716970>

        Unreviewed test gardening.

        * platform/mac-highsierra: Added.
        * platform/mac-highsierra-wk1: Added.
        * platform/mac-highsierra-wk2: Added.

2017-07-14  Jer Noble  <jer.noble@apple.com>

        [MSE] Removing samples when presentation order does not match decode order can cause bad behavior.
        https://bugs.webkit.org/show_bug.cgi?id=174514

        Reviewed by Sam Weinig.

        * media/media-source/media-source-remove-decodeorder-crash-expected.txt: Added.
        * media/media-source/media-source-remove-decodeorder-crash.html: Added.

2017-07-14  Matt Lewis  <jlewis3@apple.com>

        Correcting test expectations after mac-expectation changes.
        https://bugs.webkit.org/show_bug.cgi?id=174472

        Unreviews test gardening.

        * platform/mac/TestExpectations:

2017-07-14  Jer Noble  <jer.noble@apple.com>

        Adding the 'autoplay' attribute to a media element during a user gesture should remove user gesture restrictions.
        https://bugs.webkit.org/show_bug.cgi?id=174373

        Reviewed by Eric Carlson.

        * media/video-add-autoplay-user-gesture-expected.txt: Added.
        * media/video-add-autoplay-user-gesture.html: Added.
        * media/platform/ios/TestExpectations: Skipped; requires EventSender.

2017-07-14  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r219500.

        The test is consistently failing on iOS simulator.

        Reverted changeset:

        "AX: VoiceOver silent or skipping over time values on media
        player."
        https://bugs.webkit.org/show_bug.cgi?id=174324
        http://trac.webkit.org/changeset/219500

2017-07-14  Jonathan Bedard  <jbedard@apple.com>

        Add script to rebase patches during the WebKit2->WebKit/WebKit->WebKitLegacy transition
        https://bugs.webkit.org/show_bug.cgi?id=174438
        <rdar://problem/33277112>

        Reviewed by David Kilzer.

        * platform/mac-wk2/TestExpectations: Move skipped tests because of webkit.org/b/174504. 
        * platform/wk2/TestExpectations: Ditto.

2017-07-14  Fujii Hironori  <Hironori.Fujii@sony.com>

        [HarfBuzz] Decomposed Vietnamese characters are rendered incorrectly
        https://bugs.webkit.org/show_bug.cgi?id=174418

        Reviewed by Michael Catanzaro.

        * fast/text/international/vietnamese-nfd-expected.html: Added.
        * fast/text/international/vietnamese-nfd.html: Added.

2017-07-14  Aaron Chu  <aaron_chu@apple.com>

        AX: VoiceOver silent or skipping over time values on media player.
        https://bugs.webkit.org/show_bug.cgi?id=174324
        <rdar://problem/32021784>

        Reviewed by Antoine Quint.

        Added role attribute to modern media controls time lable class so that VoiceOver can access the time label when the media is playing.

        * media/modern-media-controls/time-label/time-label-expected.txt:
        * media/modern-media-controls/time-label/time-label.html:

2017-07-13  Matt Lewis  <jlewis3@apple.com>

        Skipped multiple http/tests/webrtc/ test on iOS simulator.
        https://bugs.webkit.org/show_bug.cgi?id=173861

        Unreviewed test gardening.
        * platform/ios-simulator-wk2/TestExpectations:

2017-07-13  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/web-platform-tests/IndexedDB/large-nested-cloning.html as flaky on iOS.
        https://bugs.webkit.org/show_bug.cgi?id=173487

        Unreviewed test gardening.

        * platform/ios-simulator-wk2/TestExpectations:

2017-07-13  Matt Lewis  <jlewis3@apple.com>

        Skipping media/video-source-before-src.html.
        https://bugs.webkit.org/show_bug.cgi?id=174284

        Unreviewed test gardening.

        * TestExpectations:

2017-07-13  Antoine Quint  <graouts@apple.com>

        REGRESSION: "visibility:hidden" does not hide play button for video elements
        ​https://bugs.webkit.org/show_bug.cgi?id=174258
        <rdar://problem/33181452>

        Unreviewed test gardening.

        Add a missing expectation file which is designed to be empty and is now just a space.

        * media/modern-media-controls/css/visibility-hidden-expected.html: Added.

2017-07-13  Alex Christensen  <achristensen@webkit.org>

        Deleting last URLSearchParams key should remove trailing ? in associated URL
        https://bugs.webkit.org/show_bug.cgi?id=174465

        Reviewed by Chris Dumez.

        * fast/dom/DOMURL/searchparams-expected.txt:
        * fast/dom/DOMURL/searchparams.html:

2017-07-13  Miguel Gomez  <magomez@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of several tests failing at r219449.

        * platform/gtk/TestExpectations:

2017-07-13  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] Implement CryptoKeyRSA SPKI exports
        https://bugs.webkit.org/show_bug.cgi?id=173695

        Reviewed by Jiewen Tan.

        * platform/gtk/TestExpectations: Unskip the RSA SPKI export tests
        that are now passing.

2017-07-13  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] Implement CryptoKeyRSA SPKI imports
        https://bugs.webkit.org/show_bug.cgi?id=173694

        Reviewed by Jiewen Tan.

        * platform/gtk/TestExpectations: Unskip the RSA SPKI import tests
        that are now passing.

2017-07-12  Carlos Alberto Lopez Perez  <clopez@igalia.com>

        REGRESSION(r219332): [GTK] 9 new failures on fast/forms spinbutton related tests
        https://bugs.webkit.org/show_bug.cgi?id=174395

        Reviewed by Carlos Garcia Campos.

        * fast/forms/number/number-spinbutton-in-multi-column.html: Instead of assuming that the width will be 100, calculate a -7 offset dinamically.
        * platform/gtk/TestExpectations: Remove expected failures now orking.
        * platform/gtk/fast/forms/number/number-size-spinbutton-nocover-expected.png: Rebaseline.
        * platform/gtk/fast/forms/number/number-size-spinbutton-nocover-expected.txt: Rebaseline.

2017-07-13  Caio Lima  <ticaiolima@gmail.com>

        [ESnext] Implement Object Spread
        https://bugs.webkit.org/show_bug.cgi?id=167963

        Reviewed by Saam Barati.

        * js/parser-syntax-check-expected.txt:
        * js/script-tests/parser-syntax-check.js:

2017-07-12  Nan Wang  <n_wang@apple.com>

        AX: [iOS] Implement a way to retrieve a text marker range with desired text that is closest to a position
        https://bugs.webkit.org/show_bug.cgi?id=174393
        <rdar://problem/33248006>

        Reviewed by Chris Fleizach.

        * accessibility/ios-simulator/text-marker-range-matches-text-expected.txt: Added.
        * accessibility/ios-simulator/text-marker-range-matches-text.html: Added.

2017-07-12  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r219409.

        The revision caused the Windows builds to fail.

        Reverted changeset:

        "AX: [iOS] Implement a way to retrieve a text marker range
        with desired text that is closest to a position"
        https://bugs.webkit.org/show_bug.cgi?id=174393
        http://trac.webkit.org/changeset/219409

2017-07-12  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r219361.
        https://bugs.webkit.org/show_bug.cgi?id=174434

        Huge PLUM memory regression on iOS (Requested by kling on
        #webkit).

        Reverted changeset:

        "[WebIDL] Convert MutationCallback to be a normal generate
        callback"
        https://bugs.webkit.org/show_bug.cgi?id=174140
        http://trac.webkit.org/changeset/219361

2017-07-12  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] a capture source failure should end the MediaStreamTrack
        https://bugs.webkit.org/show_bug.cgi?id=174375

        Reviewed by Youenn Fablet.

        * fast/mediastream/media-stream-track-source-failure-expected.txt: Added.
        * fast/mediastream/media-stream-track-source-failure.html: Added.

2017-07-12  Antoine Quint  <graouts@apple.com>

        Playback controls should not hide while AirPlay is active
        https://bugs.webkit.org/show_bug.cgi?id=174422
        <rdar://problem/33011477>

        Reviewed by Eric Carlson.

        Expand the existing AirPlaySupport test to check that when we enter AirPlay we correctly prevent
        the media controls from automatically hiding.

        * media/modern-media-controls/airplay-support/airplay-support-expected.txt:
        * media/modern-media-controls/airplay-support/airplay-support.html:

2017-07-12  Nan Wang  <n_wang@apple.com>

        AX: [iOS] Implement a way to retrieve a text marker range with desired text that is closest to a position
        https://bugs.webkit.org/show_bug.cgi?id=174393
        <rdar://problem/33248006>

        Reviewed by Chris Fleizach.

        * accessibility/ios-simulator/text-marker-range-matches-text-expected.txt: Added.
        * accessibility/ios-simulator/text-marker-range-matches-text.html: Added.

2017-07-12  Per Arne Vollan  <pvollan@apple.com>

        Skip WebRTC tests on Windows.

        Unreviewed test gardening.

        * platform/win/TestExpectations:

2017-07-12  Matt Lewis  <jlewis3@apple.com>

        Rebaseline of test fast/dom/Window/property-access-on-cached-window-after-frame-removed.html.
        https://bugs.webkit.org/show_bug.cgi?id=174400

        Unreviewed test gardening.

        * fast/dom/Window/property-access-on-cached-window-after-frame-removed-expected.txt:

2017-07-12  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r219401.

        This revision rolled out the previous patch, but after talking
        with reviewer, a rebaseline is what was needed.Rolling back in
        before rebaseline.

        Reverted changeset:

        "Unreviewed, rolling out r219379."
        https://bugs.webkit.org/show_bug.cgi?id=174400
        http://trac.webkit.org/changeset/219401

2017-07-12  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r219379.

        This revision caused a consistent failure in the test
        fast/dom/Window/property-access-on-cached-window-after-frame-
        removed.html.

        Reverted changeset:

        "Remove NAVIGATOR_HWCONCURRENCY"
        https://bugs.webkit.org/show_bug.cgi?id=174400
        http://trac.webkit.org/changeset/219379

2017-07-12  Charlie Turner  <cturner@igalia.com>

        [GTK] Media test gardening after r219253
        https://bugs.webkit.org/show_bug.cgi?id=174254

        Unreviewed test gardening.

        video-cookie was fixed by r219252.
        media/video-restricted-no-preload-metadata.html been passing consistently.

        * platform/gtk/TestExpectations:

2017-07-12  Tooru Fujisawa [:arai]  <arai.unmht@gmail.com>

        Wrong radix used in Unicode Escape in invalid character error message
        https://bugs.webkit.org/show_bug.cgi?id=174419

        Reviewed by Alex Christensen.

        * fast/loader/cache-encoding-expected.txt:
        * http/tests/preload/preload-encoding-expected.txt:
        * js/basic-strict-mode-expected.txt:
        * js/kde/parse-expected.txt:
        * loader/reload-subresource-when-type-changes-expected.txt:
        * platform/ios/imported/w3c/web-platform-tests/html/syntax/parsing-html-fragments/the-input-byte-stream-003-expected.txt:
        * platform/ios/imported/w3c/web-platform-tests/html/syntax/parsing-html-fragments/the-input-byte-stream-004-expected.txt:

2017-07-12  Youenn Fablet  <youenn@apple.com>

        WebRTC: Incorrect sdpMLineIndex for video breaks Firefox interop
        https://bugs.webkit.org/show_bug.cgi?id=173530

        Reviewed by Alex Christensen.

        * webrtc/ice-candidate-sdpMLineIndex-expected.txt: Added.
        * webrtc/ice-candidate-sdpMLineIndex.html: Added.

2017-07-12  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] Implement CryptoKeyEC PKCS#8 exports
        https://bugs.webkit.org/show_bug.cgi?id=173648

        Reviewed by Jiewen Tan.

        * platform/gtk/TestExpectations: Unskip the EC PKCS#8 export tests
        that are now passing.

2017-07-11  Carlos Alberto Lopez Perez  <clopez@igalia.com>

        REGRESSION(r219332): [GTK] 9 new failures on fast/forms spinbutton related tests.
        https://bugs.webkit.org/show_bug.cgi?id=174395

        Unreviewed GTK gardening.

        * platform/gtk/TestExpectations: Mark the new failures. Further investigation pending.

2017-07-11  Said Abou-Hallawa  <sabouhallawa@apple.com>

        REGRESSION(r219045): The <body> element does not get repainted when its background image finishes decoding
        https://bugs.webkit.org/show_bug.cgi?id=174376

        Reviewed by Simon Fraser.

        * fast/images/async-image-body-background-image-expected.html: Added.
        * fast/images/async-image-body-background-image.html: Added.

2017-07-11  Youenn Fablet  <youenn@apple.com>

        We should do ICE candidate filtering at the Document level
        https://bugs.webkit.org/show_bug.cgi?id=173861
        <rdar://problem/33122058>

        Unreviewed.

        * resources/testharnessreport.js: Not calling setICECandidateFiltering if not defined.

2017-07-10  Sam Weinig  <sam@webkit.org>

        [WebIDL] Convert MutationCallback to be a normal generate callback
        https://bugs.webkit.org/show_bug.cgi?id=174140

        Reviewed by Chris Dumez.

        * fast/dom/MutationObserver/mutation-observer-constructor-expected.txt:
        Update results for standard error messages.

2017-07-11  Chris Dumez  <cdumez@apple.com>

        Window's [[OwnPropertyKeys]] is wrong for cross origin windows
        https://bugs.webkit.org/show_bug.cgi?id=174364
        <rdar://problem/33238056>

        Reviewed by Brent Fulgham.

        Update test to reflect behavior change. I verified that the test is passing in Firefox.
        The test fails in Chrome because its does not expose frames indexes on the Window, and
        it is incorrectly listing "assign" on Location.

        * http/tests/security/cross-frame-access-enumeration.html:

2017-07-11  Charlie Turner  <cturner@igalia.com>

        [GTK] editing/input new passes since r211277
        https://bugs.webkit.org/show_bug.cgi?id=160119

        Unreviewed test gardening.

        * platform/gtk/TestExpectations:

2017-07-11  Brent Fulgham  <bfulgham@apple.com>

        Reset cookie partitioning state after network process crashes
        https://bugs.webkit.org/show_bug.cgi?id=174306
        <rdar://problem/33171605>

        Reviewed by Chris Dumez.

        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-with-network-process-crash-expected.txt: Added.
        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-with-network-process-crash.html: Added.
        * http/tests/loading/resourceLoadStatistics/resources/get-cookies.php:
        * http/tests/loading/resourceLoadStatistics/resources/set-cookie.php:

2017-07-11  Charlie Turner  <cturner@igalia.com>

        REGRESSION(r219298): [GTK] imported/w3c/IndexedDB-private-browsing/idbfactory_open.html is crashing occassionaly
        https://bugs.webkit.org/show_bug.cgi?id=174354

        Unreviewed test gardening.

        * platform/gtk/TestExpectations:

2017-07-11  Charlie Turner  <cturner@igalia.com>

        [GTK][WPE] Some resource load statistics tests added in r212183 also fail.
        https://bugs.webkit.org/show_bug.cgi?id=168171

        Unreviewed test gardening.

        * platform/gtk/TestExpectations:

2017-07-11  Ali Juma  <ajuma@chromium.org>

        elementFromPoint() should consider x and y to be in client (layout viewport) coordinates
        https://bugs.webkit.org/show_bug.cgi?id=172019

        Reviewed by Simon Fraser.

        * fast/dom/elementFromPoint-scaled-scrolled-expected.txt: Updated.
        * fast/dom/elementFromPoint-scaled-scrolled.html: Updated.
        * platform/ios/TestExpectations:

2017-07-11  Charlie Turner  <cturner@igalia.com>

        [GTK] compositing/video/poster.html passing since r218320
        https://bugs.webkit.org/show_bug.cgi?id=169918

        Unreviewed test gardening.

        * platform/gtk/TestExpectations:

2017-07-11  Sergio Villar Senin  <svillar@igalia.com>

        [SVG] Leak in SVGAnimatedListPropertyTearOff
        https://bugs.webkit.org/show_bug.cgi?id=172545

        Reviewed by Darin Adler.

        * svg/animations/animation-leak-list-property-instances-expected.txt: Added.
        * svg/animations/animation-leak-list-property-instances.html: Added.

2017-07-11  Carlos Alberto Lopez Perez  <clopez@igalia.com>

        [GTK] Spin buttons on input type number appear over the value itself for small widths
        https://bugs.webkit.org/show_bug.cgi?id=173572

        Reviewed by Carlos Garcia Campos.

        * fast/forms/number/number-size-expected.txt:
        * fast/forms/number/number-size.html: Obtain the size of the spinbutton by inspecting the shadow dom (is more reliable)
          and make the test for user controlled style special for the case of GTK+.
        * platform/gtk/fast/forms/number/number-size-spinbutton-nocover-expected.png: Added.
        * platform/gtk/fast/forms/number/number-size-spinbutton-nocover-expected.txt: Added.
        * platform/gtk/fast/forms/number/number-size-spinbutton-nocover.html: Added.

2017-07-11  Youenn Fablet  <youenn@apple.com>

        We should do ICE candidate filtering at the Document level
        https://bugs.webkit.org/show_bug.cgi?id=173861
        <rdar://problem/33122058>

        Reviewed by Eric Carlson.

        * http/tests/webrtc/filtering-ice-candidate-cross-origin-frame-expected.txt: Added.
        * http/tests/webrtc/filtering-ice-candidate-cross-origin-frame.html: Added.
        * http/tests/webrtc/filtering-ice-candidate-same-origin-frame-expected.txt: Added.
        * http/tests/webrtc/filtering-ice-candidate-same-origin-frame.html: Added.
        * http/tests/webrtc/filtering-ice-candidate-same-origin-frame2-expected.txt: Added.
        * http/tests/webrtc/filtering-ice-candidate-same-origin-frame2.html: Added.
        * http/tests/webrtc/resources/check-ice-candidate-filtering.html: Added.
        * http/tests/webrtc/resources/do-get-user-media.html: Added.
        * platform/mac-wk1/TestExpectations: Disable http/tests/webrtc tests.
        * resources/testharnessreport.js: Disabled ICE candidate filtering by default.
        * webrtc/filtering-ice-candidate-after-reload-expected.txt: Added.
        * webrtc/filtering-ice-candidate-after-reload.html: Added.

2017-07-11  Sergio Villar Senin  <svillar@igalia.com>

        Unreviewed, rolling out r219325.

        The test is still flaky

        Reverted changeset:

        "[SVG] Leak in SVGAnimatedListPropertyTearOff"
        https://bugs.webkit.org/show_bug.cgi?id=172545
        http://trac.webkit.org/changeset/219325

2017-07-11  Charlie Turner  <cturner@igalia.com>

        [GTK] media/video-restricted-invisible-autoplay-not-allowed.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=174353

        Unreviewed test gardening.

        * platform/gtk/TestExpectations:

2017-07-11  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed WPE gardening.

        * platform/wpe/TestExpectations:
        Enable EMEv3 tests under media/encrypted-media/, all of them passing.

2017-07-10  Brent Fulgham  <bfulgham@apple.com>

        Resource Load Statistics: Prune statistics in orders of importance
        https://bugs.webkit.org/show_bug.cgi?id=174215
        <rdar://problem/33164403>

        Unreviewed test correction.

        Drive-by fix after recent refactoring to correct the new function names in TestRunner.

        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-deletion.html:
        * http/tests/loading/resourceLoadStatistics/partitioned-cookies-with-and-without-user-interaction.html:

2017-07-10  Simon Fraser  <simon.fraser@apple.com>

        [WK2 iOS] REGRESSION (r216803) During momentum scroll, getBoundingClientRect returns wrong coordinates (missing images on pinterest, elle.com and many other sites)
        https://bugs.webkit.org/show_bug.cgi?id=174286
        rdar://problem/32864180

        Reviewed by Dean Jackson.

        * fast/visual-viewport/ios/get-bounding-client-rect-unstable-expected.txt: Added.
        * fast/visual-viewport/ios/get-bounding-client-rect-unstable.html: Added.

2017-07-10  John Wilander  <wilander@apple.com>

        Resource Load Statistics: Prune statistics in orders of importance
        https://bugs.webkit.org/show_bug.cgi?id=174215
        <rdar://problem/33164403>

        Reviewed by Chris Dumez.

        * http/tests/loading/resourceLoadStatistics/prune-statistics-expected.txt: Added.
        * http/tests/loading/resourceLoadStatistics/prune-statistics.html: Added.
        * platform/wk2/TestExpectations:
            Added http/tests/loading/resourceLoadStatistics/prune-statistics.html as
            [ Pass ] since Resource Load Statistics is WK2-only.

2017-07-10  Devin Rousso  <drousso@apple.com>

        Web Inspector: Highlight matching CSS canvas clients when hovering contexts in the Resources tab
        https://bugs.webkit.org/show_bug.cgi?id=174279

        Reviewed by Matt Baker.

        * inspector/dom/highlightNodeList-expected.html: Added.
        * inspector/dom/highlightNodeList.html: Added.

2017-07-10  Javier Fernandez  <jfernandez@igalia.com>

        [css-align][css-flex][css-grid] 'auto' values of align-self and justify-self must not be resolved
        https://bugs.webkit.org/show_bug.cgi?id=172707

        Reviewed by Antti Koivisto.

        Updated layout tests so that resolved value is as specified, even for 'auto' values.

        * TestExpectations:
        * css3/flexbox/css-properties-expected.txt:
        * css3/flexbox/css-properties.html:
        * css3/flexbox/new-alignment-values-invalid-if-grid-not-enabled-expected.txt:
        * css3/flexbox/new-alignment-values-invalid-if-grid-not-enabled.html:
        * css3/parse-align-self.html:
        * css3/parse-alignment-of-root-elements-expected.txt:
        * css3/parse-alignment-of-root-elements.html:
        * css3/parse-place-items.html:
        * css3/parse-place-self.html:
        * fast/css/ensure-flexbox-compatibility-with-initial-values-expected.txt:
        * fast/css/parse-justify-self.html:

2017-07-10  Myles C. Maxfield  <mmaxfield@apple.com>

        fast/text/trak-optimizeLegibility.html is failing on macOS High Sierra
        https://bugs.webkit.org/show_bug.cgi?id=174325
        <rdar://problem/33190322>

        Reviewed by Zalan Bujtas.

        The name of the font changed.

        * fast/text/trak-optimizeLegibility.html:

2017-07-10  Youenn Fablet  <youenn@apple.com>

        Update webrtc expectations
        https://bugs.webkit.org/show_bug.cgi?id=174318

        Unreviewed.

        Updated expectation according flakiness dashboard information.

        * TestExpectations:
        * platform/ios-wk2/TestExpectations:
        * platform/mac-wk1/TestExpectations:
        * platform/mac-wk2/TestExpectations:
        * platform/wk2/TestExpectations:

2017-07-10  Wenson Hsieh  <wenson_hsieh@apple.com>

        [WK2] Ignore touch events that interrupt platform-driven momentum scrolling
        https://bugs.webkit.org/show_bug.cgi?id=174300
        <rdar://problem/33030639>

        Reviewed by Simon Fraser.

        Adds 3 new LayoutTests covering cases of touch event handling during scroll deceleration in mainframe and
        overflow scrolling containers. See Source/WebKit2/ChangeLog for more detail.

        * fast/events/ios/no-touch-events-when-stopping-momentum-scroll-in-mainframe-expected.txt: Added.
        * fast/events/ios/no-touch-events-when-stopping-momentum-scroll-in-mainframe.html: Added.
        * fast/events/ios/no-touch-events-when-stopping-momentum-scroll-in-overflow-expected.txt: Added.
        * fast/events/ios/no-touch-events-when-stopping-momentum-scroll-in-overflow.html: Added.
        * fast/events/ios/touch-events-during-scroll-deceleration-in-overflow-expected.txt: Added.
        * fast/events/ios/touch-events-during-scroll-deceleration-in-overflow.html: Added.

2017-07-10  Matt Lewis  <jlewis3@apple.com>

        Marked animations/resume-after-page-cache.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=174183

        Unreviewed test gardening.

        * platform/ios-simulator-wk2/TestExpectations:

2017-07-10  Jeremy Jones  <jeremyj@apple.com>

        media element handle adding source immediately before src.
        https://bugs.webkit.org/show_bug.cgi?id=174284
        rdar://problem/33115439

        Reviewed by David Kilzer.

        * media/video-source-before-src.html: Added.

2017-07-10  Matt Lewis  <jlewis3@apple.com>

        Fixed test expectations for http/tests/loading/resourceLoadStatistics/user-interaction-in-cross-origin-sub-frame.html.
        https://bugs.webkit.org/show_bug.cgi?id=174120

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-07-03  Brian Burg  <bburg@apple.com>

        Web Replay: remove some unused code
        https://bugs.webkit.org/show_bug.cgi?id=173903

        Rubber-stamped by Joseph Pecoraro.

        * inspector/replay/javascript-date-now-expected.txt: Removed.
        * inspector/replay/javascript-date-now.html: Removed.
        * inspector/replay/javascript-random-seed-expected.txt: Removed.
        * inspector/replay/javascript-random-seed.html: Removed.
        * inspector/replay/window-navigator-plugins-memoized-expected.txt: Removed.
        * inspector/replay/window-navigator-plugins-memoized.html: Removed.

2017-07-10  Matt Lewis  <jlewis3@apple.com>

        Skipped http/tests/loading/resourceLoadStatistics/user-interaction-in-cross-origin-sub-frame.html.
        https://bugs.webkit.org/show_bug.cgi?id=174120

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-07-10  Chris Dumez  <cdumez@apple.com>

        Further WebResourceLoadStatisticsStore / ResourceLoadStatisticsStore clean up
        https://bugs.webkit.org/show_bug.cgi?id=174301

        Reviewed by Brent Fulgham.

        Update existing layout tests to reflect testRunner API changes.

        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-deletion.html:
        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-with-partitioning-timeout.html:
        * http/tests/loading/resourceLoadStatistics/partitioned-cookies-with-and-without-user-interaction.html:

2017-07-10  Andreas Kling  <akling@apple.com>

        REGRESSION(r210226): Keyboard-focused element not preserved when navigating back through page cache, causing multiple elements to have focus
        https://bugs.webkit.org/show_bug.cgi?id=174302
        <rdar://problem/33204273>

        Reviewed by Antti Koivisto.

        * fast/history/page-cache-element-state-focused-expected.html: Added.
        * fast/history/page-cache-element-state-focused.html: Added.

2017-07-10  Zalan Bujtas  <zalan@apple.com>

        Block of text is missing in iBooks sample books.
        https://bugs.webkit.org/show_bug.cgi?id=174295
        <rdar://problem/32955620>

        Reviewed by Antti Koivisto.

        * fast/multicol/simple-line-layout-line-index-after-strut-2-expected.html: Added.
        * fast/multicol/simple-line-layout-line-index-after-strut-2.html: Added.

2017-07-08  John Wilander  <wilander@apple.com>

        Resource Load Statistics: User interaction should always go to top document
        https://bugs.webkit.org/show_bug.cgi?id=174120
        <rdar://problem/33117899>

        Reviewed by Chris Dumez.

        * http/tests/loading/resourceLoadStatistics/resources/dummy.html: Added.
        * http/tests/loading/resourceLoadStatistics/user-interaction-in-cross-origin-sub-frame-expected.txt: Added.
        * http/tests/loading/resourceLoadStatistics/user-interaction-in-cross-origin-sub-frame.html: Added.
        * platform/mac-wk2/TestExpectations:
            Added as [ Pass ].

2017-07-08  Antoine Quint  <graouts@apple.com>

        REGRESSION: "visibility:hidden" does not hide play button for video elements
        https://bugs.webkit.org/show_bug.cgi?id=174258
        <rdar://problem/33181452>

        Reviewed by Dean Jackson.

        Add a test that checks that <video controls style="visibility:hidden"> does not render anything.

        * media/modern-media-controls/css/visibility-hidden-expected.html: Added.
        * media/modern-media-controls/css/visibility-hidden.html: Added.
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-07-08  Chris Dumez  <cdumez@apple.com>

        Simplify WebResourceLoadStatisticsStore / ResourceLoadStatisticsStore
        https://bugs.webkit.org/show_bug.cgi?id=174290

        Reviewed by Brent Fulgham.

        Update layout tests to reflect changes to the testRunner API naming.

        * http/tests/loading/resourceLoadStatistics/classify-as-non-prevalent-based-on-mixed-statistics.html:
        * http/tests/loading/resourceLoadStatistics/classify-as-non-prevalent-based-on-sub-frame-under-top-frame-origins.html:
        * http/tests/loading/resourceLoadStatistics/classify-as-non-prevalent-based-on-subresource-under-top-frame-origins.html:
        * http/tests/loading/resourceLoadStatistics/classify-as-non-prevalent-based-on-subresource-unique-redirects-to.html:
        * http/tests/loading/resourceLoadStatistics/classify-as-prevalent-based-on-mixed-statistics.html:
        * http/tests/loading/resourceLoadStatistics/classify-as-prevalent-based-on-sub-frame-under-top-frame-origins.html:
        * http/tests/loading/resourceLoadStatistics/classify-as-prevalent-based-on-subresource-under-top-frame-origins.html:
        * http/tests/loading/resourceLoadStatistics/classify-as-prevalent-based-on-subresource-unique-redirects-to.html:
        * http/tests/loading/resourceLoadStatistics/clear-in-memory-and-persistent-store-one-hour.html:
        * http/tests/loading/resourceLoadStatistics/clear-in-memory-and-persistent-store.html:
        * http/tests/loading/resourceLoadStatistics/grandfathering.html:
        * http/tests/loading/resourceLoadStatistics/non-prevalent-resource-with-user-interaction.html:
        * http/tests/loading/resourceLoadStatistics/non-prevalent-resource-without-user-interaction.html:
        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-deletion.html:
        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-with-partitioning-timeout.html:
        * http/tests/loading/resourceLoadStatistics/partitioned-cookies-with-and-without-user-interaction.html:
        * http/tests/loading/resourceLoadStatistics/prevalent-resource-with-user-interaction-timeout.html:
        * http/tests/loading/resourceLoadStatistics/prevalent-resource-with-user-interaction.html:
        * http/tests/loading/resourceLoadStatistics/prevalent-resource-without-user-interaction.html:
        * http/tests/loading/resourceLoadStatistics/telemetry-generation.html:

2017-07-07  Daniel Bates  <dabates@apple.com>

        [AppCache] Ignore fallback entries whose namespace is not prefixed with manifest path
        https://bugs.webkit.org/show_bug.cgi?id=174273
        <rdar://problem/33011682>

        Reviewed by Brent Fulgham.

        * http/tests/appcache/fallback-namespace-outside-manifest-path-expected.txt: Added.
        * http/tests/appcache/fallback-namespace-outside-manifest-path.html: Added.
        * http/tests/appcache/resources/fallback-namespace-outside-manifest-path.txt: Added.

2017-07-07  Devin Rousso  <drousso@apple.com>

        Web Inspector: Show all elements currently using a given CSS Canvas
        https://bugs.webkit.org/show_bug.cgi?id=173965

        Reviewed by Joseph Pecoraro.

        * inspector/canvas/css-canvas-clients-expected.txt: Added.
        * inspector/canvas/css-canvas-clients.html: Added.
        * platform/mac/TestExpectations:

2017-07-07  Matt Lewis  <jlewis3@apple.com>

        Adjusted test expectations for webrtc/video-replace-muted-track.html.
        https://bugs.webkit.org/show_bug.cgi?id=173608

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-07-07  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r219257.

        The test added in the revision was still extreamly flaky on
        all testers.

        Reverted changeset:

        "[SVG] Leak in SVGAnimatedListPropertyTearOff"
        https://bugs.webkit.org/show_bug.cgi?id=172545
        http://trac.webkit.org/changeset/219257

2017-07-07  Mark Lam  <mark.lam@apple.com>

        \n\r is not the same as \r\n.
        https://bugs.webkit.org/show_bug.cgi?id=173053

        Reviewed by Keith Miller.

        * js/parse-backslash-before-newline-expected.txt:
        * js/script-tests/parse-backslash-before-newline.js:

2017-07-07  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r219256.

        Previous change to Test Expectations broke the tests

        Reverted changeset:

        "[WPE] Unreviewed gardening"
        http://trac.webkit.org/changeset/219256

2017-07-07  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r219258.

        Previous change to Test Expectations broke the tests

        Reverted changeset:

        "Unreviewed gardening, fix WK2 expectations after my previous
        commit"
        http://trac.webkit.org/changeset/219258

2017-07-07  Michael Catanzaro  <mcatanzaro@igalia.com>

        Unreviewed gardening, fix WK2 expectations after my previous commit

        * platform/wk2/TestExpectations:

2017-07-07  Michael Catanzaro  <mcatanzaro@igalia.com>

        [WPE] Unreviewed gardening

        * platform/wk2/TestExpectations: Do not mark individual resourceLoadStatistics tests as
        passing. Instead, mark the entire directory, so we don't have to override the expectations
        for every single test individually in the WPE expectations file.
        * platform/wpe/TestExpectations: Update resourceLoadStatistics expectations.

2017-07-07  Yusuke Suzuki  <utatane.tea@gmail.com>

        [GTK][WPE] Enable X-Content-Type-Options: nosniff
        https://bugs.webkit.org/show_bug.cgi?id=174250

        Reviewed by Carlos Alberto Lopez Perez.

        * platform/gtk/TestExpectations:
        * platform/gtk/imported/w3c/web-platform-tests/fetch/nosniff/stylesheet-expected.txt: Removed.

2017-07-07  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] New baseline after r218740

        Unreviewed gardening.
        * platform/wpe/js/dom/global-constructors-attributes-expected.txt:

2017-07-07  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Unreviewed gardening

        resourceLoadingStatistics tests are timing out and failing.
        * platform/wpe/TestExpectations:

2017-07-07  Charlie Turner  <cturner@igalia.com>

        [GStreamer] vid.me videos do not play
        https://bugs.webkit.org/show_bug.cgi?id=172240

        Reviewed by Xabier Rodriguez-Calvar.

        Add a test for single output file HLS playlists that require HTTP
        range requests to playback. This failed using the WK http source
        for reasons documented in the linked bug.

        Generated with mp4hls --segment-duration 3 --output-single-file

        * Http/tests/media/hls/range-request-expected.txt: Added.
        * http/tests/media/hls/range-request.html: Added.
        * http/tests/media/resources/hls/range-request-playlist.m3u8: Added.
        * http/tests/media/resources/hls/range-request-playlists/iframes.m3u8: Added.
        * http/tests/media/resources/hls/range-request-playlists/media.ts: Added.
        * http/tests/media/resources/hls/range-request-playlists/stream.m3u8: Added.

2017-07-06  Michael Catanzaro  <mcatanzaro@igalia.com>

        Unreviewed GTK and WPE test gardening

        * platform/gtk/TestExpectations:
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/hkdf.worker-expected.txt:
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/test_hkdf.https-expected.txt:
        * platform/wpe/TestExpectations:
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/hkdf.worker-expected.txt:
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/test_hkdf.https-expected.txt:

2017-07-06  Michael Catanzaro  <mcatanzaro@igalia.com>

        Follow-up to "REGRESSION(r209495): materiauxlaverdure.com fails to load"
        https://bugs.webkit.org/show_bug.cgi?id=173301
        <rdar://problem/32624850>

        Unreviewed gardening. Attempt to fix this test by updating it to expect double quotes. It
        was missed because it is marked as flaky on Mac, so no way to automatically detect the
        failure there.

        This doesn't actually fix the test for me due to some floating point issues, but it's a step
        in the right direction, and I speculate this will fix the test on the GTK and WPE bots.

        * transitions/clip-path-path-transitions.html:

2017-07-06  Myles C. Maxfield  <mmaxfield@apple.com>

        REGRESSION(r216944): Font loads can cause Chinese characters to draw as .notdef
        https://bugs.webkit.org/show_bug.cgi?id=173962
        <rdar://problem/32925318>

        Reviewed by Simon Fraser.

        * fast/text/font-loading-system-fallback-expected.html: Added.
        * fast/text/font-loading-system-fallback.html: Added.
        * http/tests/webfont/font-loading-system-fallback-visibility-expected.html: Added.
        * http/tests/webfont/font-loading-system-fallback-visibility.html: Added.

2017-07-06  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r219193.

        The tests added with this revision were extreamly flaky on all
        platforms.

        Reverted changeset:

        "[SVG] Leak in SVGAnimatedListPropertyTearOff"
        https://bugs.webkit.org/show_bug.cgi?id=172545
        http://trac.webkit.org/changeset/219193

2017-07-06  Matt Lewis  <jlewis3@apple.com>

        Marked js/slow-stress/Int32Array-alloc-huge.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=173010

        Unreviewed test gardening.

        * platform/ios-simulator-wk2/TestExpectations:

2017-07-06  Devin Rousso  <drousso@apple.com>

        Web Inspector: Support getting the content of WebGL/WebGL2 contexts
        https://bugs.webkit.org/show_bug.cgi?id=173569
        <rdar://problem/33112420>

        Reviewed by Joseph Pecoraro.

        * inspector/canvas/requestContent-2d-expected.txt: Added.
        * inspector/canvas/requestContent-2d.html: Added.
        * inspector/canvas/requestContent-webgl-expected.txt: Added.
        * inspector/canvas/requestContent-webgl.html: Added.
        * inspector/canvas/requestContent-webgl2-expected.txt: Added.
        * inspector/canvas/requestContent-webgl2.html: Added.
        * inspector/canvas/requestContent-expected.txt: Removed.
        * inspector/canvas/requestContent.html: Removed.
        * platform/gtk/TestExpectations:
        * platform/win/TestExpectations:
        Split the existing canvas content tests into one for each context type. This allows
        platforms that don't support certain context types to ignore just those tests (e.g. WebGL2).

2017-07-06  Carlos Alberto Lopez Perez  <clopez@igalia.com>

        [GTK] Layout test gardening.

        Unreviewed.

        * platform/gtk/TestExpectations: Update WebRTC related expectations and mark a new emoji related test failing after r218371.
        * platform/gtk/fast/css/css2-system-fonts-expected.txt: Rebaseline after r218446.
        * platform/gtk/fast/css/getComputedStyle/computed-style-font-family-expected.txt: Removed. Rebaseline after r218446 (use the general expectation).
        * platform/gtk/fast/text/font-stretch-parse-expected.txt: Removed. Rebaseline after r218446 (use the general expectation).
        * platform/gtk/fast/text/font-style-parse-expected.txt: Removed. Rebaseline after r218446 (use the general expectation).
        * platform/gtk/fast/text/font-weight-parse-expected.txt: Removed Rebaseline after r218446 (use the general expectation).

2017-07-06  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r219194.
        https://bugs.webkit.org/show_bug.cgi?id=174207

        it broke some layout tests (Requested by clopez on #webkit).

        Reverted changeset:

        "[GStreamer] vid.me videos do not play"
        https://bugs.webkit.org/show_bug.cgi?id=172240
        http://trac.webkit.org/changeset/219194

2017-07-06  Charlie Turner  <cturner@igalia.com>

        [GStreamer] vid.me videos do not play
        https://bugs.webkit.org/show_bug.cgi?id=172240

        Reviewed by Xabier Rodriguez-Calvar.

        Add a test for single output file HLS playlists that require HTTP
        range requests to playback. This failed using the WK http source
        for reasons documented in the linked bug.

        Generated with mp4hls --segment-duration 3 --output-single-file

        * Http/tests/media/hls/range-request-expected.txt: Added.
        * http/tests/media/hls/range-request.html: Added.
        * http/tests/media/resources/hls/range-request-playlist.m3u8: Added.
        * http/tests/media/resources/hls/range-request-playlists/iframes.m3u8: Added.
        * http/tests/media/resources/hls/range-request-playlists/media.ts: Added.
        * http/tests/media/resources/hls/range-request-playlists/stream.m3u8: Added.

2017-07-05  Zalan Bujtas  <zalan@apple.com>

        REGRESSION: Stack overflow in RenderBlockFlow::layoutBlock after increasing the font size to max in some RTL vertical books.
        https://bugs.webkit.org/show_bug.cgi?id=174144
        <rdar://problem/32781038>

        Reviewed by Simon Fraser.

        * fast/ruby/ruby-overhang-margin-crash-expected.txt: Added.
        * fast/ruby/ruby-overhang-margin-crash.html: Added.

2017-07-05  Jonathan Bedard  <jbedard@apple.com>

        Move internal iOS 11 TestExpectations to OpenSource
        <rdar://problem/32717028>

        Unreviewed test gardening.

        * platform/ios-11/platform/ios/ios/fast/text/opticalFont-expected.txt: Added.
        * platform/ios-11/platform/ios/ios/fast/text/opticalFontWithTextStyle-expected.txt: Added.
        * platform/ios-11/platform/ios/ios/fast/text/opticalFontWithWeight-expected.txt: Added.

2017-07-05  Myles C. Maxfield  <mmaxfield@apple.com>

        CSSFontStyleValue::isItalic seems a bit bogus.
        https://bugs.webkit.org/show_bug.cgi?id=174149

        Reviewed by Tim Horton.

        * editing/execCommand/italicizeByCharacter-normal-expected.txt: Added.
        * editing/execCommand/italicizeByCharacter-normal.html: Added.

2017-07-05  Matt Lewis  <jlewis3@apple.com>

        Skipped webgl/1.0.2/conformance/glsl/misc/shader-with-non-reserved-words.html.
        https://bugs.webkit.org/show_bug.cgi?id=174100

        Unreviewed test gardening.

        * platform/ios-simulator-wk2/TestExpectations:

2017-07-05  Brady Eidson  <beidson@apple.com>

        Allow navigations in subframes to get a ShouldOpenExternalURLsPolicy of "ShouldAllow".
        <rdar://problem/22485589> and https://bugs.webkit.org/show_bug.cgi?id=174178

        Reviewed by Alex Christensen.

        Added a new explicit test and updated expectations for an old one.
        
        * loader/navigation-policy/should-open-external-urls/resources/main-frame-with-subframe-main-programatically-navigates-subframe.html: Added.
        * loader/navigation-policy/should-open-external-urls/subframe-click-target-self-expected.txt:
        * loader/navigation-policy/should-open-external-urls/subframe-navigated-programatically-by-main-frame-expected.txt: Added.
        * loader/navigation-policy/should-open-external-urls/subframe-navigated-programatically-by-main-frame.html: Added.

2017-07-05  Matt Lewis  <jlewis3@apple.com>

        Marked animations/needs-layout.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172397

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-07-05  Zalan Bujtas  <zalan@apple.com>

        REGRESSION (r217522): "Show My Relationship" link in familysearch.org does not work.
        https://bugs.webkit.org/show_bug.cgi?id=174070

        Reviewed by Simon Fraser.

        * fast/css/getComputedStyle/computed-style-expected.txt:

2017-07-05  Devin Rousso  <drousso@apple.com>

        Web Inspector: Allow users to log any tracked canvas context
        https://bugs.webkit.org/show_bug.cgi?id=173397
        <rdar://problem/33111581>

        Reviewed by Joseph Pecoraro.

        * inspector/canvas/resolveCanvasContext-2d-expected.txt: Added.
        * inspector/canvas/resolveCanvasContext-2d.html: Added.
        * inspector/canvas/resolveCanvasContext-webgl-expected.txt: Added.
        * inspector/canvas/resolveCanvasContext-webgl.html: Added.
        * inspector/canvas/resolveCanvasContext-webgl2-expected.txt: Added.
        * inspector/canvas/resolveCanvasContext-webgl2.html: Added.
        * inspector/canvas/resolveCanvasContext-webgpu-expected.txt: Added.
        * inspector/canvas/resolveCanvasContext-webgpu.html: Added.
        * platform/gtk/TestExpectations:
        * platform/ios/TestExpectations:
        * platform/win/TestExpectations:

2017-07-05  Antti Koivisto  <antti@apple.com>

        Low memory notification shouldn't cause style recalc
        https://bugs.webkit.org/show_bug.cgi?id=173574
        <rdar://problem/32616997>

        Reviewed by Andreas Kling.

        * platform/mac/printing/width-overflow-expected.txt:

            1px width change that doesn't affect what is being tested.

2017-07-05  Jonathan Bedard  <jbedard@apple.com>

        Move internal iOS 11 TestExpectations to OpenSource
        <rdar://problem/32717028>

        Unreviewed test gardening.

        * platform/ios-11: Added.

2017-07-05  Matt Lewis  <jlewis3@apple.com>

        Adjusted test expectations for tiled-drawing/scrolling/fast-scroll-iframe-latched-mainframe.html.
        https://bugs.webkit.org/show_bug.cgi?id=168937

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-07-05  Charlie Turner  <cturner@igalia.com>

        Incorrect IfModule on Fedora with with PHP 7
        https://bugs.webkit.org/show_bug.cgi?id=174159

        Reviewed by Michael Catanzaro.

        * http/conf/fedora-httpd-2.4-php7.conf:

2017-07-05  Youenn Fablet  <youenn@apple.com>

        Receiving tracks should be ended when peer connection is being closed
        https://bugs.webkit.org/show_bug.cgi?id=174109

        Reviewed by Eric Carlson.

        * webrtc/peer-connection-track-end-expected.txt: Added.
        * webrtc/peer-connection-track-end.html: Added.

2017-07-04  Antti Koivisto  <antti@apple.com>

        FrameView should not set RenderView::logicalWidth directly for printing
        https://bugs.webkit.org/show_bug.cgi?id=174135

        Reviewed by Zalan Bujtas.

        * platform/mac/printing/width-overflow-expected.txt:

            This is a progression, view and root element sizes now match.
            Printing output is not affected.

2017-07-03  Saam Barati  <sbarati@apple.com>

        LayoutTest workers/bomb.html is a Crash
        https://bugs.webkit.org/show_bug.cgi?id=167757
        <rdar://problem/33086462>

        Reviewed by Keith Miller.

        * platform/mac-wk2/TestExpectations:

2017-07-03  Matt Lewis  <jlewis3@apple.com>

        Removed expectations and skipped workers/bomb.html on mac.
        https://bugs.webkit.org/show_bug.cgi?id=167757

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:
        * platform/mac/TestExpectations:

2017-07-03  Myles C. Maxfield  <mmaxfield@apple.com>

        REGRESSION(Variation Fonts): Specifying Skia by PostScript name does not yield the expected result
        https://bugs.webkit.org/show_bug.cgi?id=174079
        <rdar://problem/33040854>

        Reviewed by Alex Christensen.

        * fast/text/variations/skia-postscript-name-expected-mismatch.html: Added.
        * fast/text/variations/skia-postscript-name.html: Added.
        * platform/ios-simulator/TestExpectations:

2017-07-03  Per Arne Vollan  <pvollan@apple.com>

        [Win] Update expectations for layout tests.
        https://bugs.webkit.org/show_bug.cgi?id=172437

        Unreviewed test gardening, update test expectations for failing tests.

        * platform/win/TestExpectations:

2017-07-03  Brady Eidson  <beidson@apple.com>

        Switch all WebKit API related to favicons from WebIconDatabase over to new WebCore::IconLoader mechanism.
        https://bugs.webkit.org/show_bug.cgi?id=174073

        Reviewed by Andy Estes.

        * http/tests/security/contentSecurityPolicy/block-favicon-expected.txt: Updated results to actually catch
          the load being blocked due to CSP.

2017-07-03  Matt Lewis  <jlewis3@apple.com>

        Marked media/track/track-cues-sorted-before-dispatch.html as flaky
        https://bugs.webkit.org/show_bug.cgi?id=168092

        Unreviewed test gardening.

        * platform/wk2/TestExpectations:

2017-07-03  Youenn Fablet  <youenn@apple.com>

        WebAudioSourceProviderAVFObjC should not reconfigure for each data call
        https://bugs.webkit.org/show_bug.cgi?id=174101

        Reviewed by Eric Carlson.

        * TestExpectations:
        * webrtc/peer-connection-audio-mute2.html:
        * webrtc/peer-connection-remote-audio-mute2.html:

2017-07-03  Alex Christensen  <achristensen@webkit.org>

        Rebase test after r219024
        https://bugs.webkit.org/show_bug.cgi?id=174051

        * fast/events/popup-blocked-from-unique-frame-via-window-open-named-sibling-frame-expected.txt:

2017-07-03  Jonathan Bedard  <jbedard@apple.com>

        Run webgl tests on iOS ports
        https://bugs.webkit.org/show_bug.cgi?id=173000

        Unreviewed test gardening.

        * platform/ios-device/TestExpectations: Garden webgl tests.
        * platform/ios-simulator/TestExpectations: Ditto.
        * platform/ios/TestExpectations: Ditto.
        * platform/ios/fast/canvas/webgl: Added.
        * platform/ios/fast/canvas/webgl/css-webkit-canvas-expected.txt: Added.
        * platform/ios/fast/canvas/webgl/css-webkit-canvas-repaint-expected.txt: Added.

2017-07-02  Ryosuke Niwa  <rniwa@webkit.org>

        REGRESSION(r218910): Crash inside textMarkerDataForFirstPositionInTextControl
        https://bugs.webkit.org/show_bug.cgi?id=174077
        <rdar://problem/33083972>

        Reviewed by Chris Fleizach.

        Added a regression test for changing the input element's type during editing.

        * accessibility/mac/input-type-change-crash-expected.txt: Added.
        * accessibility/mac/input-type-change-crash.html: Added.

2017-07-03  Saam Barati  <sbarati@apple.com>

        Unreviewed. Mark workers/bomb.html as flaky.

        * platform/ios-device/TestExpectations:
        * platform/ios-wk2/TestExpectations:
        * platform/mac/TestExpectations:

2017-07-03  Devin Rousso  <drousso@apple.com>

        Web Inspector: Support listing WebGL2 and WebGPU contexts
        https://bugs.webkit.org/show_bug.cgi?id=173396

        Reviewed by Joseph Pecoraro.

        * inspector/canvas/create-canvas-contexts-expected.txt: Removed.
        * inspector/canvas/create-canvas-contexts.html: Removed.
        * inspector/canvas/create-context-2d-expected.txt: Added.
        * inspector/canvas/create-context-2d.html: Added.
        * inspector/canvas/create-context-webgl-expected.txt: Added.
        * inspector/canvas/create-context-webgl.html: Added.
        * inspector/canvas/create-context-webgl2-expected.txt: Added.
        * inspector/canvas/create-context-webgl2.html: Added.
        * inspector/canvas/create-context-webgpu-expected.txt: Added.
        * inspector/canvas/create-context-webgpu.html: Added.
        * inspector/canvas/resources/create-context-utilities.css: Added.
        (.canvas):
        * inspector/canvas/resources/create-context-utilities.js: Added.
        (createAttachedCanvas):
        (createDetachedCanvas):
        (createCSSCanvas):
        (destroyCanvases):
        (TestPage.registerInitializer.awaitCanvasAdded):
        (TestPage.registerInitializer.awaitCanvasRemoved):
        (TestPage.registerInitializer.window.initializeTestSuite):
        (TestPage.registerInitializer.window.addSimpleTestCase):
        (TestPage.registerInitializer.window.addCSSCanvasTestCase):
        * platform/gtk/TestExpectations:
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:
        * platform/win/TestExpectations:
        Split the existing canvas lifecycle tests into one for each context type. This allows
        platforms that don't support certain context types to ignore just those tests (e.g. WebGPU).

2017-07-03  Chris Fleizach  <cfleizach@apple.com>

        AX: role="none" (or presentation) does not work on iframes
        https://bugs.webkit.org/show_bug.cgi?id=173930
        <rdar://problem/33034347>

        Reviewed by Ryosuke Niwa.

        * accessibility/presentation-role-iframe-expected.txt: Added.
        * accessibility/presentation-role-iframe.html: Added.

2017-07-03  Alex Christensen  <achristensen@webkit.org>

        Rebase test after r219024
        https://bugs.webkit.org/show_bug.cgi?id=174051

        * http/tests/security/no-popup-from-sandbox-top-expected.txt:

2017-07-03  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r219030.

        This was a rebaseline of a test that was broken with revision
        r219024

        Reverted changeset:

        "Rebase test after r219024"
        https://bugs.webkit.org/show_bug.cgi?id=174051
        http://trac.webkit.org/changeset/219030

2017-07-03  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] Implement CryptoKeyEC SPKI exports
        https://bugs.webkit.org/show_bug.cgi?id=173646

        Reviewed by Jiewen Tan.

        * platform/gtk/TestExpectations:
        Unskip tests that cover SPKI exports of EC keys.

2017-07-02  Sam Weinig  <sam@webkit.org>

        [WebIDL] Remove special casing for RegExp which is no longer required by the spec
        https://bugs.webkit.org/show_bug.cgi?id=174025

        Reviewed by Chris Dumez.

        * fast/files/blob-constructor-expected.txt:
        * fast/files/blob-constructor.html:
        * fast/files/file-constructor-expected.txt:
        * fast/files/file-constructor.html:
        Update tests/results for change in conversions of RegExp.

2017-07-01  Myles C. Maxfield  <mmaxfield@apple.com>

        REGRESSION(r218371): Reeder's default font is Times instead of San Francisco
        https://bugs.webkit.org/show_bug.cgi?id=173617
        <rdar://problem/32969819>

        Reviewed by Simon Fraser.

        * fast/text/font-face-local-system-expected.html: Added.
        * fast/text/font-face-local-system.html: Added.

2017-06-30  Said Abou-Hallawa  <sabouhallawa@apple.com>

        If an image appears more than once on a page, decoding for painting one instance repaints them all
        https://bugs.webkit.org/show_bug.cgi?id=169944

        Reviewed by Simon Fraser.

        * fast/images/async-image-multiple-clients-repaint-expected.txt: Added.
        * fast/images/async-image-multiple-clients-repaint.html: Added.
        * platform/ios-simulator/fast/images: Added.
        * platform/ios-simulator/fast/images/async-image-multiple-clients-repaint-expected.txt: Added.

2017-06-30  Jonathan Bedard  <jbedard@apple.com>

        Run webgl tests on iOS ports
        https://bugs.webkit.org/show_bug.cgi?id=173000

        Unreviewed test gardening.

        * platform/ios/TestExpectations: Enable webgl, fast/canvas/webgl and http/tests/webgl.

2017-06-30  Matt Baker  <mattbaker@apple.com>

        Web Inspector: AsyncStackTrace nodes can be corrupted when truncating
        https://bugs.webkit.org/show_bug.cgi?id=173840
        <rdar://problem/30840820>

        Reviewed by Joseph Pecoraro.

        Add a test for truncating a branching asynchronous stack trace.

        * inspector/debugger/truncate-async-stack-trace-expected.txt: Added.
        * inspector/debugger/truncate-async-stack-trace.html: Added.

2017-06-30  Alex Christensen  <achristensen@webkit.org>

        Rebase test after r219024
        https://bugs.webkit.org/show_bug.cgi?id=174051

        * fast/events/popup-blocked-from-unique-frame-via-window-open-named-sibling-frame-expected.txt:
        This was an intentional change making URL parsing how it was before r215096 for URLs with non-special schemes.

2017-06-30  Matt Lewis  <jlewis3@apple.com>

        Marked test imported/w3c/web-platform-tests/IndexedDB/idbobjectstore_getKey.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=173068

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-06-30  Chris Dumez  <cdumez@apple.com>

        Move store logic from WebResourceLoadStatisticsManager to WebResourceLoadStatisticsStore
        https://bugs.webkit.org/show_bug.cgi?id=174038

        Reviewed by Brent Fulgham.

        Fix typo in testRunner API.

        * http/tests/loading/resourceLoadStatistics/grandfathering.html:
        * http/tests/loading/resourceLoadStatistics/non-prevalent-resource-with-user-interaction.html:
        * http/tests/loading/resourceLoadStatistics/non-prevalent-resource-without-user-interaction.html:
        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-deletion.html:
        * http/tests/loading/resourceLoadStatistics/prevalent-resource-with-user-interaction-timeout.html:
        * http/tests/loading/resourceLoadStatistics/prevalent-resource-with-user-interaction.html:
        * http/tests/loading/resourceLoadStatistics/prevalent-resource-without-user-interaction.html:

2017-06-30  Devin Rousso  <drousso@apple.com>

        Web Inspector: Default string comparisons to treat numeric characters as numbers
        https://bugs.webkit.org/show_bug.cgi?id=173984

        Reviewed by Joseph Pecoraro.

        * inspector/unit-tests/string-utilities.html:
        Add tests for String.prototype.extendedLocaleCompare.

2017-06-30  Ryosuke Niwa  <rniwa@webkit.org>

        REGRESSION(r214194): Safari leaves a popup window open opened during before unload
        https://bugs.webkit.org/show_bug.cgi?id=174016

        Reviewed by Chris Dumez.

        Added regression tests for navigating a new window, a sibling iframe, and another existing window.

        * fast/events/before-unload-navigate-different-window-expected.txt: Added.
        * fast/events/before-unload-navigate-different-window.html: Added.
        * fast/events/before-unload-open-window-expected.txt: Added.
        * fast/events/before-unload-open-window.html: Added.
        * fast/events/before-unload-sibling-frame-expected.txt: Added.
        * fast/events/before-unload-sibling-frame.html: Added.
        * fast/events/resources/message-opener.html: Added.
        * fast/events/resources/message-top.html: Added.

2017-06-30  Fujii Hironori  <Hironori.Fujii@sony.com>

        ASSERTION FAILED: !canAnimate() && !m_currentFrame
        https://bugs.webkit.org/show_bug.cgi?id=173089

        Reviewed by Said Abou-Hallawa.

        * fast/images/animated-gif-paint-after-animation-expected.txt: Added.
        * fast/images/animated-gif-paint-after-animation.html: Added.
        * fast/images/resources/animated-red-green-1000x1000-repeat-1.gif: Added.

2017-06-30  John Wilander  <wilander@apple.com>

        Update expectations for layout tests.
        https://bugs.webkit.org/show_bug.cgi?id=173940

        Unreviewed test gardening, update test expectations for failing tests.

        * platform/wk2/TestExpectations:
            http/tests/loading/resourceLoadStatistics/telemetry-generation.html
            is still failing.

2017-06-30  Antoine Quint  <graouts@apple.com>

        Top controls bars should invert with right-to-left user interface layout direction locale
        https://bugs.webkit.org/show_bug.cgi?id=173989
        <rdar://problem/32863552>

        Reviewed by Dean Jackson.

        Add a new test to check we correctly layout the top controls bars in RTL and rebaseline a
        test that now requires an asynchronous assertion.

        * media/modern-media-controls/macos-inline-media-controls/macos-inline-media-controls-rtl-expected.txt: Added.
        * media/modern-media-controls/macos-inline-media-controls/macos-inline-media-controls-rtl.html: Added.
        * media/modern-media-controls/mute-button/mute-button-expected.txt:
        * media/modern-media-controls/mute-button/mute-button.html:
        * platform/mac/TestExpectations:

2017-06-30  Dean Jackson  <dino@apple.com>

        REGRESSION (High Sierra): Gradient LayoutTests are failing
        https://bugs.webkit.org/show_bug.cgi?id=174015
        <rdar://problem/32332022>

        Reviewed by Tim Horton.

        Add the fudge factor to more of the gradient tests.

        * canvas/philip/tests.js:
        (_assertPixelWithGradientNoise): Bump the factor up a bit.
        * canvas/philip/tests/2d.gradient.interpolate.multiple.html:
        * canvas/philip/tests/2d.gradient.interpolate.solid.html:
        * canvas/philip/tests/2d.gradient.radial.transform.1.html:
        * canvas/philip/tests/2d.gradient.radial.transform.2.html:
        * canvas/philip/tests/2d.gradient.radial.transform.3.html:
        * canvas/philip/tests/initial.reset.gradient.html:

2017-06-29  Chris Fleizach  <cfleizach@apple.com>

        AX: Cannot call setValue() on contenteditable or ARIA text controls
        https://bugs.webkit.org/show_bug.cgi?id=173520

        Reviewed by Ryosuke Niwa.

        * accessibility/mac/set-value-editable-types-expected.txt: Added.
        * accessibility/mac/set-value-editable-types.html: Added.

2017-06-28  Simon Fraser  <simon.fraser@apple.com>

        getBoundingClientRect returns wrong value for combination of page zoom and scroll
        https://bugs.webkit.org/show_bug.cgi?id=173841
        rdar://problem/32983841

        Reviewed by Dean Jackson.

        * fast/events/clientXY-in-zoom-and-scroll.html: New baseline for progressed behavior.
        * fast/events/simulated-click-zoomed-expected.txt: Added.
        * fast/events/simulated-click-zoomed.html: Added.
        * fast/visual-viewport/client-rects-relative-to-layout-viewport-zoomed-expected.txt: Added.
        * fast/visual-viewport/client-rects-relative-to-layout-viewport-zoomed.html: Added.
        * platform/ios/TestExpectations:
        * platform/mac/fast/events/clientXY-in-zoom-and-scroll-expected.txt:

2017-06-29  John Wilander  <wilander@apple.com>

        Fix for intermittent Layout Test fail http/tests/loading/resourceLoadStatistics/telemetry-generation.html
        https://bugs.webkit.org/show_bug.cgi?id=173940
        <rdar://problem/33018125>

        Reviewed by Brent Fulgham.

        * platform/wk2/TestExpectations:
            http/tests/loading/resourceLoadStatistics/telemetry-generation.html
            is now expected to pass.

2017-06-29  Sam Weinig  <sam@webkit.org>

        [WebIDL] Add a new extended attribute to model the forced return value optimization used on Node and Crypto
        https://bugs.webkit.org/show_bug.cgi?id=173961

        Reviewed by Darin Adler.

        * js/dom/dot-node-base-exception-expected.txt: Removed.
        * js/dom/dot-node-base-exception.html: Removed.
        * js/dom/script-tests/dot-node-base-exception.js: Removed.
        Remove now obsolete test.

2017-06-29  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r218512.
        https://bugs.webkit.org/show_bug.cgi?id=173981

        "It changes the behavior of the JS API's JSEvaluateScript
        which breaks TurboTax" (Requested by saamyjoon on #webkit).

        Reverted changeset:

        "test262: Completion values for control flow do not match the
        spec"
        https://bugs.webkit.org/show_bug.cgi?id=171265
        http://trac.webkit.org/changeset/218512

2017-06-29  Alex Christensen  <achristensen@webkit.org>

        WKContentRuleLists with if-top-url or unless-top-url should run regex against entire top URL
        https://bugs.webkit.org/show_bug.cgi?id=173980

        Reviewed by Tim Horton.

        * http/tests/contentextensions/top-url-expected.txt: Added.
        * http/tests/contentextensions/top-url.html: Added.
        * http/tests/contentextensions/top-url.html.json: Added.

2017-06-29  JF Bastien  <jfbastien@apple.com>

        WebAssembly: disable some APIs under CSP
        https://bugs.webkit.org/show_bug.cgi?id=173892
        <rdar://problem/32914613>

        Reviewed by Daniel Bates.

        These tests are basically the same as eval-blocked, but with
        WebAssembly APIs instead of eval.

        Disable all of them on iOS simulator which doesn't support
        WebAssembly (whereas iOS does).

        * http/tests/security/contentSecurityPolicy/WebAssembly-allowed-expected.txt: Added.
        * http/tests/security/contentSecurityPolicy/WebAssembly-allowed.html: Added.
        * http/tests/security/contentSecurityPolicy/WebAssembly-blocked-expected.txt: Added.
        * http/tests/security/contentSecurityPolicy/WebAssembly-blocked-in-about-blank-iframe-expected.txt: Added.
        * http/tests/security/contentSecurityPolicy/WebAssembly-blocked-in-about-blank-iframe.html: Added.
        * http/tests/security/contentSecurityPolicy/WebAssembly-blocked-in-external-script-expected.txt: Added.
        * http/tests/security/contentSecurityPolicy/WebAssembly-blocked-in-external-script.html: Added.
        * http/tests/security/contentSecurityPolicy/WebAssembly-blocked-in-subframe-expected.txt: Added.
        * http/tests/security/contentSecurityPolicy/WebAssembly-blocked-in-subframe.html: Added.
        * http/tests/security/contentSecurityPolicy/WebAssembly-blocked.html: Added.
        * http/tests/security/contentSecurityPolicy/resources/WebAssembly-blocked-in-external-script.js: Added.
        * platform/ios-simulator/TestExpectations:

2017-06-29  Antoine Quint  <graouts@apple.com>

        Full stop shows to the right of the picture-in-picture localised string in Hebrew
        https://bugs.webkit.org/show_bug.cgi?id=173966
        <rdar://problem/32847376>

        Reviewed by Dean Jackson.

        * media/modern-media-controls/placard/placard-ltr-expected.txt: Added.
        * media/modern-media-controls/placard/placard-ltr.html: Added.

2017-06-29  Romain Bellessort  <romain.bellessort@crf.canon.fr>

        [Readable Streams API] Fix ReadableStream "strategy" argument handling
        https://bugs.webkit.org/show_bug.cgi?id=172716

        Reviewed by Xabier Rodriguez-Calvar.

        Added new tests and updated some existing ones based on the newly
        expected behavior.

        * streams/readable-byte-stream-controller-expected.txt: Updated.
        * streams/readable-byte-stream-controller.js: Updated.

2017-06-29  Antti Koivisto  <antti@apple.com>

        NAS4Free Pop-down menus take 3 seconds to appear
        https://bugs.webkit.org/show_bug.cgi?id=173967
        <rdar://problem/32690114>

        Reviewed by Andreas Kling.

        * compositing/backing/non-composited-visibility-change-expected.html: Added.
        * compositing/backing/non-composited-visibility-change.html: Added.

2017-06-28  Per Arne Vollan  <pvollan@apple.com>

        [Win] Update expectations for layout tests.
        https://bugs.webkit.org/show_bug.cgi?id=172437

        Unreviewed test gardening, update test expectations for failing tests.

        * platform/win/TestExpectations:

2017-06-27  Myles C. Maxfield  <mmaxfield@apple.com>

        [iOS] Cannot italicize or bold text rendered with text styles
        https://bugs.webkit.org/show_bug.cgi?id=173634

        Reviewed by Darin Adler.

        * fast/text/ipad/bold-tall-body-text-style-expected-mismatch.html: Added.
        * fast/text/ipad/bold-tall-body-text-style.html: Added.

2017-06-28  Devin Rousso  <drousso@apple.com>

        Web Inspector: Instrument active pixel memory used by canvases
        https://bugs.webkit.org/show_bug.cgi?id=173087
        <rdar://problem/32719261>

        Reviewed by Joseph Pecoraro.

        * inspector/canvas/memory-expected.txt: Added.
        * inspector/canvas/memory.html: Added.

2017-06-28  Ryan Haddad  <ryanhaddad@apple.com>

        Skip webrtc/video-replace-muted-track.html on iOS.
        https://bugs.webkit.org/show_bug.cgi?id=173608

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-06-28  Antoine Quint  <graouts@apple.com>

        Volume controls should be hidden when AirPlay is active
        https://bugs.webkit.org/show_bug.cgi?id=173933
        <rdar://problem/33011931>

        Reviewed by Dean Jackson.

        Expand the AirplaySupport testing to check that the mute button's enabled state is set to "false"
        in AirPlay and add new tests to check that volume controls are correctly hidden when the mute button
        is disabled.

        * media/modern-media-controls/airplay-support/airplay-support-expected.txt:
        * media/modern-media-controls/airplay-support/airplay-support.html:
        * media/modern-media-controls/macos-fullscreen-media-controls/macos-fullscreen-media-controls-volume-controls-hidden-when-mute-button-disabled-expected.txt: Added.
        * media/modern-media-controls/macos-fullscreen-media-controls/macos-fullscreen-media-controls-volume-controls-hidden-when-mute-button-disabled.html: Added.
        * media/modern-media-controls/macos-inline-media-controls/macos-inline-media-controls-top-right-controls-bar-hidden-when-mute-button-disabled-expected.txt: Added.
        * media/modern-media-controls/macos-inline-media-controls/macos-inline-media-controls-top-right-controls-bar-hidden-when-mute-button-disabled.html: Added.
        * platform/mac/TestExpectations:

2017-06-28  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/web-platform-tests/IndexedDB/idbindex_getAllKeys.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172834

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-06-28  Matt Lewis  <jlewis3@apple.com>

        Adjusted test expectations for http/tests/loading/resourceLoadStatistics/telemetry-generation.html.
        https://bugs.webkit.org/show_bug.cgi?id=173499

        Unreviewed test gardening.

        * platform/wk2/TestExpectations:

2017-06-28  Antoine Quint  <graouts@apple.com>

        Media controls volume glyph does not have the correct material
        https://bugs.webkit.org/show_bug.cgi?id=173918
        <rdar://problem/33012697>

        Reviewed by Eric Carlson.

        Add a new test to check the mute button is correctly hosted in the top-right controls bar
        when width becomes scarce.

        * media/modern-media-controls/macos-inline-media-controls/macos-inline-media-controls-mute-button-in-bottom-or-top-right-controls-bar-expected.txt: Added.
        * media/modern-media-controls/macos-inline-media-controls/macos-inline-media-controls-mute-button-in-bottom-or-top-right-controls-bar.html: Added.
        * platform/mac/TestExpectations:

2017-06-28  Fujii Hironori  <Hironori.Fujii@sony.com>

        [GTK] LayoutTest webaudio/silent-audio-interrupted-in-background.html makes its subsequent test flaky crash
        https://bugs.webkit.org/show_bug.cgi?id=173916

        Unreviewed test gardening.

        * platform/gtk/TestExpectations: Marked it Skip.

2017-06-27  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Cleanup RemoteObject tests
        https://bugs.webkit.org/show_bug.cgi?id=173885

        Reviewed by Matt Baker.

        * inspector/model/remote-object-dom.html: Added.
        * inspector/model/remote-object-expected.txt:
        * inspector/model/remote-object.html:
        Split out DOM results (which differ across ports and features).

        * inspector/model/resources/remote-object-utilities.js:
        (TestPage.registerInitializer.window.runSteps):
        This should have been a continue not a return.

        * platform/mac/inspector/model/remote-object-dom-expected.txt: Added.
        * platform/mac/inspector/model/remote-object-expected.txt: Removed.
        Platform expectations are now limited to just the DOM test.

2017-06-27  Caio Lima  <ticaiolima@gmail.com>

        [ESnext] Implement Object Rest - Implementing Object Rest Destructuring
        https://bugs.webkit.org/show_bug.cgi?id=167962

        Reviewed by Saam Barati.

        * js/parser-syntax-check-expected.txt:
        * js/script-tests/parser-syntax-check.js:

2017-06-27  Yusuke Suzuki  <utatane.tea@gmail.com>

        Unreviewed, unmark workers/bomb.html flakiness after r218856

        * platform/gtk-wayland/TestExpectations:
        * platform/ios-device/TestExpectations:
        * platform/ios-wk2/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-27  Matt Lewis  <jlewis3@apple.com>

        Marked http/tests/loading/resourceLoadStatistics/telemetry-generation.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=173499

        Unreviewed test gardening.

        * platform/wk2/TestExpectations:

2017-06-27  Antoine Quint  <graouts@apple.com>

        [Modern Media Controls] Accessibility labels should be formatted using NSDateComponentsFormatter
        https://bugs.webkit.org/show_bug.cgi?id=173858
        <rdar://problem/32643171>

        Reviewed by Dean Jackson.

        * media/modern-media-controls/scrubber/scrubber-has-correct-ax-label-expected.txt:
        * media/modern-media-controls/scrubber/scrubber-has-correct-ax-label.html:

2017-06-27  Antoine Quint  <graouts@apple.com>

        Placard icons act like buttons (can get keyboard focus and shows up in VoiceOver)
        https://bugs.webkit.org/show_bug.cgi?id=173891
        <rdar://problem/33011855>

        Reviewed by Dean Jackson.

        Update the Placard test to check that its <button> is disabled.

        * media/modern-media-controls/placard/placard-expected.txt:
        * media/modern-media-controls/placard/placard.html:

2017-06-27  Jeremy Jones  <jeremyj@apple.com>

        Disable m_temporarilyAllowingInlinePlaybackAfterFullscreen on pause
        https://bugs.webkit.org/show_bug.cgi?id=173843
        rdar://problem/32982431

        Reviewed by Eric Carlson.

        Some pages may not have a fullscreen button, so disabled m_temporarilyAllowingInlinePlaybackAfterFullscreen on pause.

        * media/media-fullscreen-pause-inline-expected.txt: Added.
        * media/media-fullscreen-pause-inline.html: Added.
        * platform/mac-wk2/TestExpectations:

2017-06-27  Saam Barati  <sbarati@apple.com>

        Function constructor needs to follow the spec and validate parameters and body independently
        https://bugs.webkit.org/show_bug.cgi?id=173303
        <rdar://problem/32732526>

        Reviewed by Keith Miller.

        * fast/dom/attribute-event-listener-errors-expected.txt:
        * fast/events/attribute-listener-deletion-crash-expected.txt:
        * fast/events/window-onerror-syntax-error-in-attr-expected.txt:
        * js/dom/invalid-syntax-for-function-expected.txt:

2017-06-27  John Wilander  <wilander@apple.com>

        Resource Load Statistics: Add telemetry
        https://bugs.webkit.org/show_bug.cgi?id=173499
        <rdar://problem/32826094>

        Reviewed by Brent Fulgham.

        * http/tests/loading/resourceLoadStatistics/telemetry-generation-expected.txt: Added.
        * http/tests/loading/resourceLoadStatistics/telemetry-generation.html: Added.
        * platform/wk2/TestExpectations:
            Enabled here since ResourceLoadStatistics is WK2-only.

2017-06-27  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Crash generating object preview for ArrayIterator
        https://bugs.webkit.org/show_bug.cgi?id=173754
        <rdar://problem/32859012>

        Reviewed by Saam Barati.

        * platform/mac/inspector/model/remote-object-expected.txt:
        * inspector/model/remote-object-expected.txt:
        * inspector/model/remote-object.html:
        Test generating a preview for an ArrayIterator that has had a `return` property added to it.

        * inspector/model/remote-object-mutated-iterators-expected.txt: Added.
        * inspector/model/remote-object-mutated-iterators.html: Added.
        Test generating a preview for different iterators after the IteratorPrototypes have been mutated.

        * inspector/model/resources/remote-object-utilities.js: Added.
        (runInBrowserTest):
        (TestPage.registerInitializer):
        (TestPage.registerInitializer.checkComplete):
        (TestPage.registerInitializer.window.runSteps):
        Share code for remote-object dump tests.

2017-06-27  Frederic Wang  <fwang@igalia.com>

        Some tests to verify forbidden frame navigation time out
        https://bugs.webkit.org/show_bug.cgi?id=173657

        Reviewed by Chris Dumez.

        * fast/frames/sandboxed-iframe-navigation-top-denied-expected.txt: Add the security error.
        * http/tests/security/frameNavigation/inactive-function-in-popup-navigate-child.html: Adjust
        the test to catch and dump the exception and complete immediately.
        * http/tests/security/frameNavigation/inactive-function-in-popup-navigate-child-expected.txt:
        Add the dumped security error exception.

2017-06-27  Youenn Fablet  <youenn@apple.com>

        LayoutTest webrtc/datachannel/multiple-connections.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=173853

        Reviewed by Eric Carlson.

        * webrtc/datachannel/multiple-connections.html:

2017-06-26  Antti Koivisto  <antti@apple.com>

        REGRESSION (AsyncImageDecoding): A tab with the WWDC keynote paused is killed for using excessive power (Image thrashing)
        https://bugs.webkit.org/show_bug.cgi?id=173804
        <rdar://problem/32623745>

        Reviewed by Simon Fraser.

        * fast/images/low-memory-decode-expected.txt: Added.
        * fast/images/low-memory-decode.html: Added.

2017-06-26  Matt Lewis  <jlewis3@apple.com>

        Marked media/media-source/media-source-paint-to-canvas.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=173565

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-06-26  Matt Lewis  <jlewis3@apple.com>

        Marked animations/play-state-suspend.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=173726

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-06-26  Jonathan Bedard  <jbedard@apple.com>

        Unreviewed, rolling out r218783.

        Causing accessibility/mac/setting-attributes-is-
        asynchronous.html to crash consistently on mac-wk2 Debug

        Reverted changeset:

        "AX: Cannot call setValue() on contenteditable or ARIA text
        controls"
        https://bugs.webkit.org/show_bug.cgi?id=173520
        http://trac.webkit.org/changeset/218783

2017-06-26  Youenn Fablet  <youenn@apple.com>

        Make webrtc/video-replace-track-to-null.html more robust
        https://bugs.webkit.org/show_bug.cgi?id=173834

        Reviewed by Eric Carlson.

        * webrtc/video-replace-track-to-null.html:

2017-06-26  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] Add support for aria-details and aria-errormessage
        https://bugs.webkit.org/show_bug.cgi?id=172588

        Reviewed by Chris Fleizach.

        Add new test cases to relation-types.html.

        * accessibility/gtk/relation-types-expected.txt:
        * accessibility/gtk/relation-types.html:

2017-06-26  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE][GCrypt] Unreviewed gardening

        After r218744, land new expectations for AES-CFB tests.
        * platform/wpe/crypto/subtle/aes-cbc-cfb-decrypt-malformed-parameters-expected.txt: Added.
        * platform/wpe/crypto/subtle/aes-cbc-cfb-encrypt-malformed-parameters-expected.txt: Added.
        * platform/wpe/crypto/subtle/aes-export-key-malformed-parameters-expected.txt: Added.
        * platform/wpe/crypto/subtle/aes-generate-key-malformed-parameters-expected.txt: Added.
        * platform/wpe/crypto/subtle/aes-import-key-malformed-parameters-expected.txt: Added.

2017-06-26  Per Arne Vollan  <pvollan@apple.com>

        [Win] Update expectations for layout tests.
        https://bugs.webkit.org/show_bug.cgi?id=172437

        Unreviewed test gardening, update test expectations for failing tests.

        * platform/win/TestExpectations:

2017-06-25  Youenn Fablet  <youenn@apple.com>

        Remove use of mock webrtc backend factory at injected bundle reset time
        https://bugs.webkit.org/show_bug.cgi?id=173817

        Reviewed by Darin Adler.

        Making some tests less flaky.

        * TestExpectations:
        * fast/mediastream/RTCPeerConnection-media-setup-two-dialogs-expected.txt:
        * platform/mac/webrtc/captureCanvas-webrtc-software-encoder.html:
        * webrtc/audio-peer-connection-webaudio.html:
        * webrtc/captureCanvas-webrtc.html:
        * webrtc/datachannel/bufferedAmountLowThreshold-default-expected.txt: Added.
        * webrtc/datachannel/bufferedAmountLowThreshold-default.html: Added.
        * webrtc/datachannel/bufferedAmountLowThreshold-expected.txt:
        * webrtc/datachannel/bufferedAmountLowThreshold.html:
        * webrtc/routines.js:
        * webrtc/video-replace-muted-track.html:
        * webrtc/video-unmute.html:

2017-06-24  Joseph Pecoraro  <pecoraro@apple.com>

        Remove Reflect.enumerate
        https://bugs.webkit.org/show_bug.cgi?id=173806

        Reviewed by Yusuke Suzuki.

        * inspector/model/remote-object-expected.txt:
        * inspector/model/remote-object.html:
        * platform/mac/inspector/model/remote-object-expected.txt:

2017-06-24  Chris Fleizach  <cfleizach@apple.com>

        AX: Cannot call setValue() on contenteditable or ARIA text controls
        https://bugs.webkit.org/show_bug.cgi?id=173520

        Reviewed by Ryosuke Niwa.

        * accessibility/mac/set-value-editable-types-expected.txt: Added.
        * accessibility/mac/set-value-editable-types.html: Added.

2017-06-23  Chris Dumez  <cdumez@apple.com>

        fast/events/page-visibility-iframe-delete-test.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=173798

        Reviewed by Simon Fraser.

        Modernize the test and deflake it by not making it rely on a specific order
        for the visibilitychange events. The event queues are per documents and there
        is therefore no guarantee those events will fire in frame tree order.

        * fast/events/page-visibility-iframe-delete-test-expected.txt:
        * fast/events/page-visibility-iframe-delete-test.html:

2017-06-23  Youenn Fablet  <youenn@apple.com>

        Add a binary data channel webrtc test
        https://bugs.webkit.org/show_bug.cgi?id=173787

        Reviewed by Alex Christensen.

        * webrtc/datachannel/binary-expected.txt: Added.
        * webrtc/datachannel/binary.html: Added.

2017-06-23  Youenn Fablet  <youenn@apple.com>

        Set getUserMedia permission to true by default on WTR
        https://bugs.webkit.org/show_bug.cgi?id=173610

        Reviewed by Alex Christensen.

        * fast/mediastream/delayed-permission-allowed.html:
        * fast/mediastream/delayed-permission-denied.html:

2017-06-23  Youenn Fablet  <youenn@apple.com>

        webrtc/routines.js should call createAnswer once setRemoteDescription promise is resolved
        https://bugs.webkit.org/show_bug.cgi?id=173785

        Reviewed by Alex Christensen.

        * webrtc/routines.js:

2017-06-23  Youenn Fablet  <youenn@apple.com>

        webrtc::WebRtcSession is not handling correctly its state when setLocalDescription fails and is called again
        https://bugs.webkit.org/show_bug.cgi?id=173783

        Reviewed by Alex Christensen.

        * webrtc/libwebrtc/setLocalDescriptionCrash-expected.txt: Added.
        * webrtc/libwebrtc/setLocalDescriptionCrash.html: Added.

2017-06-23  Matt Lewis  <jlewis3@apple.com>

        Added additional test expectations for webrtc/video-replace-muted-track.html.
        https://bugs.webkit.org/show_bug.cgi?id=173608

        Unreviewed test expectations.

        * platform/mac-wk2/TestExpectations:

2017-06-23  Frederic Wang  <fwang@igalia.com>

        Remove fast/regions/region-leak-js-information-when-disabled-at-runtime.html
        https://bugs.webkit.org/show_bug.cgi?id=173784

        Reviewed by Simon Fraser.

        fast/regions/region-leak-js-information-when-disabled-at-runtime.html is supposed to test
        that some JS properties are undefined when CSS regions are disabled at runtime. However, this
        part is currently commented out and the test is no longer relevant after r200524. Hence we
        just remove it.

        * fast/regions/region-leak-js-information-when-disabled-at-runtime-expected.txt: Removed.
        * fast/regions/region-leak-js-information-when-disabled-at-runtime.html: Removed.

2017-06-23  Frederic Wang  <fwang@igalia.com>

        Use window.internals instead of overridePreference to set WebCore settings in tests
        https://bugs.webkit.org/show_bug.cgi?id=173714

        Reviewed by Simon Fraser.

        This commit is a first step to replace the use of testRunner.overridePreference with
        internals.settings.set* calls in tests. Such a call will fail immediately and obviously if
        its a function that does not exist, and these settings are restored properly between tests.
        Some preferences that do not have a WebCore setting or an internals.settings setter are not
        handled yet. The temporary failure added in r218480 for fast/frames/flattening/set-preference
        is removed and so is a custom expectation caret-mode-document-begin-end for Mac WK1.

        * accessibility/gtk/caret-browsing-select-focus.html: Use internals.settings.set* function.
        * accessibility/gtk/caret-browsing-text-focus.html: Ditto.
        * accessibility/gtk/caret-offsets-and-extraneous-white-spaces.html: Ditto.
        * accessibility/gtk/caret-offsets.html: Ditto.
        * accessibility/gtk/text-in-span-block-in-a-block.html: Ditto.
        * css3/blending/blend-mode-isolation-turn-off-self-painting-layer1.html: Ditto.
        * css3/blending/blend-mode-simple.html: Ditto.
        * css3/blending/effect-background-blend-mode.html: Ditto.
        * css3/filters/blur-filter-page-scroll-parents.html: Ditto.
        * css3/filters/blur-filter-page-scroll-self.html: Ditto.
        * css3/filters/blur-filter-page-scroll.html: Ditto.
        * css3/filters/effect-blur.html: Ditto.
        * css3/filters/effect-brightness-clamping.html: Ditto.
        * css3/filters/effect-brightness.html: Ditto.
        * css3/filters/effect-combined.html: Ditto.
        * css3/filters/effect-contrast.html: Ditto.
        * css3/filters/effect-drop-shadow.html: Ditto.
        * css3/filters/effect-grayscale.html: Ditto.
        * css3/filters/effect-hue-rotate.html: Ditto.
        * css3/filters/effect-invert.html: Ditto.
        * css3/filters/effect-opacity.html: Ditto.
        * css3/filters/effect-saturate.html: Ditto.
        * css3/filters/effect-sepia.html: Ditto.
        * css3/filters/filter-repaint.html: Ditto.
        * css3/filters/null-effect-check.html: Ditto.
        * editing/selection/caret-mode-document-begin-end.html: Ditto.
        * editing/selection/caret-mode-paragraph-keys-navigation.html: Ditto.
        * fast/animation/request-animation-frame-disabled.html: Ditto.
        * fast/canvas/canvas-blend-image.html: Ditto.
        * fast/canvas/canvas-blend-solid.html: Ditto.
        * fast/canvas/canvas-imageSmoothingQuality.html: Ditto.
        * fast/canvas/drawImage-with-small-values.html: Ditto.
        * fast/images/exif-orientation-composited.html: Ditto.
        * fast/images/exif-orientation-css.html: Ditto.
        * fast/images/exif-orientation.html: Ditto.
        * fast/images/image-controls-basic.html: Ditto.
        * fast/parser/pre-html5-parser-quirks.html: Ditto.
        * fast/repaint/no-caret-repaint-in-non-content-editable-element.html: Ditto.
        * http/tests/appcache/disabled.html: Ditto.
        * http/tests/contentextensions/block-cookies-in-ping.html: Ditto.
        * http/tests/contentextensions/block-ping.html: Ditto.
        * http/tests/contentextensions/hide-on-ping-with-ping-that-redirects.html: Ditto.
        * http/tests/contentextensions/hide-on-ping.html: Ditto.
        * http/tests/misc/favicon-loads-with-icon-loading-override.html: Ditto.
        * http/tests/navigation/ping-attribute/anchor-cookie.html: Ditto.
        * http/tests/navigation/ping-attribute/anchor-cross-origin-from-https.html: Ditto.
        * http/tests/navigation/ping-attribute/anchor-cross-origin.html: Ditto.
        * http/tests/navigation/ping-attribute/anchor-ping-and-follow-redirect-when-sending-ping.html: Ditto.
        * http/tests/navigation/ping-attribute/anchor-same-origin.html: Ditto.
        * http/tests/navigation/ping-attribute/area-cookie.html: Ditto.
        * http/tests/navigation/ping-attribute/area-cross-origin-from-https.html: Ditto.
        * http/tests/navigation/ping-attribute/area-cross-origin.html: Ditto.
        * http/tests/navigation/ping-attribute/area-same-origin.html: Ditto.
        * http/tests/security/mixedContent/insecure-script-in-data-iframe-in-main-frame-blocked.html: Ditto.
        * imported/blink/fast/css/image-orientation/image-orientation-dynamic-expected.html: Ditto.
        * loader/meta-refresh-disabled.html: Ditto.
        * media/crash-closing-page-with-media-as-plugin-fallback.html: Ditto.
        * platform/mac-wk1/editing/selection/caret-mode-document-begin-end-expected.txt: Removed.
        Mac WK1 now produces the same output as other platforms.
        * platform/mac/TestExpectations: Remove the failure for FrameFlattening now that the test
        uses internals.settings.set*.
        * platform/mac/fast/frames/flattening/set-preference.html: Use internals.settings.set*.
        * plugins/crash-restoring-plugin-page-from-page-cache.html: Ditto.
        * plugins/frameset-with-plugin-frame.html: Ditto.
        * plugins/netscape-plugin-page-cache-works.html: Ditto.

2017-06-23  Chris Dumez  <cdumez@apple.com>

        [mac-wk1] requestAnimationFrame callbacks may not get serviced
        https://bugs.webkit.org/show_bug.cgi?id=173628

        Reviewed by Simon Fraser.

        Extend layout test coverage.

        * fast/events/page-visibility-transition-test-expected.txt:
        * fast/events/page-visibility-transition-test.html:

2017-06-23  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] Drop the AES-CFB support
        https://bugs.webkit.org/show_bug.cgi?id=173547

        Reviewed by Jiewen Tan.

        Add GTK+-specific baselines for AES tests that also cover the CFB variation.
        These tests still pass because errors are expected, it's just that errors now
        occur because the algorithm isn't supported anymore, rather than because of
        operation errors due to malformed parameters.

        * platform/gtk/crypto/subtle/aes-cbc-cfb-decrypt-malformed-parameters-expected.txt: Added.
        * platform/gtk/crypto/subtle/aes-cbc-cfb-encrypt-malformed-parameters-expected.txt: Added.
        * platform/gtk/crypto/subtle/aes-export-key-malformed-parameters-expected.txt: Added.
        * platform/gtk/crypto/subtle/aes-generate-key-malformed-parameters-expected.txt: Added.
        * platform/gtk/crypto/subtle/aes-import-key-malformed-parameters-expected.txt: Added.

2017-06-22  Antti Koivisto  <antti@apple.com>

        REGRESSION(r217695): Offscreen/overflowed items not being rendered while translating in-frame
        https://bugs.webkit.org/show_bug.cgi?id=173732

        Reviewed by Simon Fraser.

        * compositing/backing/transform-transition-from-outside-view-expected.txt: Added.
        * compositing/backing/transform-transition-from-outside-view.html: Added.

2017-06-22  Myles C. Maxfield  <mmaxfield@apple.com>

        @font-face rules with invalid primary fonts never download their secondary fonts
        https://bugs.webkit.org/show_bug.cgi?id=173138
        <rdar://problem/32554450>

        Reviewed by Simon Fraser.

        * fast/text/font-fallback-invalid-load-expected.html: Added.
        * fast/text/font-fallback-invalid-load.html: Added.
        * fast/text/resources/bogus.svg: Added.

2017-06-22  Youenn Fablet  <youenn@apple.com>

        Add a test for multi data channel peer connection
        https://bugs.webkit.org/show_bug.cgi?id=173735

        Reviewed by Eric Carlson.

        * webrtc/datachannel/multi-channel-expected.txt: Added.
        * webrtc/datachannel/multi-channel.html: Added.

2017-06-22  Antoine Quint  <graouts@apple.com>

        REGRESSION: LayoutTest media/modern-media-controls/placard-support/placard-support-pip.html is a flaky timeout on Sierra
        https://bugs.webkit.org/show_bug.cgi?id=173725

        Reviewed by Dean Jackson.

        On WK1, this test enters fullscreen rather than PiP (which is unexpected, see webkit.org/b/173729) and thus the button
        to exit PiP could not be clicked. But we don't need a button click to exit PiP, so instead we just call a method to
        toggle it.

        * media/modern-media-controls/placard-support/placard-support-pip.html:

2017-06-22  Ryan Haddad  <ryanhaddad@apple.com>

        Mark perf/object-keys.html as flaky on iOS.
        https://bugs.webkit.org/show_bug.cgi?id=171617

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-06-22  Zalan Bujtas  <zalan@apple.com>

        REGRESSION(r214712): Infinite recursion in RenderTable::layout in paginated mode
        https://bugs.webkit.org/show_bug.cgi?id=173731
        <rdar://problem/32237775>

        Reviewed by Antti Koivisto.

        * fast/table/caption-bottom-with-pagination-expected.txt: Added.
        * fast/table/caption-bottom-with-pagination.html: Added.

2017-06-22  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/forward-button/forward-button.html as flaky on mac-wk1.
        https://bugs.webkit.org/show_bug.cgi?id=168265

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-06-22  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Pausing with a deep call stack can be very slow, avoid eagerly generating object previews
        https://bugs.webkit.org/show_bug.cgi?id=173698

        Reviewed by Matt Baker.

        * inspector/runtime/getPreview-expected.txt: Added.
        * inspector/runtime/getPreview.html: Added.
        Test the new protocol command `Runtime.getPreview` as well as the frontend
        model method RemoteObject.prototype.updatePreview which uses it with its
        own slightly different semantics about when it should be used.

        * inspector/debugger/tail-deleted-frames-this-value.html:
        This test used `CallFrame.thisObject.preview` so rewrite it to first
        load the preview and then check values with it.

2017-06-22  Ryan Haddad  <ryanhaddad@apple.com>

        Skip fast/forms/file/input-file-write-files-using-open-panel.html on ios-wk2.
        https://bugs.webkit.org/show_bug.cgi?id=173733

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-06-22  Ryan Haddad  <ryanhaddad@apple.com>

        Remove TestExpectations for test that were removed in r218651.

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-06-22  Ryan Haddad  <ryanhaddad@apple.com>

        Mark webaudio/silent-audio-interrupted-in-background.html as flaky on mac-wk2.
        https://bugs.webkit.org/show_bug.cgi?id=172201

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-06-22  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r218633.

        The test is failing frequently on Sierra Debug and Windows

        Reverted changeset:

        "AX: Cannot call setValue() on contenteditable or ARIA text
        controls"
        https://bugs.webkit.org/show_bug.cgi?id=173520
        http://trac.webkit.org/changeset/218633

2017-06-22  Romain Bellessort  <romain.bellessort@crf.canon.fr>

        [Readable Streams API] Implement ReadableStreamBYOBReader read()
        https://bugs.webkit.org/show_bug.cgi?id=172714

        Reviewed by Youenn Fablet.

        Added 1 test to check that read() can only be applied to a ReadableStreamBYOBReader.
        Other behaviors are checked by WPT (web-platform-tests/streams/readable-byte-streams/general.js).

        * streams/readable-stream-byob-reader-expected.txt: Updated.
        * streams/readable-stream-byob-reader.js: Added 1 test.


2017-06-22  Youenn Fablet  <youenn@apple.com>

        [WebRTC] Prevent capturing at unconventional resolutions when using the SW encoder on Mac
        https://bugs.webkit.org/show_bug.cgi?id=172602
        <rdar://problem/32407693>

        Reviewed by Eric Carlson.

        * platform/mac-wk1/TestExpectations: Mark captureCanvas as flaky due to AVDCreateGPUAccelerator: Error loading GPU renderer" appearing on some bots.
        * platform/mac/webrtc/captureCanvas-webrtc-software-encoder-expected.txt: Copied from LayoutTests/webrtc/captureCanvas-webrtc-expected.txt.
        * platform/mac/webrtc/captureCanvas-webrtc-software-encoder.html: Added.
        * webrtc/captureCanvas-webrtc-expected.txt:
        * webrtc/captureCanvas-webrtc.html:

2017-06-22  Joseph Pecoraro  <pecoraro@apple.com>

        LayoutTests/inspector/indexeddb/requestDatabaseNames.html: Sort database names to prevent flakiness
        https://bugs.webkit.org/show_bug.cgi?id=173699

        Reviewed by Alex Christensen.

        * inspector/indexeddb/requestDatabaseNames.html:
        Sort database names (when more than one) to ensure a consistent order.

2017-06-22  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Skip js geolocation test.

        Unreviewed gardening.
        Geolocation was disabled since r218553.
        * platform/wpe/TestExpectations:

2017-06-22  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Unskip http cache tests.

        Unreviewed gardening.

        Currently failing tests are the same as in the GTK+ port.
        * platform/wpe/TestExpectations:

2017-06-21  Youenn Fablet  <youenn@apple.com>

        [Fetch API] TypeError when called with body === {}
        https://bugs.webkit.org/show_bug.cgi?id=173295
        <rdar://problem/32746733>

        Reviewed by Sam Weinig.

        * fetch/body-init-expected.txt: Added.
        * fetch/body-init.html: Added.

2017-06-21  Antoine Quint  <graouts@apple.com>

        CSS text properties affect <video> shadow root
        https://bugs.webkit.org/show_bug.cgi?id=173664
        <rdar://problem/32904328>

        Reviewed by Dean Jackson.

        Add a test that ensures that setting an inheritable style on the <video> does not affect
        time labels within the shadow root.

        * media/modern-media-controls/time-label/time-label-inherited-text-indent-expected.txt: Added.
        * media/modern-media-controls/time-label/time-label-inherited-text-indent.html: Added.

2017-06-21  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Using "break on all exceptions" when throwing stack overflow hangs inspector
        https://bugs.webkit.org/show_bug.cgi?id=172432
        <rdar://problem/29870873>

        Reviewed by Saam Barati.

        * inspector/debugger/no-pause-out-of-memory-exception-expected.txt: Added.
        * inspector/debugger/no-pause-out-of-memory-exception.html: Added.
        * inspector/debugger/no-pause-stack-overflow-exception-expected.txt: Added.
        * inspector/debugger/no-pause-stack-overflow-exception.html: Added.

2017-06-20  Simon Fraser  <simon.fraser@apple.com>

        Remove WILL_REVEAL_EDGE_EVENTS code
        https://bugs.webkit.org/show_bug.cgi?id=173632

        Reviewed by Sam Weinig, Beth Dakin.

        Remove will-reveal-edge events, which never took off.

        * fast/events/will-reveal-edge-on-div-expected.txt: Removed.
        * fast/events/will-reveal-edge-on-div.html: Removed.
        * fast/events/will-reveal-edges-body-attributes-expected.txt: Removed.
        * fast/events/will-reveal-edges-body-attributes.html: Removed.
        * fast/events/will-reveal-edges-event-listeners-expected.txt: Removed.
        * fast/events/will-reveal-edges-event-listeners.html: Removed.
        * fast/events/will-reveal-edges-window-attributes-expected.txt: Removed.
        * fast/events/will-reveal-edges-window-attributes.html: Removed.

2017-06-21  Simon Fraser  <simon.fraser@apple.com>

        svgPath.getTotalLength() freezes webkit
        https://bugs.webkit.org/show_bug.cgi?id=173566
        <rdar://problem/32866731>

        Reviewed by Dean Jackson.

        * svg/custom/path-getTotalLength-hang.html: Added.

2017-06-21  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Unreviewed gardening

        Update expectations to known flaky http/appcache tests and also a
        couple of flaky crashing tests.
        * platform/wpe/TestExpectations:

2017-06-21  Chris Fleizach  <cfleizach@apple.com>

        AX: Cannot call setValue() on contenteditable or ARIA text controls
        https://bugs.webkit.org/show_bug.cgi?id=173520

        Reviewed by Ryosuke Niwa.

        * accessibility/set-value-editable-types-expected.txt: Added.
        * accessibility/set-value-editable-types.html: Added.

2017-06-20  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] Implement CryptoKeyEC SPKI imports
        https://bugs.webkit.org/show_bug.cgi?id=172927

        Reviewed by Jiewen Tan, Michael Catanzaro and Carlos Garcia Campos.

        * platform/gtk/TestExpectations:
        Unskip or enable the EC-based SPKI import tests that are now passing.

2017-06-20  Myles C. Maxfield  <mmaxfield@apple.com>

        Disable font variations on macOS Sierra and iOS 10
        https://bugs.webkit.org/show_bug.cgi?id=173618
        <rdar://problem/32879164>

        Reviewed by Jon Lee.

        Update expected test results. The old test results are now High Sierra- and iOS 11-expected.

        * fast/css/getComputedStyle/computed-style-expected.txt:
        * fast/css/getComputedStyle/computed-style-font-family-expected.txt:
        * fast/css/getComputedStyle/computed-style-without-renderer-expected.txt:
        * fast/text/font-selection-font-face-parse-expected.txt:
        * fast/text/font-selection-font-loading-api-parse-expected.txt:
        * fast/text/font-stretch-parse-expected.txt:
        * fast/text/font-style-parse-expected.txt:
        * fast/text/font-weight-parse-expected.txt:
        * platform/ios/TestExpectations:
        * platform/mac-elcapitan/fast/css/getComputedStyle/computed-style-expected.txt: Removed.
        * platform/mac-elcapitan/fast/css/getComputedStyle/computed-style-font-family-expected.txt: Removed.
        * platform/mac-elcapitan/fast/css/getComputedStyle/computed-style-without-renderer-expected.txt: Removed.
        * platform/mac-elcapitan/fast/text/font-selection-font-face-parse-expected.txt: Removed.
        * platform/mac-elcapitan/fast/text/font-selection-font-loading-api-parse-expected.txt: Removed.
        * platform/mac-elcapitan/fast/text/font-stretch-parse-expected.txt: Removed.
        * platform/mac-elcapitan/fast/text/font-style-parse-expected.txt: Removed.
        * platform/mac-elcapitan/fast/text/font-weight-parse-expected.txt: Removed.
        * platform/mac-elcapitan/svg/css/getComputedStyle-basic-expected.txt: Removed
        * platform/mac/TestExpectations:
        * platform/mac/svg/css/getComputedStyle-basic-expected.txt: Removed

2017-06-20  Devin Rousso  <drousso@apple.com>

        Web Inspector: Send context attributes for tracked canvases
        https://bugs.webkit.org/show_bug.cgi?id=173327

        Reviewed by Joseph Pecoraro.

        * inspector/canvas/context-attributes-expected.txt: Added.
        * inspector/canvas/context-attributes.html: Added.

2017-06-20  Matt Lewis  <jlewis3@apple.com>

        Marked webrtc/video-replace-muted-track.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=173486

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-06-20  Myles C. Maxfield  <mmaxfield@apple.com>

        [Cocoa] The system Japanese font cannot be italicized
        https://bugs.webkit.org/show_bug.cgi?id=173300
        <rdar://problem/31805407>

        Reviewed by Ryosuke Niwa.

        * fast/text/system-font-japanese-synthetic-italic-expected-mismatch.html: Added.
        * fast/text/system-font-japanese-synthetic-italic.html: Added.
        * platform/mac/TestExpectations: This codepath doesn't work in El Capitan.

2017-06-20  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r218524.

        This change broke internal builds.

        Reverted changeset:

        "[Cocoa] The system Japanese font cannot be italicized"
        https://bugs.webkit.org/show_bug.cgi?id=173300
        http://trac.webkit.org/changeset/218524

2017-06-20  Simon Fraser  <simon.fraser@apple.com>

        <rdar://problem/32862652> [REGRESSION] r218374: fast/events/ios/rotation/layout-viewport-during-safari-type-rotation.html
        
        Rebaseline.

        * fast/events/ios/rotation/layout-viewport-during-safari-type-rotation-expected.txt:

2017-06-20  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline fast/events/touch/document-create-touch-list tests.

        Unreviewed test gardening.

        * fast/events/touch/document-create-touch-list-crash-expected.txt:
        * fast/events/touch/document-create-touch-list-ios-expected.txt:

2017-06-20  Matt Baker  <mattbaker@apple.com>

        LayoutTest inspector/canvas/create-canvas-contexts.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=173603

        Reviewed by Joseph Pecoraro.

        Removed test case `CheckCanvasesCleared`, which involved a page reload
        and would intermittently timeout.

        * inspector/canvas/create-canvas-contexts-expected.txt:
        * inspector/canvas/create-canvas-contexts.html:

2017-06-20  Antoine Quint  <graouts@apple.com>

        REGRESSION: media/remote-control-command-seek.html is timing out
        https://bugs.webkit.org/show_bug.cgi?id=173615
        <rdar://problem/32626498>

        Reviewed by Eric Carlson.

        This test assumes that we load metadata and video data that can be seeked through
        at the same time, but this is incorrect. Using the "canplaythrough" event guarantees
        that the video is seekable, so we switch to this event to make the test more robust.

        * media/remote-control-command-seek-expected.txt:
        * media/remote-control-command-seek.html:

2017-06-20  Matt Lewis  <jlewis3@apple.com>

        Added additional test expectations for media/video-buffered.html.
        https://bugs.webkit.org/show_bug.cgi?id=173611

        Uneviewed test gardening.

        * platform/ios/TestExpectations:

2017-06-20  Devin Rousso  <drousso@apple.com>

        Web Inspector: add console messages for WebGL shader compile and program link errors/warnings
        https://bugs.webkit.org/show_bug.cgi?id=143236
        <rdar://problem/20352149>

        Reviewed by Dean Jackson.

        * fast/canvas/webgl/fragment-shader-assertion.html:
        * fast/canvas/webgl/shader-compile-logging-expected.txt: Added.
        * fast/canvas/webgl/shader-compile-logging.html: Added.

2017-06-19  Antoine Quint  <graouts@apple.com>

        Media document experience with long-loading files is poor
        https://bugs.webkit.org/show_bug.cgi?id=173575
        <rdar://problem/32178119>

        Reviewed by Dean Jackson.

        Fix a test that started failing with this patch and add two new tests that check we are adding
        the expected CSS classes when loading video and invalid media documents.

        * media/modern-media-controls/media-documents/media-document-invalid-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-invalid.html: Added.
        * media/modern-media-controls/media-documents/media-document-video-with-initial-audio-layout-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-video-with-initial-audio-layout.html: Added.
        * media/modern-media-controls/volume-up-support/volume-up-support-expected.txt:
        * media/modern-media-controls/volume-up-support/volume-up-support.html:

2017-06-20  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Enable appcache tests

        Unreviewed gardening.

        Most of these tests are passing, so enable them. For known GTK+
        failures, copy the expectations. Mark as failing deferred events
        tests that have slight differences that need to be investigated.
        * platform/wpe/TestExpectations:

2017-06-20  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Skip geolocation tests

        Geolocation was disabled since r218553 and thus far tests were
        only using the mock provider. Skip until we add geoclue
        support.
        * platform/wpe/TestExpectations:

2017-06-20  Oleksandr Skachkov  <gskachkov@gmail.com>

        Revert changes in bug#160417 about extending `null` not being a derived class
        https://bugs.webkit.org/show_bug.cgi?id=169293

        Reviewed by Saam Barati.

        * js/class-syntax-extends-expected.txt:
        * js/class-syntax-super-expected.txt:
        * js/script-tests/class-syntax-extends.js:
        * js/script-tests/class-syntax-super.js:

2017-06-20  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed WPE gardening.

        Unskipping AES-CTR and RSA-PSS layout tests that already pass.

        Adding layout test baselines for two imported W3C tests that cover AES-CBC.
        The subtests there pass, but the generic baseline expects failures, so we
        work around that by adding baselines that expect passing tests.

        * platform/wpe/TestExpectations:
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/encrypt_decrypt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/encrypt_decrypt/aes_cbc.worker-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/encrypt_decrypt/test_aes_cbc.https-expected.txt: Added.

2017-06-20  Miguel Gomez  <magomez@igalia.com>

        [GTK] Layout Test fast/canvas/webgl/tex-image-and-sub-image-2d-with-video.html makes the subsequent test case flaky crash.
        https://bugs.webkit.org/show_bug.cgi?id=173459

        Reviewed by Carlos Garcia Campos.

        Unskip fast/canvas/webgl/tex-image-and-sub-image-2d-with-video.html.

        * platform/gtk/TestExpectations:

2017-06-19  Devin Rousso  <drousso@apple.com>

        Web Inspector: create canvas content view and details sidebar panel
        https://bugs.webkit.org/show_bug.cgi?id=138941
        <rdar://problem/19051672>

        Reviewed by Joseph Pecoraro.

        * inspector/canvas/requestContent-expected.txt: Added.
        * inspector/canvas/requestContent.html: Added.
        * inspector/canvas/requestNode-expected.txt: Added.
        * inspector/canvas/requestNode.html: Added.

2017-06-19  Frederic Wang  <fwang@igalia.com>

        [iOS] Always include frames in the scrolling tree when async frame scrolling is enabled
        https://bugs.webkit.org/show_bug.cgi?id=173405

        Reviewed by Simon Fraser.

        Add some new expectations for iOS/WK2 now that the "async frame scrolling" setting is taken
        into account for the layer and scrolling trees.

        * platform/ios-wk2/compositing/iframes/compositing-for-scrollable-iframe-expected.txt: Added.
        A specific layer is created for the iframe.
        * platform/ios-wk2/fast/scrolling/scrolling-tree-includes-frame-expected.txt: Added.
        The frame appears in the scrolling tree.
        * platform/ios/fast/scrolling/scrolling-tree-includes-frame-expected.txt: Renamed from LayoutTests/platform/ios-simulator/fast/scrolling/scrolling-tree-includes-frame-expected.txt.
        Use this as a generic expectation for iOS.

2017-06-19  Frederic Wang  <fwang@igalia.com>

        [Mac] Add an experimental feature setting for async frame scrolling
        https://bugs.webkit.org/show_bug.cgi?id=173359

        Reviewed by Simon Fraser.

        * compositing/iframes/compositing-for-scrollable-iframe.html: Use "async frame scrolling" for
        this test.
        * fast/scrolling/scrolling-tree-includes-frame.html: Ditto.

2017-06-19  Zan Dobersek  <zdobersek@igalia.com>

        [WebCrypto] Add test for ECDH SPKI imports using the ecDH algorithm identifier
        https://bugs.webkit.org/show_bug.cgi?id=173543

        Reviewed by Jiewen Tan.

        Add the ecdh-import-spki-key-ecdh-identifier.html layout test which
        tests for successful import of EC keys through the SPKI format when
        using the ecDH algorithm identifier (OID 1.3.132.1.12) and following
        the ECDH algorithm import steps.

        No implementation supports this yet, so the test is skipped on all ports.

        * TestExpectations:
        * crypto/subtle/ecdh-import-spki-key-ecdh-identifier-expected.txt: Added.
        * crypto/subtle/ecdh-import-spki-key-ecdh-identifier.html: Added.

2017-06-19  Myles C. Maxfield  <mmaxfield@apple.com>

        [Cocoa] The system Japanese font cannot be italicized
        https://bugs.webkit.org/show_bug.cgi?id=173300
        <rdar://problem/31805407>

        Reviewed by Ryosuke Niwa.

        * fast/text/system-font-japanese-synthetic-italic-expected-mismatch.html: Added.
        * fast/text/system-font-japanese-synthetic-italic.html: Added.
        * platform/mac/TestExpectations: This codepath doesn't work in El Capitan.

2017-06-19  Youenn Fablet  <youenn@apple.com>

        Improve debugging ability of some webrtc tests
        https://bugs.webkit.org/show_bug.cgi?id=173549

        Reviewed by Eric Carlson.

        Improve debugging ability for first two tests.
        Improve reliability for the next three tests.

        * webrtc/audio-replace-track-expected.txt:
        * webrtc/audio-replace-track.html: Checking connected state.
        * webrtc/video-mute-expected.txt:
        * webrtc/video-mute.html: Ditto.
        * webrtc/video-replace-track-to-null.html: Improving reliability of test.
        * webrtc/video-rotation.html: Adding some delay before testing black frames and increasing delay between the tests..
        * webrtc/video-unmute.html: Using counter based testing of black frames.

2017-06-19  Alex Christensen  <achristensen@webkit.org>

        [Cocoa] implement URLSession:task:needNewBodyStream: delegate method
        https://bugs.webkit.org/show_bug.cgi?id=173551
        rdar://problem/32250512

        Reviewed by Alex Christensen.

        * http/tests/misc/form-blob-challenge-expected.txt: Added.
        * http/tests/misc/form-blob-challenge.html: Added.
        * http/tests/misc/resources/basic-echo-post.php: Added.

2017-06-19  Matt Lewis  <jlewis3@apple.com>

        Adjusted test ecpectaions for webrtc/libwebrtc/descriptionGetters.html.
        https://bugs.webkit.org/show_bug.cgi?id=171703

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-06-19  Joseph Pecoraro  <pecoraro@apple.com>

        test262: Completion values for control flow do not match the spec
        https://bugs.webkit.org/show_bug.cgi?id=171265

        Reviewed by Saam Barati.

        * js/eval-throw-return-expected.txt:
        * js/kde/completion-expected.txt:
        * js/kde/script-tests/completion.js:
        * js/script-tests/eval-throw-return.js:
        * sputnik/Conformance/12_Statement/12.6_Iteration_Statements/12.6.3_The_for_Statement/S12.6.3_A9-expected.txt:
        * sputnik/Conformance/12_Statement/12.6_Iteration_Statements/12.6.3_The_for_Statement/S12.6.3_A9.1-expected.txt:
        Rebaseline expectations. These are all outdated. In fact the sputnik
        tests were imported into test262 and modified for ES2015.
        
        * js/script-tests/function-toString-vs-name.js:
        ClassDeclarations on their own don't produce a value. So output
        the class value so the test behaves as expected.

2017-06-19  Sam Weinig  <sam@webkit.org>

        [WebIDL] Add support for serializers that have members that are themselves serializers (or inherit being a serializer from a parent)
        https://bugs.webkit.org/show_bug.cgi?id=173395

        Reviewed by Simon Fraser.

        * fast/css/DOMQuad-serialization-expected.txt: Added.
        * fast/css/DOMQuad-serialization.html: Added.
        Add test for DOMQuad serialization, now that it is supported.

2017-06-19  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r218505.
        https://bugs.webkit.org/show_bug.cgi?id=173563

        "It would break internal builds" (Requested by youenn on
        #webkit).

        Reverted changeset:

        "[WebRTC] Prevent capturing at unconventional resolutions when
        using the SW encoder on Mac"
        https://bugs.webkit.org/show_bug.cgi?id=172602
        http://trac.webkit.org/changeset/218505

2017-06-19  Youenn Fablet  <youenn@apple.com>

        [WebRTC] Prevent capturing at unconventional resolutions when using the SW encoder on Mac
        https://bugs.webkit.org/show_bug.cgi?id=172602
        <rdar://problem/32407693>

        Reviewed by Eric Carlson.

        * platform/mac-wk1/TestExpectations: Mark captureCanvas as flaky due to AVDCreateGPUAccelerator: Error loading GPU renderer" appearing on some bots.
        * platform/mac/webrtc/captureCanvas-webrtc-software-encoder-expected.txt: Copied from LayoutTests/webrtc/captureCanvas-webrtc-expected.txt.
        * platform/mac/webrtc/captureCanvas-webrtc-software-encoder.html: Added.
        * webrtc/captureCanvas-webrtc-expected.txt:
        * webrtc/captureCanvas-webrtc.html:

2017-06-19  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline js/dom/global-constructors-attributes.html.

        Unreviewed test gardening.

        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:

2017-06-19  Youenn Fablet  <youenn@apple.com>

        A cloned MediaStreamTrack should mute independently other tracks using the same source
        https://bugs.webkit.org/show_bug.cgi?id=172831
        <rdar://problem/32518527>

        Reviewed by Eric Carlson.

        * webrtc/clone-audio-track.html: Added.
        * webrtc/video-disabled-black.html:
        * webrtc/video-unmute-expected.txt:
        * webrtc/video-unmute.html:

2017-06-19  Sam Weinig  <sam@webkit.org>

        [WebIDL] Properly model buffer source / typed arrays as their own IDL types
        https://bugs.webkit.org/show_bug.cgi?id=173513

        Reviewed by Alex Christensen.

        * crypto/subtle/aes-cbc-cfb-encrypt-malformed-parameters-expected.txt:
        * crypto/subtle/hkdf-derive-bits-malformed-parametrs-expected.txt:
        * crypto/subtle/pbkdf2-derive-bits-malformed-parametrs-expected.txt:
        Update results for changed exception language.

2017-06-19  Claudio Saavedra  <csaavedra@igalia.com>

        Unreviewed GTK+ gardening

        Unmarked a bunch of http multimedia tests that were failing with gst 1.6.3.
        We're now depending on 1.10.4 and these are passing. Also marked as slow
        a couple more.
        * platform/gtk/TestExpectations:

2017-06-19  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed GTK+ gardening.

        Enable RSA-PSS tests on the GTK+ port. Tests covering this Web Crypto
        algorithm are skipped on all platforms, but since the libgcrypt-based
        implementation is operating properly, we can enable the majority of
        these tests for GTK+. The tests that remain skipped cover SPKI and
        PKCS#8 import and export capabilities that still have to be landed.

        WPE will enable these tests in a separate patch.

        * platform/gtk/TestExpectations:

2017-06-19  Claudio Saavedra  <csaavedra@igalia.com>

        [GTK] Rebaseline js/dom/dom-static-property-for-in-iteration.html
        https://bugs.webkit.org/show_bug.cgi?id=133868

        Unreviewed gardening

        This test needs expectations to be updated after changes to DOM
        static properties. Update and unskip.
        * platform/gtk/TestExpectations: Unskip.
        * platform/gtk/js/dom/dom-static-property-for-in-iteration-expected.txt:

2017-06-19  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] AES_CTR support
        https://bugs.webkit.org/show_bug.cgi?id=171420

        Reviewed by Michael Catanzaro.

        * platform/gtk/TestExpectations: Unskip the relevant AES_CTR tests.

2017-06-19  Fujii Hironori  <Hironori.Fujii@sony.com>

        [GTK] Layout Test imported/w3c/web-platform-tests/webrtc/RTCPeerConnection-createOffer.html crashes
        https://bugs.webkit.org/show_bug.cgi?id=173456

        Unreviewed gardening.

        * platform/gtk/TestExpectations: Marked
        imported/w3c/web-platform-tests/webrtc/RTCPeerConnection-createOffer.html,
        webrtc/createOfferAnswer.html and webrtc/video-addTransceiver.html Crash.

2017-06-19  Claudio Saavedra  <csaavedra@igalia.com>

        [GTK][WPE] Rebaseline after r218458

        Unreviewed gardening.

        Add new DOMQuad attribute to the test expectations.
        * platform/gtk/js/dom/global-constructors-attributes-expected.txt:
        * platform/wpe/js/dom/global-constructors-attributes-dedicated-worker-expected.txt:
        * platform/wpe/js/dom/global-constructors-attributes-expected.txt:

2017-05-14 Frederic Wang  <fwang@igalia.com>

        Add heuristic to avoid flattening "fullscreen" iframes
        https://bugs.webkit.org/show_bug.cgi?id=171914

        Reviewed by Simon Fraser.

        This commit adjusts tests to work when frame flattening is an enum.
        It also adds a test to check the new heuristic when "frame flattening for non-fullscreen
        iframes" is enabled.
        set-preference.html is disabled for now, as the test suite does not support overridePreference()
        for non-boolean values (bug 128594).

        * fast/forms/ios/delete-in-input-in-iframe.html: Use enum value "FullyEnabled".
        * fast/forms/ios/focus-input-in-iframe.html: Ditto.
        * fast/forms/ios/programmatic-focus-input-in-iframe.html: Ditto.
        * fast/forms/ios/typing-in-input-in-iframe.html: Ditto.
        * fast/frames/flattening/crash-remove-iframe-during-object-beforeload.html: Ditto.
        * fast/frames/flattening/crash-svg-document.html: Ditto.
        * fast/frames/flattening/crash-when-sibling-iframe-is-destroyed-with-subtree-layoutroot.html: Ditto.
        * fast/frames/flattening/frameset-flattening-advanced.html: Ditto.
        * fast/frames/flattening/frameset-flattening-grid.html: Ditto.
        * fast/frames/flattening/frameset-flattening-simple.html: Ditto.
        * fast/frames/flattening/frameset-flattening-subframe-resize.html: Ditto.
        * fast/frames/flattening/frameset-flattening-subframesets.html: Ditto.
        * fast/frames/flattening/hittest-iframe-while-style-changes-crash.html: Ditto.
        Be sure to use single quotes for the inline iframe page.
        * fast/frames/flattening/iframe-flattening-crash.html: Use enum value "FullyEnabled".
        * fast/frames/flattening/iframe-flattening-fixed-height.html: Ditto.
        * fast/frames/flattening/iframe-flattening-fixed-width-and-height-no-scrolling-with-js-forced-layout.html: Ditto.
        * fast/frames/flattening/iframe-flattening-fixed-width-and-height-no-scrolling.html: Ditto.
        * fast/frames/flattening/iframe-flattening-fixed-width-and-height-zero-size.html: Ditto.
        * fast/frames/flattening/iframe-flattening-fixed-width-and-height.html: Ditto.
        * fast/frames/flattening/iframe-flattening-fixed-width.html: Ditto.
        * fast/frames/flattening/iframe-flattening-fullscreen.html: Added. Check the new heuristic.
        * fast/frames/flattening/iframe-flattening-fullscreen-expected.txt: Added.
        * fast/frames/flattening/iframe-flattening-inside-flexbox-with-delayed-scroll-update.html: Use enum value "FullyEnabled".
        * fast/frames/flattening/iframe-flattening-nested.html: Ditto.
        * fast/frames/flattening/iframe-flattening-offscreen.html: Ditto.
        * fast/frames/flattening/iframe-flattening-out-of-view-and-scroll.html: Ditto.
        * fast/frames/flattening/iframe-flattening-out-of-view-scroll-and-relayout.html: Ditto.
        * fast/frames/flattening/iframe-flattening-out-of-view.html: Ditto.
        * fast/frames/flattening/iframe-flattening-resize-event-count.html: Ditto.
        * fast/frames/flattening/iframe-flattening-selection-crash.html: Ditto.
        * fast/frames/flattening/iframe-flattening-simple.html: Ditto.
        * fast/frames/flattening/iframe-tiny.html: Ditto.
        * fast/frames/flattening/scrollable-flexbox-inside-iframe-with-zero-height-and-needs-full-repaint-crash.html: Ditto.
        * fast/frames/flattening/scrollable-flexbox-inside-iframe-with-zero-height-assertion-failure.html: Ditto.
        * fast/frames/flattening/scrolling-in-object.html: Ditto.
        * fast/spatial-navigation/snav-iframe-flattening-simple.html: Ditto.
        * http/tests/misc/iframe-flattening-3level-nesting-with-blocking-resource.html: Ditto.
        * platform/mac/TestExpectations: Disable this due to limitation in the test infrastructure.
        * plugins/frameset-with-plugin-frame.html: Use enum value "FullyEnabled".

2017-06-18  Ryosuke Niwa  <rniwa@webkit.org>

        Meter element doesn't respect the writing direction
        https://bugs.webkit.org/show_bug.cgi?id=173507

        Reviewed by Sam Weinig.

        A regression ref test since existing tests were pixel tests and did not catch this regression.
        Note that black border was added to workaround the anti-aliasing differences in macOS High Sierra.

        * fast/dom/HTMLMeterElement/meter-rtl-expected.html: Added.
        * fast/dom/HTMLMeterElement/meter-rtl.html: Added.

2017-06-18  Chris Dumez  <cdumez@apple.com>

        Crash when re-entering MediaDevicesEnumerationRequest::cancel()
        https://bugs.webkit.org/show_bug.cgi?id=173522
        <rdar://problem/31185739>

        Reviewed by Darin Adler.

        Add layout test coverage. This test would flakily crash before the fix because it
        relies on the order in which contextDestroyed() is called for MediaDevicesRequest
        and MediaDevicesEnumerationRequest.

        * fast/mediastream/destroy-document-while-enumerating-devices-expected.txt: Added.
        * fast/mediastream/destroy-document-while-enumerating-devices.html: Added.
        * fast/mediastream/resources/enumerate-devices-frame.html: Added.

2017-06-17  Simon Fraser  <simon.fraser@apple.com>

        Implement DOMQuad
        https://bugs.webkit.org/show_bug.cgi?id=163534

        Reviewed by Sam Weinig.
        
        Implement DOMQuad per https://drafts.fxtf.org/geometry/#DOMQuad.

        * js/dom/global-constructors-attributes-dedicated-worker-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-06-17  Antti Koivisto  <antti@apple.com>

        Crash due to infinite recursion via FrameSelection::updateAppearanceAfterLayout
        https://bugs.webkit.org/show_bug.cgi?id=173468

        Reviewed by Ryosuke Niwa.

        * editing/selection/updateAppearanceAfterLayout-recursion-expected.txt: Added.
        * editing/selection/updateAppearanceAfterLayout-recursion.html: Added.

2017-06-17  Per Arne Vollan  <pvollan@apple.com>

        [Win] Update expectations for layout tests.
        https://bugs.webkit.org/show_bug.cgi?id=172437

        Unreviewed test gardening, update test expectations for failing tests.

        * platform/win/TestExpectations:

2017-06-17  Keith Miller  <keith_miller@apple.com>

        ArrayPrototype methods should use JSValue::toLength for non-Arrays.
        https://bugs.webkit.org/show_bug.cgi?id=173506

        Unreviewed test gardening.

        * TestExpectations:

2017-06-17  Per Arne Vollan  <pvollan@apple.com>

        Unreviewed test gardening. Remove duplicate entries for tests.

        * platform/win/TestExpectations:

2017-06-17  Ryosuke Niwa  <rniwa@webkit.org>

        REGRESSION(r209495): materiauxlaverdure.com fails to load
        https://bugs.webkit.org/show_bug.cgi?id=173301
        <rdar://problem/32624850>

        Reviewed by Antti Koivisto.

        Rebaselined the existing tests and added a new regression test for serializing CSS properties and values.

        * accessibility/mac/alt-for-css-content-expected.txt:
        * accessibility/mac/webkit-alt-for-css-content-expected.txt:
        * editing/pasteboard/cjk-line-height-expected.txt:
        * fast/css/alt-inherit-initial-expected.txt:
        * fast/css/alt-inherit-initial.html:
        * fast/css/content-language-comma-separated-list-expected.txt:
        * fast/css/content-language-empty-expected.txt:
        * fast/css/content-language-only-whitespace-expected.txt:
        * fast/css/content-language-with-whitespace-expected.txt:
        * fast/css/counters/counter-cssText-expected.txt:
        * fast/css/counters/counter-cssText.html:
        * fast/css/font-family-trailing-bracket-gunk-expected.txt:
        * fast/css/font-family-trailing-bracket-gunk.html:
        * fast/css/getComputedStyle/computed-style-font-family-expected.txt:
        * fast/css/getComputedStyle/computed-style-properties-expected.txt:
        * fast/css/getComputedStyle/computed-style-properties.html:
        * fast/css/getComputedStyle/font-family-fallback-reset-expected.txt:
        * fast/css/getComputedStyle/font-family-fallback-reset.html:
        * fast/css/lang-mapped-to-webkit-locale-expected.txt:
        * fast/css/lang-mapped-to-webkit-locale.xhtml:
        * fast/css/serialization-with-double-quotes-expected.txt: Added.
        * fast/css/serialization-with-double-quotes.html: Added.
        * fast/css/uri-token-parsing-expected.txt:
        * fast/css/uri-token-parsing.html:
        * fast/inspector-support/cssURLQuotes-expected.txt:
        * fast/inspector-support/style-expected.txt:
        * fast/text/font-stretch-parse-expected.txt:
        * fast/text/font-stretch-parse.html:
        * fast/text/font-style-parse-expected.txt:
        * fast/text/font-style-parse.html:
        * fast/text/font-weight-parse-expected.txt:
        * fast/text/font-weight-parse.html:
        * media/controls/track-menu.html:
        * platform/mac-elcapitan/fast/css/getComputedStyle/computed-style-font-family-expected.txt:
        * platform/mac-elcapitan/fast/text/font-stretch-parse-expected.txt:
        * platform/mac-elcapitan/fast/text/font-style-parse-expected.txt:
        * platform/mac-elcapitan/fast/text/font-weight-parse-expected.txt:

2017-06-16  Per Arne Vollan  <pvollan@apple.com>

        [Win] Update expectations for layout tests.
        https://bugs.webkit.org/show_bug.cgi?id=172437

        Unreviewed test gardening, update test expectations for failing tests.

        * platform/win/TestExpectations:

2017-06-16  Per Arne Vollan  <pvollan@apple.com>

        Unreviewed test gardening. Update test expectations for failing tests.

        * platform/win/TestExpectations:

2017-06-16  Matt Baker  <mattbaker@apple.com>

        Web Inspector: Instrument 2D/WebGL canvas contexts in the backend
        https://bugs.webkit.org/show_bug.cgi?id=172623
        <rdar://problem/32415986>

        Reviewed by Devin Rousso and Joseph Pecoraro.

        Test that CanvasAgent dispatches events for canvas lifecycle events.

        * inspector/canvas/create-canvas-contexts-expected.txt: Added.
        * inspector/canvas/create-canvas-contexts.html: Added.

2017-06-16  Sam Weinig  <sam@webkit.org>

        [WebIDL] Remove custom bindings for HTMLDocument
        https://bugs.webkit.org/show_bug.cgi?id=173444

        Reviewed by Darin Adler.

        * dom/xhtml/level2/html/HTMLDocument17-expected.txt:
        * dom/xhtml/level2/html/HTMLDocument18-expected.txt:
        * dom/xhtml/level2/html/HTMLDocument19-expected.txt:
        * dom/xhtml/level2/html/HTMLDocument20-expected.txt:
        * dom/xhtml/level2/html/HTMLDocument21-expected.txt:
        Update test results for correct exception being thrown.

        * fast/dom/frame-deleted-in-document-open-expected.txt: Removed.
        * fast/dom/frame-deleted-in-document-open.html: Removed.
        * http/tests/security/isolatedWorld/document-open-expected.txt: Removed.
        * http/tests/security/isolatedWorld/document-open.html: Removed.
        Remove two tests that were testing the behavior of document.open using javascript
        to call the window.open operation. This is not how it is specified and no
        longer how it is implemented.

2017-06-16  Youenn Fablet  <youenn@apple.com>

        WebRTC sockets should be closed at destruction time if not closed explicitly
        https://bugs.webkit.org/show_bug.cgi?id=173479

        Reviewed by Eric Carlson.

        * webrtc/datachannel/multiple-connections-expected.txt: Added.
        * webrtc/datachannel/multiple-connections.html: Added.

2017-06-16  Youenn Fablet  <youenn@apple.com>

        addTransceiver should trigger mid generation in the SDP
        https://bugs.webkit.org/show_bug.cgi?id=173452

        Reviewed by Alex Christensen.

        * webrtc/routines.js:
        (createConnections):
        * webrtc/video-addTransceiver-expected.txt: Added.
        * webrtc/video-addTransceiver.html: Added.

2017-06-16  Jonathan Bedard  <jbedard@apple.com>

        Clean-up lint-test-expectation errors

        Unreviewed test gardening

        * platform/ios-wk1/TestExpectations:
        * platform/ios-wk2/TestExpectations:
        * platform/win/TestExpectations:

2017-06-16  Youenn Fablet  <youenn@apple.com>

        [iOS] Switching cameras in a WebRTC call makes black frames being sent
        https://bugs.webkit.org/show_bug.cgi?id=173486

        Reviewed by Eric Carlson.

        * webrtc/video-replace-muted-track-expected.txt: Added.
        * webrtc/video-replace-muted-track.html: Added.

2017-06-16  Ryan Haddad  <ryanhaddad@apple.com>

        Remove a test that was accidentally checked in with r218408.

        Unreviewed test gardening.

        * webrtc/datachannel/test.html: Removed.

2017-06-16  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/web-platform-tests/IndexedDB/large-nested-cloning.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=173487

        Unreviewed test gardening.


        * platform/mac/TestExpectations:

2017-06-16  Youenn Fablet  <youenn@apple.com>

        Remove replaceTrack restriction about video resolution
        https://bugs.webkit.org/show_bug.cgi?id=173490

        Reviewed by Eric Carlson.

        * webrtc/video-replace-track-expected.txt:
        * webrtc/video-replace-track.html:

2017-06-16  Matt Lewis  <jlewis3@apple.com>

        Marked multiple imported/w3c/web-platform-tests/IndexedDB as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172834

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-06-16  Jer Noble  <jer.noble@apple.com>

        [iOS] Do not pause playing video when application resigns active state.
        https://bugs.webkit.org/show_bug.cgi?id=173474

        Reviewed by Tim Horton.

        * media/video-background-playback-expected.txt:
        * media/video-background-playback.html:
        * media/video-background-tab-playback-expected.txt:
        * media/video-background-tab-playback.html:
        * media/video-inactive-playback-expected.txt: Added.
        * media/video-inactive-playback.html: Added.

2017-06-16  Alex Christensen  <achristensen@webkit.org>

        REGRESSION (r213126): Sync XHR needs partition for cache and credentials
        https://bugs.webkit.org/show_bug.cgi?id=173496
        <rdar://problem/31943596>

        Reviewed by Darin Adler.

        * http/tests/security/sync-xhr-partition-expected.txt: Added.
        * http/tests/security/sync-xhr-partition.html: Added.

2017-06-16  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/web-platform-tests/fetch/nosniff/importscripts.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=173432
        
        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-06-16  Matt Lewis  <jlewis3@apple.com>

        Adjusted test expectations for media/track/track-in-band-cues-added-once.html.
        https://bugs.webkit.org/show_bug.cgi?id=142152

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-16  Youenn Fablet  <youenn@apple.com>

        Make some WebRTC tests easier to debug when failing
        https://bugs.webkit.org/show_bug.cgi?id=173480

        Reviewed by Eric Carlson.

        * webrtc/captureCanvas-webrtc-expected.txt:
        * webrtc/captureCanvas-webrtc.html: Splitting test in smaller tests.
        * webrtc/datachannel/basic-expected.txt:
        * webrtc/datachannel/basic-tcp-expected.txt: Added.
        * webrtc/datachannel/basic-tcp.html: Test from basic.html
        * webrtc/datachannel/basic.html: Moving TCP specifict test and other creation tests to their own files.
        * webrtc/datachannel/bufferedAmountLowThreshold.html: Removing console log message in case of unhandled promise.
        * webrtc/datachannel/creation-expected.txt:
        * webrtc/datachannel/creation.html: Test from basic.html
        * webrtc/datachannel/filter-ice-candidate-expected.txt:
        * webrtc/datachannel/filter-ice-candidate.html: Exchanging the tests.
        * webrtc/video-stats.html: Improving test that timestamp is milliseconds and not microseconds.

2017-06-16  Antoine Quint  <graouts@apple.com>

        REGRESSION: AirPlay placard is not shown when in fullscreen
        https://bugs.webkit.org/show_bug.cgi?id=173447
        <rdar://problem/32803773>

        Reviewed by Jon Lee.

        Add a new test to check that we display the AirPlay placard on macOS in fullscreen.

        * media/modern-media-controls/placard-support/placard-support-airplay-fullscreen-expected.txt: Added.
        * media/modern-media-controls/placard-support/placard-support-airplay-fullscreen.html: Added.
        * platform/ios-simulator/TestExpectations:

2017-06-16  Antoine Quint  <graouts@apple.com>

        Backdrop blur missing in media controls bar on Sierra
        https://bugs.webkit.org/show_bug.cgi?id=173451

        Reviewed by Simon Fraser.

        Add a new test that checks that a ControlsBar establishes a stacking context.

        * media/modern-media-controls/controls-bar/controls-bar-stacking-context-expected.txt: Added.
        * media/modern-media-controls/controls-bar/controls-bar-stacking-context.html: Added.
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-16  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r218376.

        The patch cause multiple Layout Test Crashes.

        Reverted changeset:

        "Web Inspector: Instrument 2D/WebGL canvas contexts in the
        backend"
        https://bugs.webkit.org/show_bug.cgi?id=172623
        http://trac.webkit.org/changeset/218376

2017-06-16  Fujii Hironori  <Hironori.Fujii@sony.com>

        [GTK] Layout Test fast/events/tabindex-focus-blur-all.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=145171

        Unreviewed gardening.

        Recently, this test case results in flaky crash, no flaky timeout.

        * platform/gtk/TestExpectations: Marked it Crash Pass.

2017-06-16  Adrian Perez de Castro  <aperez@igalia.com>

        REGRESSION(r215188?): Test platform/gtk/fast/forms/menulist-typeahead-find.html is failing
        https://bugs.webkit.org/show_bug.cgi?id=171492

        Unreviewed gardening.

        * platform/gtk/TestExpectations: The fixes needed for the test to pass
        have landed, so the test can be unskipped.

2017-06-16  Fujii Hironori  <Hironori.Fujii@sony.com>

        [GTK] Layout Test fast/canvas/webgl/tex-image-and-sub-image-2d-with-video.html makes the subsequent test case flaky crash.
        https://bugs.webkit.org/show_bug.cgi?id=173459

        Unreviewed gardening.

        * platform/gtk/TestExpectations: Marked it Skip.

2017-06-16  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] fast/animation gardening

        Unreviewed gardening.

        fast/animation tests are flaky, report and mark.
        fast/animation/height-auto-transition-computed-value.html is not really failing, unmark.
        storage/domstorage/sessionstorage/set-item-synchronous-keydown.html
        depends on event injection in WTR that is not implemented in WPE
        yet, reported and marked as failing.
        * platform/wpe/TestExpectations:

2017-06-15  Per Arne Vollan  <pvollan@apple.com>

        [Win] Update expectations for layout tests.
        https://bugs.webkit.org/show_bug.cgi?id=172437

        Unreviewed test gardening, update test expectations for failing tests.

        * platform/win/TestExpectations:

2017-06-15  Antoine Quint  <graouts@apple.com>

        REGRESSION: AirPlay button is incorrectly highlighted in inline and fullscreen
        https://bugs.webkit.org/show_bug.cgi?id=173446

        Reviewed by Dean Jackson.

        Update the test to explicitly check the color on the <picture>. We also make the test check
        the color with a value depending on the platform, so we can use a single expectation file.

        * media/modern-media-controls/airplay-button/airplay-button-on-expected.txt:
        * media/modern-media-controls/airplay-button/airplay-button-on.html:
        * platform/ios/media/modern-media-controls/airplay-button/airplay-button-on-expected.txt: Removed.

2017-06-15  Matt Baker  <mattbaker@apple.com>

        Web Inspector: Instrument 2D/WebGL canvas contexts in the backend
        https://bugs.webkit.org/show_bug.cgi?id=172623
        <rdar://problem/32415986>

        Reviewed by Devin Rousso.

        Test that CanvasAgent dispatches events for canvas lifecycle events.

        * inspector/canvas/create-canvas-contexts-expected.txt: Added.
        * inspector/canvas/create-canvas-contexts.html: Added.

2017-06-15  Myles C. Maxfield  <mmaxfield@apple.com>

        [Cocoa] Expand system-ui to include every item in the Core Text cascade list
        https://bugs.webkit.org/show_bug.cgi?id=173043
        <rdar://problem/21125708>

        Reviewed by Simon Fraser.

        * fast/text/system-font-fallback-emoji-expected.txt: Added.
        * fast/text/system-font-fallback-emoji.html: Added.
        * fast/text/system-font-fallback-expected.html: Added.
        * fast/text/system-font-fallback.html: Added.
        * fast/text/system-font-zero-size-expected.txt: Added.
        * fast/text/system-font-zero-size.html: Added.
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:
        * platform/mac/fast/text/international/system-language/system-font-punctuation-expected.png: Added.

2017-06-15  Matt Lewis  <jlewis3@apple.com>

        Marked webrtc/video-unmute.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172879

        Unreviewed test gardening.

        * platform/ios-simulator-wk2/TestExpectations:

2017-06-15  Saam Barati  <sbarati@apple.com>

        [iOS wk2] Layout Test perf/object-keys.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=171617
        <rdar://problem/31977874>

        Reviewed by Mark Lam.

        Increase the starting magnitude of the object-keys test to
        remove variance from having objects with a very few number of keys.

        * perf/object-keys.html:
        * platform/ios-wk2/TestExpectations:

2017-06-15  Matt Lewis  <jlewis3@apple.com>

        Marked webrtc/datachannel/basic.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172922

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:
        * platform/wk2/TestExpectations:

2017-06-15  Matt Lewis  <jlewis3@apple.com>

        REGRESSION (r218228): Layout Test editing/execCommand/strikethrough-uses-strike-tag.html is failing
        https://bugs.webkit.org/show_bug.cgi?id=173375

        Unreviewed test gardening.

        Reverted an incorrect baseline and skipped a test causing test failures.

        * TestExpectations:
        * platform/mac-wk1/editing/execCommand/strikethrough-uses-strike-tag-expected.txt: Removed.
        * platform/win/editing/execCommand/strikethrough-uses-strike-tag-expected.txt: Removed.

2017-06-15  Youenn Fablet  <youenn@apple.com>

        RTCPeerConnection returns RTCSessionDescription where RTCSessionDescriptionInit would be appropriate
        https://bugs.webkit.org/show_bug.cgi?id=173118
        <rdar://problem/32746761>

        Reviewed by Eric Carlson.

        * fast/mediastream/RTCPeerConnection-setLocalDescription-offer-expected.txt:
        * fast/mediastream/RTCPeerConnection-setRemoteDescription-offer-expected.txt:
        * webrtc/createOfferAnswer-expected.txt: Added.
        * webrtc/createOfferAnswer.html: Added.

2017-06-15  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/web-platform-tests/dom/nodes/Document-constructor-svg.svg as skip.
        https://bugs.webkit.org/show_bug.cgi?id=173333

        Unreviewed test gardening.

        * TestExpectations:

2017-06-15  Miguel Gomez  <magomez@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of several tests failing after r218320.

        * platform/gtk/TestExpectations:

2017-06-15  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] dom storage gardening

        Unreviewed gardening.

        Two dom storage tests marked as failing have been passing always,
        so remove them.
        * platform/wpe/TestExpectations:

2017-06-14  Alexey Proskuryakov  <ap@apple.com>

        REGRESSION: trac.webkit.org/export returns Content-Type application/xhtml+xml for .html files
        https://bugs.webkit.org/show_bug.cgi?id=173191

        Add a MIME type to one test to check if this changes the behavior.

        * http/tests/security/contentSecurityPolicy/allow-favicon.html: Added property svn:mime-type.

2017-06-14  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/media-documents
        https://bugs.webkit.org/show_bug.cgi?id=173394

        Reviewed by Dean Jackson.

        * media/modern-media-controls/media-documents/click-on-video-should-not-pause-expected.txt:
        * media/modern-media-controls/media-documents/click-on-video-should-not-pause.html:
        * media/modern-media-controls/media-documents/media-document-audio-mac-sizing-expected.txt:
        * media/modern-media-controls/media-documents/media-document-audio-mac-sizing.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-14  Dean Jackson  <dino@apple.com>

        Restrict filtered painting across cross-origin boundaries with transforms
        https://bugs.webkit.org/show_bug.cgi?id=173388
        <rdar://problem/27362159>

        Reviewed by Simon Fraser.

        New test that checks painting across a origin boundary when in
        a transformed container. Also clean up the existing test
        to make it smfr-compliant (green is good, red is bad).

        * http/tests/css/filters-on-iframes-expected.html:
        * http/tests/css/filters-on-iframes-transform-expected.html: Added.
        * http/tests/css/filters-on-iframes-transform.html: Added.
        * http/tests/css/filters-on-iframes.html:
        * http/tests/css/resources/references-external-green.html: Copied from LayoutTests/http/tests/css/resources/references-external.html.
        * http/tests/css/resources/references-external-red.html: Renamed from LayoutTests/http/tests/css/resources/references-external.html.
        * http/tests/css/resources/solid-green.html: Added.

2017-06-14  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r218161.

        Introduced bot API test failures and Layout Test Failures.

        Reverted changeset:

        "[Cocoa] Expand system-ui to include every item in the Core
        Text cascade list"
        https://bugs.webkit.org/show_bug.cgi?id=173043
        http://trac.webkit.org/changeset/218161

2017-06-14  Zalan Bujtas  <zalan@apple.com>

        Crash in WebCore::RenderStyle::colorIncludingFallback.
        https://bugs.webkit.org/show_bug.cgi?id=173347
        <rdar://problem/32675317>

        Reviewed by Chris Dumez.

        * svg/animations/animated-svg-image-removed-from-document-paused.html: animations are not started synchronously anymore.
        * svg/as-image/svg-css-animation-expected.txt: Added.
        * svg/as-image/svg-css-animation.html: Added.

2017-06-14  Matt Lewis  <jlewis3@apple.com>

        Fixed typo error for re-baselined editing/execCommand/strikethrough-uses-strike-tag.html.
        https://bugs.webkit.org/show_bug.cgi?id=173375
        

        Unreviewed test gardening.

        * platform/mac-wk1/editing/execCommand/strikethrough-uses-strike-tag-expected.txt: Renamed from LayoutTests/platform/mac-wk1/editing/exeCommand/strikethrough-uses-strike-tag-expected.txt.
        * platform/win/editing/execCommand/strikethrough-uses-strike-tag-expected.txt: Renamed from LayoutTests/platform/win/editing/exeCommand/strikethrough-uses-strike-tag-expected.txt.

2017-06-14  Chris Dumez  <cdumez@apple.com>

        transitions/created-while-suspended.html is slow and flaky
        https://bugs.webkit.org/show_bug.cgi?id=173370

        Reviewed by Zalan Bujtas.

        The test was waiting 8 seconds at the end, unnecessarily.
        Instead, end the test as soon as the transition ends, after resuming
        the animations.

        * TestExpectations:
        * platform/gtk/TestExpectations:
        * platform/wpe/TestExpectations:
        * transitions/created-while-suspended-expected.txt:
        * transitions/created-while-suspended.html:

2017-06-14  Antoine Quint  <graouts@apple.com>

        Layout Test media/modern-media-controls/placard-support/placard-support-pip.html is failing
        https://bugs.webkit.org/show_bug.cgi?id=173373

        Reviewed by Antoine Quint.

        * platform/mac/TestExpectations:

2017-06-14  Matt Lewis  <jlewis3@apple.com>

        Rebaselined editing/execCommand/strikethrough-uses-strike-tag.html.
        https://bugs.webkit.org/show_bug.cgi?id=173375
        

        Unreviewed test gardening.

        * platform/mac-wk1/editing/exeCommand/strikethrough-uses-strike-tag-expected.txt: Added.
        * platform/win/editing/exeCommand/strikethrough-uses-strike-tag-expected.txt: Added.

2017-06-14  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r218157.

        This patch caused multiple API failures on iOS Simulator.

        Reverted changeset:

        "@font-face rules with invalid primary fonts never download
        their secondary fonts"
        https://bugs.webkit.org/show_bug.cgi?id=173138
        http://trac.webkit.org/changeset/218157

2017-06-14  Chris Dumez  <cdumez@apple.com>

        REGRESSION (r217997): mint.com header renders incorrectly when initially loaded
        https://bugs.webkit.org/show_bug.cgi?id=173302
        <rdar://problem/32731747>

        Reviewed by Darin Adler.

        Add layout test coverage. We change the style of the animated element while the animation is paused,
        and then we resume the animations.

        * fast/animation/css-animation-resuming-when-visible-with-style-change-expected.txt: Added.
        * fast/animation/css-animation-resuming-when-visible-with-style-change.html: Added.
        * fast/animation/css-animation-resuming-when-visible-with-style-change2-expected.txt: Added.
        * fast/animation/css-animation-resuming-when-visible-with-style-change2.html: Added.

2017-06-14  Per Arne Vollan  <pvollan@apple.com>

        [Win] Update expectations for layout tests.
        https://bugs.webkit.org/show_bug.cgi?id=172437

        Unreviewed test gardening, update test expectations for failing tests.

        * platform/win/TestExpectations:

2017-06-14  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] IndexedDB gardening

        Unreviewed gardening.

        Mark a few expected crashers. We don't use IndexedDB in workers,
        storage/indexeddb/modern/worker-getall.html is expected to fail.
        storage/indexeddb/modern/idbkey-array-equality.html is now passing.

        * platform/wpe/TestExpectations:

2017-06-14  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Rebaseline imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-requestmediakeysystemaccess.html

        Unreviewed gardening.

        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-requestmediakeysystemaccess-expected.txt:

2017-06-14  Nael Ouedraogo  <nael.ouedraogo@crf.canon.fr>

        MediaSource duration attribute should not be equal to Infinity when set to a value greater than 2^64
        https://bugs.webkit.org/show_bug.cgi?id=171668

        Reviewed by Jer Noble.

        MediaSource duration attribute is a double represented in MediaSource by a MediaTime instance created with
        MediaTime::CreateWithDouble(). This method implements an overflow control mechanism which sets MediaTime to
        Infinity when the double value passed as argument is greater than 2^64.

        This patch removes the overflow control mechanism when time value is represented as a double. This patch also
        modifies the behavior of mathematical operations between a double MediaTime and rational MediaTime: the rational
        MediaTime is converted to a double before applying the operation. Double MediaTime precision is the same as for
        double. Overflow mechanisms still apply to the conversion of a double MediaTime to rational with setTimescale()
        method. No behavior change for rational MediaTime.

        Update test expectations.

        * media/media-source/media-source-timeoffset-expected.txt:
        * platform/gtk/imported/w3c/web-platform-tests/media-source/mediasource-duration-boundaryconditions-expected.txt:
        * platform/mac-elcapitan/imported/w3c/web-platform-tests/media-source/mediasource-duration-boundaryconditions-expected.txt:

2017-06-13  Chris Dumez  <cdumez@apple.com>

        Event handlers should not be called in frameless documents
        https://bugs.webkit.org/show_bug.cgi?id=173233

        Reviewed by Sam Weinig.

        Extend layout test coverage.

        * fast/events/event-handler-detached-document-dispatchEvent-expected.txt: Added.
        * fast/events/event-handler-detached-document-dispatchEvent.html: Added.
        * fast/events/event-handler-detached-document-expected.txt: Added.
        * fast/events/event-handler-detached-document.html: Added.

2017-06-13  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/placard-support
        https://bugs.webkit.org/show_bug.cgi?id=173340

        Reviewed by Dean Jackson.

        We update tests to use the new "placard" property rather than "showsPlacard" which this patch removes.

        * media/modern-media-controls/placard-support/placard-support-airplay-expected.txt:
        * media/modern-media-controls/placard-support/placard-support-airplay.html:
        * media/modern-media-controls/placard-support/placard-support-error-expected.txt:
        * media/modern-media-controls/placard-support/placard-support-error-recover-expected.txt:
        * media/modern-media-controls/placard-support/placard-support-error-recover.html:
        * media/modern-media-controls/placard-support/placard-support-error.html:
        * media/modern-media-controls/placard-support/placard-support-pip-expected.txt:
        * media/modern-media-controls/placard-support/placard-support-pip.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-13  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/mute-support
        https://bugs.webkit.org/show_bug.cgi?id=173345

        Reviewed by Dean Jackson.

        * media/modern-media-controls/mute-support/mute-support-press-on-button-expected.txt: Renamed from LayoutTests/media/modern-media-controls/mute-support/mute-support-button-click-expected.txt.
        * media/modern-media-controls/mute-support/mute-support-press-on-button.html: Renamed from LayoutTests/media/modern-media-controls/mute-support/mute-support-button-click.html.
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-13  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/tracks-button
        https://bugs.webkit.org/show_bug.cgi?id=173220

        Reviewed by Dean Jackson.

        Use SVG assets.

        * media/modern-media-controls/tracks-button/tracks-button-expected.txt:
        * media/modern-media-controls/tracks-button/tracks-button.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-13  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/time-control
        https://bugs.webkit.org/show_bug.cgi?id=173218

        Reviewed by Dean Jackson.

        There no longer is a Scrubber class and the useSixDigitsForTimeLabels property no longer exists.
 
        * media/modern-media-controls/time-control/time-control-expected.txt:
        * media/modern-media-controls/time-control/time-control-use-six-digits-for-time-labels-expected.txt: Removed.
        * media/modern-media-controls/time-control/time-control-use-six-digits-for-time-labels.html: Removed.
        * media/modern-media-controls/time-control/time-control.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-13  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/status-label
        https://bugs.webkit.org/show_bug.cgi?id=173217

        Reviewed by Dean Jackson.

        There is no need for macOS and iOS-specific tests, they share the same styles.

        * media/modern-media-controls/status-label/status-label-expected.txt:
        * media/modern-media-controls/status-label/status-label-in-controls-expected.txt: Renamed from LayoutTests/media/modern-media-controls/status-label/status-label-macos-expected.txt.
        * media/modern-media-controls/status-label/status-label-in-controls.html: Renamed from LayoutTests/media/modern-media-controls/status-label/status-label-macos.html.
        * media/modern-media-controls/status-label/status-label-ios-expected.txt: Removed.
        * media/modern-media-controls/status-label/status-label-ios.html: Removed.
        * media/modern-media-controls/status-label/status-label.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-13  Antoine Quint  <graouts@apple.com>

        Remove media/modern-media-controls/start-button
        https://bugs.webkit.org/show_bug.cgi?id=173216

        Reviewed by Dean Jackson.

        The StartButton class was removed.

        * media/modern-media-controls/start-button/start-button-expected.txt: Removed.
        * media/modern-media-controls/start-button/start-button-styles-expected.txt: Removed.
        * media/modern-media-controls/start-button/start-button-styles.html: Removed.
        * media/modern-media-controls/start-button/start-button.html: Removed.

2017-06-13  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/slider
        https://bugs.webkit.org/show_bug.cgi?id=173215

        Reviewed by Dean Jackson.

        * media/modern-media-controls/slider/slider-constructor-expected.txt:
        * media/modern-media-controls/slider/slider-constructor.html:
        * media/modern-media-controls/slider/slider-styles-expected.txt:
        * media/modern-media-controls/slider/slider-styles.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-13  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/skip-back-button
        https://bugs.webkit.org/show_bug.cgi?id=173213

        Reviewed by Dean Jackson.

        Use SVG assets.

        * media/modern-media-controls/skip-back-button/skip-back-button-expected.txt:
        * media/modern-media-controls/skip-back-button/skip-back-button.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-11  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/time-label
        https://bugs.webkit.org/show_bug.cgi?id=173219

        Reviewed by Dean Jackson.

        We update the content of the time-label.html test to be relevant to its new API.

        * media/modern-media-controls/time-label/time-label-expected.txt:
        * media/modern-media-controls/time-label/time-label.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-11  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/fullscreen-support
        https://bugs.webkit.org/show_bug.cgi?id=173199

        Reviewed by Simon Fraser.

        We no longer need to test the "error" event for FullscreenSupport since we don't actually
        enable or disable the fullscreen button when an error happens, instead the media controls
        code will simply not present it since we'll be showing a placard instead.
        
        We also remove the iPad-specific test since the fullscreen button is now accessible on an
        iPhone as well, so it no longer needs a special iPad test.

        * media/modern-media-controls/fullscreen-support/fullscreen-support-enabled-expected.txt:
        * media/modern-media-controls/fullscreen-support/fullscreen-support-enabled.html:
        * media/modern-media-controls/fullscreen-support/fullscreen-support-press-expected.txt: Renamed from LayoutTests/media/modern-media-controls/fullscreen-support/fullscreen-support-click-expected.txt.
        * media/modern-media-controls/fullscreen-support/fullscreen-support-press.html: Renamed from LayoutTests/media/modern-media-controls/fullscreen-support/fullscreen-support-click.html.
        * media/modern-media-controls/fullscreen-support/ipad/fullscreen-support-tap-expected.txt: Removed.
        * media/modern-media-controls/fullscreen-support/ipad/fullscreen-support-tap.html: Removed.
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-13  Carlos Alberto Lopez Perez  <clopez@igalia.com>

        [GTK] Fix linter warnings on the GTK Debug TestExpectation file and update some expectations for Debug.

        Unreviewed test gardening.

        * TestExpectations: Merge expectations for imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/pbkdf2.worker.html
        * platform/gtk/TestExpectations: Mark observed timeouts on Debug and fix linter warnings related to tests renamed or deleted.
        * platform/gtk/imported/w3c/web-platform-tests/fetch/api/basic/request-headers-expected.txt: Removed.
        * platform/gtk/imported/w3c/web-platform-tests/fetch/api/basic/request-headers-worker-expected.txt: Removed.

2017-06-13  Zalan Bujtas  <zalan@apple.com>

        Synchronous media query callbacks on nested frames could produced a detached FrameView.
        https://bugs.webkit.org/show_bug.cgi?id=173330

        Reviewed by Simon Fraser.

        * TestExpectations: ASSERT(frame()->view() == this) still fires due to the unexpected navigation, but we clearly
        manage to recover from it. Unskip it (debug) when webkit.org/b/173329 is resolved.

2017-06-13  Chris Fleizach  <cfleizach@apple.com>

        AX[macOS]: Expose Inline property as an accessibility attribute
        https://bugs.webkit.org/show_bug.cgi?id=173131
        <rdar://problem/32667686>

        Reviewed by Joanmarie Diggs.

        * accessibility/mac/inline-text-attribute.html: Added.
        * accessibility/mac/inline-text-attribute-expected.txt: Added.

2017-06-13  Joseph Pecoraro  <pecoraro@apple.com>

        Debugger has unexpected effect on program correctness
        https://bugs.webkit.org/show_bug.cgi?id=172683

        Reviewed by Saam Barati.

        * inspector/injected-script/observable-expected.txt: Added.
        * inspector/injected-script/observable.html: Added.

2017-06-13  Matt Lewis  <jlewis3@apple.com>

        Updated test expectations for imported/w3c/web-platform-tests/dom/nodes/Document-constructor-svg.svg.
        https://bugs.webkit.org/show_bug.cgi?id=173333

        Unreviewed test gardening.

        * TestExpectations:

2017-06-13  Matt Lewis  <jlewis3@apple.com>

        Re-baselined imported/w3c/web-platform-tests/WebCryptoAPI/import_export/test_rsa_importKey.https.html and fixed text expectations.
        https://bugs.webkit.org/show_bug.cgi?id=173335

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-06-13  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/web-platform-tests/WebCryptoAPI/import_export/test_rsa_importKey.https.html as failing.
        https://bugs.webkit.org/show_bug.cgi?id=173335

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-06-13  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/web-platform-tests/dom/nodes/Document-constructor-svg.svg as a timeout.
        https://bugs.webkit.org/show_bug.cgi?id=173333

        Unreviewed test gardening.

        * TestExpectations:

2017-06-13  Daniel Bates  <dabates@apple.com>

        Implement W3C Secure Contexts Draft Specification
        https://bugs.webkit.org/show_bug.cgi?id=158121
        <rdar://problem/26012994>

        Reviewed by Brent Fulgham.

        Part 4

        Adds a test to ensure that the global object property isSecureContext is not
        exposed (is undefined) when the runtime enabled feature flag isSecureContextAttributeEnabled
        is disabled.

        * platform/win/TestExpectations: Skip the test as DumpRenderTree on Windows does not support
        parsing of test options. See <https://bugs.webkit.org/show_bug.cgi?id=173281> for more details.
        * security/isSecureContext-disabled-expected.txt: Added.
        * security/isSecureContext-disabled.html: Added.
        * security/resources/worker-isSecureContext-disabled.js: Added.

2017-06-13  Youenn Fablet  <youenn@apple.com>

        getReceivers() should return transceivers that have only an active receiver
        https://bugs.webkit.org/show_bug.cgi?id=173313

        Reviewed by Alex Christensen.

        * fast/mediastream/RTCPeerConnection-addTrack-reuse-sender-expected.txt:
        * webrtc/video-receivers-expected.txt: Added.
        * webrtc/video-receivers.html: Added.

2017-06-13  Youenn Fablet  <youenn@apple.com>

        Refresh WPT tests up to cb7017e654fb4daddb9dee8d654c78b26e61fa9f
        https://bugs.webkit.org/show_bug.cgi?id=173260

        Reviewed by Alex Christensen.

        * TestExpectations:
        * platform/ios-simulator-wk2/TestExpectations:
        * platform/mac-wk1/imported/w3c/web-platform-tests/WebCryptoAPI/wrapKey_unwrapKey/test_wrapKey_unwrapKey.https-expected.txt: Added.
        * platform/mac/imported/w3c/web-platform-tests/html/webappapis/system-state-and-capabilities/the-navigator-object/NavigatorID.worker-expected.png: Added.
        * tests-options.json:

2017-06-13  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: [ATK] Implement missing AtkRelation types
        https://bugs.webkit.org/show_bug.cgi?id=155494

        Reviewed by Darin Adler.

        * accessibility/aria-owns-expected.txt: Renamed from LayoutTests/accessibility/mac/aria-owns-expected.txt.
        * accessibility/aria-owns.html: Renamed from LayoutTests/accessibility/mac/aria-owns.html.
        * accessibility/gtk/relation-types-expected.txt: Added.
        * accessibility/gtk/relation-types.html: Added.

2017-06-13  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Ensure that fast/url/user-visible tests are skipped

        Unreviewed gardening.

        Tests under this directory are currently Mac specific, so skip the
        directory altogether.
        * platform/wpe/TestExpectations:

2017-06-13  Youenn Fablet  <youenn@apple.com>

        Filter SDP from ICE candidates in case of local ICE candidate filtering
        https://bugs.webkit.org/show_bug.cgi?id=173120

        Reviewed by Eric Carlson.

        * webrtc/datachannel/filter-ice-candidate.html: Minor clean-up and
        adding assertions to ensure that ICE candidates are also filtered out.

2017-06-12  Charlie Turner  <cturner@igalia.com>

        [GTK] skip fast/scrolling/scrolling-tree-includes-frame.html
        https://bugs.webkit.org/show_bug.cgi?id=173258

        Unreviewed gardening.

        GTK doesn't appear to use the scrolling tree, only WK2 Mac and iOS do. Skip it here.

        * platform/gtk/TestExpectations:

2017-06-12  Myles C. Maxfield  <mmaxfield@apple.com>

        [Cocoa] Expand system-ui to include every item in the Core Text cascade list
        https://bugs.webkit.org/show_bug.cgi?id=173043
        <rdar://problem/21125708>

        Reviewed by Simon Fraser.

        Rebaseline tests which use non-English text in form controls

        * fast/text/system-font-fallback-emoji-expected.txt: Added.
        * fast/text/system-font-fallback-emoji.html: Added.
        * fast/text/system-font-fallback-expected.html: Added.
        * fast/text/system-font-fallback.html: Added.
        * platform/mac-elcapitan/fast/forms/listbox-bidi-align-expected.png: Added.
        * platform/mac-elcapitan/fast/forms/listbox-bidi-align-expected.txt:
        * platform/mac-elcapitan/fast/forms/search-rtl-expected.png: Added.
        * platform/mac-elcapitan/fast/forms/search-rtl-expected.txt:
        * platform/mac-elcapitan/fast/forms/searchfield-heights-expected.png: Added.
        * platform/mac-elcapitan/fast/forms/searchfield-heights-expected.txt:
        * platform/mac-elcapitan/fast/forms/visual-hebrew-text-field-expected.txt:
        * platform/mac-elcapitan/fast/text/drawBidiText-expected.png: Added.
        * platform/mac-elcapitan/fast/text/drawBidiText-expected.txt:
        * platform/mac-elcapitan/fast/text/international/pop-up-button-text-alignment-and-direction-expected.png: Added.
        * platform/mac-elcapitan/fast/text/international/pop-up-button-text-alignment-and-direction-expected.txt:
        * platform/mac/TestExpectations:
        * platform/mac/fast/css/rtl-ordering-expected.png:
        * platform/mac/fast/css/rtl-ordering-expected.txt:
        * platform/mac/fast/forms/listbox-bidi-align-expected.png:
        * platform/mac/fast/forms/listbox-bidi-align-expected.txt:
        * platform/mac/fast/forms/listbox-hit-test-zoomed-expected.png:
        * platform/mac/fast/forms/listbox-hit-test-zoomed-expected.txt:
        * platform/mac/fast/forms/search-rtl-expected.png:
        * platform/mac/fast/forms/search-rtl-expected.txt:
        * platform/mac/fast/forms/searchfield-heights-expected.txt:
        * platform/mac/fast/forms/select-visual-hebrew-expected.png:
        * platform/mac/fast/forms/select-visual-hebrew-expected.txt:
        * platform/mac/fast/forms/visual-hebrew-text-field-expected.png:
        * platform/mac/fast/forms/visual-hebrew-text-field-expected.txt:
        * platform/mac/fast/text/drawBidiText-expected.png:
        * platform/mac/fast/text/drawBidiText-expected.txt:
        * platform/mac/fast/text/international/pop-up-button-text-alignment-and-direction-expected.png:
        * platform/mac/fast/text/international/pop-up-button-text-alignment-and-direction-expected.txt:
        * platform/mac/fast/text/updateNewFont-expected.png:
        * platform/mac/fast/text/updateNewFont-expected.txt:

2017-06-12  Myles C. Maxfield  <mmaxfield@apple.com>

        @font-face rules with invalid primary fonts never download their secondary fonts
        https://bugs.webkit.org/show_bug.cgi?id=173138
        <rdar://problem/32554450>

        Reviewed by Simon Fraser.

        * fast/text/font-fallback-invalid-load-expected.html: Added.
        * fast/text/font-fallback-invalid-load.html: Added.
        * fast/text/resources/bogus.svg: Added.

2017-06-12  Daniel Bates  <dabates@apple.com>

        Implement W3C Secure Contexts Draft Specification
        https://bugs.webkit.org/show_bug.cgi?id=158121
        <rdar://problem/26012994>

        Reviewed by Ryosuke Niwa.

        Part 3

        Skip tests that exercise Shared Workers as WebKit does not support them. With the exception
        of web-platform-tests/secure-contexts/basic-popup-and-iframe-tests.html all other tests are
        skipped because they time out. The following sub-tests in web-platform-tests/secure-contexts/basic-popup-and-iframe-tests.html
        are expected to fail:
            - "Test Window.isSecureContext for HTTP creator"
                Reason: Sub-test must be run from non-localhost server
            - "Test Window.isSecureContext in an iframe loading an http"
                Reason: Sub-test must be run from non-localhost server
            - "Test Window.isSecureContext in a sandboxed iframe loading an http"
                Reason: We do not implement the allow-secure-context flag
            - "Test Window.isSecureContext in a popup loading about:blank"
                Reason: Times out; further investigation needed.

        We will investigate the test failures and fix them in subsequent commits.

        * TestExpectations:

2017-06-12  Chris Dumez  <cdumez@apple.com>

        Add Arabic Kasra to list of blacklisted characters when puny-decoding URL
        https://bugs.webkit.org/show_bug.cgi?id=173283
        <rdar://problem/32725659>

        Reviewed by Brent Fulgham.

        Add layout test coverage.

        * fast/url/user-visible/arabic_kasra-expected.txt: Added.
        * fast/url/user-visible/arabic_kasra.html: Added.

2017-06-12  Aaron Chu  <aaron_chu@apple.com>

        AX: Video/Audio Player Controls missing group container.
        https://bugs.webkit.org/show_bug.cgi?id=171790
        <rdar://problem/32008994>

        Reviewed by Antoine Quint.

        Modified existing test cases to accommodate testing for controls bar aria-label.

        * media/modern-media-controls/audio/audio-controls-buttons-expected.txt:
        * media/modern-media-controls/audio/audio-controls-buttons.html:
        * media/modern-media-controls/ios-inline-media-controls/ios-inline-media-controls-constructor-expected.txt:
        * media/modern-media-controls/ios-inline-media-controls/ios-inline-media-controls-constructor.html:
        * media/modern-media-controls/macos-inline-media-controls/macos-inline-media-controls-constructor-expected.txt:
        * media/modern-media-controls/macos-inline-media-controls/macos-inline-media-controls-constructor.html:

2017-06-12  Jonathan Bedard  <jbedard@apple.com>

        Garden tests for on-device testing

        Unreviewed test gardening.

        The tests gardened here have not been investigated. https://bugs.webkit.org/show_bug.cgi?id=173275
        tracks the investigation of the tests marked as failing, crashing or skipped because they timeout
        when running layout tests on-device in this revision.

        * platform/ios-device/TestExpectations: Initial gardening of expectations for on-device testing.
        * platform/ios-simulator-wk2/TestExpectations: Moved simulator specific expectations from platfrom/ios-wk2.
        * platform/ios-simulator/TestExpectations: Moved simulator specific expectations from platfrom/ios.
        * platform/ios-simulator/compositing: Removed.
        * platform/ios-wk2/TestExpectations: Moved simulator specific expectation to platform/ios-simulator-wk2.
        * platform/ios/TestExpectations: Moved simulator specific expectation to platform/ios.
        * platform/ios/compositing/iframes/compositing-for-scrollable-iframe-expected.txt: Copied from
        LayoutTests/platform/ios-simulator/compositing/iframes/compositing-for-scrollable-iframe-expected.txt.

2017-06-12  Antoine Quint  <graouts@apple.com>

        Add tests for the SkipForwardButton class
        https://bugs.webkit.org/show_bug.cgi?id=173214

        Reviewed by Jon Lee.

        * media/modern-media-controls/skip-forward-button/skip-forward-button-expected.txt: Added.
        * media/modern-media-controls/skip-forward-button/skip-forward-button.html: Added.
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-12  Sam Weinig  <sam@webkit.org>

        [WebIDL] Re-implement GetOwnPropertySlot[ByIndex] generation to more closely follow WebIDL
        https://bugs.webkit.org/show_bug.cgi?id=173229

        Reviewed by Chris Dumez.

        * fast/dom/HTMLDocument/document-special-properties-expected.txt:
        Update results. Named properties on HTMLDocument no longer override own properties, they 
        only override properties from the prototype chain (as per the WebIDL specification for 
        OverrideBuiltins). These results now also match Firefox.

        * js/dom/dfg-prototype-chain-caching-with-impure-get-own-property-slot-traps-4.html:
        * js/dom/dfg-prototype-chain-caching-with-impure-get-own-property-slot-traps-5.html:
        * js/dom/prototype-chain-caching-with-impure-get-own-property-slot-traps-4.html:
        * js/dom/prototype-chain-caching-with-impure-get-own-property-slot-traps-5-short.html:
        * js/dom/prototype-chain-caching-with-impure-get-own-property-slot-traps-5.html:
        Update tests to use a property on the prototype, rather than the instance, to test 
        overriding the [GetOwnProperty] hook. This is needed now that HTMLDocument correctly
        follows the OverrideBuiltins rules as explained above.

2017-06-12  Saam Barati  <sbarati@apple.com>

        Unreviewed. Unmark test as flaky after fix in r217944. The test should now pass.

        * platform/mac/TestExpectations:

2017-06-12  Matt Lewis  <jlewis3@apple.com>

        Updated test expectations for fast/mediastream/getUserMedia-webaudio.html.
        https://bugs.webkit.org/show_bug.cgi?id=170960

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-06-12  Carlos Garcia Campos  <cgarcia@igalia.com>

        [GTK] Stop dismissing menus attached to the web view for every injected event
        https://bugs.webkit.org/show_bug.cgi?id=172708

        Reviewed by Alex Christensen.

        * editing/selection/5354455-1.html: No need to click on editable area to focus it, contextClick already focuses
        it, we even have another test to ensure it. Those fast clicks were causing a double click in GTK+ port which
        selected the whole line. We don't need to dismiss the context menu either, because contextClick() doesn't really
        show the menu.
        * fast/events/context-activated-by-key-event.html: Dismiss the context menu every time we show it.
        * fast/events/mouse-click-events.html: Dimiss the context menu when testing right click events.

2017-06-12  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/mediastream/getUserMedia-webaudio.html as flaky on mac-wk2.
        https://bugs.webkit.org/show_bug.cgi?id=170960

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-06-12  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/web-platform-tests/html/browsers/windows/browsing-context.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172255

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-06-12  Claudio Saavedra  <csaavedra@igalia.com>

        transforms/hittest-translated-content-off-to-infinity-and-back.html is passing

        Ureviewed gardening.
        * platform/wpe/TestExpectations: This started passing lately, remove.

2017-06-12  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE][GTK] Rebaseline js/dom/global-constructors-attributes.html

        Unreviewed gardening.

        Needs to be updated in WPE due to enabling ENCRYPTED_MEDIA. GTK+
        port was skipping this but it just needs an updated expectations.
        * platform/gtk/TestExpectations: Unskip.
        * platform/gtk/js/dom/global-constructors-attributes-expected.txt:
        * platform/wpe/js/dom/global-constructors-attributes-expected.txt:

2017-06-12  Charlie Turner  <cturner@igalia.com>

        Mark fast/mediastream/getUserMedia-grant-persistency3.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=173257

        Unreviewed gardening.

        * platform/gtk/TestExpectations:

2017-06-11  Myles C. Maxfield  <mmaxfield@apple.com>

        [iOS 11] fast/text/international/system-language/arabic-glyph-cache-fill-combine.html hardcodes the system UI Arabic font
        https://bugs.webkit.org/show_bug.cgi?id=173244
        <rdar://problem/32659595>

        Reviewed by Ryosuke Niwa.

        iOS 11 changed this font, so we shouldn't hardcode it. Instead,
        we can simply change this to an -expected-mismatch.html test to
        specifically test against the ".notdef" glyph.

        * fast/text/international/system-language/arabic-glyph-cache-fill-combine-expected-mismatch.html: Renamed from LayoutTests/fast/text/international/system-language/arabic-glyph-cache-fill-combine-expected.html.

2017-06-11  Myles C. Maxfield  <mmaxfield@apple.com>

        fast/text/variations/getComputedStyle.html does not need to be asynchronous
        https://bugs.webkit.org/show_bug.cgi?id=173246
        <rdar://problem/31393842>

        Reviewed by Sam Weinig.

        I dont know why I made it asynchronous in the first place.

        * fast/text/variations/getComputedStyle.html:

2017-06-09  Ryosuke Niwa  <rniwa@webkit.org>

        didMoveToNewDocument doesn't get called on an Attr inside a shadow tree
        https://bugs.webkit.org/show_bug.cgi?id=173133

        Reviewed by Antti Koivisto.

        Added a regression test for moving a shadow tree with an Attr node across a document.
        The test hits an assertion in a debug build and fails in a release build without the fix.

        * fast/dom/adopt-attr-with-shadow-tree-expected.txt: Added.
        * fast/dom/adopt-attr-with-shadow-tree.html: Added.

2017-06-11  Keith Miller  <keith_miller@apple.com>

        TypedArray constructor with string shouldn't throw
        https://bugs.webkit.org/show_bug.cgi?id=173181

        Reviewed by JF Bastien.

        Update tests to allow null buffers.

        * fast/canvas/webgl/array-unit-tests-expected.txt:
        * fast/canvas/webgl/array-unit-tests.html:
        * fast/canvas/webgl/webgl-array-invalid-ranges-expected.txt:
        * fast/canvas/webgl/webgl-array-invalid-ranges.html:
        * webgl/1.0.2/resources/webgl_test_files/conformance/typedarrays/array-unit-tests.html:

2017-06-11  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/scrubber
        https://bugs.webkit.org/show_bug.cgi?id=173212

        Reviewed by Jon Lee.

        Remove a media/modern-media-controls/scrubber test that is no longer relevant now that there is no standalone scrubber class.

        * media/modern-media-controls/scrubber/scrubber-expected.txt: Removed.
        * media/modern-media-controls/scrubber/scrubber.html: Removed.
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-11  Antoine Quint  <graouts@apple.com>

        Enable media/modern-media-controls/scheduler
        https://bugs.webkit.org/show_bug.cgi?id=173211

        Reviewed by Jon Lee.

        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-11  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/rewind-button
        https://bugs.webkit.org/show_bug.cgi?id=173210

        Reviewed by Jon Lee.

        Use SVG assets.

        * media/modern-media-controls/rewind-button/rewind-button-expected.txt:
        * media/modern-media-controls/rewind-button/rewind-button.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-11  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/play-pause-button
        https://bugs.webkit.org/show_bug.cgi?id=173209

        Reviewed by Jon Lee.

        Use SVG assets.

        * media/modern-media-controls/play-pause-button/play-pause-button-expected.txt:
        * media/modern-media-controls/play-pause-button/play-pause-button.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-11  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/placard
        https://bugs.webkit.org/show_bug.cgi?id=173208

        Reviewed by Jon Lee.

        IconButton is now simply Button.

        * media/modern-media-controls/placard/placard-expected.txt:
        * media/modern-media-controls/placard/placard.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-11  Antoine Quint  <graouts@apple.com>

        Enable media/modern-media-controls/pip-placard tests
        https://bugs.webkit.org/show_bug.cgi?id=173207

        Reviewed by Jon Lee.

        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-11  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/pip-button.
        https://bugs.webkit.org/show_bug.cgi?id=173206

        Reviewed by Jon Lee.

        Use SVG assets.

        * media/modern-media-controls/pip-button/pip-button-expected.txt:
        * media/modern-media-controls/pip-button/pip-button.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-11  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/mute-button
        https://bugs.webkit.org/show_bug.cgi?id=173205

        Reviewed by Jon Lee.

        We now use SVG assets, so let the test reflect that.

        * media/modern-media-controls/mute-button/mute-button-expected.txt:
        * media/modern-media-controls/mute-button/mute-button.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-11  Antoine Quint  <graouts@apple.com>

        Remove media/modern-media-controls/macos-media-controls
        https://bugs.webkit.org/show_bug.cgi?id=173204

        Reviewed by Jon Lee.

        There no longer is a MacOSMediaControls class and this test no longer makes sense.

        * media/modern-media-controls/macos-media-controls/macos-media-controls-expected.txt: Removed.
        * media/modern-media-controls/macos-media-controls/macos-media-controls.html: Removed.

2017-06-09  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/layout-node
        https://bugs.webkit.org/show_bug.cgi?id=173203

        Reviewed by Jon Lee.

         The "visible" property no longer sets "display: initial" when true, but rather removes the "display" property altogether.

        * media/modern-media-controls/layout-node/visible-expected.txt:
        * media/modern-media-controls/layout-node/visible.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-09  Antoine Quint  <graouts@apple.com>

        Enable media/modern-media-controls/layout-item
        https://bugs.webkit.org/show_bug.cgi?id=173202

        Reviewed by Jon Lee.

        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-09  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/invalid-placard
        https://bugs.webkit.org/show_bug.cgi?id=173201

        Reviewed by Jon Lee.

        The only required change was to update IconButton to Button since IconButton has been folded in its superclass Button.

        * media/modern-media-controls/invalid-placard/invalid-placard-constrained-metrics-expected.txt:
        * media/modern-media-controls/invalid-placard/invalid-placard-constrained-metrics.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-09  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/icon-service
        https://bugs.webkit.org/show_bug.cgi?id=173200

        Reviewed by Jon Lee.

        The method we were testing has changed name and the pause icon is no longer a good
        test since it doesn't have a fullscreen variant, so we use the AirPlay icon instead.

        * media/modern-media-controls/icon-service/icon-service-expected.txt:
        * media/modern-media-controls/icon-service/icon-service.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-09  Brady Eidson  <beidson@apple.com>

        Crash when IndexedDB's getAll is used inside a Web Worker.
        https://bugs.webkit.org/show_bug.cgi?id=172434

        Reviewed by Andy Estes.

        * storage/indexeddb/modern/resources/worker-getall.js: Added.
        * storage/indexeddb/modern/worker-getall-expected.txt: Added.
        * storage/indexeddb/modern/worker-getall.html: Added.

2017-06-09  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/mediastream/getUserMedia-grant-persistency3.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=173188

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-06-09  Daniel Bates  <dabates@apple.com>

        CSP: Apply img-src directive to favicon loads
        https://bugs.webkit.org/show_bug.cgi?id=172733

        Remove CONSOLE MESSAGE line from expected result that I inadvertently left in from an earlier iteration
        of the test that did not call testRunner.queueReload(). Calling testRunner.queueReload() clears out
        any emitted console messages. The dump of the resource load callbacks is sufficient to ensure that
        the favicon was blocked as expected.

        * http/tests/security/contentSecurityPolicy/block-favicon-expected.txt:

2017-06-09  Andy VanWagoner  <thetalecrafter@gmail.com>

        REGRESSION: LayoutTest js/intl-datetimeformat.html is failing
        https://bugs.webkit.org/show_bug.cgi?id=172720

        Reviewed by Darin Adler.

        Reenable DateTimeFormat tests, allowing for some variation in the
        formatting of time zone names.

        * js/intl-datetimeformat-expected.txt:
        * js/script-tests/intl-datetimeformat.js:
        * platform/mac/TestExpectations:

2017-06-09  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Web inspector does not show non-shadow children of an element with a shadow root (e.g. <video>)
        https://bugs.webkit.org/show_bug.cgi?id=173121
        <rdar://problem/30948943>

        Reviewed by Matt Baker.

        * inspector/dom/shadow-and-non-shadow-children-expected.txt: Added.
        * inspector/dom/shadow-and-non-shadow-children.html: Added.

2017-06-09  Said Abou-Hallawa  <sabouhallawa@apple.com>

        LayoutTest fast/images/animated-image-different-dest-size.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170203
 
        Reviewed by Simon Fraser.
 
        Instead of using setTimeout(), listen to the webkitImageFrameReady event
        to know relaibly when to draw the next frame of an animated image to a
        canvas.

        * fast/images/animated-image-different-dest-size.html:
        * platform/mac-wk2/TestExpectations:

2017-06-09  Matt Lewis  <jlewis3@apple.com>

        Skipped layout test svg/animations/svglength-element-removed-crash.svg.
        https://bugs.webkit.org/show_bug.cgi?id=173178

        Unreviewed test gardening.

        * platform/ios-simulator-wk2/TestExpectations:

2017-06-09  Daniel Bates  <dabates@apple.com>

        CSP: Apply img-src directive to favicon loads
        https://bugs.webkit.org/show_bug.cgi?id=172733
        <rdar://problem/32082654>

        Reviewed by Brady Eidson.

        Adds tests to ensure the CSP policy is applied to favicon loads.

        * http/tests/security/contentSecurityPolicy/allow-favicon-expected.txt: Added.
        * http/tests/security/contentSecurityPolicy/allow-favicon.html: Added.
        * http/tests/security/contentSecurityPolicy/block-favicon-expected.txt: Added.
        * http/tests/security/contentSecurityPolicy/block-favicon.html: Added.
        * platform/wk2/TestExpectations: Skip the tests until we fix <https://bugs.webkit.org/show_bug.cgi?id=115809>.

2017-06-09  Ryan Haddad  <ryanhaddad@apple.com>

        Add a result file for js/dom/prototype-chain-caching-with-impure-get-own-property-slot-traps-5-short.html.
        https://bugs.webkit.org/show_bug.cgi?id=161156

        Unreviewed test gardening.

        * js/dom/prototype-chain-caching-with-impure-get-own-property-slot-traps-5-short-expected.txt: Added.

2017-06-09  Matthew Hanson  <matthew_hanson@apple.com>

        Revert r217955. rdar://problem/21125708

2017-06-09  Jonathan Bedard  <jbedard@apple.com>

        [ios-sim] Cleaning-up timeouts WebKit1
        https://bugs.webkit.org/show_bug.cgi?id=173169

        Unreviewed test gardening.

        The intention of this change is to allow the iOS WK1 bots to finish their
        test runs. Because these tests are being gardened based on the output of
        bots, there will likely be follow-up fixes.

        * platform/ios-wk1/TestExpectations: Skip tests timing out in iOS WK1.

2017-06-09  Jer Noble  <jer.noble@apple.com>

        [iOS] Video occasionally mixes with other system audio instead of interrupting
        https://bugs.webkit.org/show_bug.cgi?id=173127

        Reviewed by Eric Carlson.

        * platform/mac/media/audio-session-category-video-track-change-expected.txt: Added.
        * platform/mac/media/audio-session-category-video-track-change.html: Added.

2017-06-09  Chris Dumez  <cdumez@apple.com>

        CSS transitions added while page is not visible do not start when the page becomes visible
        https://bugs.webkit.org/show_bug.cgi?id=173166
        <rdar://problem/32250351>

        Reviewed by Darin Adler.

        Add layout test coverage.

        * fast/animation/css-animation-resuming-when-visible-expected.txt: Added.
        * fast/animation/css-animation-resuming-when-visible.html: Added.

2017-06-09  Eric Carlson  <eric.carlson@apple.com>

        fast/mediastream/MediaStream-page-muted.html times out and asserts
        https://bugs.webkit.org/show_bug.cgi?id=170355
        <rdar://problem/31376041>

        Reviewed by Chris Dumez.

        * fast/mediastream/media-stream-wrapper-collected-expected.txt: Added.
        * fast/mediastream/media-stream-wrapper-collected.html: Added.

2017-06-09  Charlie Turner  <cturner@igalia.com>

        [GTK] Fix test linter reported errors
        https://bugs.webkit.org/show_bug.cgi?id=173160

        Unreviewed gardening.

        webrtc/audio-peer-connection-webaudio.html failed ambiguity checks, it typically fails
           in release and times out in debug, but it could have bother outcomes in both build
           configurations, so removing the first instance seems like the right approach.
           See: https://bugs.webkit.org/show_bug.cgi?id=169110
        https://bugs.webkit.org/show_bug.cgi?id=131218 no longer crashing
        https://bugs.webkit.org/show_bug.cgi?id=131216 no longer crashing
        https://bugs.webkit.org/show_bug.cgi?id=119255 no longer flaky, stablized at r195130.

        Linter is now quiet, aside from non-existent path errors,
        which I think is tracked by https://bugs.webkit.org/show_bug.cgi?id=172471

        * platform/gtk/TestExpectations:

2017-06-09  Claudio Saavedra  <csaavedra@igalia.com>

        [GTK] Add baseline for media/media-fullscreen-inline-expected.html

        Unreviewed gardening.

        mediaElement.webkitSupportsPresentationMode is only present with
        VIDEO_PRESENTATION_MODE enabled, and this option is only enabled
        for Cocoa builds. Add a baseline without this property.
        * platform/gtk/media/media-fullscreen-inline-expected.txt: Added.

2017-06-09  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Unskip passing userscripts tests

        Unreviewed gardening.

        * platform/wpe/TestExpectations:

2017-06-09  Zan Dobersek  <zdobersek@igalia.com>

        [WPE] Enable ENCRYPTED_MEDIA for build-webkit builds
        https://bugs.webkit.org/show_bug.cgi?id=173103

        Reviewed by Xabier Rodriguez-Calvar.

        Enable the imported W3C tests covering Encrypted Media API for the WPE port,
        but only tests that use the ClearKey key system. WPE-specific baselines for
        those tests are also added, despite the test cases universally failing. This
        will allow us to spot any change in behavior that's introduced.

        * platform/wpe/TestExpectations: Skip tests that test PlayReady or Widevine key systems.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-check-initdata-type-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-events-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-events-session-closed-event-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-generate-request-disallowed-input-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-invalid-license-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-keystatuses-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-keystatuses-multiple-sessions-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-destroy-persistent-license-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-persistent-license-events-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-persistent-license-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-persistent-usage-record-events-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-persistent-usage-record-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-retrieve-destroy-persistent-license-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-retrieve-persistent-license-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-retrieve-persistent-usage-record-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-clear-encrypted-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-encrypted-clear-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-encrypted-clear-sources-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-events-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-multikey-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-multikey-sequential-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-multikey-sequential-readyState-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-multisession-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-setMediaKeys-after-src-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-setMediaKeys-after-update-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-setMediaKeys-immediately-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-setMediaKeys-onencrypted-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-two-videos-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-playback-temporary-waitingforkey-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-requestmediakeysystemaccess-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-reset-src-after-setmediakeys-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-setmediakeys-again-after-playback-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-setmediakeys-again-after-resetting-src-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-setmediakeys-at-same-time-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-setmediakeys-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-setmediakeys-multiple-times-with-different-mediakeys-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-setmediakeys-multiple-times-with-the-same-mediakeys-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-setmediakeys-to-multiple-video-elements-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-syntax-mediakeys-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-syntax-mediakeysession-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-syntax-mediakeysystemaccess-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-unique-origin-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-update-disallowed-input-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-mp4-waiting-for-a-key-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-not-callable-after-createsession-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/encrypted-media/clearkey-update-non-ascii-input-expected.txt: Added.

2017-06-09  Zan Dobersek  <zdobersek@igalia.com>

        [WPE] Enable MEDIA_SOURCE for build-webkit builds
        https://bugs.webkit.org/show_bug.cgi?id=173136

        Reviewed by Xabier Rodriguez-Calvar.

        * platform/wpe/TestExpectations: Enable the media/media-source/ layout tests
        for the WPE port, adding half a dozen failure or timeout expectations for
        tests that are currently failing.

2017-06-09  Xabier Rodriguez Calvar  <calvaris@igalia.com>

        [GStreamer][EME] Remove the legacy code that was not even official and is deprecated
        https://bugs.webkit.org/show_bug.cgi?id=173096

        Reviewed by Žan Doberšek.

        * platform/gtk/TestExpectations: Mark legacy tests as deprecated

2017-06-09  Aaron Chu  <aaron_chu@apple.com>

        AX: Media Controls: Missing labels for the Time Labels.
        https://bugs.webkit.org/show_bug.cgi?id=171715
        <rdar://problem/32009214>

        Reviewed by Antoine Quint.

        Modified existing test case to accommodate testing for time label description.

        * media/modern-media-controls/time-label/time-label.html:

2017-06-08  Yoav Weiss  <yoav@yoav.ws>

        [preload] Mandatory `as` value and related spec alignments
        https://bugs.webkit.org/show_bug.cgi?id=173047

        Reviewed by Dean Jackson.

        Fix tests and expectations to this patch's changes: `as` is mandatory and "fetch" replaces the previous empty `as` value,
        onerror no longer fires for invalid `as` values, and the IDL for `as` reflects only valid values, to enable feature detection.

        * http/tests/fetch/redirectmode-and-preload.html:
        * http/tests/preload/download_resources-expected.txt:
        * http/tests/preload/download_resources.html:
        * http/tests/preload/download_resources_from_header_iframe-expected.txt:
        * http/tests/preload/onerror_event-expected.txt:
        * http/tests/preload/onerror_event.html:
        * http/tests/preload/onload_event-expected.txt:
        * http/tests/preload/onload_event.html:
        * http/tests/preload/preloadscanner_download_resources.html:
        * http/tests/preload/resources/download_resources_from_header.php:
        * http/tests/preload/resources/nph-invalid_resources_from_header.pl:
        * http/tests/preload/single_download_preload.html:
        * http/tests/preload/single_download_preload_headers.php:
        * imported/w3c/web-platform-tests/html/dom/reflection-metadata-expected.txt: PProgressions related to correct reflection.

2017-06-08  Ryosuke Niwa  <rniwa@webkit.org>

        Crash inside InsertNodeBeforeCommand via InsertParagraphSeparatorCommand
        https://bugs.webkit.org/show_bug.cgi?id=173085

        Reviewed by Wenson Hsieh.

        Added a regresion test.

        * editing/inserting/insert-horizontal-rule-in-empty-document-crash-expected.txt: Added.
        * editing/inserting/insert-horizontal-rule-in-empty-document-crash.html: Added.

2017-06-08  Ryosuke Niwa  <rniwa@webkit.org>

        The tree scope of an Attr node inside a shadow tree does not updated upon detach.
        https://bugs.webkit.org/show_bug.cgi?id=173122

        Reviewed by Chris Dumez.

        Added a regression test which hits the newly added assertion.

        * fast/dom/detaching-attr-node-in-shadow-tree-crash-expected.txt: Added.
        * fast/dom/detaching-attr-node-in-shadow-tree-crash.html: Added.

2017-06-08  Myles C. Maxfield  <mmaxfield@apple.com>

        [Cocoa] Expand system-ui to include every item in the Core Text cascade list
        https://bugs.webkit.org/show_bug.cgi?id=173043
        <rdar://problem/21125708>

        Reviewed by Simon Fraser.

        Rebaseline tests which use non-English text in form controls

        * fast/text/system-font-fallback-emoji-expected.txt: Added.
        * fast/text/system-font-fallback-emoji.html: Added.
        * fast/text/system-font-fallback-expected.html: Added.
        * fast/text/system-font-fallback.html: Added.
        * platform/mac-elcapitan/fast/forms/listbox-bidi-align-expected.png: Added.
        * platform/mac-elcapitan/fast/forms/listbox-bidi-align-expected.txt:
        * platform/mac-elcapitan/fast/forms/search-rtl-expected.png: Added.
        * platform/mac-elcapitan/fast/forms/search-rtl-expected.txt:
        * platform/mac-elcapitan/fast/forms/searchfield-heights-expected.png: Added.
        * platform/mac-elcapitan/fast/forms/searchfield-heights-expected.txt:
        * platform/mac-elcapitan/fast/forms/visual-hebrew-text-field-expected.txt:
        * platform/mac-elcapitan/fast/text/drawBidiText-expected.png: Added.
        * platform/mac-elcapitan/fast/text/drawBidiText-expected.txt:
        * platform/mac-elcapitan/fast/text/international/pop-up-button-text-alignment-and-direction-expected.png: Added.
        * platform/mac-elcapitan/fast/text/international/pop-up-button-text-alignment-and-direction-expected.txt:
        * platform/mac/TestExpectations:
        * platform/mac/fast/css/rtl-ordering-expected.png:
        * platform/mac/fast/css/rtl-ordering-expected.txt:
        * platform/mac/fast/forms/listbox-bidi-align-expected.png:
        * platform/mac/fast/forms/listbox-bidi-align-expected.txt:
        * platform/mac/fast/forms/listbox-hit-test-zoomed-expected.png:
        * platform/mac/fast/forms/listbox-hit-test-zoomed-expected.txt:
        * platform/mac/fast/forms/search-rtl-expected.png:
        * platform/mac/fast/forms/search-rtl-expected.txt:
        * platform/mac/fast/forms/searchfield-heights-expected.txt:
        * platform/mac/fast/forms/select-visual-hebrew-expected.png:
        * platform/mac/fast/forms/select-visual-hebrew-expected.txt:
        * platform/mac/fast/forms/visual-hebrew-text-field-expected.png:
        * platform/mac/fast/forms/visual-hebrew-text-field-expected.txt:
        * platform/mac/fast/text/drawBidiText-expected.png:
        * platform/mac/fast/text/drawBidiText-expected.txt:
        * platform/mac/fast/text/international/pop-up-button-text-alignment-and-direction-expected.png:
        * platform/mac/fast/text/international/pop-up-button-text-alignment-and-direction-expected.txt:
        * platform/mac/fast/text/updateNewFont-expected.png:
        * platform/mac/fast/text/updateNewFont-expected.txt:

2017-06-08  Chris Dumez  <cdumez@apple.com>

        REGRESSION: fast/images/animated-gif-webkit-transform.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=170410
        <rdar://problem/31409381>

        Reviewed by Simon Fraser.

        Fix flakiness and unskip test.

        * fast/images/animated-gif-webkit-transform-expected.txt:
        * fast/images/animated-gif-webkit-transform.html:
        * platform/mac-wk2/TestExpectations:

2017-06-08  Antoine Quint  <graouts@apple.com>

        [iOS] Buttons in top-left and bottom media controls bar are positioned too high
        https://bugs.webkit.org/show_bug.cgi?id=173111
        <rdar://problem/32650615>

        Reviewed by Jon Lee.

        Add a test that checks that the appropriate styles as set in buttons-container.css
        are applied to a button in a buttons container on iOS.

        * media/modern-media-controls/ios-inline-media-controls/ios-inline-media-controls-button-padding-expected.txt: Added.
        * media/modern-media-controls/ios-inline-media-controls/ios-inline-media-controls-button-padding.html: Added.
        * platform/ios-simulator/TestExpectations:

2017-06-08  Youenn Fablet  <youenn@apple.com>

        getUserMedia should not be prompted again if user denied access
        https://bugs.webkit.org/show_bug.cgi?id=173104

        Reviewed by Geoff Garen.

        Splitting grant test due to remembering deny decisions.

        * fast/mediastream/getUserMedia-deny-persistency-expected.txt: Added.
        * fast/mediastream/getUserMedia-deny-persistency-reload-expected.txt: Added.
        * fast/mediastream/getUserMedia-deny-persistency-reload.html: Added.
        * fast/mediastream/getUserMedia-deny-persistency.html: Added.
        * fast/mediastream/getUserMedia-deny-persistency2-expected.txt: Added.
        * fast/mediastream/getUserMedia-deny-persistency2.html: Added.
        * fast/mediastream/getUserMedia-deny-persistency3-expected.txt: Added.
        * fast/mediastream/getUserMedia-deny-persistency3.html: Added.
        * fast/mediastream/getUserMedia-grant-persistency-expected.txt:
        * fast/mediastream/getUserMedia-grant-persistency.html:
        * fast/mediastream/getUserMedia-grant-persistency2-expected.txt: Added.
        * fast/mediastream/getUserMedia-grant-persistency2.html: Added.
        * fast/mediastream/getUserMedia-grant-persistency3-expected.txt: Added.
        * fast/mediastream/getUserMedia-grant-persistency3.html: Added.


2017-06-08  Filip Pizlo  <fpizlo@apple.com>

        REGRESSION: js/dom/prototype-chain-caching-with-impure-get-own-property-slot-traps-5.html has a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=161156

        Reviewed by Saam Barati.
        
        Add a version of the test that's guaranteed to fail if the problem it's testing for manifests
        in the LLInt.

        * js/dom/prototype-chain-caching-with-impure-get-own-property-slot-traps-5-short.html: Added.

2017-06-07  Dave Hyatt  <hyatt@apple.com>

        Laili restaurant menu page does not display full menu
        https://bugs.webkit.org/show_bug.cgi?id=173062
        rdar://problem/32436486

        Reviewed by Simon Fraser.

        * fast/hidpi/percent-height-image-nested-expected.html:
        * fast/hidpi/percent-height-image-nested.html:
        * fast/multicol/pagination/RightToLeft-max-width.html:
        * fast/replaced/max-height-percent-inside-auto-block-expected.html: Added.
        * fast/replaced/max-height-percent-inside-auto-block.html: Added.
        * platform/mac/fast/multicol/pagination/RightToLeft-max-width-expected.txt:

2017-06-08  Antoine Quint  <graouts@apple.com>

        Rebaseline and enable media/modern-media-controls/fullscreen-button
        https://bugs.webkit.org/show_bug.cgi?id=173101

        Reviewed by Dean Jackson.

        Update the test to check an SVG asset now that we use those.

        * media/modern-media-controls/fullscreen-button/fullscreen-button-expected.txt:
        * media/modern-media-controls/fullscreen-button/fullscreen-button.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-08  Antoine Quint  <graouts@apple.com>

        Rebaseline and enable media/modern-media-controls/forward-button
        https://bugs.webkit.org/show_bug.cgi?id=173100

        Reviewed by Dean Jackson.

        Update the test to check an SVG asset now that we use those.

        * media/modern-media-controls/forward-button/forward-button-expected.txt:
        * media/modern-media-controls/forward-button/forward-button.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-08  Antoine Quint  <graouts@apple.com>

        Layout Test media/modern-media-controls/button/button-icon-name.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=173099

        Reviewed by Dean Jackson.

        Rewrite the test to use asynchronous assertions, the number of frames running is immaterial to this test.

        * media/modern-media-controls/button/button-icon-name-expected.txt:
        * media/modern-media-controls/button/button-icon-name.html:

2017-06-08  Tim Horton  <timothy_horton@apple.com>

        Add a borderless mode to <attachment>, and make it respect its layout size
        https://bugs.webkit.org/show_bug.cgi?id=173079
        <rdar://problem/32491584>

        Reviewed by Simon Fraser.

        * TestExpectations:
        * platform/ios/TestExpectations:
        * fast/attachment/attachment-borderless-expected-mismatch.html: Added.
        * fast/attachment/attachment-borderless.html: Added.
        * fast/attachment/attachment-respects-css-size-expected-mismatch.html: Added.
        * fast/attachment/attachment-respects-css-size.html: Added.
        Add mismatch tests ensuring that CSS width/height and borderless-attachment
        have *some* kind of impact on rendering.

2017-06-08  Marcos Chavarría Teijeiro  <chavarria1991@gmail.com>

        Modify security test to avoid spacing differences.
        https://bugs.webkit.org/show_bug.cgi?id=141709

        Reviewed by Carlos Alberto Lopez Perez.

        * http/tests/security/XFrameOptions/x-frame-options-deny-multiple-clients-expected.txt:
        * http/tests/security/XFrameOptions/x-frame-options-deny-multiple-clients.html:
        * http/tests/security/cross-frame-access-callback-explicit-domain-ALLOW-expected.txt:
        * http/tests/security/cross-frame-access-callback-explicit-domain-ALLOW.html:
        * platform/gtk/TestExpectations:

2017-06-08  Youenn Fablet  <youenn@apple.com>

        getUserMedia request should not be allowed for background tabs unless the tab is already capturing
        https://bugs.webkit.org/show_bug.cgi?id=172989

        Reviewed by Eric Carlson.

        * fast/mediastream/getUserMedia-grant-persistency-expected.txt:
        * fast/mediastream/getUserMedia-grant-persistency.html: Using testRunner.setPageVisibility so that UIProcess is made aware of the change.
        Removing test about capture muted page since there is no API for setting a page as muted right now.
        This test should be readded later on.

2017-06-08  Charlie Turner  <cturner@igalia.com>

        [GTK] Test gardening
        https://bugs.webkit.org/show_bug.cgi?id=173093

        Unreviewed GTK gardening.

        r147201 added a crash expectation for the following test, but did so in a manner
        that failed linter checks:

        LayoutTests/platform/gtk/TestExpectations:1302 More specific entry for
           http/tests/security/XFrameOptions/x-frame-options-deny-multiple-clients.html on line
           LayoutTests/platform/gtk/TestExpectations:992 overrides line LayoutTests/platform/gtk/TestExpectations:1302.
           http/tests/security/XFrameOptions/x-frame-options-deny-multiple-clients.html

        Furthermore, this test no longer crashes in Debug builds, it fails due to whitespace
        oddities that are addressed by webkit.org/b/141709 (unreviewed)

        * platform/gtk/TestExpectations:

2017-06-08  Xabier Rodriguez Calvar  <calvaris@igalia.com>

        MediaTime class has rounding issues in different platforms
        https://bugs.webkit.org/show_bug.cgi?id=172640

        Reviewed by Jer Noble.

        Update expectations because the MediaTime printing changed, but
        results are the same.

        * media/media-source/media-source-overlapping-append-expected.txt:
        * media/media-source/media-source-overlapping-decodetime-expected.txt:
        * media/media-source/media-source-seek-back-expected.txt:
        * media/media-source/media-source-sequence-timestamps-expected.txt:
        * media/media-source/media-source-timeoffset-expected.txt:

2017-06-07  Alexey Proskuryakov  <ap@apple.com>

        Add High Sierra support to WebKit tools
        https://bugs.webkit.org/show_bug.cgi?id=173080

        Rubber-stamped by Daniel Bates.

        * platform/mac-sierra: Added an empty directory to avoid breaking scripts.

2017-06-07  Jer Noble  <jer.noble@apple.com>

        [Web Audio] createScriptProcessor throws IndexSizeError for valid arguments
        https://bugs.webkit.org/show_bug.cgi?id=173022

        Reviewed by Sam Weinig.

        * webaudio/javascriptaudionode-expected.txt:
        * webaudio/javascriptaudionode.html:

2017-06-07  Chris Dumez  <cdumez@apple.com>

        CSSStyleRule.style / CSSPageRule.style / CSSKeyframeRule.style should be settable
        https://bugs.webkit.org/show_bug.cgi?id=164537
        <rdar://problem/29181773>

        Reviewed by Sam Weinig.

        Add better test coverage for CSSPageRule. This test is being upstreamed via:
        - https://github.com/w3c/web-platform-tests/pull/6183

        * http/wpt/cssom/CSSPageRule-expected.txt: Added.
        * http/wpt/cssom/CSSPageRule.html: Added.

2017-06-07  Youenn Fablet  <youenn@apple.com>

        RTCTrackEvent.track should be found in RTCTrackEvent.streams[0]
        https://bugs.webkit.org/show_bug.cgi?id=173074

        Reviewed by Eric Carlson.

        * webrtc/video.html:

2017-06-07  Devin Rousso  <drousso@apple.com>

        Web Inspector: Add ContextMenu item to log WebSocket object to console
        https://bugs.webkit.org/show_bug.cgi?id=172878

        Reviewed by Joseph Pecoraro.

        * http/tests/websocket/tests/hybi/inspector/resolveWebSocket-expected.txt: Added.
        * http/tests/websocket/tests/hybi/inspector/resolveWebSocket.html: Added.

        * http/tests/websocket/tests/hybi/inspector/before-load-expected.txt:
        * http/tests/websocket/tests/hybi/inspector/before-load.html:
        * http/tests/websocket/tests/hybi/inspector/before-load_wsh.py: Removed.
        * http/tests/websocket/tests/hybi/inspector/client-close.html:
        * http/tests/websocket/tests/hybi/inspector/client-close_wsh.py: Removed.
        * http/tests/websocket/tests/hybi/inspector/send-and-receive.html:
        * http/tests/websocket/tests/hybi/inspector/send-and-receive_wsh.py: Removed.
        * http/tests/websocket/tests/hybi/inspector/echo.py: Added.
        (web_socket_do_extra_handshake):
        (web_socket_transfer_data):
        Unified common configurations for Inspector WebSocket tests.

2017-06-07  Devin Rousso  <drousso@apple.com>

        Web Inspector: Allow user to choose stylesheet when creating new rules
        https://bugs.webkit.org/show_bug.cgi?id=172487

        Reviewed by Joseph Pecoraro.

        * inspector/css/add-rule-expected.html: Added.
        * inspector/css/add-rule.html: Added.

2017-06-07  Youenn Fablet  <youenn@apple.com>

        getUserMedia is prompting too often
        https://bugs.webkit.org/show_bug.cgi?id=172859
        <rdar://problem/32589950>

        Reviewed by Eric Carlson.

        * fast/mediastream/getUserMedia-grant-persistency-expected.txt: Added.
        * fast/mediastream/getUserMedia-grant-persistency-reload-expected.txt: Added.
        * fast/mediastream/getUserMedia-grant-persistency-reload.html: Added.
        * fast/mediastream/getUserMedia-grant-persistency.html: Added.
        * http/tests/media/media-stream/get-user-media-prompt-expected.txt:
        * http/tests/media/media-stream/get-user-media-prompt.html: Last gum does not need a prompt anymore.

2017-06-07  Daniel Bates  <dabates@apple.com>

        Fetching Blob URLs with XHR gives null content-type and content-length
        https://bugs.webkit.org/show_bug.cgi?id=137647
        <rdar://problem/18215114>

        Reviewed by Darin Adler.

        Add a test to ensure that we do not regress the computed Content-Type and Content-Length
        for a blob URL fetched using XHR.

        * fast/xmlhttprequest/xmlhttprequest-blob-url-has-valid-response-type-and-size-expected.txt: Added.
        * fast/xmlhttprequest/xmlhttprequest-blob-url-has-valid-response-type-and-size.html: Added.

2017-06-07  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed GTK+ and WPE gardening.

        Add platform-specific test baselines for layout tests where the
        libgcrypt-based implementation passes more tests than the generic
        baselines expect. The WPE test expectations for these tests are
        also cleaned up a bit, and the tests are marked as slow to give
        them more time to properly execute.

        * platform/gtk/TestExpectations: Skip two imported W3C Web Crypto API tests that rely in SPKI and PKCS#8 imports.
        * platform/wpe/TestExpectations: Ditto.
        * platform/wpe/crypto: Added.
        * platform/wpe/crypto/subtle: Added.
        * platform/wpe/crypto/subtle/rsa-generate-key-malformed-parameters-expected.txt: Added.
        * platform/wpe/crypto/subtle/rsa-import-key-malformed-parameters-expected.txt: Added.
        * platform/wpe/imported: Added.
        * platform/wpe/imported/w3c: Added.
        * platform/wpe/imported/w3c/web-platform-tests: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/hkdf.worker-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/test_hkdf.https-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey/failures.worker-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey/failures_RSA-PSS.worker-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey/successes_RSA-PSS.worker-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey/test_failures.https-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey/test_failures_RSA-PSS.https-expected.txt: Added.
        * platform/wpe/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey/test_successes_RSA-PSS.https-expected.txt: Added.

2017-06-07  Sam Weinig  <sam@webkit.org>

        [WebIDL] PutForwards is not implemented to spec as illustrated by the WPT WebIDL/ecmascript-binding/put-forwards.html
        https://bugs.webkit.org/show_bug.cgi?id=172956

        Reviewed by Chris Dumez.

        * http/tests/security/xss-DENIED-contentWindow-eval-expected.txt:
        Update results to show that we now throw a type error, because the action now requires
        an explicit get of the location object, which does not work in the context.

2017-06-07  Antoine Quint  <graouts@apple.com>

        Rebaseline and enable media/modern-media-controls/controls-visibility-support
        https://bugs.webkit.org/show_bug.cgi?id=173060
        <rdar://problem/32616840>

        Reviewed by Eric Carlson.

        We only check the "visible" property on the MediaControls instance which is the only thing being
        set by this class now. We also fix entering fullscreen by not using a <button> element which has
        some default styles set by the Button class. Finally, we make some videoTracks.length assertions
        asynchronous to avoid timing issues.

        * media/modern-media-controls/controls-visibility-support/controls-visibility-support-controls-off-audio-expected.txt:
        * media/modern-media-controls/controls-visibility-support/controls-visibility-support-controls-off-audio.html:
        * media/modern-media-controls/controls-visibility-support/controls-visibility-support-controls-off-expected.txt:
        * media/modern-media-controls/controls-visibility-support/controls-visibility-support-controls-off.html:
        * media/modern-media-controls/controls-visibility-support/controls-visibility-support-controls-on-audio-expected.txt:
        * media/modern-media-controls/controls-visibility-support/controls-visibility-support-controls-on-audio.html:
        * media/modern-media-controls/controls-visibility-support/controls-visibility-support-controls-on-expected.txt:
        * media/modern-media-controls/controls-visibility-support/controls-visibility-support-controls-on.html:
        * media/modern-media-controls/controls-visibility-support/controls-visibility-support-controls-toggle-expected.txt:
        * media/modern-media-controls/controls-visibility-support/controls-visibility-support-controls-toggle.html:
        * media/modern-media-controls/controls-visibility-support/controls-visibility-support-fullscreen-on-parent-element-expected.txt:
        * media/modern-media-controls/controls-visibility-support/controls-visibility-support-fullscreen-on-parent-element.html:
        * media/modern-media-controls/controls-visibility-support/controls-visibility-support-fullscreen-on-video-expected.txt:
        * media/modern-media-controls/controls-visibility-support/controls-visibility-support-fullscreen-on-video.html:

2017-06-07  Antoine Quint  <graouts@apple.com>

        Rebaseline and enable media/modern-media-controls/buttons-container
        https://bugs.webkit.org/show_bug.cgi?id=173059
        <rdar://problem/32616156>

        Reviewed by Eric Carlson.

        The only change is the default margin for a ButtonsContainer.

        * media/modern-media-controls/buttons-container/buttons-container-constructor-expected.txt:
        * media/modern-media-controls/buttons-container/buttons-container-constructor.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-07  Antoine Quint  <graouts@apple.com>

        Rebaseline and enable media/modern-media-controls/button
        https://bugs.webkit.org/show_bug.cgi?id=173058
        <rdar://problem/32615846>

        Reviewed by Eric Carlson.

        The IconButton class was removed and merged into its superclass Button, so we merge those tests
        in a single directory. A couple tests no longer applied as we do not have a focused state for
        buttons anymore, nor do we deal with changes in layout traits since there is no such thing as
        a compact mode anymore.

        * media/modern-media-controls/button/button-active-state-expected.txt: Added.
        * media/modern-media-controls/button/button-active-state.html: Renamed from LayoutTests/media/modern-media-controls/icon-button/icon-button-active-state.html.
        * media/modern-media-controls/button/button-icon-name-expected.txt: Added.
        * media/modern-media-controls/button/button-icon-name.html: Added.
        * media/modern-media-controls/button/button-on-expected.txt: Added.
        * media/modern-media-controls/button/button-on.html: Renamed from LayoutTests/media/modern-media-controls/icon-button/icon-button-on.html.
        * media/modern-media-controls/button/button.html:
        * media/modern-media-controls/icon-button/icon-button-active-state-expected.txt: Removed.
        * media/modern-media-controls/icon-button/icon-button-change-layout-traits-expected.txt: Removed.
        * media/modern-media-controls/icon-button/icon-button-change-layout-traits.html: Removed.
        * media/modern-media-controls/icon-button/icon-button-expected.txt: Removed.
        * media/modern-media-controls/icon-button/icon-button-focus-state-expected.txt: Removed.
        * media/modern-media-controls/icon-button/icon-button-focus-state.html: Removed.
        * media/modern-media-controls/icon-button/icon-button-on-expected.txt: Removed.
        * media/modern-media-controls/icon-button/icon-button.html: Removed.
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-07  Ryan Haddad  <ryanhaddad@apple.com>

        Remove TestExpectation for fast/backgrounds/background-repeat-x-y-parse.html.
        https://bugs.webkit.org/show_bug.cgi?id=167428

        Unreviewed test gardening.

        * TestExpectations:

2017-06-07  Per Arne Vollan  <pvollan@apple.com>

        Support removal of authentication data through the Website data store API.
        https://bugs.webkit.org/show_bug.cgi?id=171217

        Reviewed by Brady Eidson.

        * TestExpectations:
        * http/tests/loading/basic-auth-remove-credentials-expected.txt: Added.
        * http/tests/loading/basic-auth-remove-credentials.html: Added.
        * platform/mac-wk2/TestExpectations:

2017-06-07  Antoine Quint  <graouts@apple.com>

        Rebaseline and enable media/modern-media-controls/background-tint
        https://bugs.webkit.org/show_bug.cgi?id=173056
        <rdar://problem/32614607>

        Reviewed by Eric Carlson.

        Update the background-color and filter properties for backdrops to match
        the latest implementation and specs.

        * media/modern-media-controls/background-tint/background-tint-expected.txt:
        * media/modern-media-controls/background-tint/background-tint.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-07  Alejandro G. Castro  <alex@igalia.com>

        Unreviewed GTK expectations gardening

        Mark the mediacapturefromelement tests as skipped, we need canvas
        captureStreams support.

        * platform/gtk/TestExpectations:

2017-06-07  Antoine Quint  <graouts@apple.com>

        [mac-wk1] LayoutTest media/modern-media-controls/airplay-button/airplay-button.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=168409

        Unreviewed test gardening. This test has started timing out again on WK1.

        * platform/mac-wk1/TestExpectations:

2017-06-07  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed GTK+ gardening.

        Add test baselines that expect RSA-PSS and HKDF tests running successfully.
        Also mark tests under imported/w3c/web-platform-tests/WebCryptoAPI as slow,
        giving them enough time to run properly and avoid timeouts.

        * platform/gtk/TestExpectations:
        * platform/gtk/crypto: Added.
        * platform/gtk/crypto/subtle: Added.
        * platform/gtk/crypto/subtle/rsa-generate-key-malformed-parameters-expected.txt: Added.
        * platform/gtk/crypto/subtle/rsa-import-key-malformed-parameters-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/hkdf.worker-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/test_hkdf.https-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey/failures.worker-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey/failures_RSA-PSS.worker-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey/successes_RSA-PSS.worker-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey/test_failures.https-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey/test_failures_RSA-PSS.https-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/WebCryptoAPI/generateKey/test_successes_RSA-PSS.https-expected.txt: Added.

2017-06-07  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] RSA-PSS support
        https://bugs.webkit.org/show_bug.cgi?id=172856

        Reviewed by Jiewen Tan.

        * platform/gtk/TestExpectations: Enable RSA-PSS tests that we pass. The remaining
        disabled tests rely on SPKI or PKCS#8 support that hasn't landed yet.

2017-06-06  Matt Lewis  <jlewis3@apple.com>

        Marked workers/bomb.html as flaky on iOS.
        https://bugs.webkit.org/show_bug.cgi?id=167757

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-06-06  Darin Adler  <darin@apple.com>

        Update to slightly stricter rules for custom element names from more recent standard draft
        https://bugs.webkit.org/show_bug.cgi?id=173019

        Reviewed by Ryosuke Niwa.

        * platform/ios-wk2/imported/w3c/web-platform-tests/html/semantics/interfaces-expected.txt: Expect more PASS.
        * platform/ios/imported/w3c/web-platform-tests/html/semantics/interfaces-expected.txt: Ditto.

2017-06-06  Yoav Weiss  <yoav@yoav.ws>

        [preload] Conditional support for media preloading and align media `as` values.
        https://bugs.webkit.org/show_bug.cgi?id=172501

        Reviewed by Dean Jackson.

        Tests checking media resources preloading support were removed.

        * http/tests/preload/download_resources.html: Replaced "media" with "video".
        * http/tests/preload/download_resources_from_header_iframe-expected.txt: Changed expectation due to added "audio" test.
        * http/tests/preload/onload_event.html: Replaced "media" with "video".
        * http/tests/preload/preloadscanner_download_resources.html: Replaced "media" with "video".
        * http/tests/preload/resources/download_resources_from_header.php: Replaced "media" with "video" and "audio".
        * http/tests/preload/resources/nph-invalid_resources_from_header.pl: Replaced "media" with "video".
        * http/tests/preload/single_download_preload.html: Replaced "media" with "video" and "audio".
        * http/tests/preload/single_download_preload_headers.php: Replaced "media" with "video" and "audio".
        * http/tests/preload/single_download_preload_headers_charset.php: Replaced "media" with "video" and "audio".

2017-06-06  Ryan Haddad  <ryanhaddad@apple.com>

        Mark imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/hkdf.worker.html as flaky on mac.
        https://bugs.webkit.org/show_bug.cgi?id=170907

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-06  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed GTK+ gardening.

        * platform/gtk/TestExpectations: Clean up the Web Crypto API test expectations.
        Unskip the crypto/subtle/, crypto/workers/subtle/ and
        imported/w3c/web-platform-tests/WebCryptoAPI/ directories and add expectations
        that skip the remaining failing layout tests, instead of skipping those
        directories and maintaining expectations for the passing tests.

2017-06-06  Jonathan Bedard  <jbedard@apple.com>

        Move storage/websql/alter-to-info-table.html failure expectation.
        https://bugs.webkit.org/show_bug.cgi?id=156718

        Unreviewed test gardening

        storage/websql/alter-to-info-table.html fails on iOS-simulator,
        but passes on device.

        * platform/ios-simulator/TestExpectations:
        * platform/ios/TestExpectations:

2017-06-06  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/fullscreen-api-enabled-media-with-presentation-mode.html is failing.
        https://bugs.webkit.org/show_bug.cgi?id=172998

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-06-06  Zalan Bujtas  <zalan@apple.com>

        Safari doesn't load newest The Order of the Stick comic.
        https://bugs.webkit.org/show_bug.cgi?id=172949
        <rdar://problem/32389730>

        Reviewed by Antti Koivisto.

        * fast/table/floating-table-sibling-is-invisible-expected.html: Added.
        * fast/table/floating-table-sibling-is-invisible.html: Added.

2017-06-06  Emilio Cobos Álvarez  <ecobos@igalia.com>

        [css-conditional] The one-string version of CSS.supports should be wrapped in implied parentheses.
        https://bugs.webkit.org/show_bug.cgi?id=172906

        Reviewed by Darin Adler.

        * css3/supports-dom-api-expected.txt:
        * css3/supports-dom-api.html: Added test

2017-06-06  Joseph Pecoraro  <pecoraro@apple.com>

        Unreviewed rollout r217807. Caused a test to crash.

        * inspector/unit-tests/heap-snapshot-expected.txt:
        * inspector/unit-tests/heap-snapshot.html:

2017-06-06  Antoine Quint  <graouts@apple.com>

        Rebaseline and enable media/modern-media-controls/audio
        https://bugs.webkit.org/show_bug.cgi?id=172996
        <rdar://problem/32590725>

        Reviewed by Eric Carlson.

        The new controls design switches the AirPlay and mute button order around.

        * media/modern-media-controls/audio/audio-controls-buttons-expected.txt:
        * media/modern-media-controls/audio/audio-controls-buttons.html:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-06  Antoine Quint  <graouts@apple.com>

        Rebaseline and enable media/modern-media-controls/airplay-support
        https://bugs.webkit.org/show_bug.cgi?id=172980
        <rdar://problem/32589074>

        Reviewed by Eric Carlson.

        The test passes as-is on macOS, but needs to be skipped on iOS since we can't test AirPlay.

        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-06  Antoine Quint  <graouts@apple.com>

        Rebaseline and enable media/modern-media-controls/airplay-placard
        https://bugs.webkit.org/show_bug.cgi?id=172977
        <rdar://problem/32588681>

        Reviewed by Eric Carlson.

        These two tests work fine as-is, we just need to enable them.

        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-06  Antoine Quint  <graouts@apple.com>

        Rebaseline and enable media/modern-media-controls/airplay-button
        https://bugs.webkit.org/show_bug.cgi?id=172975
        <rdar://problem/32588422>

        Reviewed by Eric Carlson.

        * media/modern-media-controls/airplay-button/airplay-button-expected.txt:
        * media/modern-media-controls/airplay-button/airplay-button-on.html: Remove some unnecessary
        code, the path to the icon directory is provided directly by media-controls-loader.js.
        * media/modern-media-controls/airplay-button/airplay-button.html: Remove the test for the "icon"
        CSS class since buttons no longer carry this class. We also update the assumptions to use SVG
        assets.
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-06  Antoine Quint  <graouts@apple.com>

        Update modern media controls testing utilities
        https://bugs.webkit.org/show_bug.cgi?id=172976
        <rdar://problem/32588432>

        Reviewed by Eric Carlson.

        Update the list of CSS files to load to match the current list of
        existing CSS files in the modern-media-controls module.

        * media/modern-media-controls/resources/media-controls-loader.js:

2017-06-05  Antoine Quint  <graouts@apple.com>

        Update media controls to match latest design specs
        https://bugs.webkit.org/show_bug.cgi?id=172932

        Reviewed by Dean Jackson.

        Update test expectations to make a few of the tests we had already rebaselined pass.

        * TestExpectations:
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-06-05  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline fast/mediacapturefromelement/CanvasCaptureMediaStream-2d-events.html and update TestExpectations.

        Unreviewed test gardening.

        * fast/mediacapturefromelement/CanvasCaptureMediaStream-2d-events-expected.txt:

2017-06-05  Ryan Haddad  <ryanhaddad@apple.com>

        Skip storage/domstorage/sessionstorage/set-item-synchronous-keydown.html on iOS.
        https://bugs.webkit.org/show_bug.cgi?id=172943

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-06-05  Michael Catanzaro  <mcatanzaro@igalia.com>

        Unreviewed GTK expectations gardening

        Mark a few tests as crashing.

        * platform/gtk/TestExpectations:

2017-06-05  Chris Dumez  <cdumez@apple.com>

        ASSERTION FAILED: RunLoop::isMain() in com.apple.WebKit: IPC::Connection::sendSyncMessage + 128
        https://bugs.webkit.org/show_bug.cgi?id=172943
        <rdar://problem/31288058>

        Reviewed by Alexey Proskuryakov.

        Make test clean a little bit more robust.

        * storage/domstorage/sessionstorage/set-item-synchronous-keydown.html:

2017-06-05  Chris Dumez  <cdumez@apple.com>

        ASSERTION FAILED: RunLoop::isMain() in com.apple.WebKit: IPC::Connection::sendSyncMessage + 128
        https://bugs.webkit.org/show_bug.cgi?id=172943
        <rdar://problem/31288058>

        Reviewed by Alexey Proskuryakov.

        Add better test coverage.

        * storage/domstorage/sessionstorage/set-item-synchronous-keydown-expected.txt: Added.
        * storage/domstorage/sessionstorage/set-item-synchronous-keydown.html: Added.

2017-06-05  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Improve ES6 Class instances in Heap Snapshot instances view
        https://bugs.webkit.org/show_bug.cgi?id=172848
        <rdar://problem/25709212>

        Reviewed by Saam Barati.

        * inspector/unit-tests/heap-snapshot-expected.txt:
        * inspector/unit-tests/heap-snapshot.html:
        Update for the new node flag.

2017-06-05  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline tests for Windows after r217772.
        https://bugs.webkit.org/show_bug.cgi?id=172866

        Unreviewed test gardening.

        * platform/win/svg/W3C-SVG-1.1-SE/paths-dom-02-f-expected.txt:
        * platform/win/svg/W3C-SVG-1.1/animate-elem-06-t-expected.txt:
        * platform/win/svg/W3C-SVG-1.1/animate-elem-07-t-expected.txt:
        * platform/win/svg/W3C-SVG-1.1/animate-elem-08-t-expected.txt:
        * platform/win/svg/W3C-SVG-1.1/animate-elem-83-t-expected.txt:
        * platform/win/svg/W3C-SVG-1.1/filters-example-01-b-expected.txt:
        * platform/win/svg/W3C-SVG-1.1/paths-data-01-t-expected.txt:
        * platform/win/svg/W3C-SVG-1.1/paths-data-02-t-expected.txt:
        * platform/win/svg/W3C-SVG-1.1/paths-data-12-t-expected.txt:
        * platform/win/svg/W3C-SVG-1.1/text-path-01-b-expected.txt:
        * platform/win/svg/batik/filters/feTile-expected.txt:
        * platform/win/svg/batik/filters/filterRegions-expected.txt:
        * platform/win/svg/batik/masking/maskRegions-expected.txt:
        * platform/win/svg/batik/paints/gradientLimit-expected.txt:
        * platform/win/svg/batik/paints/patternPreserveAspectRatioA-expected.txt:
        * platform/win/svg/batik/paints/patternRegionA-expected.txt:
        * platform/win/svg/batik/paints/patternRegions-expected.txt:
        * platform/win/svg/batik/paints/patternRegions-positioned-objects-expected.txt: Added.
        * platform/win/svg/batik/text/longTextOnPath-expected.txt: Added.
        * platform/win/svg/batik/text/smallFonts-expected.txt:
        * platform/win/svg/batik/text/textAnchor-expected.txt:
        * platform/win/svg/batik/text/textDecoration-expected.txt:
        * platform/win/svg/batik/text/textEffect-expected.txt:
        * platform/win/svg/batik/text/textEffect2-expected.txt:
        * platform/win/svg/batik/text/textEffect3-expected.txt:
        * platform/win/svg/batik/text/textFeatures-expected.txt:
        * platform/win/svg/batik/text/textGlyphOrientationHorizontal-expected.txt:
        * platform/win/svg/batik/text/textLayout-expected.txt:
        * platform/win/svg/batik/text/textLayout2-expected.txt:
        * platform/win/svg/batik/text/textLength-expected.txt:
        * platform/win/svg/batik/text/textOnPathSpaces-expected.txt:
        * platform/win/svg/batik/text/textPosition-expected.txt:
        * platform/win/svg/batik/text/textProperties-expected.txt:
        * platform/win/svg/batik/text/textProperties2-expected.txt:
        * platform/win/svg/batik/text/textStyles-expected.txt:
        * platform/win/svg/custom/broken-internal-references-expected.txt:
        * platform/win/svg/custom/path-textPath-simulation-expected.txt:
        * platform/win/svg/dom/SVGPathSegList-segment-modification-expected.txt:
        * platform/win/svg/hixie/perf/001-expected.txt:
        * platform/win/svg/hixie/perf/002-expected.txt:
        * platform/win/svg/text/text-path-01-b-expected.txt:
        * platform/win/svg/zoom/page/zoom-svg-through-object-with-override-size-expected.txt:

2017-06-05  Ryan Haddad  <ryanhaddad@apple.com>

        Remove debug-only flag for flaky test http/tests/navigation/statistics.html.
        https://bugs.webkit.org/show_bug.cgi?id=172454

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:
        * platform/mac-wk2/TestExpectations:

2017-06-05  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/audio/audio-controls-metrics.html
        https://bugs.webkit.org/show_bug.cgi?id=172915

        Reviewed by Antoine Quint.

        The default height of <audio> elements is now 31pt.

        * media/modern-media-controls/audio/audio-controls-metrics-expected.txt:
        * media/modern-media-controls/audio/audio-controls-metrics.html:

2017-06-04  Simon Fraser  <simon.fraser@apple.com>

        Percentages are calculated wrong in SVG transform CSS property
        https://bugs.webkit.org/show_bug.cgi?id=172901

        Reviewed by Zalan Bujtas.

        * svg/transforms/percent-transform-values-viewbox-expected.html: Added.
        * svg/transforms/percent-transform-values-viewbox.html: Added.
        * svg/transforms/transform-origin-css-property-expected.xhtml:
        * svg/transforms/transform-origin-css-property.xhtml: Make this test a bit less
        annoying to maintain by applying the transforms relative to the fill-box, which means all
        the transform origins are no longer offset by the box position. Other tests exercise
        view-box relative transform origins.

2017-06-04  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] Page capture state not reported correctly
        https://bugs.webkit.org/show_bug.cgi?id=172897
        <rdar://problem/32493318>

        Reviewed by Youenn Fablet.

        * fast/mediastream/media-stream-track-muted-expected.txt: Added.
        * fast/mediastream/media-stream-track-muted.html: Added.

2017-06-03  Sam Weinig  <sam@webkit.org>

        Can't use Object.defineProperty() to add an item to a DOMStringMap or Storage
        https://bugs.webkit.org/show_bug.cgi?id=172687

        Reviewed by Darin Adler.

        * js/dom/legacy-platform-object-defineOwnProperty-expected.txt: Added.
        * js/dom/legacy-platform-object-defineOwnProperty.html: Added.
        New tests for Object.defineProperty on Storage and DOMStringMap.

        * js/dom/named-property-deleter.html:
        Fix test which was deleting the wrong property. This doesn't change the result,
        but is now actually testing the thing it meant to.

        * storage/domstorage/localstorage/delete-defineproperty-removal-expected.txt:
        * storage/domstorage/localstorage/delete-defineproperty-removal.html:
        Convert to testharness.js and show that the results are now correct.

2017-06-04  Simon Fraser  <simon.fraser@apple.com>

        Object bounding box wrong for some paths
        https://bugs.webkit.org/show_bug.cgi?id=172866

        Reviewed by Tim Horton.

        So many new baselines.

        * platform/ios/svg/W3C-SVG-1.1-SE/paths-dom-02-f-expected.txt:
        * platform/ios/svg/W3C-SVG-1.1/animate-elem-06-t-expected.txt:
        * platform/ios/svg/W3C-SVG-1.1/animate-elem-08-t-expected.txt:
        * platform/ios/svg/W3C-SVG-1.1/animate-elem-83-t-expected.txt:
        * platform/ios/svg/W3C-SVG-1.1/filters-example-01-b-expected.txt:
        * platform/ios/svg/W3C-SVG-1.1/metadata-example-01-b-expected.txt:
        * platform/ios/svg/W3C-SVG-1.1/paths-data-01-t-expected.txt:
        * platform/ios/svg/W3C-SVG-1.1/paths-data-02-t-expected.txt:
        * platform/ios/svg/W3C-SVG-1.1/paths-data-03-f-expected.txt:
        * platform/ios/svg/W3C-SVG-1.1/paths-data-12-t-expected.txt:
        * platform/ios/svg/W3C-SVG-1.1/text-path-01-b-expected.txt:
        * platform/ios/svg/batik/text/longTextOnPath-expected.txt:
        * platform/ios/svg/batik/text/smallFonts-expected.txt:
        * platform/ios/svg/batik/text/textAnchor-expected.txt:
        * platform/ios/svg/batik/text/textDecoration-expected.txt:
        * platform/ios/svg/batik/text/textEffect-expected.txt:
        * platform/ios/svg/batik/text/textEffect2-expected.txt:
        * platform/ios/svg/batik/text/textEffect3-expected.txt:
        * platform/ios/svg/batik/text/textFeatures-expected.txt:
        * platform/ios/svg/batik/text/textGlyphOrientationHorizontal-expected.txt:
        * platform/ios/svg/batik/text/textLayout-expected.txt:
        * platform/ios/svg/batik/text/textLayout2-expected.txt:
        * platform/ios/svg/batik/text/textLength-expected.txt:
        * platform/ios/svg/batik/text/textOnPath-expected.txt:
        * platform/ios/svg/batik/text/textOnPathSpaces-expected.txt:
        * platform/ios/svg/batik/text/textPosition-expected.txt:
        * platform/ios/svg/batik/text/textPosition2-expected.txt:
        * platform/ios/svg/batik/text/textProperties-expected.txt:
        * platform/ios/svg/batik/text/textProperties2-expected.txt:
        * platform/ios/svg/batik/text/textStyles-expected.txt:
        * platform/ios/svg/batik/text/verticalText-expected.txt:
        * platform/ios/svg/batik/text/verticalTextOnPath-expected.txt:
        * platform/ios/svg/custom/broken-internal-references-expected.txt:
        * platform/ios/svg/custom/path-textPath-simulation-expected.txt:
        * platform/ios/svg/custom/relative-sized-use-on-symbol-expected.txt:
        * platform/ios/svg/custom/relative-sized-use-without-attributes-on-symbol-expected.txt:
        * platform/ios/svg/custom/second-inline-text-expected.txt:
        * platform/ios/svg/text/text-path-01-b-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1-SE/paths-dom-02-f-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/animate-elem-06-t-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/animate-elem-07-t-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/animate-elem-08-t-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/animate-elem-83-t-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/filters-example-01-b-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/metadata-example-01-b-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/paths-data-01-t-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/paths-data-02-t-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/paths-data-03-f-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/paths-data-12-t-expected.txt:
        * platform/mac/svg/W3C-SVG-1.1/text-path-01-b-expected.txt:
        * platform/mac/svg/batik/filters/filterRegions-expected.txt:
        * platform/mac/svg/batik/paints/patternPreserveAspectRatioA-expected.txt:
        * platform/mac/svg/batik/paints/patternRegionA-expected.txt:
        * platform/mac/svg/batik/paints/patternRegions-expected.txt:
        * platform/mac/svg/batik/text/smallFonts-expected.txt:
        * platform/mac/svg/batik/text/textAnchor-expected.txt:
        * platform/mac/svg/batik/text/textEffect2-expected.txt:
        * platform/mac/svg/batik/text/textEffect3-expected.txt:
        * platform/mac/svg/batik/text/textFeatures-expected.txt:
        * platform/mac/svg/batik/text/textGlyphOrientationHorizontal-expected.txt:
        * platform/mac/svg/batik/text/textLayout-expected.txt:
        * platform/mac/svg/batik/text/textLayout2-expected.txt:
        * platform/mac/svg/batik/text/textOnPathSpaces-expected.txt:
        * platform/mac/svg/batik/text/textPosition2-expected.txt:
        * platform/mac/svg/batik/text/textProperties-expected.txt:
        * platform/mac/svg/batik/text/textProperties2-expected.txt:
        * platform/mac/svg/batik/text/textStyles-expected.txt:
        * platform/mac/svg/custom/animate-path-morphing-expected.txt:
        * platform/mac/svg/custom/broken-internal-references-expected.txt:
        * platform/mac/svg/custom/path-textPath-simulation-expected.txt:
        * platform/mac/svg/custom/relative-sized-use-on-symbol-expected.txt:
        * platform/mac/svg/custom/relative-sized-use-without-attributes-on-symbol-expected.txt:
        * platform/mac/svg/custom/second-inline-text-expected.txt:
        * platform/mac/svg/dom/SVGPathSegList-segment-modification-expected.txt:
        * platform/mac/svg/hixie/perf/001-expected.txt:
        * platform/mac/svg/hixie/perf/002-expected.txt:
        * platform/mac/svg/text/text-path-01-b-expected.txt:
        * platform/mac/svg/zoom/page/zoom-svg-through-object-with-override-size-expected.txt:
        * svg/custom/control-points-for-S-and-T-expected.txt:
        * svg/custom/use-nested-transform-expected.txt:

2017-06-04  Jonathan Bedard  <jbedard@apple.com>

        Unreviewed test gardening

        Gardening test expectations for layout tests on iOS device. Moving
        expectations for tests which fail on Simulator but pass on device.

        * platform/ios-simulator-wk1/TestExpectations:
        * platform/ios-simulator-wk2/TestExpectations:
        * platform/ios-simulator/TestExpectations:
        * platform/ios-wk1/TestExpectations:
        * platform/ios-wk2/TestExpectations:
        * platform/ios/TestExpectations:

2017-06-04  Chris Dumez  <cdumez@apple.com>

        Implement DOMMatrixReadOnly.transformPoint()
        https://bugs.webkit.org/show_bug.cgi?id=172900

        Reviewed by Simon Fraser.

        * imported/blink/fast/dom/geometry-interfaces-dom-matrix-transformPoint-expected.txt: Added.
        * imported/blink/fast/dom/geometry-interfaces-dom-matrix-transformPoint.html: Added.
        * imported/blink/fast/dom/resources/geometry-interfaces-test-helpers.js: Added.
        Import test coverage from Blink.

2017-06-04  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed GTK+ gardening. Add a few test failure expectations, linking them to
        existing bugs. Update or add GTK+-specific baselines for three tests.

        * platform/gtk/TestExpectations:
        * platform/gtk/accessibility/disabled-controls-not-focusable-expected.txt: Added.
        * platform/gtk/compositing/backing-store-attachment-1-expected.txt: Added.
        * platform/gtk/css1/box_properties/acid_test-expected.txt:

2017-06-03  Chris Dumez  <cdumez@apple.com>

        Implement DOMMatrix's fromFloat32Array / fromFloat64Array & toFloat32Array / toFloat64Array
        https://bugs.webkit.org/show_bug.cgi?id=172898

        Reviewed by Sam Weinig.

        Add layout test coverage.

        * http/wpt/geometry/DOMMatrix-from-to-typed-arrays-expected.txt: Added.
        * http/wpt/geometry/DOMMatrix-from-to-typed-arrays.html: Added.

2017-06-03  Simon Fraser  <simon.fraser@apple.com>

        Implement DOMPointReadOnly.matrixTransform()
        https://bugs.webkit.org/show_bug.cgi?id=172896

        Reviewed by Chris Dumez.

        DOMPoint-003.html should be upstreamed at some point.

        * http/wpt/geometry/DOMPoint-003-expected.txt: Added.
        * http/wpt/geometry/DOMPoint-003.html: Added.

2017-06-03  Jonathan Bedard  <jbedard@apple.com>

        Unreviewed test gardening

        * platform/ios/TestExpectations: Update expectation for tests passing
        after https://bugs.webkit.org/show_bug.cgi?id=139968.

2017-06-03  Yusuke Suzuki  <utatane.tea@gmail.com>

        Script modules should be able to import data urls
        https://bugs.webkit.org/show_bug.cgi?id=171594

        Reviewed by Youenn Fablet.

        * http/tests/security/script-with-dataurl-expected.txt:
        * http/tests/security/script-with-dataurl.html:
        Now, the spec is changed and errors from data: scripts should not be muted.
        https://github.com/whatwg/html/issues/1778

        * js/dom/classic-script-with-data-url-expected.txt: Added.
        * js/dom/classic-script-with-data-url.html: Added.
        * js/dom/modules/module-script-with-data-url-expected.txt: Added.
        * js/dom/modules/module-script-with-data-url.html: Added.

2017-06-03  Jonathan Bedard  <jbedard@apple.com>

        Move css3/flexbox/image-percent-max-height.html failure expectation.
        https://bugs.webkit.org/show_bug.cgi?id=126898

        Unreviewed test gardening

        css3/flexbox/image-percent-max-height.html fails on iOS-simulator,
        but passes on device.

        * platform/ios-simulator/TestExpectations:
        * platform/ios/TestExpectations:

2017-06-03  Chris Dumez  <cdumez@apple.com>

        http/tests/cache/disk-cache/shattered-deduplication.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=172868
        <rdar://problem/31249379>

        Reviewed by Antti Koivisto.

        http/tests/cache/disk-cache/shattered-deduplication.html was flaky due to PDF banner
        fade-in / fade-out animation.

        <rdar://problem/31249379> is fixed for me with the proposed changes.

        * http/tests/cache/disk-cache/shattered-deduplication-expected.html:
        - Wait 1 second before calling notifyDone() to give the PDF as much time to render as
        the test page.
        - Reduce frame height to 30 to not have to worry about the PDF tool banner being visible
          or not (as it fades in and out). 30 is still enough to see the color and confirm the
          test is passing.

        * http/tests/cache/disk-cache/shattered-deduplication.html:
        - Reduce frame height to 30 to not have to worry about the PDF tool banner being visible
          or not (as it fades in and out). 30 is still enough to see the color and confirm the
          test is passing.

2017-06-02  Myles C. Maxfield  <mmaxfield@apple.com>

        REGRESSION(r213464): [iOS] Fonts get too bold when the "Bold Text" accessibility setting is enabled
        https://bugs.webkit.org/show_bug.cgi?id=172737
        <rdar://problem/31608236>

        Reviewed by Simon Fraser.

        * fast/text/accessibility-bold-system-font-2-expected.html: Added.
        * fast/text/accessibility-bold-system-font-2.html: Added.
        * fast/text/accessibility-bold-system-font-expected.txt: Added.
        * fast/text/accessibility-bold-system-font.html: Added.
        * platform/mac/TestExpectations:

2017-06-02  Ryan Haddad  <ryanhaddad@apple.com>

        Mark webrtc/captureCanvas-webrtc.html as flaky on iOS.
        https://bugs.webkit.org/show_bug.cgi?id=170870

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-06-02  Jonathan Bedard  <jbedard@apple.com>

        Move compositing/overflow/dynamic-composited-scrolling-status.html failure expectation.
        https://bugs.webkit.org/show_bug.cgi?id=152439

        Unreviewed test gardening

        compositing/overflow/dynamic-composited-scrolling-status.html fails on iOS-simulator WK2,
        but passes on device.

        * platform/ios-simulator-wk2/TestExpectations:
        * platform/ios-wk2/TestExpectations:

2017-06-02  Ryan Haddad  <ryanhaddad@apple.com>

        Mark webrtc/audio-replace-track.html as flaky on iOS and remove Timeout expectation for macOS.
        https://bugs.webkit.org/show_bug.cgi?id=171895

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:
        * platform/mac-wk2/TestExpectations:

2017-06-02  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream iOS] Cleanup video muting/unmuting when tab visibility changes
        https://bugs.webkit.org/show_bug.cgi?id=172858

        Reviewed by Youenn Fablet.

        * platform/ios/mediastream/video-muted-in-background-tab-expected.txt: Added.
        * platform/ios/mediastream/video-muted-in-background-tab.html: Added.

2017-06-02  Matt Lewis  <jlewis3@apple.com>

        Moved test expectation for http/tests/preload/viewport/meta-viewport-link-headers.php to correct file.
        https://bugs.webkit.org/show_bug.cgi?id=172518

        Unreviewed test gardening

        * platform/ios-simulator/TestExpectations:
        * platform/ios/TestExpectations:

2017-06-02  Chris Dumez  <cdumez@apple.com>

        REGRESSION: LayoutTest fast/scrolling/arrow-key-scroll-in-rtl-document.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=161549
        <rdar://problem/28213429>

        Reviewed by Simon Fraser.

        * fast/scrolling/arrow-key-scroll-in-rtl-document.html:
        Call eventSender.callAfterScrollingCompletes() in the next event loop iteration to
        address the flakiness.

        * platform/mac-wk2/TestExpectations:
        Unskip test.

2017-06-02  Frederic Wang  <fwang@igalia.com>

        [Mac] Include frames in the scrolling tree when ScrollingTreeIncludesFrames=true
        https://bugs.webkit.org/show_bug.cgi?id=172825

        Reviewed by Simon Fraser.

        Add a new test to check whether a non-main frame appears in the scrolling tree when
        ScrollingTreeIncludesFrames=true. For now this is only happens for Mac WK2. Also update
        the iOS WK2 reference for scrolling-iframe-expected.html

        * fast/scrolling/scrolling-tree-includes-frame-expected.txt: Added.
        * fast/scrolling/scrolling-tree-includes-frame.html: Added.
        * platform/ios-simulator/fast/scrolling/scrolling-tree-includes-frame-expected.txt: Added.
        * platform/ios-wk2/compositing/iframes/scrolling-iframe-expected.txt: Update reference.
        * platform/mac-wk1/fast/scrolling/scrolling-tree-includes-frame-expected.txt: Added.

2017-06-02  Frederic Wang  <fwang@igalia.com>

        [Mac] Use compositing for frames when ScrollingTreeIncludesFrames=true
        https://bugs.webkit.org/show_bug.cgi?id=172851

        Reviewed by Simon Fraser.

        This commit adds a test to check whether scrollable iframes require a special composited
        layer when ScrollingTreeIncludesFrames=true. This is currently only done on Mac WK2.

        * compositing/iframes/compositing-for-scrollable-iframe.html: Added. This is a basic test
        printing the layer tree of a page with an iframe.
        * platform/ios-simulator/compositing/iframes/compositing-for-scrollable-iframe-expected.txt: Added.
        * platform/mac/compositing/iframes/compositing-for-scrollable-iframe-expected.txt: Added.
        * platform/mac-wk1/compositing/iframes/compositing-for-scrollable-iframe-expected.txt: Added.

2017-06-02  Andy Estes  <aestes@apple.com>

        [Cocoa] Add a "supportedCountries" property to ApplePayPaymentRequest
        https://bugs.webkit.org/show_bug.cgi?id=172832
        <rdar://problem/30735544>

        Reviewed by Alex Christensen.

        * http/tests/ssl/applepay/ApplePaySessionV3-expected.txt: Added.
        * http/tests/ssl/applepay/ApplePaySessionV3.html: Added.
        * platform/mac-wk2/TestExpectations:

2017-06-02  Devin Rousso  <drousso@apple.com>

        Web Inspector: Should see active Web Sockets when opening Web Inspector
        https://bugs.webkit.org/show_bug.cgi?id=172312

        Reviewed by Joseph Pecoraro.

        Test that WebSockets created before the inspector loads are also tracked.

        * http/tests/websocket/tests/hybi/inspector/before-load-expected.txt: Added.
        * http/tests/websocket/tests/hybi/inspector/before-load.html: Added.
        * http/tests/websocket/tests/hybi/inspector/before-load_wsh.py: Added.
        (web_socket_do_extra_handshake):
        (web_socket_transfer_data):

2017-06-02  Matt Lewis  <jlewis3@apple.com>

        Marked fast/images/slower-decoding-than-animation-image.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172666

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-06-02  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed WPE gardening.

        * platform/wpe/TestExpectations: Add a few test failure expectations.
        * platform/wpe/js/dom/global-constructors-attributes-dedicated-worker-expected.txt: Rebaseline.
        * platform/wpe/js/dom/global-constructors-attributes-expected.txt: Ditto.

2017-06-02  Javier Fernandez  <jfernandez@igalia.com>

        [css-grid] Logical margin incorrectly applied during the tracks sizing algorithm of auto tracks
        https://bugs.webkit.org/show_bug.cgi?id=172836

        Reviewed by Manuel Rego Casasnovas.

        Test to verify different cases of auto-sized tracks and orthogonal items with margins.

        * fast/css-grid-layout/grid-track-sizing-with-margins-and-orthogonal-flows-expected.txt: Added.
        * fast/css-grid-layout/grid-track-sizing-with-margins-and-orthogonal-flows.html: Added.

2017-06-02  Javier Fernandez  <jfernandez@igalia.com>

        [css-grid] Margin wrong applied when stretching an orthogonal item in fixed size track
        https://bugs.webkit.org/show_bug.cgi?id=172590

        Reviewed by Sergio Villar Senin.

        * TestExpectations: 2 tests pass now but 3 more fail because of bug #172836
        * fast/css-grid-layout/grid-item-stretching-must-not-depend-on-previous-layouts-expected.html: Added.
        * fast/css-grid-layout/grid-item-stretching-must-not-depend-on-previous-layouts.html: Added.

2017-06-02  Zan Dobersek  <zdobersek@igalia.com>

        [WPE] Enable SUBTLE_CRYPTO
        https://bugs.webkit.org/show_bug.cgi?id=172756

        Reviewed by Michael Catanzaro.

        * platform/wpe/TestExpectations: Enable tests under crypto/ and
        imported/w3c/web-platform-tests/WebCryptoAPI/ in general, but add
        the test expectations for failing tests under those directories.

2017-06-01  Andreas Kling  <akling@apple.com>

        [Mac] Remove backing store for layers that are outside the viewport
        https://bugs.webkit.org/show_bug.cgi?id=170082
        <rdar://problem/31245009>

        Reviewed by Simon Fraser.

        Add a simple test with two compositing layers far apart vertically. Only one of them
        should have its backing store attached.

        * compositing/backing-store-attachment-1-expected.txt: Added.
        * compositing/backing-store-attachment-1.html: Added.

2017-06-01  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r217691.

        This change broke the Windows build.

        Reverted changeset:

        "Web Inspector: Should see active Web Sockets when opening Web
        Inspector"
        https://bugs.webkit.org/show_bug.cgi?id=172312
        http://trac.webkit.org/changeset/217691

2017-06-01  Devin Rousso  <drousso@apple.com>

        Web Inspector: Should see active Web Sockets when opening Web Inspector
        https://bugs.webkit.org/show_bug.cgi?id=172312

        Reviewed by Joseph Pecoraro.

        Test that WebSockets created before the inspector loads are also tracked.

        * http/tests/websocket/tests/hybi/inspector/before-load-expected.txt: Added.
        * http/tests/websocket/tests/hybi/inspector/before-load.html: Added.
        * http/tests/websocket/tests/hybi/inspector/before-load_wsh.py: Added.
        (web_socket_do_extra_handshake):
        (web_socket_transfer_data):

2017-06-01  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/navigation/statistics.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172454

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:
        * platform/mac-wk2/TestExpectations:

2017-06-01  Matt Lewis  <jlewis3@apple.com>

        Fixed typo in test expectations.
        https://bugs.webkit.org/show_bug.cgi?id=172054

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-06-01  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline webarchive/loading/mainresource-null-mimetype-crash.html after r217680.

        Unreviewed test gardening.

        * webarchive/loading/mainresource-null-mimetype-crash-expected.txt:

2017-06-01  Chris Dumez  <cdumez@apple.com>

        webarchive/loading/mainresource-null-mimetype-crash.html / webarchive/loading/missing-data.html are flaky
        https://bugs.webkit.org/show_bug.cgi?id=172823

        Reviewed by Alexey Proskuryakov.

        Rewrite webarchive/loading/mainresource-null-mimetype-crash.html / webarchive/loading/missing-data.html
        to address flakiness. We now navigate a subframe instead of the main frame. We also mark the test as
        asynchronous and wait for the subframe to finish loading before calling testRunner.notifyDone().

        * platform/mac/webarchive/loading/mainresource-null-mimetype-crash-expected.txt:
        * webarchive/loading/mainresource-null-mimetype-crash.html:
        * webarchive/loading/missing-data-expected.txt:
        * webarchive/loading/missing-data.html:

2017-06-01  Carlos Garcia Campos  <cgarcia@igalia.com>

        [GTK] Bump GTK+ and its dependencies in jhbuild
        https://bugs.webkit.org/show_bug.cgi?id=171918

        Reviewed by Carlos Alberto Lopez Perez.

        Rebaseline tests for new GTK+ version.

        * platform/gtk/css1/box_properties/acid_test-expected.txt:
        * platform/gtk/css2.1/20110323/replaced-elements-001-expected.png:
        * platform/gtk/css2.1/20110323/replaced-elements-001-expected.txt:
        * platform/gtk/css2.1/t09-c5526c-display-00-e-expected.png:
        * platform/gtk/css2.1/t09-c5526c-display-00-e-expected.txt:
        * platform/gtk/css3/flexbox/button-expected.png:
        * platform/gtk/css3/flexbox/button-expected.txt:
        * platform/gtk/css3/selectors3/html/css3-modsel-161-expected.png:
        * platform/gtk/css3/selectors3/html/css3-modsel-161-expected.txt:
        * platform/gtk/css3/selectors3/html/css3-modsel-19b-expected.png:
        * platform/gtk/css3/selectors3/html/css3-modsel-19b-expected.txt:
        * platform/gtk/css3/selectors3/html/css3-modsel-23-expected.png:
        * platform/gtk/css3/selectors3/html/css3-modsel-23-expected.txt:
        * platform/gtk/css3/selectors3/html/css3-modsel-25-expected.png:
        * platform/gtk/css3/selectors3/html/css3-modsel-25-expected.txt:
        * platform/gtk/css3/selectors3/html/css3-modsel-69-expected.png:
        * platform/gtk/css3/selectors3/html/css3-modsel-69-expected.txt:
        * platform/gtk/css3/selectors3/html/css3-modsel-70-expected.png:
        * platform/gtk/css3/selectors3/html/css3-modsel-70-expected.txt:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-161-expected.png:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-161-expected.txt:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-19b-expected.png:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-19b-expected.txt:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-23-expected.png:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-23-expected.txt:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-25-expected.png:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-25-expected.txt:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-69-expected.png:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-69-expected.txt:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-70-expected.png:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-70-expected.txt:
        * platform/gtk/css3/selectors3/xml/css3-modsel-161-expected.png:
        * platform/gtk/css3/selectors3/xml/css3-modsel-161-expected.txt:
        * platform/gtk/css3/selectors3/xml/css3-modsel-19b-expected.png:
        * platform/gtk/css3/selectors3/xml/css3-modsel-19b-expected.txt:
        * platform/gtk/css3/selectors3/xml/css3-modsel-23-expected.png:
        * platform/gtk/css3/selectors3/xml/css3-modsel-23-expected.txt:
        * platform/gtk/css3/selectors3/xml/css3-modsel-25-expected.png:
        * platform/gtk/css3/selectors3/xml/css3-modsel-25-expected.txt:
        * platform/gtk/css3/selectors3/xml/css3-modsel-69-expected.png:
        * platform/gtk/css3/selectors3/xml/css3-modsel-69-expected.txt:
        * platform/gtk/css3/selectors3/xml/css3-modsel-70-expected.png:
        * platform/gtk/css3/selectors3/xml/css3-modsel-70-expected.txt:
        * platform/gtk/editing/pasteboard/4641033-expected.png:
        * platform/gtk/editing/pasteboard/4641033-expected.txt:
        * platform/gtk/editing/pasteboard/4944770-1-expected.png:
        * platform/gtk/editing/pasteboard/4944770-1-expected.txt:
        * platform/gtk/editing/pasteboard/4944770-2-expected.png:
        * platform/gtk/editing/pasteboard/4944770-2-expected.txt:
        * platform/gtk/editing/selection/3690703-2-expected.png:
        * platform/gtk/editing/selection/3690703-2-expected.txt:
        * platform/gtk/editing/selection/3690703-expected.png:
        * platform/gtk/editing/selection/3690703-expected.txt:
        * platform/gtk/editing/selection/3690719-expected.png:
        * platform/gtk/editing/selection/3690719-expected.txt:
        * platform/gtk/editing/selection/4397952-expected.png:
        * platform/gtk/editing/selection/4397952-expected.txt:
        * platform/gtk/editing/selection/5240265-expected.png:
        * platform/gtk/editing/selection/5240265-expected.txt:
        * platform/gtk/editing/selection/caret-before-select-expected.png:
        * platform/gtk/editing/selection/caret-before-select-expected.txt:
        * platform/gtk/editing/selection/replaced-boundaries-3-expected.png:
        * platform/gtk/editing/selection/replaced-boundaries-3-expected.txt:
        * platform/gtk/editing/selection/select-box-expected.png:
        * platform/gtk/editing/selection/select-box-expected.txt:
        * platform/gtk/editing/selection/select-element-paragraph-boundary-expected.png:
        * platform/gtk/editing/selection/select-element-paragraph-boundary-expected.txt:
        * platform/gtk/editing/selection/selection-button-text-expected.png:
        * platform/gtk/editing/selection/selection-button-text-expected.txt:
        * platform/gtk/fast/block/basic/011-expected.png:
        * platform/gtk/fast/block/basic/011-expected.txt:
        * platform/gtk/fast/block/float/float-avoidance-expected.png:
        * platform/gtk/fast/block/float/float-avoidance-expected.txt:
        * platform/gtk/fast/block/margin-collapse/103-expected.png:
        * platform/gtk/fast/block/margin-collapse/103-expected.txt:
        * platform/gtk/fast/block/positioning/inline-block-relposition-expected.png:
        * platform/gtk/fast/block/positioning/inline-block-relposition-expected.txt:
        * platform/gtk/fast/box-sizing/percentage-height-expected.png:
        * platform/gtk/fast/box-sizing/percentage-height-expected.txt:
        * platform/gtk/fast/css/continuationCrash-expected.png:
        * platform/gtk/fast/css/continuationCrash-expected.txt:
        * platform/gtk/fast/css/focus-ring-exists-for-search-field-expected.png:
        * platform/gtk/fast/css/focus-ring-exists-for-search-field-expected.txt:
        * platform/gtk/fast/css/input-search-padding-expected.png:
        * platform/gtk/fast/css/input-search-padding-expected.txt:
        * platform/gtk/fast/css/margin-top-bottom-dynamic-expected.png:
        * platform/gtk/fast/css/margin-top-bottom-dynamic-expected.txt:
        * platform/gtk/fast/css/non-standard-checkbox-size-expected.png:
        * platform/gtk/fast/css/non-standard-checkbox-size-expected.txt:
        * platform/gtk/fast/css/rtl-ordering-expected.png:
        * platform/gtk/fast/css/rtl-ordering-expected.txt:
        * platform/gtk/fast/css/text-input-with-webkit-border-radius-expected.png:
        * platform/gtk/fast/css/text-input-with-webkit-border-radius-expected.txt:
        * platform/gtk/fast/css/text-overflow-input-expected.png:
        * platform/gtk/fast/css/text-overflow-input-expected.txt:
        * platform/gtk/fast/css/text-transform-select-expected.png:
        * platform/gtk/fast/css/text-transform-select-expected.txt:
        * platform/gtk/fast/dom/HTMLInputElement/input-slider-update-expected.png:
        * platform/gtk/fast/dom/HTMLInputElement/input-slider-update-expected.txt:
        * platform/gtk/fast/dom/HTMLProgressElement/indeterminate-progress-001-expected.txt:
        * platform/gtk/fast/dom/HTMLProgressElement/native-progress-bar-expected.png:
        * platform/gtk/fast/dom/HTMLProgressElement/native-progress-bar-expected.txt:
        * platform/gtk/fast/dom/HTMLProgressElement/progress-bar-value-pseudo-element-expected.png:
        * platform/gtk/fast/dom/HTMLProgressElement/progress-bar-value-pseudo-element-expected.txt:
        * platform/gtk/fast/dom/HTMLProgressElement/progress-element-expected.png:
        * platform/gtk/fast/dom/HTMLProgressElement/progress-element-expected.txt:
        * platform/gtk/fast/dom/HTMLTableColElement/resize-table-using-col-width-expected.png:
        * platform/gtk/fast/dom/HTMLTableColElement/resize-table-using-col-width-expected.txt:
        * platform/gtk/fast/dom/HTMLTextAreaElement/reset-textarea-expected.png:
        * platform/gtk/fast/dom/HTMLTextAreaElement/reset-textarea-expected.txt:
        * platform/gtk/fast/dynamic/positioned-movement-with-positioned-children-expected.txt:
        * platform/gtk/fast/forms/001-expected.png:
        * platform/gtk/fast/forms/001-expected.txt:
        * platform/gtk/fast/forms/003-expected.png:
        * platform/gtk/fast/forms/003-expected.txt:
        * platform/gtk/fast/forms/004-expected.png:
        * platform/gtk/fast/forms/004-expected.txt:
        * platform/gtk/fast/forms/basic-buttons-expected.png:
        * platform/gtk/fast/forms/basic-buttons-expected.txt:
        * platform/gtk/fast/forms/basic-inputs-expected.png:
        * platform/gtk/fast/forms/basic-inputs-expected.txt:
        * platform/gtk/fast/forms/basic-selects-expected.png:
        * platform/gtk/fast/forms/basic-selects-expected.txt:
        * platform/gtk/fast/forms/blankbuttons-expected.png:
        * platform/gtk/fast/forms/blankbuttons-expected.txt:
        * platform/gtk/fast/forms/box-shadow-override-expected.png:
        * platform/gtk/fast/forms/box-shadow-override-expected.txt:
        * platform/gtk/fast/forms/button-align-expected.png:
        * platform/gtk/fast/forms/button-align-expected.txt:
        * platform/gtk/fast/forms/button-cannot-be-nested-expected.png:
        * platform/gtk/fast/forms/button-cannot-be-nested-expected.txt:
        * platform/gtk/fast/forms/button-default-title-expected.png:
        * platform/gtk/fast/forms/button-default-title-expected.txt:
        * platform/gtk/fast/forms/button-generated-content-expected.png:
        * platform/gtk/fast/forms/button-generated-content-expected.txt:
        * platform/gtk/fast/forms/button-inner-block-reuse-expected.png:
        * platform/gtk/fast/forms/button-inner-block-reuse-expected.txt:
        * platform/gtk/fast/forms/button-positioned-expected.png:
        * platform/gtk/fast/forms/button-positioned-expected.txt:
        * platform/gtk/fast/forms/button-sizes-expected.png:
        * platform/gtk/fast/forms/button-sizes-expected.txt:
        * platform/gtk/fast/forms/button-style-color-expected.png:
        * platform/gtk/fast/forms/button-style-color-expected.txt:
        * platform/gtk/fast/forms/button-table-styles-expected.png:
        * platform/gtk/fast/forms/button-table-styles-expected.txt:
        * platform/gtk/fast/forms/button-text-transform-expected.png:
        * platform/gtk/fast/forms/button-text-transform-expected.txt:
        * platform/gtk/fast/forms/button-white-space-expected.png:
        * platform/gtk/fast/forms/button-white-space-expected.txt:
        * platform/gtk/fast/forms/control-clip-expected.png:
        * platform/gtk/fast/forms/control-clip-expected.txt:
        * platform/gtk/fast/forms/control-clip-overflow-expected.png:
        * platform/gtk/fast/forms/control-clip-overflow-expected.txt:
        * platform/gtk/fast/forms/control-restrict-line-height-expected.png:
        * platform/gtk/fast/forms/control-restrict-line-height-expected.txt:
        * platform/gtk/fast/forms/disabled-select-change-index-expected.png:
        * platform/gtk/fast/forms/disabled-select-change-index-expected.txt:
        * platform/gtk/fast/forms/file/file-input-direction-expected.png:
        * platform/gtk/fast/forms/file/file-input-direction-expected.txt:
        * platform/gtk/fast/forms/file/file-input-disabled-expected.png:
        * platform/gtk/fast/forms/file/file-input-disabled-expected.txt:
        * platform/gtk/fast/forms/form-element-geometry-expected.png:
        * platform/gtk/fast/forms/form-element-geometry-expected.txt:
        * platform/gtk/fast/forms/formmove-expected.png:
        * platform/gtk/fast/forms/formmove-expected.txt:
        * platform/gtk/fast/forms/formmove2-expected.png:
        * platform/gtk/fast/forms/formmove2-expected.txt:
        * platform/gtk/fast/forms/formmove3-expected.png:
        * platform/gtk/fast/forms/formmove3-expected.txt:
        * platform/gtk/fast/forms/indeterminate-expected.png:
        * platform/gtk/fast/forms/indeterminate-expected.txt:
        * platform/gtk/fast/forms/input-appearance-height-expected.png:
        * platform/gtk/fast/forms/input-appearance-height-expected.txt:
        * platform/gtk/fast/forms/input-button-sizes-expected.png:
        * platform/gtk/fast/forms/input-button-sizes-expected.txt:
        * platform/gtk/fast/forms/input-first-letter-expected.png:
        * platform/gtk/fast/forms/input-first-letter-expected.txt:
        * platform/gtk/fast/forms/input-number-click-expected.txt: Added.
        * platform/gtk/fast/forms/input-value-expected.png:
        * platform/gtk/fast/forms/input-value-expected.txt:
        * platform/gtk/fast/forms/menulist-deselect-update-expected.png:
        * platform/gtk/fast/forms/menulist-deselect-update-expected.txt:
        * platform/gtk/fast/forms/menulist-narrow-width-expected.png:
        * platform/gtk/fast/forms/menulist-narrow-width-expected.txt:
        * platform/gtk/fast/forms/menulist-no-overflow-expected.png:
        * platform/gtk/fast/forms/menulist-no-overflow-expected.txt:
        * platform/gtk/fast/forms/menulist-restrict-line-height-expected.png:
        * platform/gtk/fast/forms/menulist-restrict-line-height-expected.txt:
        * platform/gtk/fast/forms/menulist-separator-painting-expected.png:
        * platform/gtk/fast/forms/menulist-separator-painting-expected.txt:
        * platform/gtk/fast/forms/menulist-style-color-expected.png:
        * platform/gtk/fast/forms/menulist-style-color-expected.txt:
        * platform/gtk/fast/forms/menulist-width-change-expected.png:
        * platform/gtk/fast/forms/menulist-width-change-expected.txt:
        * platform/gtk/fast/forms/number/number-appearance-rtl-expected.png:
        * platform/gtk/fast/forms/number/number-appearance-rtl-expected.txt:
        * platform/gtk/fast/forms/number/number-appearance-spinbutton-disabled-readonly-expected.png:
        * platform/gtk/fast/forms/number/number-appearance-spinbutton-disabled-readonly-expected.txt:
        * platform/gtk/fast/forms/number/number-appearance-spinbutton-layer-expected.png:
        * platform/gtk/fast/forms/number/number-appearance-spinbutton-layer-expected.txt:
        * platform/gtk/fast/forms/number/number-spinbutton-change-and-input-events-expected.txt: Added.
        * platform/gtk/fast/forms/number/number-spinbutton-click-in-iframe-expected.txt: Added.
        * platform/gtk/fast/forms/number/number-spinbutton-gets-disabled-or-readonly-expected.txt: Added.
        * platform/gtk/fast/forms/option-script-expected.png:
        * platform/gtk/fast/forms/option-script-expected.txt:
        * platform/gtk/fast/forms/option-strip-whitespace-expected.png:
        * platform/gtk/fast/forms/option-strip-whitespace-expected.txt:
        * platform/gtk/fast/forms/option-text-clip-expected.png:
        * platform/gtk/fast/forms/option-text-clip-expected.txt:
        * platform/gtk/fast/forms/placeholder-position-expected.png:
        * platform/gtk/fast/forms/placeholder-position-expected.txt:
        * platform/gtk/fast/forms/placeholder-pseudo-style-expected.png:
        * platform/gtk/fast/forms/placeholder-pseudo-style-expected.txt:
        * platform/gtk/fast/forms/range/input-appearance-range-expected.png:
        * platform/gtk/fast/forms/range/input-appearance-range-expected.txt:
        * platform/gtk/fast/forms/range/slider-padding-expected.png:
        * platform/gtk/fast/forms/range/slider-padding-expected.txt:
        * platform/gtk/fast/forms/range/slider-thumb-shared-style-expected.png:
        * platform/gtk/fast/forms/range/slider-thumb-shared-style-expected.txt:
        * platform/gtk/fast/forms/range/slider-transformed-expected.txt:
        * platform/gtk/fast/forms/range/thumbslider-no-parent-slider-expected.png:
        * platform/gtk/fast/forms/range/thumbslider-no-parent-slider-expected.txt:
        * platform/gtk/fast/forms/search-cancel-button-style-sharing-expected.png:
        * platform/gtk/fast/forms/search-cancel-button-style-sharing-expected.txt:
        * platform/gtk/fast/forms/search-display-none-cancel-button-expected.png:
        * platform/gtk/fast/forms/search-display-none-cancel-button-expected.txt:
        * platform/gtk/fast/forms/search-input-rtl-expected.png:
        * platform/gtk/fast/forms/search-input-rtl-expected.txt: Added.
        * platform/gtk/fast/forms/search-rtl-expected.png:
        * platform/gtk/fast/forms/search-rtl-expected.txt:
        * platform/gtk/fast/forms/search-styled-expected.png:
        * platform/gtk/fast/forms/search-styled-expected.txt:
        * platform/gtk/fast/forms/search/search-size-with-decorations-expected.png:
        * platform/gtk/fast/forms/search/search-size-with-decorations-expected.txt:
        * platform/gtk/fast/forms/searchfield-heights-expected.png:
        * platform/gtk/fast/forms/searchfield-heights-expected.txt:
        * platform/gtk/fast/forms/select-align-expected.png:
        * platform/gtk/fast/forms/select-align-expected.txt:
        * platform/gtk/fast/forms/select-background-none-expected.png:
        * platform/gtk/fast/forms/select-background-none-expected.txt:
        * platform/gtk/fast/forms/select-baseline-expected.png:
        * platform/gtk/fast/forms/select-baseline-expected.txt:
        * platform/gtk/fast/forms/select-change-listbox-to-popup-expected.png:
        * platform/gtk/fast/forms/select-change-listbox-to-popup-expected.txt:
        * platform/gtk/fast/forms/select-dirty-parent-pref-widths-expected.png:
        * platform/gtk/fast/forms/select-dirty-parent-pref-widths-expected.txt:
        * platform/gtk/fast/forms/select-disabled-appearance-expected.png:
        * platform/gtk/fast/forms/select-disabled-appearance-expected.txt:
        * platform/gtk/fast/forms/select-element-focus-ring-expected.png: Added.
        * platform/gtk/fast/forms/select-element-focus-ring-expected.txt:
        * platform/gtk/fast/forms/select-initial-position-expected.png:
        * platform/gtk/fast/forms/select-initial-position-expected.txt:
        * platform/gtk/fast/forms/select-non-native-rendering-direction-expected.png: Added.
        * platform/gtk/fast/forms/select-non-native-rendering-direction-expected.txt: Added.
        * platform/gtk/fast/forms/select-selected-expected.png:
        * platform/gtk/fast/forms/select-selected-expected.txt:
        * platform/gtk/fast/forms/select-style-expected.png:
        * platform/gtk/fast/forms/select-style-expected.txt:
        * platform/gtk/fast/forms/select-visual-hebrew-expected.png:
        * platform/gtk/fast/forms/select-visual-hebrew-expected.txt:
        * platform/gtk/fast/forms/select-writing-direction-natural-expected.png:
        * platform/gtk/fast/forms/select-writing-direction-natural-expected.txt:
        * platform/gtk/fast/forms/select/optgroup-rendering-expected.png:
        * platform/gtk/fast/forms/select/optgroup-rendering-expected.txt:
        * platform/gtk/fast/forms/selectlist-minsize-expected.png:
        * platform/gtk/fast/forms/selectlist-minsize-expected.txt:
        * platform/gtk/fast/forms/stuff-on-my-optgroup-expected.png:
        * platform/gtk/fast/forms/stuff-on-my-optgroup-expected.txt:
        * platform/gtk/fast/forms/targeted-frame-submission-expected.png:
        * platform/gtk/fast/forms/targeted-frame-submission-expected.txt:
        * platform/gtk/fast/forms/validation-message-appearance-expected.png:
        * platform/gtk/fast/forms/validation-message-appearance-expected.txt:
        * platform/gtk/fast/html/details-replace-summary-child-expected.png:
        * platform/gtk/fast/html/details-replace-summary-child-expected.txt:
        * platform/gtk/fast/html/details-replace-text-expected.png:
        * platform/gtk/fast/html/details-replace-text-expected.txt:
        * platform/gtk/fast/html/keygen-expected.png:
        * platform/gtk/fast/html/keygen-expected.txt:
        * platform/gtk/fast/inline/positionedLifetime-expected.png:
        * platform/gtk/fast/inline/positionedLifetime-expected.txt:
        * platform/gtk/fast/invalid/014-expected.png:
        * platform/gtk/fast/invalid/014-expected.txt:
        * platform/gtk/fast/overflow/scroll-nested-positioned-layer-in-overflow-expected.png:
        * platform/gtk/fast/overflow/scroll-nested-positioned-layer-in-overflow-expected.txt:
        * platform/gtk/fast/overflow/scrollRevealButton-expected.png:
        * platform/gtk/fast/overflow/scrollRevealButton-expected.txt:
        * platform/gtk/fast/parser/bad-xml-slash-expected.png:
        * platform/gtk/fast/parser/bad-xml-slash-expected.txt:
        * platform/gtk/fast/parser/document-write-option-expected.png:
        * platform/gtk/fast/parser/document-write-option-expected.txt:
        * platform/gtk/fast/repaint/search-field-cancel-expected.png:
        * platform/gtk/fast/repaint/search-field-cancel-expected.txt:
        * platform/gtk/fast/repaint/slider-thumb-drag-release-expected.png:
        * platform/gtk/fast/repaint/slider-thumb-drag-release-expected.txt:
        * platform/gtk/fast/replaced/replaced-breaking-expected.png:
        * platform/gtk/fast/replaced/replaced-breaking-expected.txt:
        * platform/gtk/fast/replaced/replaced-breaking-mixture-expected.png:
        * platform/gtk/fast/replaced/replaced-breaking-mixture-expected.txt:
        * platform/gtk/fast/replaced/three-selects-break-expected.png:
        * platform/gtk/fast/replaced/three-selects-break-expected.txt:
        * platform/gtk/fast/replaced/width100percent-button-expected.png:
        * platform/gtk/fast/replaced/width100percent-button-expected.txt:
        * platform/gtk/fast/replaced/width100percent-menulist-expected.png:
        * platform/gtk/fast/replaced/width100percent-menulist-expected.txt:
        * platform/gtk/fast/replaced/width100percent-searchfield-expected.png:
        * platform/gtk/fast/replaced/width100percent-searchfield-expected.txt:
        * platform/gtk/fast/scrolling/overflow-scrollable-after-back-expected.txt: Added.
        * platform/gtk/fast/table/append-cells2-expected.png:
        * platform/gtk/fast/table/append-cells2-expected.txt:
        * platform/gtk/fast/table/remove-td-display-none-expected.png:
        * platform/gtk/fast/table/remove-td-display-none-expected.txt:
        * platform/gtk/fast/text/international/bidi-menulist-expected.png:
        * platform/gtk/fast/text/international/bidi-menulist-expected.txt:
        * platform/gtk/fast/text/international/hindi-spacing-expected.png:
        * platform/gtk/fast/text/international/hindi-spacing-expected.txt:
        * platform/gtk/fast/text/international/pop-up-button-text-alignment-and-direction-expected.png:
        * platform/gtk/fast/text/international/pop-up-button-text-alignment-and-direction-expected.txt:
        * platform/gtk/fast/text/textIteratorNilRenderer-expected.png:
        * platform/gtk/fast/text/textIteratorNilRenderer-expected.txt:
        * platform/gtk/fast/text/whitespace/normal-after-nowrap-breaking-expected.png:
        * platform/gtk/fast/text/whitespace/normal-after-nowrap-breaking-expected.txt:
        * platform/gtk/http/tests/navigation/javascriptlink-frames-expected.png:
        * platform/gtk/http/tests/navigation/javascriptlink-frames-expected.txt:
        * platform/gtk/svg/custom/foreign-object-skew-expected.png:
        * platform/gtk/svg/custom/foreign-object-skew-expected.txt:
        * platform/gtk/svg/custom/inline-svg-in-xhtml-expected.png:
        * platform/gtk/svg/custom/inline-svg-in-xhtml-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug1188-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug1188-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug1318-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug1318-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug138725-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug138725-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug18359-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug18359-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug2479-2-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug2479-2-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug2479-3-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug2479-3-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug2479-4-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug26178-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug26178-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug28928-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug28928-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug29326-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug29326-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug33855-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug33855-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug39209-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug39209-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug4382-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug4382-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug4429-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug4429-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug44505-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug44505-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug4527-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug4527-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug46368-1-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug46368-1-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug46368-2-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug46368-2-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug51037-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug51037-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug51727-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug51727-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug52505-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug52505-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug52506-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug52506-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug60749-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug60749-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug68912-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug68912-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug7342-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug7342-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug92647-2-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug92647-2-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug96334-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug96334-expected.txt:
        * platform/gtk/tables/mozilla/collapsing_borders/bug41262-4-expected.png:
        * platform/gtk/tables/mozilla/collapsing_borders/bug41262-4-expected.txt:
        * platform/gtk/tables/mozilla/core/margins-expected.png:
        * platform/gtk/tables/mozilla/core/margins-expected.txt:
        * platform/gtk/tables/mozilla/dom/tableDom-expected.png:
        * platform/gtk/tables/mozilla/dom/tableDom-expected.txt:
        * platform/gtk/tables/mozilla/other/move_row-expected.png:
        * platform/gtk/tables/mozilla/other/move_row-expected.txt:
        * platform/gtk/tables/mozilla_expected_failures/bugs/bug1725-expected.png:
        * platform/gtk/tables/mozilla_expected_failures/bugs/bug1725-expected.txt:
        * platform/gtk/tables/mozilla_expected_failures/bugs/bug2479-5-expected.png:
        * platform/gtk/tables/mozilla_expected_failures/bugs/bug2479-5-expected.txt:
        * platform/gtk/tables/mozilla_expected_failures/bugs/bug58402-2-expected.png:
        * platform/gtk/tables/mozilla_expected_failures/bugs/bug58402-2-expected.txt:
        * platform/gtk/tables/mozilla_expected_failures/collapsing_borders/bug41262-5-expected.png:
        * platform/gtk/tables/mozilla_expected_failures/collapsing_borders/bug41262-5-expected.txt:
        * platform/gtk/tables/mozilla_expected_failures/collapsing_borders/bug41262-6-expected.png:
        * platform/gtk/tables/mozilla_expected_failures/collapsing_borders/bug41262-6-expected.txt:
        * platform/gtk/tables/mozilla_expected_failures/core/captions1-expected.png:
        * platform/gtk/tables/mozilla_expected_failures/core/captions1-expected.txt:
        * platform/gtk/tables/mozilla_expected_failures/core/captions2-expected.png:
        * platform/gtk/tables/mozilla_expected_failures/core/captions2-expected.txt:
        * platform/gtk/transforms/2d/zoom-menulist-expected.png:
        * platform/gtk/transforms/2d/zoom-menulist-expected.txt:

2017-06-01  Ryan Haddad  <ryanhaddad@apple.com>

        Mark two webrtc tests as flaky.

        Unreviewed test gardening.

        * TestExpectations:

2017-06-01  Matt Lewis  <jlewis3@apple.com>

        Adjusted loader/stateobjects/replacestate-size-iframe.html Test Expectations.
        https://bugs.webkit.org/show_bug.cgi?id=172054

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-06-01  Matt Lewis  <jlewis3@apple.com>

        Marked loader/stateobjects/replacestate-size-iframe.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172054

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-06-01  Antoine Quint  <graouts@apple.com>

        Rebaseline two media/modern-media-controls/macos-fullscreen-media-controls tests
        https://bugs.webkit.org/show_bug.cgi?id=172810

        Reviewed by Antoine Quint.

        We need to rebaseline a couple of tests to account for the width change for the left button container in fullscreen.

        * media/modern-media-controls/macos-fullscreen-media-controls/macos-fullscreen-media-controls-drag-is-prevented-over-button-expected.txt:
        * media/modern-media-controls/macos-fullscreen-media-controls/macos-fullscreen-media-controls-drag-is-prevented-over-button.html:
        * media/modern-media-controls/macos-fullscreen-media-controls/macos-fullscreen-media-controls-drag-expected.txt:
        * media/modern-media-controls/macos-fullscreen-media-controls/macos-fullscreen-media-controls-drag.html:

2017-06-01  Miguel Gomez  <magomez@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of several tests failing after r217651.

        * platform/gtk/TestExpectations:

2017-06-01  Antoine Quint  <graouts@apple.com>

        Remove media/modern-media-controls/ios-inline-media-controls/ios-inline-media-controls-audio-background.html
        https://bugs.webkit.org/show_bug.cgi?id=172808

        Reviewed by Antoine Quint.

        This test no longer applies, there is no iOS-specific styling for <audio> elements anymore.

        * media/modern-media-controls/ios-inline-media-controls/ios-inline-media-controls-audio-background.html: Removed.
        * media/modern-media-controls/ios-inline-media-controls/ios-inline-media-controls-audio-background-expected.txt: Removed.

2017-06-01  Ryan Haddad  <ryanhaddad@apple.com>

        Mark imported/w3c/web-platform-tests/css/selectors4/focus-display-none-001.html and focus-within-display-none-001.html as flaky failures
        https://bugs.webkit.org/show_bug.cgi?id=172807

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-06-01  Antoine Quint  <graouts@apple.com>

        Rebaseline media/modern-media-controls/audio/audio-controls-metrics.html
        https://bugs.webkit.org/show_bug.cgi?id=172715

        Reviewed by Antoine Quint.

        We update the expectations for <audio> metrics to match the latest implementation.

        * media/modern-media-controls/audio/audio-controls-metrics-expected.txt:
        * media/modern-media-controls/audio/audio-controls-metrics.html:

2017-06-01  Yusuke Suzuki  <utatane.tea@gmail.com>

        Unreviewed, rebaseline test results according to the error message change
        https://bugs.webkit.org/show_bug.cgi?id=172798

        * js/dom/string-prototype-properties-expected.txt:
        * sputnik/Conformance/15_Native_Objects/15.5_String/15.5.4/15.5.4.6_String.prototype.concat/S15.5.4.6_A1_T3-expected.txt:

2017-05-31  Chris Dumez  <cdumez@apple.com>

        Flaky Test: http/tests/misc/acid3.html
        https://bugs.webkit.org/show_bug.cgi?id=165734
        <rdar://problem/32249821>

        Reviewed by Simon Fraser.

        Increase internal test timeout from 5 seconds to 10 seconds to reduce
        flakiness.

        * http/tests/misc/acid3.html:

2017-05-31  Ryan Haddad  <ryanhaddad@apple.com>

        Skip http/tests/cache/cancel-during-revalidation-succeeded.html on ios-wk2.
        https://bugs.webkit.org/show_bug.cgi?id=172772

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-31  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/css/target-fragment-match.html as flaky on iOS.
        https://bugs.webkit.org/show_bug.cgi?id=168239

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-05-31  Youenn Fablet  <youenn@apple.com>

        PeerConnection should respect tracks that are muted at the time they are added
        https://bugs.webkit.org/show_bug.cgi?id=172771

        Reviewed by Eric Carlson.

        * webrtc/audio-replace-track.html:
        * webrtc/peer-connection-audio-unmute-expected.txt: Added.
        * webrtc/peer-connection-audio-unmute.html: Added.
        * webrtc/routines.js:
        * webrtc/video-unmute-expected.txt: Added.
        * webrtc/video-unmute.html: Added.

2017-05-31  Antti Koivisto  <antti@apple.com>

        CrashTracer: Regression : com.apple.WebKit.WebContent at STP responsible :: com.apple.WebCore: WebCore::SharedBuffer::data const + 11
        https://bugs.webkit.org/show_bug.cgi?id=172747
        <rdar://problem/32275314>

        Reviewed by Andreas Kling.

        * http/tests/css/empty-stylesheet-integrity-crash-expected.txt: Added.
        * http/tests/css/empty-stylesheet-integrity-crash.html: Added.

2017-05-31  Matt Lewis  <jlewis3@apple.com>

        Marked http/tests/preload/viewport/meta-viewport-link-headers.php as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172518

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-05-31  Brent Fulgham  <bfulgham@apple.com>

        Make ResourceLoadStatistics testing more reliable
        https://bugs.webkit.org/show_bug.cgi?id=172730
        <rdar://problem/32028373>

        Reviewed by Andy Estes.

        Revise some of the tests to wait to check state until after the background process has finished processing the
        load information.

        * http/tests/loading/resourceLoadStatistics/classify-as-non-prevalent-based-on-mixed-statistics.html:
        * http/tests/loading/resourceLoadStatistics/classify-as-non-prevalent-based-on-sub-frame-under-top-frame-origins.html:
        * http/tests/loading/resourceLoadStatistics/classify-as-non-prevalent-based-on-subresource-under-top-frame-origins.html:
        * http/tests/loading/resourceLoadStatistics/classify-as-non-prevalent-based-on-subresource-unique-redirects-to.html:
        * http/tests/loading/resourceLoadStatistics/classify-as-prevalent-based-on-mixed-statistics.html:
        * http/tests/loading/resourceLoadStatistics/classify-as-prevalent-based-on-sub-frame-under-top-frame-origins.html:
        * http/tests/loading/resourceLoadStatistics/classify-as-prevalent-based-on-subresource-under-top-frame-origins.html:
        * http/tests/loading/resourceLoadStatistics/classify-as-prevalent-based-on-subresource-unique-redirects-to.html:
        * http/tests/loading/resourceLoadStatistics/clear-in-memory-and-persistent-store-one-hour.html:
        * http/tests/loading/resourceLoadStatistics/clear-in-memory-and-persistent-store.html:
        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-with-partitioning-timeout.html:
        * http/tests/loading/resourceLoadStatistics/partitioned-cookies-with-and-without-user-interaction.html:

2017-05-31  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] More CSS test expectations cleanup

        Unreviewed gardening.

        * platform/wpe/TestExpectations: remove more assorted css tests
        that are actually passing.

2017-05-31  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] CSS tests expectations cleanup

        Unreviewed gardening.

        * platform/wpe/TestExpectations: Remove a bunch of css 2.1 and 3
        tests that are actually passing and a recently removed css tests
        directory.

2017-05-31  Claudio Saavedra  <csaavedra@igalia.com>

        [GTK][WPE] Mark js/cached-window-properties test as slow

        Unreviewed gardening.
        * platform/gtk/TestExpectations: Test was marked as flaky; but
        it's just slow.
        * platform/wpe/TestExpectations: Mark as slow.

2017-05-31  Carlos Alberto Lopez Perez  <clopez@igalia.com>

        [GTK] Upgrade the WebKitGTK+ bots to Debian 9

        This commit only adds a comment that it will be useful to mark
        the point where they where upgraded, so if there is some
        performance change on perf.webkit.org it can be pointed to this.

        Unreviewed.

        * platform/gtk/TestExpectations: Add a note regarding which
        distribution and version is running on the bots.

2017-05-31  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] WebGL expectations cleanup

        Unreviewed gardening.

        * platform/wpe/TestExpectations: Remove webgl tests that are
        consistently passing. Also mark a few known slow tests as such.

2017-05-31  Manuel Rego Casasnovas  <rego@igalia.com>

        Move css-shapes-1 test suite to WPT
        https://bugs.webkit.org/show_bug.cgi?id=172537

        Reviewed by Youenn Fablet.

        Updated the paths in TestExpectations files.
        Marked spec-examples/shape-outside-018.html as flaky.

        * TestExpectations:
        * platform/gtk/TestExpectations:
        * platform/ios/TestExpectations:
        * platform/win/TestExpectations:

2017-05-30  Frederic Wang  <fwang@igalia.com>

        Include ScrollingTreeScrollingNode properties in ScrollingTreeFrameScrollingNode::dumpProperties
        https://bugs.webkit.org/show_bug.cgi?id=172287

        Reviewed by Simon Fraser.

        Update iOS expectation to include the new node properties.

        * scrollingcoordinator/ios/ui-scrolling-tree-expected.txt: Update expectation.

2017-05-30  Tim Horton  <timothy_horton@apple.com>

        Keyboard autocorrections do not apply with an active selection (but keyboard acts like they did)
        https://bugs.webkit.org/show_bug.cgi?id=172735
        <rdar://problem/32015977>

        Reviewed by Enrica Casucci.

        * fast/events/ios/autocorrect-with-range-selection-expected.txt: Added.
        * fast/events/ios/autocorrect-with-range-selection.html: Added.
        Add a test that ensures that autocorrection with a selection succeeds.

2017-05-30  Sam Weinig  <sam@webkit.org>

        [WebIDL] Generate named property deleters
        https://bugs.webkit.org/show_bug.cgi?id=172688

        Reviewed by Chris Dumez.

        * js/dom/named-property-deleter-expected.txt: Added.
        * js/dom/named-property-deleter.html: Added.
        Add test for various named deleter conditions.

        * storage/domstorage/localstorage/delete-defineproperty-removal-expected.txt:
        * storage/domstorage/localstorage/delete-defineproperty-removal.html:
        Update test to log more information about what its doing and log it to the DOM rather
        than the console, to make comparing results in browsers easier. Also, note in the
        bug that the results are wrong, and have been wrong, due to https://webkit.org/b/172687.

2017-05-30  Youenn Fablet  <youenn@apple.com>

        Add support for Certificate and IceCandidatePair stats
        https://bugs.webkit.org/show_bug.cgi?id=172734

        Reviewed by Geoff Garen.

        * webrtc/video-stats.html:

2017-05-30  Chris Dumez  <cdumez@apple.com>

        REGRESSION(r215946): Can't reference a table cell in Google spreadsheet
        https://bugs.webkit.org/show_bug.cgi?id=172703
        <rdar://problem/32458086>

        Reviewed by Ryosuke Niwa.

        Update existing tests to reflect behavior change.

        * fast/dom/Element/getClientRects-return-type-expected.txt:
        * fast/dom/Element/getClientRects-return-type.html:
        * fast/dom/Range/getBoundingClientRect-getClientRects-return-type-expected.txt:
        * fast/dom/Range/getBoundingClientRect-getClientRects-return-type.html:

2017-05-30  Javier Fernandez  <jfernandez@igalia.com>

        [css-align] Import W3C web platform tests for the CSS Box Alignment feature
        https://bugs.webkit.org/show_bug.cgi?id=172705

        Reviewed by Manuel Rego Casasnovas.

        * TestExpectations: Mark as failure a few tests due to bug #172707.

2017-05-30  Ali Juma  <ajuma@chromium.org>

        [CredentialManagement] Incorporate IDL updates from latest spec
        https://bugs.webkit.org/show_bug.cgi?id=172011

        Reviewed by Daniel Bates.

        * credentials/idlharness-expected.txt:
        * credentials/idlharness.html:

2017-05-30  Ryan Haddad  <ryanhaddad@apple.com>

        Skip imported/w3c/web-platform-tests/innerText/getter.html.
        https://bugs.webkit.org/show_bug.cgi?id=172514

        Unreviewed test gardening.

        * TestExpectations:

2017-05-30  Said Abou-Hallawa  <sabouhallawa@apple.com>

        REGRESSION(r216882): No image decoding is needed if the BitmapImage is created with a NativeImage
        https://bugs.webkit.org/show_bug.cgi?id=172670

        Reviewed by Tim Horton.

        Use the css property -webkit-canvas to force capturing the canvas context
        in a NativeImage. This NativeImage will be used to create a BitmapImage
        which will be later used as the background-image of an element.

        * fast/images/large-image-webkit-canvas-expected.html: Added.
        * fast/images/large-image-webkit-canvas.html: Added.

2017-05-30  Matt Lewis  <jlewis3@apple.com>

        Changed Text Expectations of imported/blink/storage/indexeddb/blob-valid-after-deletion.html
        https://bugs.webkit.org/show_bug.cgi?id=172403

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-05-30  Youenn Fablet  <youenn@apple.com>

        RealtimeOutgoingVideoSource should not rotate muted frames
        https://bugs.webkit.org/show_bug.cgi?id=172659

        Reviewed by Eric Carlson.

        * webrtc/routines.js:
        * webrtc/video-rotation-expected.txt: Added.
        * webrtc/video-rotation.html: Added.

2017-05-30  Ryan Haddad  <ryanhaddad@apple.com>

        Mark js/intl-datetimeformat.html as failing.
        https://bugs.webkit.org/show_bug.cgi?id=172720

        Unreviewed test gardening.

        * js/script-tests/intl-datetimeformat.js:
        * platform/mac/TestExpectations:

2017-05-30  Per Arne Vollan  <pvollan@apple.com>

        [Win] fast/shadow-dom/fullscreen-in-slot-fullscreenElement.html is flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172709

        Reviewed by Brent Fulgham.

        * platform/win/TestExpectations:

2017-05-30  Adrian Perez de Castro  <aperez@igalia.com>

        [GTK] Test cases for typehead in form menu lists should start from known state
        https://bugs.webkit.org/show_bug.cgi?id=171792

        Reviewed by Carlos Garcia Campos.

        Since r215188 opening a popup menu in a form pre-selects the active
        element to mimic GtkComboxBox behavior, but the layout test implicitly
        assumed that type ahead search always started the beginning of the
        list, which is no longer true now that GTK+ is informed of which one
        is the active element.

        * platform/gtk/fast/forms/menulist-typeahead-find.html: Reset menu
        list to the initial state (no element selected, unfocused) at the
        beginning of testTypeAheadFunction().

2017-05-29  Antti Koivisto  <antti@apple.com>

        Crash on display-contents-replaced-001.html
        https://bugs.webkit.org/show_bug.cgi?id=172596

        Reviewed by Andreas Kling.

        * TestExpectations: Enable the test.

2017-05-30  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] RSA-OAEP support
        https://bugs.webkit.org/show_bug.cgi?id=171222

        Reviewed by Michael Catanzaro.

        * platform/gtk/TestExpectations: Enable the RSA-OAEP layout tests that we pass.

2017-05-30  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] RSAES-PKCS1-v1_5 support
        https://bugs.webkit.org/show_bug.cgi?id=171219

        Reviewed by Michael Catanzaro.

        * platform/gtk/TestExpectations: Enable the RSAES-PKCS1-v1_5 layout tests that we pass.

2017-05-30  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] RSASSA-PKCS1-v1_5 support
        https://bugs.webkit.org/show_bug.cgi?id=171220

        Reviewed by Michael Catanzaro.

        * platform/gtk/TestExpectations: Enable the RSASSA-PKCS1-v1_5 layout tests that we pass.

2017-05-29  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Mark a couple of tests as slow/timing out

        Unreviewed gardening. These are all known ones.
        * platform/wpe/TestExpectations:

2017-05-29  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Marking workers/bomb.html test as slow.

        Unreviewed gardening.

        * platform/wpe/TestExpectations:

2017-05-29  Emilio Cobos Álvarez  <ecobos@igalia.com>

        Use the parent box style to adjust RenderStyle for alignment.
        https://bugs.webkit.org/show_bug.cgi?id=172215

        Reviewed by Antti Koivisto.

        * TestExpectations:

2017-05-29  Per Arne Vollan  <pvollan@apple.com>

        Unreviewed Windows test gardening, update expected results after r217418.

        * platform/win/fast/block/float/032-expected.txt:

2017-05-29  Per Arne Vollan  <pvollan@apple.com>

        Unreviewed Windows test gardening, update expected results after r217418.

        * platform/win/fast/forms/input-appearance-spinbutton-expected.txt:
        * platform/win/fast/forms/input-appearance-spinbutton-up-expected.txt:
        * platform/win/fast/forms/number/number-appearance-rtl-expected.txt:
        * platform/win/fast/forms/number/number-appearance-spinbutton-disabled-readonly-expected.txt:
        * platform/win/fast/forms/number/number-appearance-spinbutton-layer-expected.txt:
        * platform/win/fast/forms/search-vertical-alignment-expected.txt:

2017-05-28  Sam Weinig  <sam@webkit.org>

        [WebIDL] @@iterator should only be accessed once when disambiguating a union type
        https://bugs.webkit.org/show_bug.cgi?id=172684

        Reviewed by Yusuke Suzuki.

        * js/dom/sequence-in-union-iterator-access-expected.txt: Added.
        * js/dom/sequence-in-union-iterator-access.html: Added.
        Add test case showing that @@iterator is only accessed once when converting a sequence
        as part of a union.

2017-05-27  Chris Dumez  <cdumez@apple.com>

        imported/w3c/web-platform-tests/html/semantics/forms/form-control-infrastructure/form_attribute.html is crashing
        https://bugs.webkit.org/show_bug.cgi?id=172472
        <rdar://problem/32334831>

        Reviewed by Ryosuke Niwa.

        * TestExpectations:
        Unskip test that is no longer crashing in Debug builds.

        * fast/dom/HTMLFormElement/form-removal-duplicate-id-crash-expected.txt: Added.
        * fast/dom/HTMLFormElement/form-removal-duplicate-id-crash.html: Added.
        Add reduced test case reproducing the crash.

2017-05-27  Simon Fraser  <simon.fraser@apple.com>

        getComputedStyle returns percentage values for left / right / top / bottom
        https://bugs.webkit.org/show_bug.cgi?id=29084

        Reviewed by Zalan Bujtas.

        Some new baselines, a new test, and an improved test.

        * animations/trigger-container-scroll-boundaries-expected.txt:
        * animations/trigger-container-scroll-boundaries.html:
        * animations/trigger-container-scroll-empty-expected.txt:
        * animations/trigger-container-scroll-empty.html:
        * animations/trigger-container-scroll-simple-expected.txt:
        * animations/trigger-container-scroll-simple.html:
        * fast/css/getComputedStyle/computed-style-expected.txt:
        * fast/css/getComputedStyle/computed-style-negative-top-expected.txt:
        * fast/css/getComputedStyle/computed-style-negative-top.html: Convert to a real JS test, add more cases.
        * fast/css/getComputedStyle/getComputedStyle-offsets-expected.txt: Added.
        * fast/css/getComputedStyle/getComputedStyle-offsets.html: Added.
        * fast/css/getComputedStyle/getComputedStyle-zoom-and-background-size-expected.txt:
        * fast/css/getComputedStyle/getComputedStyle-zoom-and-background-size.html:  It doesn't make any sense to test right/bottom.
        * fast/css/hover-affects-child-expected.txt:
        * fast/css/hover-affects-child.html:
        * platform/mac-elcapitan/fast/css/getComputedStyle/computed-style-expected.txt:
        * transitions/transition-to-from-auto-expected.txt:
        * transitions/transition-to-from-auto.html:

2017-05-26  Youenn Fablet  <youenn@apple.com>

        WebRTC stats should be in milliseconds
        https://bugs.webkit.org/show_bug.cgi?id=172644

        Reviewed by Eric Carlson.

        * TestExpectations:
        * webrtc/video-stats.html: Making it less flaky prone.

2017-05-26  Sam Weinig  <sam@webkit.org>

        [WebIDL] Overloaded functions should throw this object check exception before argument check exception
        https://bugs.webkit.org/show_bug.cgi?id=172480

        Reviewed by Chris Dumez.

        Add test case that shows that using the wrong this object on an overloaded function,
        even if you are passing the wrong number of arguments, results in an invalid this
        object exception.

        * js/dom/overloaded-operation-exception-order-expected.txt: Added.
        * js/dom/overloaded-operation-exception-order.html: Added.

2017-05-26  Ryan Haddad  <ryanhaddad@apple.com>

        Skip fast/events/before-unload-returnValue.html on iOS.
        https://bugs.webkit.org/show_bug.cgi?id=172672

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-05-26  Ryan Haddad  <ryanhaddad@apple.com>

        Mark workers/wasm-long-compile-many.html as flaky on mac-wk1.
        https://bugs.webkit.org/show_bug.cgi?id=172331

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-05-26  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r217458.

        This change caused 55 JSC test failures.

        Reverted changeset:

        "Date should use historical data if it's available."
        https://bugs.webkit.org/show_bug.cgi?id=172592
        http://trac.webkit.org/changeset/217458

2017-05-26  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline js/dom/global-constructors-attributes.html.

        Unreviewed test gardening.

        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-05-25  Ryan Haddad  <ryanhaddad@apple.com>

        Skip two LayoutTests that are failing due missing results.

        Unreviewed test gardening.

        * TestExpectations:
        * platform/ios/TestExpectations:

2017-05-26  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Mark animations/animation-delay-changed.htm as flaky

        Unreviewed gardening. It's flaky on all platforms so why bother.

        * platform/wpe/TestExpectations:

2017-05-26  Manuel Rego Casasnovas  <rego@igalia.com>

        [css-grid] Add support for orthogonal positioned grid items
        https://bugs.webkit.org/show_bug.cgi?id=172591

        Reviewed by Sergio Villar Senin.

        Two of the new imported tests are failing due to an issue with margins
        and orthogonal items, which is unrelated to this patch (see bug #172590).

        * TestExpectations:

2017-05-25  Emilio Cobos Álvarez  <ecobos@igalia.com>

        Don't reset m_hasDisplayContents on ElementRareData::resetComputedStyle.
        https://bugs.webkit.org/show_bug.cgi?id=172503

        Reviewed by Antti Koivisto.

        * TestExpectations:

2017-05-25  Sam Weinig  <sam@webkit.org>

        Fix MediaDeviceInfo's extended attributes so they make sense
        https://bugs.webkit.org/show_bug.cgi?id=172629

        Reviewed by Daniel Bates.

        * fast/mediastream/media-device-info-expected.txt: Added.
        * fast/mediastream/media-device-info.html: Added.
        Test that MediaDeviceInfo has the expected properties and that
        the serializer works.

2017-05-25  Chris Dumez  <cdumez@apple.com>

        imported/w3c/web-platform-tests/html/semantics/forms/form-control-infrastructure/form_owner_and_table_2.html is crashing
        https://bugs.webkit.org/show_bug.cgi?id=172628
        <rdar://problem/32418707>

        Reviewed by Sam Weinig.

        Add reduced test case.

        * TestExpectations:
        Unskip test that is no longer crashing in debug builds.

        * fast/dom/HTMLFormElement/form-removed-during-parsing-crash-expected.txt: Added.
        * fast/dom/HTMLFormElement/form-removed-during-parsing-crash.html: Added.

2017-05-25  Zalan Bujtas  <zalan@apple.com>

        Frame's composited content is visible when the frame has visibility: hidden.
        https://bugs.webkit.org/show_bug.cgi?id=125565
        <rdar://problem/32196849>

        Reviewed by Simon Fraser.

        * compositing/resources/visibility.html: Added.
        * compositing/visibility/frameset-visibility-hidden-expected.html: Added.
        * compositing/visibility/frameset-visibility-hidden.html: Added.
        * compositing/visibility/iframe-visibility-hidden-expected.html: Added.
        * compositing/visibility/iframe-visibility-hidden.html: Added.
        * compositing/visibility/object-visibility-hidden-expected.html: Added.
        * compositing/visibility/object-visibility-hidden.html: Added.

2017-05-25  Brent Fulgham  <bfulgham@apple.com>

        Gracefully handle missing localStorage support in results.html
        https://bugs.webkit.org/show_bug.cgi?id=172625
        <rdar://problem/32118243>

        Reviewed by Alexey Proskuryakov.

        Handle the case where localStorage generates a SecurityError DOMException, treating this
        as a non-fatal error.

        * fast/harness/results.html:
        (OptionWriter.save): Treat "SecurityError" as an expected condition.
        (OptionWriter.apply): Ditto.

2017-05-25  Alexey Proskuryakov  <ap@apple.com>

        Merge split script tests, part 2
        https://bugs.webkit.org/show_bug.cgi?id=172423

        Reviewed by Tim Horton.

        Fix the few remaining special cases of split tests.

        * editing/pasteboard/drop-text-events-sideeffect-crash.html:
        * editing/pasteboard/script-tests/drop-text-events-sideeffect.js: Removed.
        This JS file used to be shared between this test and editing/pasteboard/drop-text-events-sideeffect.html.
        Now it's inlined in both.

        * fast/canvas/canvas-ellipse-connecting-line-expected.html:
        * fast/canvas/script-tests/js-ellipse-implementation.js: Removed.
        This was really a resource, not a scrip test, and it was only only used in one test.

        * fast/dom/HTMLElement/class-list-quirks.html:
        * fast/dom/HTMLElement/script-tests/class-list.js: Removed.
        Another JS that used to be shared (with fast/dom/HTMLElement/class-list.html).

        * fast/dom/Window/resources/postmessage-test.js: Copied from LayoutTests/fast/dom/Window/script-tests/postmessage-test.js.
        * fast/dom/Window/script-tests/postmessage-test.js: Removed.
        Moved a shared resource to its proper location.

        * fast/dom/Window/script-tests/postmessage-clone-deep-array.js: Removed.
        * fast/dom/Window/script-tests/postmessage-clone-really-deep-array.js: Removed.
        * fast/dom/Window/script-tests/postmessage-clone.js: Removed.
        * fast/dom/Window/window-postmessage-clone-deep-array.html:
        * fast/dom/Window/window-postmessage-clone-really-deep-array.html:
        * fast/dom/Window/window-postmessage-clone.html:
        Straightforward js-tests with file names that didn't match.
        
        * fast/table/resources/min-width-helpers.js: Copied from LayoutTests/fast/table/script-tests/min-width-helpers.js.
        * fast/table/script-tests/min-width-helpers.js: Removed.
        Moved a shared resource to its proper location.

        * fast/table/min-width-css-block-table.html:
        * fast/table/min-width-css-inline-table.html:
        * fast/table/min-width-html-block-table.html:
        * fast/table/min-width-html-inline-table.html:
        * fast/table/script-tests/min-width-css-block-table.js: Removed.
        * fast/table/script-tests/min-width-css-inline-table.js: Removed.
        * fast/table/script-tests/min-width-html-block-table.js: Removed.
        * fast/table/script-tests/min-width-html-inline-table.js: Removed.
        Straightforward JS tests, weren't moved previously because my script was confused by min-width-helpers.js.

        * printing/break-after-avoid-expected.txt:
        * printing/break-after-avoid-page-expected.txt:
        * printing/break-after-avoid-page.html:
        * printing/break-after-avoid.html:
        * printing/script-tests/break-after-avoid-page.js: Removed.
        * printing/script-tests/break-after-avoid.js: Removed.
        * printing/script-tests/page-break-after-avoid.js: Removed.
        * printing/script-tests/page-break-always-for-overflow.js: Removed.
        These had a number of copy/paste mistakes, so the tests werent's actually testing what they said they did.

        * svg/dom/SVGAnimatedEnumeration-SVGMaskElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGMaskElement.html:
        * svg/dom/SVGAnimatedEnumeration-SVGPatternElement-expected.txt:
        * svg/dom/SVGAnimatedEnumeration-SVGPatternElement.html:
        * svg/dom/script-tests/SVGAnimatedEnumeration-SVGMaskElement.js: Removed.
        * svg/dom/script-tests/SVGAnimatedEnumeration-SVGPatternElement.js: Removed.
        These tests were mixed up - pattern was being tested instead of mask, and vice versa.
        
        * svg/dom/script-tests/SVGColor.js: Removed.
        * svg/dom/script-tests/SVGPaint.js: Removed.
        Removed unused files.

        * svg/dynamic-updates/SVGFEFloodElement-inherit-flood-color.html:
        * svg/dynamic-updates/SVGFEGaussianBlurElement-dom-stdDeviation-call.html:
        * svg/dynamic-updates/SVGFESpecularLightingElement-dom-suraceScale-attr.html:
        * svg/dynamic-updates/SVGFESpecularLightingElement-svgdom-suraceScale-prop.html:
        * svg/dynamic-updates/script-tests/SVGFEFloodElement-inherit-flood-color-css-prop.js: Removed.
        * svg/dynamic-updates/script-tests/SVGFEGaussianBlurElement-svgdom-stdDeviation-call.js: Removed.
        * svg/dynamic-updates/script-tests/SVGFESpecularLightingElement-dom-surfaceScale-attr.js: Removed.
        * svg/dynamic-updates/script-tests/SVGFESpecularLightingElement-svgdom-surfaceScale-prop.js: Removed.
        Straightforward js-tests with mismatching names.

2017-05-25  Myles C. Maxfield  <mmaxfield@apple.com>

        [WK1] iframes in layer-backed NSViews are not cleared between successive draws
        https://bugs.webkit.org/show_bug.cgi?id=172554
        <rdar://problem/31247133>

        Reviewed by Simon Fraser.

        Cause two successive paints, and compare it against 0 paints.

        * fast/frames/iframe-translucent-background-expected.html: Added.
        * fast/frames/iframe-translucent-background.html: Added.

2017-05-25  Keith Miller  <keith_miller@apple.com>

        Date should use historical data if it's available.
        https://bugs.webkit.org/show_bug.cgi?id=172592

        Reviewed by Mark Lam.

        Fix tests to work with historically accurate dates.

        * js/dom/date-big-setdate-expected.txt: Removed.
        * js/dom/date-big-setdate.html: Removed.
        * js/dom/script-tests/date-big-setdate.js: Removed.
        * storage/indexeddb/modern/date-basic-expected.txt:
        * storage/indexeddb/modern/date-basic-private-expected.txt:
        * storage/indexeddb/modern/get-keyrange-expected.txt:
        * storage/indexeddb/modern/get-keyrange-private-expected.txt:

2017-05-25  Chris Dumez  <cdumez@apple.com>

        DocumentThreadableLoader::redirectReceived() should not rely on the resource's loader
        https://bugs.webkit.org/show_bug.cgi?id=172578
        <rdar://problem/30754582>

        Reviewed by Youenn Fablet.

        Add layout test coverage.

        * http/tests/xmlhttprequest/cacheable-cross-origin-redirect-crash-expected.txt: Added.
        * http/tests/xmlhttprequest/cacheable-cross-origin-redirect-crash.html: Added.

2017-05-24  Jiewen Tan  <jiewen_tan@apple.com>

        Crash on WebCore::FrameSelection::setSelectionWithoutUpdatingAppearance + 1195
        https://bugs.webkit.org/show_bug.cgi?id=172555
        <rdar://problem/32004724>

        Reviewed by Ryosuke Niwa.

        * editing/selection/resources/select-iframe-focusin-document-crash-frame.html: Added.
        * editing/selection/select-iframe-focusin-document-crash-expected.txt: Added.
        * editing/selection/select-iframe-focusin-document-crash.html: Added.

2017-05-25  Javier Fernandez  <jfernandez@igalia.com>

        [css-align] Fixed errors in the CSS parsing tests of the "place-XXX" shorthands
        https://bugs.webkit.org/show_bug.cgi?id=172593

        Reviewed by Manuel Rego Casasnovas.

        * css3/parse-place-content.html:
        * css3/parse-place-items.html:
        * css3/parse-place-self.html:

2017-05-25  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] Expose doc-footnote ARIA role with ATK_ROLE_FOOTNOTE
        https://bugs.webkit.org/show_bug.cgi?id=172355

        Reviewed by Chris Fleizach.

        * accessibility/gtk/xml-roles-exposed-expected.txt: Updated.
        * platform/gtk/accessibility/roles-exposed-expected.txt: Updated.

2017-05-25  Carlos Alberto Lopez Perez  <clopez@igalia.com>

        [GTK] [WebCrypto] Mark new WebCryptoAPI test failures after last WPT sync

        Unreviewed GTK gardening.

        * platform/gtk/TestExpectations:

2017-05-25  Claudio Saavedra  <csaavedra@igalia.com>

        [GTK] Update baseline

        Unreviewed gardening. Update after r217272.
        * platform/gtk/fast/text/font-style-parse-expected.txt:

2017-05-25  Dave Hyatt  <hyatt@apple.com>

        Baseline of number inputs not right.
        https://bugs.webkit.org/show_bug.cgi?id=172237

        Reviewed by Dean Jackson.

        * fast/forms/baseline-of-number-inputs-expected.html: Added.
        * fast/forms/baseline-of-number-inputs.html: Added.

2017-05-25  Per Arne Vollan  <pvollan@apple.com>

        [Win] Update expectations for layout tests.
        https://bugs.webkit.org/show_bug.cgi?id=172437

        Unreviewed test gardening, update test expectations for failing tests.

        * platform/win/TestExpectations:

2017-05-25  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Add missing test baseline.

        Unreviewed gardening.
        * platform/wpe/fast/text/zero-font-size-expected.txt: Added.

2017-05-25  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Unreviewed gardening

        Update rebaseline after r216817.

        * platform/wpe/fast/transforms/bounding-rect-zoom-expected.txt:

2017-05-25  Per Arne Vollan  <pvollan@apple.com>

        [Win] Update expectations for layout tests.
        https://bugs.webkit.org/show_bug.cgi?id=172437

        Unreviewed test gardening, update test expectations for failing tests.

        * platform/win/TestExpectations:

2017-05-25  Manuel Rego Casasnovas  <rego@igalia.com>

        [css-grid] Fix behavior of positioned items without specific dimensions
        https://bugs.webkit.org/show_bug.cgi?id=172117

        Reviewed by Sergio Villar Senin.

        * fast/css-grid-layout/positioned-grid-items-sizing-expected.html: Added.
        * fast/css-grid-layout/positioned-grid-items-sizing.html: Added.

2017-05-25  David Kilzer  <ddkilzer@apple.com>

        REGRESSION(r217390): "Broke internal Production builds that ran run-jsc-stress-tests" (Requested by ddkilzer on #webkit).
        <https://bugs.webkit.org/show_bug.cgi?id=172584>

        * fast/regex/:
        * fast/regex/script-tests:
        - Rollback changes in r217390 for Bug 172423 to these
          directories.

2017-05-24  Chris Dumez  <cdumez@apple.com>

        ResourceResponses for data URLs have their Source marked as Unknown
        https://bugs.webkit.org/show_bug.cgi?id=172573
        <rdar://problem/31786198>

        Reviewed by Geoffrey Garen.

        Add layout test coverage.

        * fast/url/data-url-source-expected.txt: Added.
        * fast/url/data-url-source.html: Added.

2017-05-24  Fujii Hironori  <Hironori.Fujii@sony.com>

        [Win] An assertion fails if the custom cursor image isn't loaded yet
        https://bugs.webkit.org/show_bug.cgi?id=172209

        Reviewed by Said Abou-Hallawa.

        Windows port have the same issue Qt port had had several years ago
        (Bug 68223). I'd like to reuse the test case. But, current CSS
        parser rejects invalid 'cursor' property value which consists of
        a single URL but no keywords.

        * fast/css/crash-on-custom-cursor-when-loading.html: Fix invalid
        'cursor' property by appending a fallback keyword.

2017-05-24  Alexey Proskuryakov  <ap@apple.com>

        Merge split script tests
        https://bugs.webkit.org/show_bug.cgi?id=172423

        Reviewed by Sam Weinig.

        In the past, many tests were being split into HTML and JS parts for no good reason.
        This makes it hard to see what those tests are doing.

        This is first part of the change, only including files where JS and HTML counterparts
        have matching names. Custom cases will be completed in a follow-up.

        Long change list omitted.

2017-05-24  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/xmlhttprequest/xmlhttprequest-50ms-download-dispatch.html as failing on iOS.
        https://bugs.webkit.org/show_bug.cgi?id=172547

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-05-24  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Rebaseline test

        Unreviewed gardening after a series of changes to dom static properties.

        * platform/wpe/js/dom/dom-static-property-for-in-iteration-expected.txt:

2017-05-24  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Rebaseline test after r217181

        Unreviewed gardening.

        * platform/wpe/js/dom/global-constructors-attributes-dedicated-worker-expected.txt:

2017-05-24  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Remove baseline for test that passes now

        Unreviewed gardening.

        * platform/wpe/js/dom/regress-157246-expected.txt: Removed.

2017-05-24  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] Gardening needed after r217171
        https://bugs.webkit.org/show_bug.cgi?id=172539

        Unreviewed test gardening after r217171.

        Add "PASS successfullyParsed is true" and "TEST COMPLETE" lines for
        tests with platform-specific expectations.

        * accessibility/multiselect-list-reports-active-option-expected.txt:
        * accessibility/table-cells-roles-expected.txt:
        * platform/gtk/accessibility/aria-checkbox-sends-notification-expected.txt:
        * platform/gtk/accessibility/aria-switch-sends-notification-expected.txt:
        * platform/gtk/accessibility/deleting-iframe-destroys-axcache-expected.txt:
        * platform/gtk/accessibility/menu-list-sends-change-notification-expected.txt:
        * platform/gtk/accessibility/table-roles-hierarchy-expected.txt:

2017-05-24  Javier Fernandez  <jfernandez@igalia.com>

        [css-grid] Ignore collapsed tracks on content-distribution alignment
        https://bugs.webkit.org/show_bug.cgi?id=172493

        Reviewed by Manuel Rego Casasnovas.

        Unskip the web-platform-tests related to content-alignment and collapsed tracks.

        * TestExpectations:

2017-05-22  Jiewen Tan  <jiewen_tan@apple.com>

        [WebCrypto] Support RSA-PSS
        https://bugs.webkit.org/show_bug.cgi?id=170869
        <rdar://problem/31640672>

        Reviewed by Brent Fulgham.

        * TestExpectations:
        Skip tests related to RSA-PSS for now.
        * crypto/subtle/rsa-generate-key-malformed-parameters-expected.txt:
        * crypto/subtle/rsa-generate-key-malformed-parameters.html:
        * crypto/subtle/rsa-import-key-malformed-parameters-expected.txt:
        * crypto/subtle/rsa-import-key-malformed-parameters.html:
        * crypto/subtle/rsa-pss-generate-export-key-jwk-sha1-expected.txt: Added.
        * crypto/subtle/rsa-pss-generate-export-key-jwk-sha1.html: Added.
        * crypto/subtle/rsa-pss-generate-export-key-jwk-sha224-expected.txt: Added.
        * crypto/subtle/rsa-pss-generate-export-key-jwk-sha224.html: Added.
        * crypto/subtle/rsa-pss-generate-export-key-jwk-sha256-expected.txt: Added.
        * crypto/subtle/rsa-pss-generate-export-key-jwk-sha256.html: Added.
        * crypto/subtle/rsa-pss-generate-export-key-jwk-sha384-expected.txt: Added.
        * crypto/subtle/rsa-pss-generate-export-key-jwk-sha384.html: Added.
        * crypto/subtle/rsa-pss-generate-export-key-jwk-sha512-expected.txt: Added.
        * crypto/subtle/rsa-pss-generate-export-key-jwk-sha512.html: Added.
        * crypto/subtle/rsa-pss-generate-export-key-pkcs8-expected.txt: Added.
        * crypto/subtle/rsa-pss-generate-export-key-pkcs8.html: Added.
        * crypto/subtle/rsa-pss-generate-export-key-spki-expected.txt: Added.
        * crypto/subtle/rsa-pss-generate-export-key-spki.html: Added.
        * crypto/subtle/rsa-pss-generate-key-expected.txt: Added.
        * crypto/subtle/rsa-pss-generate-key.html: Added.
        * crypto/subtle/rsa-pss-import-jwk-private-key-expected.txt: Added.
        * crypto/subtle/rsa-pss-import-jwk-private-key.html: Added.
        * crypto/subtle/rsa-pss-import-jwk-public-key-empty-usages-expected.txt: Added.
        * crypto/subtle/rsa-pss-import-jwk-public-key-empty-usages.html: Added.
        * crypto/subtle/rsa-pss-import-jwk-public-key-sha1-expected.txt: Added.
        * crypto/subtle/rsa-pss-import-jwk-public-key-sha1.html: Added.
        * crypto/subtle/rsa-pss-import-jwk-public-key-sha224-expected.txt: Added.
        * crypto/subtle/rsa-pss-import-jwk-public-key-sha224.html: Added.
        * crypto/subtle/rsa-pss-import-jwk-public-key-sha256-expected.txt: Added.
        * crypto/subtle/rsa-pss-import-jwk-public-key-sha256.html: Added.
        * crypto/subtle/rsa-pss-import-jwk-public-key-sha384-expected.txt: Added.
        * crypto/subtle/rsa-pss-import-jwk-public-key-sha384.html: Added.
        * crypto/subtle/rsa-pss-import-jwk-public-key-sha512-expected.txt: Added.
        * crypto/subtle/rsa-pss-import-jwk-public-key-sha512.html: Added.
        * crypto/subtle/rsa-pss-import-key-sign-expected.txt: Added.
        * crypto/subtle/rsa-pss-import-key-sign-large-salt-expected.txt: Added.
        * crypto/subtle/rsa-pss-import-key-sign-large-salt.html: Added.
        * crypto/subtle/rsa-pss-import-key-sign.html: Added.
        * crypto/subtle/rsa-pss-import-key-verify-expected.txt: Added.
        * crypto/subtle/rsa-pss-import-key-verify.html: Added.
        * crypto/subtle/rsa-pss-import-pkcs8-key-expected.txt: Added.
        * crypto/subtle/rsa-pss-import-pkcs8-key.html: Added.
        * crypto/subtle/rsa-pss-import-spki-key-empty-usages-expected.txt: Added.
        * crypto/subtle/rsa-pss-import-spki-key-empty-usages.html: Added.
        * crypto/subtle/rsa-pss-import-spki-key-expected.txt: Added.
        * crypto/subtle/rsa-pss-import-spki-key.html: Added.
        * crypto/workers/subtle/resources/rsa-pss-import-key-sign.js: Added.
        * crypto/workers/subtle/resources/rsa-pss-import-key-verify.js: Added.
        * crypto/workers/subtle/rsa-pss-import-key-sign-expected.txt: Added.
        * crypto/workers/subtle/rsa-pss-import-key-sign.html: Added.
        * crypto/workers/subtle/rsa-pss-import-key-verify-expected.txt: Added.
        * crypto/workers/subtle/rsa-pss-import-key-verify.html: Added.

2017-05-23  Chris Dumez  <cdumez@apple.com>

        Some async tests ignore jsTestIsAsync when ported from js-test-pre.js / js-test-post.js to js-test.js
        https://bugs.webkit.org/show_bug.cgi?id=172523

        Reviewed by Ryosuke Niwa.

        * TestExpectations:
        This test used to be flaky because jsTestIsAsync was ignored. It now consistently times out.

        * fast/dom/script-charset-update.html:
        Port test to js-test.js instead of js-test-pre.js / js-test-post.js now that it works.

        * fast/mediacapturefromelement/CanvasCaptureMediaStream-webgl-events-expected.txt:
        Rebaseline test now that it actually runs to the end.

        * platform/ios-wk2/TestExpectations:
        * platform/mac-wk2/TestExpectations:
        Remove expectation for a test that is now skipped in root TestExpectations file.

        * resources/js-test.js:
        Call testRunner.waitUntilDone() in the DOMContentLoader event listener if jsTestIsAsync is already
        set then, instead of waiting for the load event listener to do so. This is needed because some
        tests may decide to complete *before* the load event has fired, such as the test updated in this
        patch. We still need to call testRunner.waitUntilDone() in the load event listener as well because
        some tests only set jsTestIsAsync in a load event handler.

2017-05-23  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline tests for iOS simulator.

        Unreviewed test gardening.

        * fast/events/ios/rotation/basic-rotation-expected.txt:
        * fast/events/touch/ios/block-without-overflow-scroll-and-passive-observer-on-block-scrolling-state-expected.txt:
        * fast/events/touch/ios/block-without-overflow-scroll-and-passive-observer-on-document-scrolling-state-expected.txt:
        * fast/events/touch/ios/block-without-overflow-scroll-scrolling-state-expected.txt:
        * fast/events/touch/ios/tap-with-active-touch-end-listener-expected.txt:
        * fast/visual-viewport/ios/zoomed-focus-in-fixed-expected.txt:

2017-05-23  Matt Baker  <mattbaker@apple.com>

        Web Inspector: Cannot delete a disabled XHR breakpoint
        https://bugs.webkit.org/show_bug.cgi?id=171971
        <rdar://problem/32129527>

        Reviewed by Devin Rousso.

        * inspector/dom-debugger/xhr-breakpoints-expected.txt:
        * inspector/dom-debugger/xhr-breakpoints.html:

2017-05-23  Ryan Haddad  <ryanhaddad@apple.com>

        Skip crashing css-display-3/display-contents tests.
        https://bugs.webkit.org/show_bug.cgi?id=172503

        Unreviewed test gardening.

        * TestExpectations:

2017-05-23  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/web-platform-tests/css/css-display-3/display-contents-dynamic-flex-002-inline.html as failing.
        https://bugs.webkit.org/show_bug.cgi?id=172515

        Unreviewed test gardening.

        * TestExpectations:

2017-05-23  Chris Dumez  <cdumez@apple.com>

        Regression(r215229): ASSERTION FAILED: !m_scriptHash || m_scriptHash == m_script.impl()->hash()
        https://bugs.webkit.org/show_bug.cgi?id=171091
        <rdar://problem/31752046>

        Reviewed by Geoffrey Garen.

        * fast/dom/resources/script-with-unicode.js: Added.
        * fast/dom/script-charset-update-expected.txt: Added.
        * fast/dom/script-charset-update.html: Added.
        Add test that was consistently hitting the assertion in debug builds before
        r215229 was rolled out.

        * fast/loader/cache-encoding-expected.txt:
        * fast/loader/cache-encoding.html:
        Improve test to check that it is actually getting a SyntaxError the first time,
        when it loads the script with the wrong encoding. Apparently this test was not
        clear enough because it was updated / disabled in r215229, but was showing a
        real bug.

        * platform/ios-wk2/TestExpectations:
        * platform/mac-wk2/TestExpectations:
        Unskip test was should no longer be flaky now that r215229 has been rolled out.

2017-05-23  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/web-platform-tests/webrtc/getstats.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172521

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:
        * platform/mac-wk2/TestExpectations:

2017-05-23  Dean Jackson  <dino@apple.com>

        checkGPUStatus needs to exercise instancing calls
        https://bugs.webkit.org/show_bug.cgi?id=172520
        <rdar://problem/23118395>

        Reviewed by Brent Fulgham.

        * fast/canvas/webgl/lose-context-on-status-failure-expected.txt: Added.
        * fast/canvas/webgl/lose-context-on-status-failure.html: Added.

2017-05-23  Manuel Rego Casasnovas  <rego@igalia.com>

        [css-grid] Import css/css-grid-1/alignment/ from WPT (8df7c9c215)
        https://bugs.webkit.org/show_bug.cgi?id=172494

        Reviewed by Youenn Fablet.

        * TestExpectations: Mark as failure a few tests due to bug #172493.

2017-05-23  Alexey Proskuryakov  <ap@apple.com>

        Many editing js-tests use waitUntilDone
        https://bugs.webkit.org/show_bug.cgi?id=172401

        Reviewed by Ryosuke Niwa.

        Corrected the use of js-test harness, updated the tests to use js-test.js instead
        of js-test-pre.js where possible.

        * editing/caret/ios/absolute-caret-position-after-scroll.html:
        * editing/caret/ios/fixed-caret-position-after-scroll.html:
        * editing/input/style-change-during-input.html:
        * editing/inserting/insert-html-crash.html:
        * editing/mac/input/undo-grouping-on-text-insertion.html:
        * editing/mac/selection/context-menu-select-editability-expected.txt:
        * editing/mac/selection/context-menu-select-editability.html:
        * editing/mac/spelling/accept-candidate-undo-does-not-select.html:
        * editing/mac/spelling/autocorrection-respets-undo-expected.txt:
        * editing/mac/spelling/autocorrection-respets-undo.html:
        * editing/pasteboard/drag-and-drop-attachment-contenteditable.html:
        * editing/pasteboard/drag-and-drop-image-contenteditable.html:
        * editing/pasteboard/drag-and-drop-inputimage-contenteditable.html:
        * editing/pasteboard/drag-and-drop-objectimage-contenteditable.html:
        * editing/pasteboard/drag-link-with-data-transfer-adds-trusted-link-to-pasteboard-expected.txt:
        * editing/pasteboard/drag-link-with-data-transfer-adds-trusted-link-to-pasteboard.html:
        * editing/selection/ios/absolute-selection-after-scroll.html:
        * editing/selection/ios/fixed-selection-after-scroll.html:
        * editing/spelling/copy-paste-crash-expected.txt:
        * editing/spelling/copy-paste-crash.html:
        * editing/style/apply-style-join-child-text-nodes-crash.html:

2017-05-23  Jiewen Tan  <jiewen_tan@apple.com>

        Unreviewed, test gardening after r217225

        * TestExpectations:
        Gardening about imported/w3c/web-platform-tests/WebCryptoAPI/

2017-05-23  Chris Dumez  <cdumez@apple.com>

        Unreviewed, roll out r215229

        It caused CachedScripts in MemoryCache to be reused with different encodings
        even though CachedScript potentially has already decoded data or cached hash
        with a previous encoding.

        * TestExpectations:
        * fast/loader/cache-encoding-expected.txt:
        * fast/loader/cache-encoding.html:
        * http/tests/preload/preload-encoding-expected.txt:
        * http/tests/preload/preload-encoding.php:

2017-05-23  Ryan Haddad  <ryanhaddad@apple.com>

        Skip LayoutTest imported/w3c/web-platform-tests/innerText/getter.html.
        https://bugs.webkit.org/show_bug.cgi?id=172514

        Unreviewed test gardening.

        * TestExpectations:

2017-05-23  Sam Weinig  <sam@webkit.org>

        [WebIDL] Remove some unnecessary specialization for enum types
        https://bugs.webkit.org/show_bug.cgi?id=172482

        Reviewed by Chris Dumez.

        * crypto/subtle/import-key-malformed-parameters-expected.txt:
        * fast/files/blob-constructor-expected.txt:
        * fast/files/script-tests/blob-constructor.js:
        Update test and results for improved order of exceptions. In this case, the conversion
        to String throws before the failure to parse the enumeration (which is what the
        plain TypeError was).

2017-05-23  Emilio Cobos Álvarez  <ecobos@igalia.com>

        Import the css-display-3 css tests.
        https://bugs.webkit.org/show_bug.cgi?id=172212

        Reviewed by Chris Dumez.

2017-05-23  youenn fablet  <youenn@apple.com>

        There should be an easy way to run HTTP/WPT served tests on a browser
        https://bugs.webkit.org/show_bug.cgi?id=172068

        Reviewed by Sam Weinig.

        * fast/harness/results.html: In case results.html is opened locallly,
        open HTTP/WPT urls as served by their related servers.
        Adding a check that the servers are running before opening the related test.

2017-05-23  Antoine Quint  <graouts@apple.com>

        [Modern Media Controls] Turn off all tests
        https://bugs.webkit.org/show_bug.cgi?id=172447

        Reviewed by Jon Lee.

        Due to the high number of timeouts and random failures with the current tests, we turn off
        all modern-media-controls tests while we wait on a more permanent solution.

        * TestExpectations:
        * platform/gtk/TestExpectations:
        * platform/ios/TestExpectations:
        * platform/mac-wk1/TestExpectations:
        * platform/mac/TestExpectations:

2017-05-22  Myles C. Maxfield  <mmaxfield@apple.com>

        Update font-style's implementation in the font selection algorithm
        https://bugs.webkit.org/show_bug.cgi?id=169453

        Reviewed by Simon Fraser.

        * fast/text/font-style-parse-expected.txt:
        * fast/text/font-style-parse.html:
        * platform/mac-elcapitan/fast/text/font-style-parse-expected.txt:

2017-05-22  Per Arne Vollan  <pvollan@apple.com>

        [Win] Update expectations for layout tests.
        https://bugs.webkit.org/show_bug.cgi?id=172437

        Unreviewed test gardening, update test expectations for failing tests.

        * platform/win/TestExpectations:

2017-05-22  Myles C. Maxfield  <mmaxfield@apple.com>

        Support calc() in font-variation-settings and font-feature-settings
        https://bugs.webkit.org/show_bug.cgi?id=171032

        Reviewed by David Hyatt.

        * css3/font-feature-settings-calc-expected.html: Added.
        * css3/font-feature-settings-calc.html: Added.
        * fast/text/variations/calc-expected.html: Added.
        * fast/text/variations/calc.html: Added.

2017-05-22  Ryan Haddad  <ryanhaddad@apple.com>

        Mark to imported/w3c/web-platform-tests/webrtc tests as failing on ios-wk2.
        https://bugs.webkit.org/show_bug.cgi?id=171605

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-22  Chris Dumez  <cdumez@apple.com>

        ASSERTION FAILED: tokens.find(item) == notFound in WebCore::DOMTokenList::replace
        https://bugs.webkit.org/show_bug.cgi?id=172473

        Reviewed by Ryosuke Niwa.

        * TestExpectations:
        Unskip test.

2017-05-22  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/loading/resourceLoadStatistics/grandfathering.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172452

        Unreviewed test gardening.

        * platform/wk2/TestExpectations:

2017-05-22  Ryan Haddad  <ryanhaddad@apple.com>

        Update TestExpectations for two new WPT LayoutTests.
        https://bugs.webkit.org/show_bug.cgi?id=172472

        Unreviewed test gardening.

        * TestExpectations:

2017-05-22  Alexey Proskuryakov  <ap@apple.com>

        Remove Java tests.

        Rubber-stamped by Tim Horton.

        These tests were disabled on all platforms for a long long time now.

        * TestExpectations:
        * java: Removed.
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:
        * platform/win/TestExpectations:
        * platform/wk2/TestExpectations:
        * platform/wpe/TestExpectations:

2017-05-22  Brian Burg  <bburg@apple.com>

        Web Inspector: webkit reload policy should match default behavior
        https://bugs.webkit.org/show_bug.cgi?id=171385
        <rdar://problem/31871515>

        Reviewed by Joseph Pecoraro.

        * http/tests/inspector/replay/replay-test.js:
        * http/tests/inspector/network/resource-sizes-memory-cache.html:
        Update tests to match new API.

        * http/tests/inspector/network/resource-response-source-memory-cache.html:
        * http/tests/inspector/network/set-resource-caching-disabled-memory-cache.html:
        Added. This is a copy of the above test but uses the option to do a "legacy" reload.
        With this reload type, the resource returned with HTTP 200.

2017-05-22  Yoav Weiss  <yoav@yoav.ws>

        [preload] Add media and type attribute support.
        https://bugs.webkit.org/show_bug.cgi?id=171720

        Reviewed by Youenn Fablet.

        * TestExpectations: Skip http/tests/preload/viewport as meta viewport is turned off in most platforms.
        * http/wpt/preload/media-attribute-expected.txt: Added.
        * http/wpt/preload/media-attribute.html: Added.
        * http/wpt/preload/type-attribute-expected.txt: Added.
        * http/wpt/preload/type-attribute.html: Added.
        * http/wpt/preload/resources/square.png: Added.
        * http/wpt/preload/resources/dummy.js: Added.
        * http/tests/preload/viewport/meta-viewport-link-headers-expected.txt: Added.
        * http/tests/preload/viewport/meta-viewport-link-headers.php: Added.
        * platform/ios-simulator/TestExpectations: Turn on http/tests/preload/viewport for ios-simulator.
        * platform/ios/TestExpectations: Turn on http/tests/preload/viewport for ios.

2017-05-22  Ryan Haddad  <ryanhaddad@apple.com>

        Mark imported/w3c/web-platform-tests/WebCryptoAPI/import_export/test_rsa_importKey.https.html as a timeout on El Capitan.
        https://bugs.webkit.org/show_bug.cgi?id=172469

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-05-22  Alexey Proskuryakov  <ap@apple.com>

        Many WebAudio js-tests use waitUntilDone
        https://bugs.webkit.org/show_bug.cgi?id=172398

        Reviewed by Sam Weinig.

        Corrected the use of js-test harness, updated the tests to use js-test.js instead
        of js-test-pre.js where possible.

        * resources/js-test.js: (shouldReject): Copied some funcitonality form js-test-pre.js
        that wasn't present here.

        * webaudio/analyser-exception.html:
        * webaudio/audiobuffer-neuter-expected.txt:
        * webaudio/audiobuffer-neuter.html:
        * webaudio/audiobuffersource-channels.html:
        * webaudio/audiobuffersource-ended-expected.txt:
        * webaudio/audiobuffersource-ended.html:
        * webaudio/audiobuffersource-exception.html:
        * webaudio/audiobuffersource-loop-comprehensive-expected.txt:
        * webaudio/audiobuffersource-loop-comprehensive.html:
        * webaudio/audiobuffersource-negative-playbackrate-expected.txt:
        * webaudio/audiobuffersource-negative-playbackrate-interpolated-expected.txt:
        * webaudio/audiobuffersource-negative-playbackrate-interpolated-loop-expected.txt:
        * webaudio/audiobuffersource-negative-playbackrate-interpolated-loop.html:
        * webaudio/audiobuffersource-negative-playbackrate-interpolated.html:
        * webaudio/audiobuffersource-negative-playbackrate-loop-expected.txt:
        * webaudio/audiobuffersource-negative-playbackrate-loop.html:
        * webaudio/audiobuffersource-negative-playbackrate.html:
        * webaudio/audiobuffersource-playbackState.html:
        * webaudio/audiobuffersource-start-expected.txt:
        * webaudio/audiobuffersource-start.html:
        * webaudio/audiochannelmerger-basic.html:
        * webaudio/audiochannelmerger-stereo.html:
        * webaudio/audiochannelsplitter.html:
        * webaudio/audiocontext-promise-throwing.html:
        * webaudio/audiocontext-promise.html:
        * webaudio/audiocontext-restriction-audiobuffersourcenode-start.html:
        * webaudio/audiocontext-restriction.html:
        * webaudio/audiocontext-state-interrupted.html:
        * webaudio/audiocontext-state.html:
        * webaudio/audionode-channel-rules.html:
        * webaudio/audionode-connect-order.html:
        * webaudio/audionode.html:
        * webaudio/audioparam-connect-audioratesignal.html:
        * webaudio/audioparam-summingjunction.html:
        * webaudio/audioprocessingevent.html:
        * webaudio/automatic-pull-node.html:
        * webaudio/biquad-allpass.html:
        * webaudio/biquad-bandpass.html:
        * webaudio/biquad-getFrequencyResponse.html:
        * webaudio/biquad-highpass.html:
        * webaudio/biquad-highshelf.html:
        * webaudio/biquad-lowpass.html:
        * webaudio/biquad-lowshelf.html:
        * webaudio/biquad-notch.html:
        * webaudio/biquad-peaking.html:
        * webaudio/biquadfilternode-basic.html:
        * webaudio/convolution-mono-mono.html:
        * webaudio/decode-audio-data-basic.html:
        * webaudio/decode-audio-data-too-short.html:
        * webaudio/delaynode-max-default-delay.html:
        * webaudio/delaynode-max-nondefault-delay.html:
        * webaudio/delaynode-maxdelay.html:
        * webaudio/delaynode-maxdelaylimit.html:
        * webaudio/delaynode-scheduling.html:
        * webaudio/delaynode.html:
        * webaudio/distance-exponential.html:
        * webaudio/distance-inverse.html:
        * webaudio/distance-linear.html:
        * webaudio/dynamicscompressor-basic.html:
        * webaudio/javascriptaudionode-downmix8-2channel-input.html:
        * webaudio/javascriptaudionode-upmix2-8channel-input.html:
        * webaudio/javascriptaudionode-zero-input-channels.html:
        * webaudio/javascriptaudionode.html:
        * webaudio/mediaelementaudiosourcenode.html:
        * webaudio/oscillator-basic.html:
        * webaudio/oscillator-ended-expected.txt:
        * webaudio/oscillator-ended.html:
        * webaudio/page-canstartmedia.html:
        * webaudio/panner-equalpower-stereo.html:
        * webaudio/panner-equalpower.html:
        * webaudio/panner-loop.html:
        * webaudio/pannernode-basic.html:
        * webaudio/realtimeanalyser-fft-scaling.html:
        * webaudio/realtimeanalyser-fft-sizing.html:
        * webaudio/resources/audiobuffersource-testing.js:
        (checkAllTests):
        * webaudio/sample-accurate-scheduling.html:
        * webaudio/stereo2mono-down-mixing.html:
        * webaudio/test-basic.html:
        * webaudio/waveshaper.html:

2017-05-22  Myles C. Maxfield  <mmaxfield@apple.com>

        Enable the woff2-variations @font-face format identifier
        https://bugs.webkit.org/show_bug.cgi?id=172425

        Reviewed by Andreas Kling.

        * fast/text/variations/font-face-format-woff2-expected.html: Added.
        * fast/text/variations/font-face-format-woff2.html: Added.
        * platform/mac/TestExpectations:

2017-05-22  Simon Fraser  <simon.fraser@apple.com>

        Support transform-box to switch sizing box in SVG
        https://bugs.webkit.org/show_bug.cgi?id=145783

        Reviewed by Dean Jackson.

        Modify tests that relied on the old "% values relative to the bounding box" behavior,
        and new tests for parsing and rendering with transform-box.

        * fast/css/transform-box-parsing.html: Added.
        * svg/transforms/change-transform-origin-css.xhtml:
        * svg/transforms/change-transform-origin-presentation-attribute.xhtml:
        * svg/transforms/percent-transform-values.xhtml:
        * svg/transforms/svg-transform-box-expected.html: Added.
        * svg/transforms/svg-transform-box.html: Added.
        * svg/transforms/transform-origin-css-property.xhtml:
        * transforms/svg-vs-css.xhtml:

2017-05-22  Antti Koivisto  <antti@apple.com>

        Crash in WebCore::StyleRuleKeyframes::findKeyframeIndex
        https://bugs.webkit.org/show_bug.cgi?id=170756
        <rdar://problem/31573157>

        Reviewed by Andreas Kling.

        Expand the tests to cover the malformed key case.

        * animations/keyframes-rule.html:
        * animations/unprefixed-keyframes-rule.html:

2017-05-22  youenn fablet  <youenn@apple.com>

        Resync web-platform-tests up to 8df7c9c215678328212f232ce0b5270c505a8563
        https://bugs.webkit.org/show_bug.cgi?id=172426

        Reviewed by Chris Dumez.

        * TestExpectations:
        * tests-options.json:

2017-05-22  Antti Koivisto  <antti@apple.com>

        [macOS Sierra Wk1] LayoutTest/animations/animation-initial-inheritance.html is a flaky image failure.
        https://bugs.webkit.org/show_bug.cgi?id=172177
        <rdar://problem/32239583>

        Unreviewed.

        * animations/animation-initial-inheritance.html: Try to unflake.

2017-05-21  Per Arne Vollan  <pvollan@apple.com>

        Unreviewed Windows test gardening, skip tests which are timing out.

        * platform/win/TestExpectations:

2017-05-21  Per Arne Vollan  <pvollan@apple.com>

        [Win] Update expectations for layout tests.
        https://bugs.webkit.org/show_bug.cgi?id=172437

        Unreviewed test gardening, update test expectations for failing tests.

        * platform/win/TestExpectations:

2017-05-21  Saam Barati  <sbarati@apple.com>

        We incorrectly throw a syntax error when declaring a top level for-loop iteration variable the same as a parameter
        https://bugs.webkit.org/show_bug.cgi?id=171041
        <rdar://problem/32082516>

        Reviewed by Yusuke Suzuki.

        * js/parser-syntax-check-expected.txt:
        * js/script-tests/parser-syntax-check.js:

2017-05-21  Antti Koivisto  <antti@apple.com>

        matchMedia('print').addListener() fires in WK1 but never in WK2 when printing (breaks printing Google maps, QuickLooks)
        https://bugs.webkit.org/show_bug.cgi?id=172361
        <rdar://problem/28777408>

        Reviewed by Sam Weinig.

        * fast/media/matchMedia-print-expected.txt: Added.
        * fast/media/matchMedia-print.html: Added.

2017-05-20  Alexey Proskuryakov  <ap@apple.com>

        Correct line endings in a couple files.

        * fast/canvas/script-tests/canvas-gradient-without-path.js:
        * fast/dom/Geolocation/page-reload-cancel-permission-requests.html:

2017-05-20  Chris Dumez  <cdumez@apple.com>

        Drop [NoInterfaceObject] from RTCDTMFSender and RTCStatsReport
        https://bugs.webkit.org/show_bug.cgi?id=172418

        Reviewed by Youenn Fablet.

        Rebaseline existing test to reflect change.

        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-yosemite/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-05-20  Chris Dumez  <cdumez@apple.com>

        Value for iterator property is wrong for maplike interfaces
        https://bugs.webkit.org/show_bug.cgi?id=172410

        Reviewed by Sam Weinig.

        Extend test coverage to test the RTCStatsReport iterator.

        * webrtc/video-stats.html:

2017-05-20  Jer Noble  <jer.noble@apple.com>

        [MSE][Mac] Support painting MSE video-element to canvas
        https://bugs.webkit.org/show_bug.cgi?id=125157
        <rdar://problem/23062016>

        Reviewed by Eric Carlson.

        * media/media-source/content/test-fragmented.mp4: Add a 'edts' atom to move the presentation time for the
            first sample to 0:00.
        * media/media-source/content/test-fragmented-manifest.json: 
        * media/media-source/media-source-paint-to-canvas-expected.txt: Added.
        * media/media-source/media-source-paint-to-canvas.html: Added.

2017-05-19  Chris Dumez  <cdumez@apple.com>

        Consider not exposing webkitURL in workers
        https://bugs.webkit.org/show_bug.cgi?id=172166

        Reviewed by Geoffrey Garen.

        Rebaseline existing test to reflect behavior change.

        * js/dom/global-constructors-attributes-dedicated-worker-expected.txt:

2017-05-19  Jeremy Jones  <jeremyj@apple.com>

        webkitSupportsFullscreen and webkitSupportsPresentationMode('fullscreen') disagree.
        https://bugs.webkit.org/show_bug.cgi?id=172329
        rdar://problem/32260891

        Reviewed by Darin Adler.

        webkitSupportsPresentationMode('fullscreen') should delegate to webkitSupportsFullscreen.
        The additional mediaSession().fullscreenPermitted() check causes it to return false when
        not handling a user gesture, which isn't helpful to deciding to show a button in controls
        or not.

        * media/media-fullscreen-inline-expected.txt:
        * media/media-fullscreen-not-in-document-expected.txt:
        * media/media-fullscreen.js:
        (canplaythrough):
        * platform/mac-elcapitan/media/media-fullscreen-inline-expected.txt:
        * platform/mac-elcapitan/media/media-fullscreen-not-in-document-expected.txt:

2017-05-19  Matt Lewis  <jlewis3@apple.com>

        Marked webrtc/datachannel/filter-ice-candidate.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171061

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:
        * platform/mac-wk1/TestExpectations:
        * platform/mac-wk2/TestExpectations:

2017-05-19  Chris Dumez  <cdumez@apple.com>

        Do not fire load event for SVGElements that are detached or in frameless documents
        https://bugs.webkit.org/show_bug.cgi?id=172289
        <rdar://problem/32275689>

        Reviewed by Ryosuke Niwa.

        Add layout test coverage.

        * svg/load-event-detached-expected.txt: Added.
        * svg/load-event-detached.html: Added.

2017-05-19  Alexey Proskuryakov  <ap@apple.com>

        Many accessibility js-tests use waitUntilDone
        https://bugs.webkit.org/show_bug.cgi?id=172372

        Reviewed by Tim Horton.

        Corrected the use of js-test harness, updated the tests to use js-test.js instead
        of js-test-pre.js where possible.

        * accessibility/anonymous-render-block-in-continuation-causes-crash-expected.txt:
        * accessibility/anonymous-render-block-in-continuation-causes-crash.html:
        * accessibility/aria-checkbox-sends-notification.html:
        * accessibility/aria-invalid.html:
        * accessibility/aria-switch-sends-notification.html:
        * accessibility/deleting-iframe-destroys-axcache.html:
        * accessibility/file-upload-button-with-axpress.html:
        * accessibility/frame-disconnect-textmarker-cache-crash-expected.txt:
        * accessibility/frame-disconnect-textmarker-cache-crash.html:
        * accessibility/gtk/aria-listbox-crash.html:
        * accessibility/heading-title-includes-links-expected.txt:
        * accessibility/heading-title-includes-links.html:
        * accessibility/image-map-update-parent-crash-expected.txt:
        * accessibility/image-map-update-parent-crash.html:
        * accessibility/insert-children-assert-expected.txt:
        * accessibility/insert-children-assert.html:
        * accessibility/ios-simulator/focus-change-notifications.html:
        * accessibility/label-element-press.html:
        * accessibility/loading-iframe-updates-axtree.html:
        * accessibility/mac/aria-expanded-notifications.html:
        * accessibility/mac/aria-listbox-selectedchildren-change.html:
        * accessibility/mac/aria-liveregion-on-image.html:
        * accessibility/mac/aria-liveregions-addedelement.html:
        * accessibility/mac/aria-liveregions-changedalt.html:
        * accessibility/mac/aria-liveregions-changedtext.html:
        * accessibility/mac/aria-liveregions-removedelement.html:
        * accessibility/mac/combobox-activedescendant-notifications-expected.txt:
        * accessibility/mac/combobox-activedescendant-notifications.html:
        * accessibility/mac/focus-setting-selection-syncronizing-not-clearing-expected.txt:
        * accessibility/mac/focus-setting-selection-syncronizing-not-clearing.html:
        * accessibility/mac/html-slider-indicator.html:
        * accessibility/mac/input-replacevalue-userinfo-expected.txt:
        * accessibility/mac/input-replacevalue-userinfo.html:
        * accessibility/mac/ordered-textmarker-crash-expected.txt:
        * accessibility/mac/ordered-textmarker-crash.html:
        * accessibility/mac/search-with-frames-expected.txt:
        * accessibility/mac/search-with-frames.html:
        * accessibility/mac/selection-boundary-userinfo.html:
        * accessibility/mac/selection-change-userinfo.html:
        * accessibility/mac/selection-element-tabbing-to-link.html:
        * accessibility/mac/selection-value-changes-for-aria-textbox.html:
        * accessibility/mac/stale-textmarker-crash-expected.txt:
        * accessibility/mac/stale-textmarker-crash.html:
        * accessibility/mac/textbox-role-reports-notifications-expected.txt:
        * accessibility/mac/textbox-role-reports-notifications.html:
        * accessibility/mac/value-change/value-change-user-info-contenteditable.html:
        * accessibility/mac/value-change/value-change-user-info-textarea.html:
        * accessibility/mac/value-change/value-change-user-info-textfield.html:
        * accessibility/media-element.html:
        * accessibility/menu-list-sends-change-notification.html:
        * accessibility/multiselect-list-reports-active-option.html:
        * accessibility/paragraph-with-linebreaks.html:
        * accessibility/platform-name.html:
        * accessibility/radio-button-group-members.html:
        * accessibility/radio-button-title-label.html:
        * accessibility/selection-states-expected.txt:
        * accessibility/selection-states.html:
        * accessibility/spinbutton-value.html:
        * accessibility/svg-bounds.html:
        * accessibility/table-cell-for-column-and-row-crash.html:
        * accessibility/table-cells-roles.html:
        * accessibility/table-roles-hierarchy.html:
        * accessibility/table-with-aria-role.html:
        * accessibility/textarea-insertion-point-line-number.html:
        * accessibility/textbox-role-reports-selection.html:
        * accessibility/title-ui-element-correctness.html:
        * accessibility/unknown-roles-not-exposed-expected.txt:
        * accessibility/unknown-roles-not-exposed.html:
        * accessibility/win/bstr-elements-role.html:
        * accessibility/win/detached-object-notification-crash.html:
        * accessibility/win/heading-elements.html:
        * accessibility/win/img-alt-attribute.html:
        * accessibility/win/linked-elements.html:
        * accessibility/win/list-item-role.html:
        * accessibility/win/list-marker-role.html:
        * accessibility/win/list-role.html:
        * accessibility/win/multiple-select-element-role.html:
        * accessibility/win/option-element-position-and-size.html:
        * accessibility/win/parent-element.html:
        * accessibility/win/select-element-role.html:
        * accessibility/win/selection-and-focus.html:
        * accessibility/win/single-select-children-changed.html:
        * accessibility/win/single-select-children.html:
        * accessibility/win/text-role.html:
        * platform/mac-wk1/accessibility/loading-iframe-updates-axtree-expected.txt:
        * platform/mac-wk2/accessibility/deleting-iframe-destroys-axcache-expected.txt:
        * platform/mac/accessibility/deleting-iframe-destroys-axcache-expected.txt:
        * platform/mac/accessibility/media-element-expected.txt:
        * platform/mac/accessibility/table-cells-roles-expected.txt:
        * platform/mac/accessibility/table-roles-hierarchy-expected.txt:

2017-05-19  Matt Lewis  <jlewis3@apple.com>

        Rebaselined js/dom/global-constructors-attributes.html after revision 217129
        

        Unreviewed test gardening.

        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-05-19  Chris Dumez  <cdumez@apple.com>

        URLSearchParams / Headers objects @@iterator is not as per Web IDL spec
        https://bugs.webkit.org/show_bug.cgi?id=172218

        Reviewed by Youenn Fablet.

        * fast/text/font-face-set-javascript-expected.txt:
        * fast/text/font-face-set-javascript.html:
        Fix FontFaceSet test which wrong expected FontFaceSet's entries() to return
        a pair iterator. It does not make sense to return a pair iterator here given
        that this is not a key-value structure. FontFaceSet should not even have an
        entries() method but this is an artifact of us using iterable<FontFace> instead of
        setlike<FontFace> until we support setlike<> (Bug 159140).

2017-05-19  Zalan Bujtas  <zalan@apple.com>

        Redundant ellipsis box triggers ASSERT_WITH_SECURITY_IMPLICATION in InlineBox::parent().
        https://bugs.webkit.org/show_bug.cgi?id=172309
        <rdar://problem/32262357>

        Reviewed by Simon Fraser.

        * fast/inline/redundant-ellipsis-triggers-assert-incorrectly-expected.txt: Added.
        * fast/inline/redundant-ellipsis-triggers-assert-incorrectly.html: Added.

2017-05-19  Ryan Haddad  <ryanhaddad@apple.com>

        LayoutTest js/Promise-types.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=171739

        Unreviewed follow-up fix for JSC tests.

        * js/script-tests/Promise-types.js:

2017-05-19  Youenn Fablet  <youenn@apple.com>

        Align MockRealtimeMediaSourceCenter with RealtimeMediaSourceCenter
        https://bugs.webkit.org/show_bug.cgi?id=172324

        Reviewed by Eric Carlson.

        * fast/mediastream/mock-media-source-webaudio.html:

2017-05-19  Alexey Proskuryakov  <ap@apple.com>

        Many CSS js-tests use waitUntilDone
        https://bugs.webkit.org/show_bug.cgi?id=172379

        Reviewed by Tim Horton.

        Corrected the use of js-test harness, updated the tests to use js-test.js instead
        of js-test-pre.js where possible.

        * css3/filters/should-not-have-compositing-layer-expected.txt:
        * css3/filters/should-not-have-compositing-layer.html:
        * css3/scroll-snap/nested-elements-expected.txt:
        * css3/scroll-snap/nested-elements.html:
        * css3/scroll-snap/scroll-snap-2d-change-axis-type-expected.txt:
        * css3/scroll-snap/scroll-snap-2d-change-axis-type.html:
        * css3/scroll-snap/scroll-snap-2d-offsets-computed-independently-expected.txt:
        * css3/scroll-snap/scroll-snap-2d-offsets-computed-independently.html:
        * css3/scroll-snap/scroll-snap-elements-container-larger-than-children-expected.txt:
        * css3/scroll-snap/scroll-snap-elements-container-larger-than-children.html:
        * css3/scroll-snap/scroll-snap-mismatch-expected.txt:
        * css3/scroll-snap/scroll-snap-mismatch.html:
        * css3/scroll-snap/scroll-snap-offsets-expected.txt:
        * css3/scroll-snap/scroll-snap-offsets.html:
        * css3/scroll-snap/scroll-snap-positions-expected.txt:
        * css3/scroll-snap/scroll-snap-positions-mainframe-expected.txt:
        * css3/scroll-snap/scroll-snap-positions-mainframe.html:
        * css3/scroll-snap/scroll-snap-positions-overflow-resize-expected.txt:
        * css3/scroll-snap/scroll-snap-positions-overflow-resize.html:
        * css3/scroll-snap/scroll-snap-positions.html:
        * css3/scroll-snap/scroll-snap-style-changed-align-expected.txt:
        * css3/scroll-snap/scroll-snap-style-changed-align.html:
        * css3/touch-action/touch-action-manipulation-fast-clicks.html:
        * fast/css/counters/2displays-expected.txt:
        * fast/css/counters/2displays.html:
        * fast/css/counters/after-continuation-expected.txt:
        * fast/css/counters/after-continuation.html:
        * fast/css/counters/counter-increment-inherit-expected.txt:
        * fast/css/counters/counter-increment-inherit.htm:
        * fast/css/counters/counter-increment-tests-expected.txt:
        * fast/css/counters/counter-increment-tests.htm:
        * fast/css/device-aspect-ratio.html:
        * fast/css/hover-display-block-inline-expected.txt:
        * fast/css/hover-display-block-inline.html:
        * fast/css/hover-display-block-none-expected.txt:
        * fast/css/hover-display-block-none.html:
        * fast/css/image-resolution/image-resolution.html:
        * fast/css/max-device-aspect-ratio.html:
        * fast/css/min-device-aspect-ratio.html:
        * fast/css/pseudo-target-indirect-sibling-001.html:
        * fast/css/pseudo-target-indirect-sibling-002.html:

2017-05-19  Ryan Haddad  <ryanhaddad@apple.com>

        Skip tests that are reporting FailureNotTested.
        https://bugs.webkit.org/show_bug.cgi?id=172378

        Unreviewed test gardening.

        * TestExpectations:
        * platform/ios-wk2/TestExpectations:
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:

2017-05-19  Ryan Haddad  <ryanhaddad@apple.com>

        LayoutTest js/Promise-types.html is a flaky failure (Unhandled Promise Rejection messages)
        https://bugs.webkit.org/show_bug.cgi?id=171739

        Reviewed by Joseph Pecoraro.

        Silence the console messages for unhandled rejections in this LayoutTest.

        * js/script-tests/Promise-types.js:

2017-05-19  Zalan Bujtas  <zalan@apple.com>

        LayoutTests/accessibility/mac/aria-multiple-liveregions-notification.html should force layout after r216726.
        https://bugs.webkit.org/show_bug.cgi?id=172363
        <rdar://problem/32182167>

        Reviewed by Simon Fraser.

        10ms timer is too short to securely ensure a layout. Let's force it instead.

        * accessibility/mac/aria-multiple-liveregions-notification.html:

2017-05-19  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r217098, r217111, r217113, and
        r217114.
        https://bugs.webkit.org/show_bug.cgi?id=172367

        These changes broke the Windows build and introduced
        LayoutTest failures (Requested by ryanhaddad on #webkit).

        Reverted changesets:

        "[MSE][Mac] Support painting MSE video-element to canvas"
        https://bugs.webkit.org/show_bug.cgi?id=125157
        http://trac.webkit.org/changeset/217098

        "[MSE][Mac] Support painting MSE video-element to canvas"
        https://bugs.webkit.org/show_bug.cgi?id=125157
        http://trac.webkit.org/changeset/217111

        "Unreviewed build fix; add undefined functions and constants
        to the CoreMediaSoftLink.h, and use the"
        http://trac.webkit.org/changeset/217113

        "[MSE][Mac] Support painting MSE video-element to canvas"
        https://bugs.webkit.org/show_bug.cgi?id=125157
        http://trac.webkit.org/changeset/217114

2017-05-19  Andy Estes  <aestes@apple.com>

        REGRESSION (r217078): window.ApplePaySession is undefined on macOS Sierra
        https://bugs.webkit.org/show_bug.cgi?id=172344

        Reviewed by Tim Horton.

        * TestExpectations: Removed http/tests/ssl/applepay/ApplePaySession.html

2017-05-19  Chris Dumez  <cdumez@apple.com>

        CSSOM insertRule() index argument is optional with default 0
        https://bugs.webkit.org/show_bug.cgi?id=172219

        Reviewed by Sam Weinig.

        Update / Rebaseline existing tests to reflect behavior change.

        * fast/css/CSSSupportsRule-parameters-expected.txt:
        * fast/css/CSSSupportsRule-parameters.html:
        * fast/css/stylesheet-parameters-expected.txt:
        * fast/css/stylesheet-parameters.html:
        * fast/dom/non-numeric-values-numeric-parameters-expected.txt:

2017-05-19  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed GTK+ gardening. Adding or updating test expectations for
        four W3C layout tests covering MSE and IndexedDB implementations.

        * platform/gtk/TestExpectations:

2017-05-19  Jer Noble  <jer.noble@apple.com>

        [MSE][Mac] Support painting MSE video-element to canvas
        https://bugs.webkit.org/show_bug.cgi?id=125157
        <rdar://problem/23062016>

        Reviewed by Eric Carlson.

        * media/media-source/content/test-fragmented.mp4:

2017-05-19  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed GTK+ gardening.

        * platform/gtk/TestExpectations: Skip Apple Pay layout tests. Update one
        http/tests/loading/resourceLoadStatistics test expectation.
        * platform/gtk/http/tests/dom/document-attributes-null-handling-expected.txt: Update after r217091.

2017-05-18  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r217079.

        This change broke internal builds.

        Reverted changeset:

        "Redundant ellipsis box triggers
        ASSERT_WITH_SECURITY_IMPLICATION in InlineBox::parent()."
        https://bugs.webkit.org/show_bug.cgi?id=172309
        http://trac.webkit.org/changeset/217079

2017-05-18  Chris Dumez  <cdumez@apple.com>

        [macOS Sierra] Layout Test http/tests/dom/document-attributes-null-handling.html is flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172311

        Reviewed by Andreas Kling.

        Not sure why the cookies are sometimes returned by CFNetwork in a different order. However,
        what matters and what we want to test is that the cookie was actually added so make the
        test not rely on a specific order to address flakiness.

        * http/tests/dom/document-attributes-null-handling-expected.txt:
        * http/tests/dom/document-attributes-null-handling.html:

2017-05-18  Andy Estes  <aestes@apple.com>

        Unreviewed gardening on ApplePaySession.html after r217078.

        * TestExpectations: Expect failure until webkit.org/b/172344 is fixed.

2017-05-18  Andy Estes  <aestes@apple.com>

        Unreviewed gardening on ApplePaySession.html after r217078.

        The ApplePayError tests are only expected to pass when APPLE_PAY_DELEGATE is enabled, so
        this breaks them out into their own file so that they can be skipped independently from
        ApplePaySession.html.

        * http/tests/ssl/applepay/ApplePayError-expected.txt: Added.
        * http/tests/ssl/applepay/ApplePayError.html: Added.
        * http/tests/ssl/applepay/ApplePaySession-expected.txt:
        * http/tests/ssl/applepay/ApplePaySession.html:
        * platform/mac-wk2/TestExpectations:

2017-05-18  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline js/dom/global-constructors-attributes.html after r217078.

        Unreviewed test gardening.

        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-05-18  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] do not cache gUM permissions
        https://bugs.webkit.org/show_bug.cgi?id=172245

        Reviewed by Youenn Fablet.

        * fast/mediastream/MediaDevices-getUserMedia-expected.txt: Updated.
        * fast/mediastream/MediaDevices-getUserMedia.html:
        * http/tests/media/media-stream/get-user-media-prompt-expected.txt:
        * http/tests/media/media-stream/get-user-media-prompt.html:

2017-05-18  Zalan Bujtas  <zalan@apple.com>

        Redundant ellipsis box triggers ASSERT_WITH_SECURITY_IMPLICATION in InlineBox::parent().
        https://bugs.webkit.org/show_bug.cgi?id=172309
        <rdar://problem/32262357>

        Reviewed by Simon Fraser.

        * fast/inline/redundant-ellipsis-triggers-assert-incorrectly-expected.txt: Added.
        * fast/inline/redundant-ellipsis-triggers-assert-incorrectly.html: Added.

2017-05-18  Simon Fraser  <simon.fraser@apple.com>

        Add a test to ensure that media controls don't trigger composting of ancestors via "isolates blending"
        https://bugs.webkit.org/show_bug.cgi?id=172320

        Reviewed by Dean Jackson.

        Test that makes some source-less and sourced audio and video controls, and dumps
        the layer tree to ensure that they didn't trigger compositing on their ancestor
        stacking context element.

        * media/controls-should-not-trigger-isolates-blending-expected.txt: Added.
        * media/controls-should-not-trigger-isolates-blending.html: Added.

2017-05-18  Dean Jackson  <dino@apple.com>

        Transform misplaces element 50% of the time
        https://bugs.webkit.org/show_bug.cgi?id=172300
        <rdar://problem/29835668>

        Reviewed by Simon Fraser.

        A test case which has an animation that relies on
        translation percentages. If all goes well, the
        animating element will be completely obscured.

        * animations/needs-layout-expected.html: Added.
        * animations/needs-layout.html: Added.

2017-05-18  Daniel Bates  <dabates@apple.com>

        Improve error message for Access-Control-Allow-Origin violation due to misconfigured server
        https://bugs.webkit.org/show_bug.cgi?id=162819
        <rdar://problem/28575938>

        Reviewed by Joseph Pecoraro.

        Add more tests when Access-Control-Allow-Origin has more than one value and group
        with existing tests. Update expected results.

        * http/tests/xmlhttprequest/origin-exact-matching-expected.txt:
        * http/tests/xmlhttprequest/resources/origin-exact-matching-iframe.html: Also extracted
        the origin string for the page into a local variable called pageOrigin, making use of document.origin,
        and referenced this variable instead of duplicating its value. Fixed various style nits.

2017-05-18  John Wilander  <wilander@apple.com>

        Resource Load Statistics: Grandfather domains for existing data records
        https://bugs.webkit.org/show_bug.cgi?id=172155
        <rdar://problem/24913532>

        Reviewed by Alex Christensen.

        * http/tests/loading/resourceLoadStatistics/grandfathering-expected.txt: Added.
        * http/tests/loading/resourceLoadStatistics/grandfathering.html: Added.
        * platform/wk2/TestExpectations:
            Marked it Pass for WebKit2.

2017-05-18  Keith Miller  <keith_miller@apple.com>

        Fix wasm-mem-post-message.html test expectations
        https://bugs.webkit.org/show_bug.cgi?id=172308

        Unreviewed, test gardening.

        * platform/ios-simulator/TestExpectations:
        * platform/win/TestExpectations:

2017-05-18  Jer Noble  <jer.noble@apple.com>

        Allow nested timers to propagate user gestures so long as the total nested interval is less than 1s.
        https://bugs.webkit.org/show_bug.cgi?id=172173

        Reviewed by Andy Estes.

        * fast/events/popup-blocked-from-untrusted-mouse-click.html:
        * fast/events/popup-blocking-timers4-expected.txt: Removed.
        * fast/events/popup-blocking-timers4.html: Removed.
        * media/restricted-audio-playback-with-multiple-settimeouts-expected.txt: Added.
        * media/restricted-audio-playback-with-multiple-settimeouts.html: Added.
        * platform/ios/TestExpectations:

2017-05-18  Daniel Bates  <dabates@apple.com>

        Evaluating window named element may return wrong result
        https://bugs.webkit.org/show_bug.cgi?id=166792
        <rdar://problem/29801059>

        Reviewed by Chris Dumez.

        Add tests to ensure we do not regress evaluation of window named elements.

        * http/tests/security/named-window-property-from-same-origin-inactive-document-expected.txt: Added.
        * http/tests/security/named-window-property-from-same-origin-inactive-document.html: Added.
        * http/tests/security/resources/innocent-victim-with-named-elements.html: Added.
        * http/tests/security/xss-DENIED-named-window-property-from-cross-origin-inactive-document-expected.txt: Added.
        * http/tests/security/xss-DENIED-named-window-property-from-cross-origin-inactive-document.html: Added.

2017-05-18  Andy Estes  <aestes@apple.com>

        Add "countryCode" to ApplePayErrorContactField
        https://bugs.webkit.org/show_bug.cgi?id=172264
        <rdar://problem/32004909>

        Reviewed by Anders Carlsson.

        * http/tests/ssl/applepay/ApplePaySession-expected.txt:
        * http/tests/ssl/applepay/ApplePaySession.html:

2017-05-18  Daniel Bates  <dabates@apple.com>

        REGRESSION (r209608): Cross-origin plugin document opened in child window blocked by parent
        window CSP when object-src 'none' is set
        https://bugs.webkit.org/show_bug.cgi?id=172038
        <rdar://problem/32258262>

        Reviewed by Andy Estes.

        Adds tests to ensure that a same-origin- and cross-origin- plugin document opened in a child
        window inherit and do not inherit the CSP of its opener, respectively. Also adds a test to
        ensure that an about:blank window inherits the CSP plugin policy of its opener.

        * http/tests/plugins/resources/plugin-document-alert-and-notify-done.pl: Added.
        * http/tests/security/contentSecurityPolicy/cross-origin-plugin-document-allowed-in-child-window-expected.txt: Added.
        * http/tests/security/contentSecurityPolicy/cross-origin-plugin-document-allowed-in-child-window.html: Added.
        * http/tests/security/contentSecurityPolicy/plugin-blocked-in-about-blank-window-expected.txt: Added.
        * http/tests/security/contentSecurityPolicy/plugin-blocked-in-about-blank-window.html: Added.
        * http/tests/security/contentSecurityPolicy/same-origin-plugin-document-blocked-in-child-window-expected.txt: Added.
        * http/tests/security/contentSecurityPolicy/same-origin-plugin-document-blocked-in-child-window.html: Added.
        * platform/ios/TestExpectations: Skip added tests as iOS does not support plugins.

2017-05-18  Keith Miller  <keith_miller@apple.com>

        WebAssembly API: test with neutered inputs
        https://bugs.webkit.org/show_bug.cgi?id=163899

        Reviewed by JF Bastien.

        This patch dups Saam's de-modularized builder.

        * workers/sab/postMessage-transfer-type-error-expected.txt:
        * workers/wasm-mem-post-message-expected.txt: Added.
        * workers/wasm-mem-post-message.html: Added.
        * workers/wasm-mem-post-message/test.js: Added.
        (worker.onmessage):
        * workers/wasm-mem-post-message/worker.js: Added.
        (onmessage):
        * workers/wasm-resources/builder.js: Added.
        (const._fail):
        (const.isNotA.assert.isNotA):
        (const):
        (switch.typeof):
        (Builder):
        (Builder.prototype.setChecked):
        (Builder.prototype.setPreamble):
        (Builder.prototype._functionIndexSpaceKeyHash):
        (Builder.prototype._registerFunctionToIndexSpace):
        (Builder.prototype._getFunctionFromIndexSpace):
        (Builder.prototype._registerSectionBuilders.const.section.in.WASM.description.section.switch.section.case.string_appeared_here.this.section):
        (Builder.prototype._registerSectionBuilders.const.section.in.WASM.description.section.switch.section.const.codeBuilder.End.switch.case.string_appeared_here.e):
        (Builder.prototype._registerSectionBuilders.this.Unknown):

2017-05-18  Chris Dumez  <cdumez@apple.com>

        Update web-platform-tests tools
        https://bugs.webkit.org/show_bug.cgi?id=172247

        Reviewed by Youenn Fablet.

        * platform/mac/imported/w3c/web-platform-tests/media-source/interfaces-expected.txt:

2017-05-18  Antti Koivisto  <antti@apple.com>

        Design mode should not affect UA shadow trees
        https://bugs.webkit.org/show_bug.cgi?id=171854
        <rdar://problem/32071037>

        Reviewed by Zalan Bujtas.

        * editing/deleting/search-shadow-tree-delete-expected.txt: Added.
        * editing/deleting/search-shadow-tree-delete.html: Added.

2017-05-18  Miguel Gomez  <magomez@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of tests failing after r217039.

        * platform/gtk/TestExpectations:

2017-05-17  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r217014.

        This change caused mac-wk2 LayoutTests to exit early due to
        crashes.

        Reverted changeset:

        "Resource Load Statistics: Grandfather domains for existing
        data records"
        https://bugs.webkit.org/show_bug.cgi?id=172155
        http://trac.webkit.org/changeset/217014

2017-05-17  Zalan Bujtas  <zalan@apple.com>

        Tighten TextIterator::handleTextNode run-renderer mapping logic.
        https://bugs.webkit.org/show_bug.cgi?id=172174

        Reviewed by Antti Koivisto.

        * fast/shadow-dom/slot-crash-expected.txt:

2017-05-17  John Wilander  <wilander@apple.com>

        Resource Load Statistics: Grandfather domains for existing data records
        https://bugs.webkit.org/show_bug.cgi?id=172155
        <rdar://problem/24913532>

        Reviewed by Alex Christensen.

        * http/tests/loading/resourceLoadStatistics/grandfathering-expected.txt: Added.
        * http/tests/loading/resourceLoadStatistics/grandfathering.html: Added.
        * platform/wk2/TestExpectations:
            Marked it Pass for WebKit2.

2017-05-17  Zalan Bujtas  <zalan@apple.com>

        Debug ASSERT: WebCore::RenderImageResource::shutdown
        https://bugs.webkit.org/show_bug.cgi?id=172238
        <rdar://problem/30064601>

        Reviewed by Simon Fraser.

        * fast/images/assert-when-insertion-point-is-incorrect-expected.txt: Added.
        * fast/images/assert-when-insertion-point-is-incorrect.html: Added.

2017-05-17  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/appcache/404-resource-with-slow-main-resource.php as flaky on mac-wk1.
        https://bugs.webkit.org/show_bug.cgi?id=172241

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-05-17  Chris Dumez  <cdumez@apple.com>

        Setting URL.search to '' results in a stringified URL ending in '?'
        https://bugs.webkit.org/show_bug.cgi?id=162345
        <rdar://problem/31800441>

        Reviewed by Alex Christensen.

        * fast/dom/DOMURL/set-href-attribute-search-expected.txt:
        * fast/dom/DOMURL/set-href-attribute-search.html:
        * fast/dom/HTMLAnchorElement/script-tests/set-href-attribute-search.js:
        * fast/dom/HTMLAnchorElement/set-href-attribute-search-expected.txt:
        Update / rebaseline existing tests to reflect behavior change.

        * platform/ios-wk1/TestExpectations:
        * platform/mac-wk1/TestExpectations:
        Unskip url-setters.html test as it seems to be passing for me on WK1.

2017-05-17  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] videoWidth and videoHeight should be set when 'loadedmetadata' event fires
        https://bugs.webkit.org/show_bug.cgi?id=172223
        <rdar://problem/31899755>

        Reviewed by Jer Noble.

        * fast/mediastream/get-user-media-on-loadedmetadata-expected.txt: Added.
        * fast/mediastream/get-user-media-on-loadedmetadata.html: Added.

2017-05-17  Youenn Fablet  <youenn@apple.com>

        iOS WebRTC Media Capture should not allow camera capture from background tab
        https://bugs.webkit.org/show_bug.cgi?id=172200

        Reviewed by Eric Carlson.

        * platform/ios/mediastream/getUserMedia-disabled-in-background-tabs-expected.txt: Added.
        * platform/ios/mediastream/getUserMedia-disabled-in-background-tabs.html: Added.

2017-05-15  Jiewen Tan  <jiewen_tan@apple.com>

        Replace CryptoOperationData with BufferSource for WebKitSubtleCrypto
        https://bugs.webkit.org/show_bug.cgi?id=172146
        <rdar://problem/32122256>

        Reviewed by Brent Fulgham.

        * crypto/webkitSubtle/argument-conversion-expected.txt:
        * crypto/webkitSubtle/import-export-raw-key-leak-expected.txt: Added.
        * crypto/webkitSubtle/import-export-raw-key-leak.html: Added.

2017-05-17  Chris Dumez  <cdumez@apple.com>

        Unreviewed, skip newly imported notifications tests on iOS

        Notifications are not enabled on iOS.

        * platform/ios/TestExpectations:

2017-05-17  Ryan Haddad  <ryanhaddad@apple.com>

        Mark two http/tests/media/hls/video tests as failing during investigation.
        https://bugs.webkit.org/show_bug.cgi?id=171814

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-05-17  Nan Wang  <n_wang@apple.com>

        ASSERTION FAILED in WebCore::AccessibilityNodeObject::insertChild()
        https://bugs.webkit.org/show_bug.cgi?id=171927
        <rdar://problem/32109781>

        Reviewed by Chris Fleizach.

        * accessibility/insert-children-assert-expected.txt: Added.
        * accessibility/insert-children-assert.html: Added.

2017-05-17  Chris Dumez  <cdumez@apple.com>

        Import Notification tests from web-platform-tests
        https://bugs.webkit.org/show_bug.cgi?id=172196

        Reviewed by Youenn Fablet.

        * resources/testharnessreport.js:
        Allow notifications as this is a pre-requirement for web-platform-tests.

2017-05-17  Ryosuke Niwa  <rniwa@webkit.org>

        getElementById can return a wrong elemnt when a matching element is removed during beforeload event
        https://bugs.webkit.org/show_bug.cgi?id=171374

        Reviewed by Brent Fulgham.

        Added a regression test for calling getElementById after removing a matching element
        during beforeload event of a link element.

        * fast/html/link-element-removal-during-beforeload-expected.txt: Added.
        * fast/html/link-element-removal-during-beforeload.html: Added.

2017-05-17  Chris Dumez  <cdumez@apple.com>

        Unreviewed, rebaseline js/dom/global-constructors-attributes.html after r216959.

        * js/dom/global-constructors-attributes-expected.txt:
        * platform/gtk/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-yosemite/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:
        * platform/win/js/dom/global-constructors-attributes-expected.txt:
        * platform/wpe/js/dom/global-constructors-attributes-expected.txt:

2017-05-17  Ben Kelly  <ben@wanderview.com>

        Import FileAPI WPT tests.
        https://bugs.webkit.org/show_bug.cgi?id=171960

        Reviewed by Youenn Fablet.

        * TestExpectations:

2017-05-17  Antti Koivisto  <antti@apple.com>

        Regression (198943): <marquee> shouldn't wrap text
        https://bugs.webkit.org/show_bug.cgi?id=172217

        Reviewed by Andreas Kling.

        * fast/html/marquee-child-wrap-expected.html: Added.
        * fast/html/marquee-child-wrap.html: Added.

2017-05-17  David Kilzer  <ddkilzer@apple.com>

        REGRESSION (r216966): fast/shadow-dom/slot-crash.html started to fail

        Unreviewed test gardening.

        Update test results after the fix for:
            Do not skip <slot> children when collecting content for innerText.
            https://bugs.webkit.org/show_bug.cgi?id=172113
            <rdar://problem/30362324>

        * fast/shadow-dom/slot-crash-expected.txt: Update results to add
        a space to the end of the output.

2017-05-16  Chris Dumez  <cdumez@apple.com>

        [macOS Debug wk2] Layout test svg/animations/animations-paused-in-background-page-iframe.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=172183

        Reviewed by Andreas Kling.

        Fix test flakiness by using shouldBecome() instead of relying on a 30ms timer.

        * svg/animations/animations-paused-in-background-page-iframe-expected.txt:
        * svg/animations/animations-paused-in-background-page-iframe.html:

2017-05-16  Sam Weinig  <sam@webkit.org>

        Bring Notification.idl up to spec
        https://bugs.webkit.org/show_bug.cgi?id=172156

        Reviewed by Chris Dumez.

        * http/tests/notifications/notification-expected.txt: Added.
        * http/tests/notifications/notification.html: Added.
        Add test for basic Notification API functionality.

2017-05-16  Zalan Bujtas  <zalan@apple.com>

        Do not skip <slot> children when collecting content for innerText.
        https://bugs.webkit.org/show_bug.cgi?id=172113
        <rdar://problem/30362324>

        Reviewed by Ryosuke Niwa and Brent Fulgham.

        * fast/text/inner-text-should-include-slot-subtree-expected.txt: Added.
        * fast/text/inner-text-should-include-slot-subtree.html: Added.

2017-05-16  Jiewen Tan  <jiewen_tan@apple.com>

        Unreviewed, fix LayoutTests/plugins/navigator-plugin-crash.html
        <rdar://problem/32236478>

        * plugins/navigator-plugin-crash-expected.txt:
        * plugins/navigator-plugin-crash.html:

2017-05-16  Chris Dumez  <cdumez@apple.com>

        Implement DOMMatrix / DOMMatrixReadOnly
        https://bugs.webkit.org/show_bug.cgi?id=110001

        Reviewed by Sam Weinig and Simon Fraser.

        Drop test I previously added now that a better version landed in web-platform-tests
        and was re-imported in this patch.

        * fast/css/matrix-stringifier-expected.txt: Removed.
        * fast/css/matrix-stringifier.html: Removed.

2017-05-16  Myles C. Maxfield  <mmaxfield@apple.com>

        REGRESSION(r212513): LastResort is platform-dependent, so its semantics should not be required to perform font loading correctly.
        https://bugs.webkit.org/show_bug.cgi?id=168487

        Reviewed by Antti Koivisto.

        * fast/text/font-download-font-face-src-list-expected.txt: Added.
        * fast/text/font-download-font-face-src-list.html: Copied from LayoutTests/fast/text/font-weight-download-2.html.
        * fast/text/font-download-font-family-property-expected.txt: Added.
        * fast/text/font-download-font-family-property.html: Copied from LayoutTests/fast/text/font-weight-download-2.html.
        * fast/text/font-download-remote-fallback-all-expected.txt: Added.
        * fast/text/font-download-remote-fallback-all.html: Copied from LayoutTests/fast/text/font-weight-download-2.html.
        * fast/text/font-interstitial-invisible-width-while-loading-expected.txt: Added.
        * fast/text/font-interstitial-invisible-width-while-loading.html: Added.
        * fast/text/font-weight-download-2.html:
        * fast/text/font-weight-download-3-expected.txt: Added.
        * fast/text/font-weight-download-3.html: Copied from LayoutTests/fast/text/font-weight-download-2.html.
        * fast/text/web-font-load-fallback-during-loading-2-expected.html: Added.
        * fast/text/web-font-load-fallback-during-loading-2.html: Added.
        * fast/text/web-font-load-fallback-during-loading-expected.html:
        * fast/text/web-font-load-fallback-during-loading.html:
        * fast/text/web-font-load-invisible-during-loading-expected.txt: Added.
        * fast/text/web-font-load-invisible-during-loading.html: Added.
        * http/tests/webfont/fallback-font-while-loading-expected.txt:
        * http/tests/webfont/fallback-font-while-loading.html:

2017-05-16  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] Return default device list until user gives permission to capture
        https://bugs.webkit.org/show_bug.cgi?id=172168
        <rdar://problem/31816884>

        Reviewed by Youenn Fablet.

        * fast/mediastream/MediaDevices-enumerateDevices-expected.txt: Removed.
        * fast/mediastream/MediaDevices-enumerateDevices.html: Removed.
        * fast/mediastream/media-devices-enumerate-devices-expected.txt: Added.
        * fast/mediastream/media-devices-enumerate-devices.html: Added.

2017-05-16  Tim Horton  <timothy_horton@apple.com>

        Make it possible to adjust which edges are affected by safe area insets
        https://bugs.webkit.org/show_bug.cgi?id=172149
        <rdar://problem/31564729>

        Reviewed by Beth Dakin.

        * fast/viewport/ios/viewport-fit-auto-expected.txt:
        * fast/viewport/ios/viewport-fit-contain-expected.txt:

2017-05-16  Mark Lam  <mark.lam@apple.com>

        Gardening: rebased parser-syntax-check test results after r216891.
        https://bugs.webkit.org/show_bug.cgi?id=172171

        Not reviewed.

        * js/parser-syntax-check-expected.txt:
        * js/script-tests/parser-syntax-check.js:

2017-05-16  Ryan Haddad  <ryanhaddad@apple.com>

        Skip LayoutTest media/restricted-audio-playback-with-document-gesture.html on iOS.

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-05-16  Claudio Saavedra  <csaavedra@igalia.com>

        [GTK] Tests that always pass when run alone, but fail in the bots
        https://bugs.webkit.org/show_bug.cgi?id=168572

        Reviewed by Michael Catanzaro.

        PlatformWebView::viewSupportsOptions() is basically a comparison
        that checks that the passed options are the ones supported by the
        web view. There is no reason for them to be implemented for each
        platform differently. In fact doing so causes issues each time a
        new option is added, if the corresponding platform implementation
        is not updated accordingly.

        A consequence of not updating the viewSupportOptions()
        implementations when new options are added is that tests that need
        these options might fail if they are executed after a test that
        didn't need the option, as the webview will be reused even if the
        option is not supported. This cannot be spotted when running the
        tests individually. See bug #165133 for other example of the same
        problem.

        Remove the platform implementations and make the comparison a
        method of the TestOptions structure, so that the check is in one
        place. For the time being include in the comparison the options
        checked in the mac and ios platforms, which seem to be the only
        ones relevant this far (unless newer ones have also been
        forgotten).

        * platform/gtk/TestExpectations: Unskip an affected test.

2017-05-16  Romain Bellessort  <romain.bellessort@crf.canon.fr>

        [Readable Streams API] Implement ReadableStreamBYOBReader releaseLock()
        https://bugs.webkit.org/show_bug.cgi?id=172111

        Reviewed by Chris Dumez.

        Added tests to check releaseLock() behavior.

        * streams/readable-stream-byob-reader-expected.txt: Updated.
        * streams/readable-stream-byob-reader.js: Added new tests.

2017-05-16  Per Arne Vollan  <pvollan@apple.com>

        Unreviewed Windows gardening. Skip svg animation test, since image throttling behaves differently on WK1.

        * platform/win/TestExpectations:

2017-05-16  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Rebaseline tests after r216817.

        * platform/gtk/fast/multicol/client-rects-expected.txt:
        * platform/gtk/fast/multicol/client-rects-spanners-complex-expected.txt:
        * platform/gtk/fast/multicol/client-rects-spanners-expected.txt:
        * platform/gtk/fast/multicol/newmulticol/client-rects-expected.txt:
        * platform/gtk/fast/transforms/bounding-rect-zoom-expected.txt:

2017-05-16  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of several WebRTC tests.

        * platform/gtk/TestExpectations:

2017-05-16  Manuel Rego Casasnovas  <rego@igalia.com>

        [css-grid] Fix static position of positioned grid items
        https://bugs.webkit.org/show_bug.cgi?id=172108

        Reviewed by Sergio Villar Senin.

        The test is updated as the expected results were wrong.
        Note that after this patch we match Chrome and Firefox behavior on this test.

        * fast/css-grid-layout/absolute-positioning-grid-container-parent.html:

2017-05-15  Said Abou-Hallawa  <sabouhallawa@apple.com>

        Do not delete asynchronously decoded frames for large images if their clients are in the viewport
        https://bugs.webkit.org/show_bug.cgi?id=170640

        Reviewed by Simon Fraser.

        * fast/images/async-image-background-image-repeated.html:
        * fast/images/async-image-background-image.html:
        * fast/images/sprite-sheet-image-draw.html:

2017-05-15  Youenn Fablet  <youenn@apple.com>

        WebRTC outgoing muted video sources should send black frames
        https://bugs.webkit.org/show_bug.cgi?id=170627
        <rdar://problem/31513869>

        Reviewed by Eric Carlson.

        * webrtc/video-mute-expected.txt:
        * webrtc/video-mute.html:

2017-05-15  Mark Lam  <mark.lam@apple.com>

        Rolling out r214038 and r213697: Crashes when using computed properties with rest destructuring and object spread.
        https://bugs.webkit.org/show_bug.cgi?id=172147

        Rubber-stamped by Saam Barati.

        * js/parser-syntax-check-expected.txt:
        * js/script-tests/parser-syntax-check.js:

2017-05-15  Chris Dumez  <cdumez@apple.com>

        Unreviewed, rebaseline platform/ios/ios/css/construct-WebKitCSSMatrix.html after r216881.

        * platform/ios/ios/css/construct-WebKitCSSMatrix-expected.txt:
        * platform/ios/ios/css/resources/construct-WebKitCSSMatrix.js:

2017-05-15  Jer Noble  <jer.noble@apple.com>

        Add experimental setting to allow document gesture interaction to fulfill media playback gesture requirement
        https://bugs.webkit.org/show_bug.cgi?id=172131

        Reviewed by Eric Carlson.

        * media/restricted-audio-playback-with-document-gesture-expected.txt: Added.
        * media/restricted-audio-playback-with-document-gesture.html: Added.

2017-05-15  Per Arne Vollan  <pvollan@apple.com>

        LayoutTest http/tests/media/track-in-band-hls-metadata-crash.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=167749

        Reviewed by Eric Carlson.

        Start video playback when the 'canplaythrough' event is handled, and stop logging the event,
        since the event sequence is not identical on all bots.

        * http/tests/media/track-in-band-hls-metadata-crash-expected.txt:
        * http/tests/media/track-in-band-hls-metadata-crash.html:

2017-05-15  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: CRASH seen with DOM.setOuterHTML when there is no documentElement
        https://bugs.webkit.org/show_bug.cgi?id=172135
        <rdar://problem/32175860>

        Reviewed by Brian Burg.

        * inspector/dom/setOuterHTML-no-document-element-expected.txt: Added.
        * inspector/dom/setOuterHTML-no-document-element.html: Added.

2017-05-15  Chris Dumez  <cdumez@apple.com>

        Align WebKitCSSMatrix stringifier with spec for DOMMatrix
        https://bugs.webkit.org/show_bug.cgi?id=172114

        Reviewed by Simon Fraser.

        * fast/css/matrix-stringifier-expected.txt: Added.
        * fast/css/matrix-stringifier.html: Added.
        Add layout test coverage.

        * fast/dom/Window/custom-constructors-expected.txt:
        * fast/dom/Window/custom-constructors.html:
        Rebaseline existing test to reflect behavior change.

2017-05-15  Mark Lam  <mark.lam@apple.com>

        WorkerRunLoop::Task::performTask() should check !scriptController->isTerminatingExecution().
        https://bugs.webkit.org/show_bug.cgi?id=171775
        <rdar://problem/30975761>

        Reviewed by Filip Pizlo.

        * TestExpectations:

2017-05-15  Myles C. Maxfield  <mmaxfield@apple.com>

        Unicode characters which can't be rendered in any font are invisible
        https://bugs.webkit.org/show_bug.cgi?id=171942
        <rdar://problem/32054234>

        Reviewed by Tim Horton.

        * fast/text/default-ignorable-expected.html: Added.
        * fast/text/default-ignorable.html: Added.
        * fast/text/unknown-char-notdef-expected-mismatch.html: Added.
        * fast/text/unknown-char-notdef.html: Added.

2017-05-15  Zalan Bujtas  <zalan@apple.com>

        Simple line layout: Leading whitespace followed by a <br> produces an extra linebreak.
        https://bugs.webkit.org/show_bug.cgi?id=172076

        Reviewed by Antti Koivisto.

        * fast/text/simple-line-layout-leading-whitespace-with-soft-hard-linebreak-expected.html: Added.
        * fast/text/simple-line-layout-leading-whitespace-with-soft-hard-linebreak.html: Added.

2017-05-15  Nael Ouedraogo  <nael.ouedraogo@crf.canon.fr>

        Invalid MediaSource duration value should throw TyperError instead of InvalidStateError
        https://bugs.webkit.org/show_bug.cgi?id=171653

        Reviewed by Chris Dumez.

        Modify MediaSource::setDuration to throw a TypeError when duration value is invalid as per MSE specification
        (https://www.w3.org/TR/2016/REC-media-source-20161117/#dom-mediasource-duration).

        Update expectations of corresponding WPT test.

        * platform/gtk/TestExpectations:
        * platform/gtk/imported/w3c/web-platform-tests/media-source/mediasource-duration-boundaryconditions-expected.txt: Added.
        * platform/mac-elcapitan/imported/w3c/web-platform-tests/media-source/mediasource-duration-boundaryconditions-expected.txt: Added.
        * platform/mac/TestExpectations:

2017-05-15  Gwang Yoon Hwang  <yoon@igalia.com>

        [CAIRO] Painting an image mask with a matrix above Pixman's limit breaks internal states of Cairo
        https://bugs.webkit.org/show_bug.cgi?id=169094

        Reviewed by Žan Doberšek.

        * fast/hidpi/hidpi-long-page-with-inset-element-expected.html: Added.
        * fast/hidpi/hidpi-long-page-with-inset-element.html: Added.

2017-05-14  Sam Weinig  <sam@webkit.org>

        [WebIDL/DOM] Remove need for custom bindings for HTMLAllCollection and bring up to spec
        https://bugs.webkit.org/show_bug.cgi?id=172095

        Reviewed by Darin Adler.

        * fast/dom/collection-null-like-arguments-expected.txt:
        Update results.

        * fast/dom/document-all-expected.txt: Added.
        * fast/dom/document-all.html: Added.
        New test that covers a bunch of missing coverage.

2017-05-14  David Kilzer  <ddkilzer@apple.com>

        [iOS/macOS Debug WK2] LayoutTests/imported/w3c/web-platform-tests/webrtc/interfaces.html is a flaky crash due to assertion failure
        <https://bugs.webkit.org/show_bug.cgi?id=172094>
        <rdar://problem/32184256>

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:
        * platform/mac-wk2/TestExpectations:
        - Mark test as flaky crash on Debug WK2 builds.

2017-05-14  David Kilzer  <ddkilzer@apple.com>

        [macOS Debug WK1] fast/parser/adoption-agency-unload-iframe-4.html is a flaky timeout (always on iOS 10 Release WK1)
        <https://webkit.org/b/172092>

        Unreviewed test gardening.

        * platform/ios-wk1/TestExpectations:
        - This only times out on Release builds.

2017-05-14  David Kilzer  <ddkilzer@apple.com>

        [macOS Debug WK1] fast/parser/adoption-agency-unload-iframe-4.html is a flaky timeout (always on iOS 10 Release WK1)
        <https://webkit.org/b/172092>

        Unreviewed test gardening.

        See also Bug 169211 for a similar GTK WK1 timeout.

        * platform/ios-wk1/TestExpectations:
        - Mark as always timing out on all builds.
        * platform/mac-wk1/TestExpectations:
        - Mark flaky on Debug builds.

2017-05-13  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] deviceId constraint doesn't work with getUserMedia
        https://bugs.webkit.org/show_bug.cgi?id=171877
        <rdar://problem/31899730>

        Reviewed by Jer Noble.

        * fast/mediastream/get-user-media-device-id-expected.txt: Added.
        * fast/mediastream/get-user-media-device-id.html: Added.
        * fast/mediastream/apply-constraints-video-expected.txt: Updated.
        * fast/mediastream/apply-constraints-video.html: Ditto.

2017-05-13  David Kilzer  <ddkilzer@apple.com>

        TestExpectations: Remove last refereneces to Legacy Notifications

        Unreviewed test gardening fixes these lint warnings:

            LayoutTests/TestExpectations:1222 Path does not exist. fast/notifications/notifications-event-stop-propagation.html
            LayoutTests/TestExpectations:1223 Path does not exist. fast/notifications/notifications-multi-events.html

        * TestExpectations: Remove references to skipped tests.  Legacy
        Notification support was removed in r216641.

2017-05-13  Ryan Haddad  <ryanhaddad@apple.com>

        Remove flaky expectation for LayoutTest media/media-controls-clone-crash.html.
        https://bugs.webkit.org/show_bug.cgi?id=171978

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-13  Javier Fernandez  <jfernandez@igalia.com>

        [css-align] Implement the place-self shorthand
        https://bugs.webkit.org/show_bug.cgi?id=168846

        Reviewed by Zalan Bujtas.

        Regression tests for the new place-self alignment shorthand.

        * css3/parse-place-self-expected.txt: Added.
        * css3/parse-place-self.html: Added.

2017-05-13  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r216801.
        https://bugs.webkit.org/show_bug.cgi?id=172072

        Many memory corruption crashes on worker threads (Requested by
        ap on #webkit).

        Reverted changeset:

        "WorkerRunLoop::Task::performTask() should check
        !scriptController->isTerminatingExecution()."
        https://bugs.webkit.org/show_bug.cgi?id=171775
        http://trac.webkit.org/changeset/216801

2017-05-12  Simon Fraser  <simon.fraser@apple.com>

        event.clientX/clientY should be in layout viewport coordinates
        https://bugs.webkit.org/show_bug.cgi?id=172018

        Reviewed by Zalan Bujtas.
        
        * fast/events/clientXY-in-zoom-and-scroll.html:
        * fast/visual-viewport/client-coordinates-relative-to-layout-viewport-expected.txt: Added.
        * fast/visual-viewport/client-coordinates-relative-to-layout-viewport.html: Added.
        * platform/ios/TestExpectations:
        * platform/mac/fast/events/clientXY-in-zoom-and-scroll-expected.txt:

2017-05-12  Simon Fraser  <simon.fraser@apple.com>

        The rects returned by Element/Range.getClientRects() should not be rounded
        https://bugs.webkit.org/show_bug.cgi?id=172057

        Reviewed by Chris Dumez.

        Fix tests that were sensitive to rounding. I had to mark fast/text/multiglyph-characters.html
        as failing (webkit.org/b/172056).

        * TestExpectations:
        * fast/dom/Document/CaretRangeFromPoint/caretRangeFromPoint-in-zoom-and-scroll.html:
        * fast/dom/Range/getClientRects-expected.txt:
        * fast/dom/Range/getClientRects.html:
        * fast/dom/Range/simple-line-layout-getclientrects-expected.html:
        * fast/dom/Range/simple-line-layout-getclientrects.html:
        * fast/visual-viewport/client-rects-relative-to-layout-viewport-expected.txt:
        * platform/ios/TestExpectations:
        * platform/ios/fast/multicol/client-rects-expected.txt:
        * platform/ios/fast/multicol/client-rects-spanners-complex-expected.txt:
        * platform/ios/fast/multicol/client-rects-spanners-expected.txt:
        * platform/ios/fast/multicol/newmulticol/client-rects-expected.txt:
        * platform/ios/fast/transforms/bounding-rect-zoom-expected.txt:
        * platform/mac/fast/multicol/client-rects-expected.txt:
        * platform/mac/fast/multicol/client-rects-spanners-complex-expected.txt:
        * platform/mac/fast/multicol/client-rects-spanners-expected.txt:
        * platform/mac/fast/multicol/newmulticol/client-rects-expected.txt:
        * platform/mac/fast/transforms/bounding-rect-zoom-expected.txt:

2017-05-12  Jiewen Tan  <jiewen_tan@apple.com>

        Elements should be inserted into a template element as its content's last child
        https://bugs.webkit.org/show_bug.cgi?id=171373
        <rdar://problem/31862949>

        Reviewed by Ryosuke Niwa.

        * fast/dom/HTMLTemplateElement/insert-fostering-child-expected.txt: Added.
        * fast/dom/HTMLTemplateElement/insert-fostering-child.html: Added.

2017-05-11  Simon Fraser  <simon.fraser@apple.com>

        Incorrect position when dragging jQuery Draggable elements with position fixed after pinch zoom
        https://bugs.webkit.org/show_bug.cgi?id=171113

        Reviewed by Tim Horton.

        Rebaseline tests which dumped the getBoundingClientRect for fixed elements; now that these
        are layout viewport-relative, getBoundingClientRect() for a fixed element is unchanging.

        New test that exercises getBoundingClientRect() and getClientRects() for fixed and absolute
        elements after zooming.

        * fast/events/autoscroll-when-zoomed.html: Adjust to account for behavior change.
        * fast/visual-viewport/client-rects-relative-to-layout-viewport-expected.txt: Added.
        * fast/visual-viewport/client-rects-relative-to-layout-viewport.html: Added.
        * fast/visual-viewport/zoomed-fixed-expected.txt:
        * fast/visual-viewport/zoomed-fixed-header-and-footer-expected.txt:
        * fast/zooming/client-rect-in-fixed-zoomed-expected.txt:
        * fast/zooming/client-rect-in-fixed-zoomed.html:
        * fast/zooming/client-rects-with-css-and-page-zoom-expected.txt: Added.
        * fast/zooming/client-rects-with-css-and-page-zoom.html: Added.
        * platform/ios-wk2/fast/visual-viewport/client-rects-relative-to-layout-viewport-expected.txt: Added.
        * platform/ios/TestExpectations: Mark imported/w3c/web-platform-tests/cssom-view/elementFromPoint.html as failing;
            it will be fixed via webkit.org/b/172019
        * platform/ios/fast/visual-viewport/zoomed-fixed-expected.txt:
        * platform/ios/fast/visual-viewport/zoomed-fixed-header-and-footer-expected.txt:

2017-05-12  Mark Lam  <mark.lam@apple.com>

        WorkerRunLoop::Task::performTask() should check !scriptController->isTerminatingExecution().
        https://bugs.webkit.org/show_bug.cgi?id=171775
        <rdar://problem/30975761>

        Reviewed by Saam Barati.

        * TestExpectations:

2017-05-12  Daniel Bates  <dabates@apple.com>

        Attempt to fix timeout failure of test plugins/navigator-plugin-crash.html in WebKit1
        following <http://trac.webkit.org/changeset/216789>
        (https://bugs.webkit.org/show_bug.cgi?id=171712)

        In r216798 I inadvertently added testRunner.setPopupBlockingEnabled(true) instead
        instead of testRunner.setPopupBlockingEnabled(false) to disable the popup blocker.

        * plugins/navigator-plugin-crash.html:

2017-05-12  Daniel Bates  <dabates@apple.com>

        Attempt to fix timeout failure of test plugins/navigator-plugin-crash.html in WebKit1
        following <http://trac.webkit.org/changeset/216789>
        (https://bugs.webkit.org/show_bug.cgi?id=171712)

        On WebKit1 we need to explicitly allow the test tool to open windows by calling
        testRunner.setCanOpenWindows(). We should also call testRunner.setCloseRemainingWindowsWhenComplete(true)
        to have the test tool close any open windows after running the test.

        It is also good practice to explicitly disable the popup blocker by calling
        testRunner.setPopupBlockingEnabled(false).

        * plugins/navigator-plugin-crash.html:

2017-05-11  Jiewen Tan  <jiewen_tan@apple.com>

        Check existence of a page before accessing its plugins
        https://bugs.webkit.org/show_bug.cgi?id=171712
        <rdar://problem/32007806>

        Reviewed by Brent Fulgham.

        * plugins/navigator-plugin-crash-expected.txt: Added.
        * plugins/navigator-plugin-crash.html: Added.

2017-05-12  Romain Bellessort  <romain.bellessort@crf.canon.fr>

        [Readable Streams API] Add ReadableStreamBYOBReader closed getter
        https://bugs.webkit.org/show_bug.cgi?id=172024

        Reviewed by Youenn Fablet.

        Added tests to check closed getter behaviour.

        * streams/readable-stream-byob-reader-expected.txt: Updated.
        * streams/readable-stream-byob-reader.js: Updated.

2017-05-12  Matt Lewis  <jlewis3@apple.com>

        Marked webrtc/closing-peerconnection.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=172034

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-12  Claudio Saavedra  <csaavedra@igalia.com>

        [GTK] After upgrading glib and glib-networking, resources with zero bytes are always identified as text/plain
        https://bugs.webkit.org/show_bug.cgi?id=171058

        Reviewed by Carlos Garcia Campos.

        GLib-based ports have issues detecting the mimetypes of empty
        files, as they are all considered to be text/plain by
        glib. Replace these resources with a minimal valid file for its
        type (that is, 1x1 PNG files and 1 whitespace for text files).

        * fast/preloader/resources/base-image1.png:
        * fast/preloader/resources/base-image2.png:
        * fast/preloader/resources/base-image3.png:
        * fast/preloader/resources/image1.png:
        * fast/preloader/resources/link1.css:
        * fast/preloader/resources/noscript-image1.png:
        * fast/preloader/resources/noscript-image2.png:
        * fast/preloader/resources/script1.js:
        * fast/preloader/resources/style1.css:
        * tables/mozilla/core/col_widths_fix_autoFixPer.html:

        * platform/gtk/TestExpectations: Unskip the now passing tests.

2017-05-12  Antti Koivisto  <antti@apple.com>

        Updating class name of a shadow host does not update the style applied by descendants of :host()
        https://bugs.webkit.org/show_bug.cgi?id=170762
        <rdar://problem/31572668>

        Reviewed by Ryosuke Niwa.

        * fast/shadow-dom/css-scoping-host-class-and-attribute-mutation-expected.html: Added.
        * fast/shadow-dom/css-scoping-host-class-and-attribute-mutation.html: Added.

2017-05-12  Claudio Saavedra  <csaavedra@igalia.com>

        [WPE] Unreviewed gardening.

        ClientRect, ClientRectList were removed, PromiseRejectionEvent was
        added, update global constructors attributes test expectations.

        * platform/wpe/js/dom/global-constructors-attributes-expected.txt:

2017-05-12  Carlos Garcia Campos  <cgarcia@igalia.com>

        [GTK] ASSERTION FAILED: !m_flushingLayers
        https://bugs.webkit.org/show_bug.cgi?id=172025

        Reviewed by Žan Doberšek.

        * platform/gtk/TestExpectations:

2017-05-12  Carlos Garcia Campos  <cgarcia@igalia.com>

        [GTK] GIF images are not properly loaded the first time
        https://bugs.webkit.org/show_bug.cgi?id=170432

        Reviewed by Carlos Alberto Lopez Perez.

        * http/tests/images/gif-progressive-load-expected.html: Added.
        * http/tests/images/gif-progressive-load.html: Added.

2017-05-12  Manuel Rego Casasnovas  <rego@igalia.com>

        [selectors4] css/selectors4/focus-within-006.html test from WPT is failing
        https://bugs.webkit.org/show_bug.cgi?id=170900

        Reviewed by Sergio Villar Senin.

        * TestExpectations: Remove test as it's passing now.

2017-05-11  Per Arne Vollan  <pvollan@apple.com>

        Geolocation requests should not be blocked when the security origin is local.
        https://bugs.webkit.org/show_bug.cgi?id=171857

        Reviewed by Brent Fulgham.

        * fast/misc/geolocation-local-security-origin-expected.txt: Added.
        * fast/misc/geolocation-local-security-origin.html: Added.

2017-05-11  Manuel Rego Casasnovas  <rego@igalia.com>

        [selectors4] :focus-within tests using shadow DOM don't pass on WK1
        https://bugs.webkit.org/show_bug.cgi?id=170935

        Reviewed by Youenn Fablet.

        * platform/mac-wk1/TestExpectations: Remove tests as they're passing now.

2017-05-11  Zalan Bujtas  <zalan@apple.com>

        RenderImageResource::hasImage is redundant and RenderImageResourceStyleImage's override is incorrect.
        https://bugs.webkit.org/show_bug.cgi?id=172010
        <rdar://problem/31086735>

        Reviewed by Simon Fraser.

        * fast/images/missing-content-image-crash-expected.txt: Added.
        * fast/images/missing-content-image-crash.html: Added.

2017-05-11  Zalan Bujtas  <zalan@apple.com>

        AX: Defer text changes until after the tree is clean if needed.
        https://bugs.webkit.org/show_bug.cgi?id=171546
        <rdar://problem/31934942>

        Reviewed by Simon Fraser.

        * accessibility/crash-when-render-tree-is-not-clean-expected.txt: Added.
        * accessibility/crash-when-render-tree-is-not-clean.html: Added.

2017-05-11  Youenn Fablet  <youenn@apple.com>

        Allow WPT server to serve specific WebKit tests
        https://bugs.webkit.org/show_bug.cgi?id=171479

        Reviewed by Ryosuke Niwa.

        Moving tests to ensure they are correctly runned.

        * http/wpt/fetch/fetch-as-blob-expected.txt: Renamed from LayoutTests/http/tests/fetch/fetch-as-blob-expected.txt.
        * http/wpt/fetch/fetch-as-blob-worker-expected.txt: Renamed from LayoutTests/http/tests/fetch/fetch-as-blob-worker-expected.txt.
        * http/wpt/fetch/fetch-as-blob-worker.html: Renamed from LayoutTests/http/tests/fetch/fetch-as-blob-worker.html.
        * http/wpt/fetch/fetch-as-blob.html: Renamed from LayoutTests/http/tests/fetch/fetch-as-blob.html.
        * http/wpt/fetch/fetch-as-blob.js: Renamed from LayoutTests/http/tests/fetch/fetch-as-blob.js.
        (promise_test):

2017-05-11  Youenn Fablet  <youenn@apple.com>

        [iOS] Unset active media capture source when stopped capturing
        https://bugs.webkit.org/show_bug.cgi?id=171815
        <rdar://problem/32117885>

        Reviewed by Eric Carlson.

        Improving the existing tests for better reliability and debugability.
        Updating tests to use less webkitAudioContext.

        * platform/ios/mediastream/getUserMedia-single-capture-expected.txt: Added.
        * platform/ios/mediastream/getUserMedia-single-capture.html: Added.
        * webrtc/audio-peer-connection-webaudio.html:
        * webrtc/audio-replace-track-expected.txt:
        * webrtc/audio-replace-track.html:
        * webrtc/peer-connection-audio-mute.html:
        * webrtc/peer-connection-audio-mute2.html:
        * webrtc/peer-connection-remote-audio-mute.html:
        * webrtc/peer-connection-remote-audio-mute2.html:
        * webrtc/routines.js:
        * webrtc/video-replace-track-expected.txt:
        * webrtc/video-replace-track.html:

2017-05-11  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r216677.

        Patch caused layout test crashes.

        Reverted changeset:

        "WorkerThread::stop() should call
        scheduleExecutionTermination() last."
        https://bugs.webkit.org/show_bug.cgi?id=171775
        http://trac.webkit.org/changeset/216677

2017-05-11  Matt Lewis  <jlewis3@apple.com>

        Marked tiled-drawing/scrolling/fast-scroll-iframe-latched-mainframe.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=168937

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-11  Joseph Pecoraro  <pecoraro@apple.com>

        Remove Vibration API
        https://bugs.webkit.org/show_bug.cgi?id=171766

        Rubber-stamped by Alexey Proskuryakov.

        * platform/gtk/TestExpectations:
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:
        * platform/win/TestExpectations:
        * platform/wpe/TestExpectations:
        * vibration/cancelVibration-after-pagevisibility-changed-to-hidden-expected.txt: Removed.
        * vibration/cancelVibration-after-pagevisibility-changed-to-hidden.html: Removed.
        * vibration/cancelVibration-during-pattern-vibrating-expected.txt: Removed.
        * vibration/cancelVibration-during-pattern-vibrating.html: Removed.
        * vibration/navigator-vibration-expected.txt: Removed.
        * vibration/navigator-vibration.html: Removed.

2017-05-11  Dean Jackson  <dino@apple.com>

        WebGLRenderingContext should implement WebGLRenderingContextBase
        https://bugs.webkit.org/show_bug.cgi?id=171961
        <rdar://problem/32124920>

        Reviewed by Sam Weinig.

        New test to make sure constants from WebGLRenderingContextBase are
        visible on the WebGLRenderingContext prototype.

        Also, fix up some existing tests that were expecting to see
        instances of WebGLRenderingContextBase.

        * fast/canvas/webgl/constants-on-interface-expected.txt: Added.
        * fast/canvas/webgl/constants-on-interface.html: Added.
        * fast/canvas/webgl/gl-object-get-calls-expected.txt:
        * fast/canvas/webgl/null-object-behaviour-expected.txt:
        * fast/canvas/webgl/texImageTest-expected.txt:

2017-05-11  Matt Lewis  <jlewis3@apple.com>

        Fixed typo errors in TestExpectations.


        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-11  Matt Lewis  <jlewis3@apple.com>

        Fixed typo errors in TestExpectations.
        

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-11  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/web-platform-tests/html/webappapis/timers/negative-settimeout.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170699

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-11  Romain Bellessort  <romain.bellessort@crf.canon.fr>

        [Readable Streams API] Implement ReadableStreamBYOBReader cancel()
        https://bugs.webkit.org/show_bug.cgi?id=171919

        Reviewed by Youenn Fablet.

        Added test cases to check cancel() behaviour.

        * streams/readable-stream-byob-reader-expected.txt: Updated.
        * streams/readable-stream-byob-reader.js: Updated.

2017-05-11  Matt Lewis  <jlewis3@apple.com>

        Marked media/media-controls-clone-crash.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171978

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-11  Matt Baker  <mattbaker@apple.com>

        Web Inspector: Error trying to delete DOM breakpoints from the Debugger tab
        https://bugs.webkit.org/show_bug.cgi?id=171970
        <rdar://problem/32129262>

        Reviewed by Brian Burg.

        Add test for DOMDebuggerManager.prototype.removeDOMBreakpointsForNode.

        * inspector/dom-debugger/dom-breakpoints-expected.txt:
        * inspector/dom-debugger/dom-breakpoints.html:

2017-05-11  Per Arne Vollan  <pvollan@apple.com>

        LayoutTest http/tests/media/track-in-band-hls-metadata-crash.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=167749

        Reviewed by Eric Carlson.

        Revert parts of r216588. The position of the 'canplaythrough' event in the event sequence
        is not always the same, causing flakiness. Stop listening to the 'canplaythrough' event,
        this was introduced in r216588.

        * http/tests/media/track-in-band-hls-metadata-crash-expected.txt:
        * http/tests/media/track-in-band-hls-metadata-crash.html:

2017-05-11  Mark Lam  <mark.lam@apple.com>

        WorkerThread::stop() should call scheduleExecutionTermination() last.
        https://bugs.webkit.org/show_bug.cgi?id=171775
        <rdar://problem/30975761>

        Reviewed by Geoffrey Garen.

        * TestExpectations:

2017-05-11  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of tests failing after r216450.

        * platform/gtk/TestExpectations:

2017-05-10  Matt Lewis  <jlewis3@apple.com>

        Marked fast/animation/request-animation-frame-time-unit.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171957

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-10  Andy Estes  <aestes@apple.com>

        REGRESSION (r167845): ASSERT(!m_renderView.needsLayout()) in svg/custom/bug79798.html
        https://bugs.webkit.org/show_bug.cgi?id=132297

        Reviewed by Simon Fraser.

        * http/tests/navigation/keyboard-events-during-provisional-navigation-expected.txt:
        * http/tests/navigation/keyboard-events-during-provisional-subframe-navigation-expected.txt:
        * http/tests/navigation/resources/keyboard-events-test.js:
        (runTest):
        * platform/ios-wk2/TestExpectations:
        * platform/wk2/TestExpectations:

2017-05-09  Sam Weinig  <sam@webkit.org>

        Remove support for legacy Notifications
        https://bugs.webkit.org/show_bug.cgi?id=171487

        Reviewed by Jon Lee.

        - Remove fast/notifications/. It was skipped on all platforms and use legacy Notifications API.
        - Remove http/notifications/legacy. It tested the legacy API.
        - Update two tests in fast/history to use the non-legacy API to test page cache + notifications.
        - Update TestExpectations for removals.

        * TestExpectations:
        * platform/gtk/TestExpectations:
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:
        * platform/win/TestExpectations:
        * fast/history/page-cache-notification-non-suspendable.html:
        * fast/history/page-cache-notification-suspendable.html:
        * fast/notifications: Removed.
        * fast/notifications/notification-after-close-expected.txt: Removed.
        * fast/notifications/notification-after-close.html: Removed.
        * fast/notifications/notification-permisssion-deletable-expected.txt: Removed.
        * fast/notifications/notification-permisssion-deletable.html: Removed.
        * fast/notifications/notifications-cancel-request-permission-expected.txt: Removed.
        * fast/notifications/notifications-cancel-request-permission.html: Removed.
        * fast/notifications/notifications-check-permission-expected.txt: Removed.
        * fast/notifications/notifications-check-permission.html: Removed.
        * fast/notifications/notifications-click-event-expected.txt: Removed.
        * fast/notifications/notifications-click-event-focus-expected.txt: Removed.
        * fast/notifications/notifications-click-event-focus.html: Removed.
        * fast/notifications/notifications-click-event.html: Removed.
        * fast/notifications/notifications-constructor-request-permission-expected.txt: Removed.
        * fast/notifications/notifications-constructor-request-permission.html: Removed.
        * fast/notifications/notifications-constructor-with-permission-expected.txt: Removed.
        * fast/notifications/notifications-constructor-with-permission.html: Removed.
        * fast/notifications/notifications-constructor-without-permission-expected.txt: Removed.
        * fast/notifications/notifications-constructor-without-permission.html: Removed.
        * fast/notifications/notifications-display-close-events-expected.txt: Removed.
        * fast/notifications/notifications-display-close-events.html: Removed.
        * fast/notifications/notifications-document-close-crash-expected.txt: Removed.
        * fast/notifications/notifications-document-close-crash.html: Removed.
        * fast/notifications/notifications-event-stop-propagation-expected.txt: Removed.
        * fast/notifications/notifications-event-stop-propagation.html: Removed.
        * fast/notifications/notifications-multi-events-expected.txt: Removed.
        * fast/notifications/notifications-multi-events.html: Removed.
        * fast/notifications/notifications-no-icon-expected.txt: Removed.
        * fast/notifications/notifications-no-icon.html: Removed.
        * fast/notifications/notifications-permission-expected.txt: Removed.
        * fast/notifications/notifications-permission.html: Removed.
        * fast/notifications/notifications-replace-expected.txt: Removed.
        * fast/notifications/notifications-replace.html: Removed.
        * fast/notifications/notifications-request-permission-expected.txt: Removed.
        * fast/notifications/notifications-request-permission-optional-expected.txt: Removed.
        * fast/notifications/notifications-request-permission-optional.html: Removed.
        * fast/notifications/notifications-request-permission.html: Removed.
        * fast/notifications/notifications-rtl-expected.txt: Removed.
        * fast/notifications/notifications-rtl.html: Removed.
        * fast/notifications/notifications-sandbox-permission-expected.txt: Removed.
        * fast/notifications/notifications-sandbox-permission.html: Removed.
        * fast/notifications/notifications-window-close-crash-expected.txt: Removed.
        * fast/notifications/notifications-window-close-crash.html: Removed.
        * fast/notifications/notifications-with-permission-expected.txt: Removed.
        * fast/notifications/notifications-with-permission.html: Removed.
        * fast/notifications/notifications-without-permission-expected.txt: Removed.
        * fast/notifications/notifications-without-permission.html: Removed.
        * fast/notifications/request-notification-permission-while-reloading-expected.txt: Removed.
        * fast/notifications/request-notification-permission-while-reloading.html: Removed.
        * fast/notifications/resources: Removed.
        * fast/notifications/resources/notifications-cancel-request-permission.html: Removed.
        * fast/notifications/resources/notifications-iframe.html: Removed.
        * http/tests/notifications/legacy: Removed.
        * http/tests/notifications/legacy/double-show-expected.txt: Removed.
        * http/tests/notifications/legacy/double-show.html: Removed.
        * http/tests/notifications/legacy/events-expected.txt: Removed.
        * http/tests/notifications/legacy/events.html: Removed.
        * http/tests/notifications/legacy/notification-request-permission-then-navigate-expected.txt: Removed.
        * http/tests/notifications/legacy/notification-request-permission-then-navigate.html: Removed.
        * http/tests/notifications/legacy/request-expected.txt: Removed.
        * http/tests/notifications/legacy/request-no-callback-expected.txt: Removed.
        * http/tests/notifications/legacy/request-no-callback.html: Removed.
        * http/tests/notifications/legacy/request.html: Removed.
        * http/tests/notifications/legacy/resources: Removed.
        * http/tests/notifications/legacy/resources/notify-opener-done.html: Removed.
        * http/tests/notifications/legacy/resources/request-permission-then-navigate.html: Removed.
        * http/tests/notifications/legacy/show-expected.txt: Removed.
        * http/tests/notifications/legacy/show.html: Removed.
        * http/tests/notifications/legacy/window-show-on-click-expected.txt: Removed.
        * http/tests/notifications/legacy/window-show-on-click.html: Removed.

2017-05-10  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/media-controller/media-controller-auto-hide-mouse-enter-and-mouse-leave.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=169876

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-05-10  Ryan Haddad  <ryanhaddad@apple.com>

        Mark inspector/protocol/inspector-backend-invocation-return-value.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=168146

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-05-10  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r216635.
        https://bugs.webkit.org/show_bug.cgi?id=171953

        "Some worker tests are failing". (Requested by mlam on #webkit).

        Reverted changeset:

        "WorkerThread::stop() should call
        scheduleExecutionTermination() last."
        https://bugs.webkit.org/show_bug.cgi?id=171775
        http://trac.webkit.org/changeset/216635

2017-05-10  Mark Lam  <mark.lam@apple.com>

        WorkerThread::stop() should call scheduleExecutionTermination() last.
        https://bugs.webkit.org/show_bug.cgi?id=171775
        <rdar://problem/30975761>

        Reviewed by Geoffrey Garen.

        * TestExpectations:

2017-05-10  Tim Horton  <timothy_horton@apple.com>

        Add an experimental feature flag for viewport-fit
        https://bugs.webkit.org/show_bug.cgi?id=171948
        <rdar://problem/31995518>

        Reviewed by Simon Fraser.

        * fast/css/variables/constants/ios/safe-area-inset-set-expected.html:
        * fast/css/variables/constants/ios/safe-area-inset-set.html:
        * fast/viewport/ios/viewport-fit-auto.html:
        * fast/viewport/ios/viewport-fit-contain.html:
        * fast/viewport/ios/viewport-fit-cover.html:

2017-05-10  Matt Lewis  <jlewis3@apple.com>

        Marked fast/hidpi/filters-and-image-buffer-resolution.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171951

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-10  Antti Koivisto  <antti@apple.com>

        REGRESSION (r207372) Visibility property is not inherited when used in an animation
        https://bugs.webkit.org/show_bug.cgi?id=171883
        <rdar://problem/32086550>

        Reviewed by Simon Fraser.

        * animations/animation-initial-inheritance-expected.html: Added.
        * animations/animation-initial-inheritance.html: Added.

2017-05-10  Matt Lewis  <jlewis3@apple.com>

        Marked transitions/extra-transition.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171947

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-10  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r216591.

        This change broke an internal build.

        Reverted changeset:

        "REGRESSION (r207372) Visibility property is not inherited
        when used in an animation"
        https://bugs.webkit.org/show_bug.cgi?id=171883
        http://trac.webkit.org/changeset/216591

2017-05-10  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, remove TestExpectation for a test that was removed in r216259.

        * platform/mac/TestExpectations:

2017-05-10  Matt Lewis  <jlewis3@apple.com>

        Marked perf/class-list-remove.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171945

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-10  Andy Estes  <aestes@apple.com>

        r216599 accidentally included two copies of the new layout test and expected result
        https://bugs.webkit.org/show_bug.cgi?id=171938

        Unreviewed.

        * http/tests/navigation/keyboard-events-during-provisional-subframe-navigation-expected.txt:
        * http/tests/navigation/keyboard-events-during-provisional-subframe-navigation.html:

2017-05-10  Ryan Haddad  <ryanhaddad@apple.com>

        Skip http/tests/navigation/keyboard-events-during-provisional-subframe-navigation.html on ios-simulator.
        https://bugs.webkit.org/show_bug.cgi?id=171880

        Unreviewed test gardening.

        This test times out on ios-simulator because it relies on eventSender.keyDown.

        * platform/ios/TestExpectations:

2017-05-10  Timothy Horton  <timothy_horton@apple.com>

        Add an experimental feature flag for constant properties
        https://bugs.webkit.org/show_bug.cgi?id=171913
        <rdar://problem/31995518>

        Reviewed by Ryosuke Niwa.

        * fast/css/variables/constants/invalid-constant-name-fallback.html:
        * fast/css/variables/constants/ios/safe-area-inset-set.html:
        * fast/css/variables/constants/safe-area-inset-cannot-override.html:
        * fast/css/variables/constants/safe-area-inset-zero.html:

2017-05-10  Matt Lewis  <jlewis3@apple.com>

        Marked media/track/track-cue-rendering-on-resize.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171939

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-10  Ryan Haddad  <ryanhaddad@apple.com>

        Mark imported/w3c/web-platform-tests/dom/nodes/ParentNode-querySelector-All tests as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171937

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-05-10  Matt Lewis  <jlewis3@apple.com>

        Marked tiled-drawing/scrolling/fast-scroll-select-latched-mainframe.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171935

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-10  Andy Estes  <aestes@apple.com>

        Keyboard input suppression should extend to subframes
        https://bugs.webkit.org/show_bug.cgi?id=171880
        <rdar://problem/31201793>

        Reviewed by Ryosuke Niwa.

        * http/tests/navigation/keyboard-events-during-provisional-navigation-expected.txt:
        * http/tests/navigation/keyboard-events-during-provisional-navigation.html:
        * http/tests/navigation/keyboard-events-during-provisional-subframe-navigation-expected.txt: Copied from LayoutTests/http/tests/navigation/keyboard-events-during-provisional-navigation-expected.txt.
        * http/tests/navigation/keyboard-events-during-provisional-subframe-navigation.html: Copied from LayoutTests/http/tests/navigation/keyboard-events-during-provisional-navigation.html.
        * http/tests/navigation/resources/keyboard-events-after-navigation.html:
        * http/tests/navigation/resources/keyboard-events-test.js:
        (runTest):
        (waitForProvisionalNavigation.xhr.onreadystatechange):
        (waitForProvisionalNavigation):

2017-05-10  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r216563.

        Revision caused 2 api failures

        Reverted changeset:

        "[MediaStream] deviceId constraint doesn't work with
        getUserMedia"
        https://bugs.webkit.org/show_bug.cgi?id=171877
        http://trac.webkit.org/changeset/216563

2017-05-10  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/web-platform-tests/webrtc/RTCPeerConnection-idl.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171930

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:
        * platform/mac-wk2/TestExpectations:

2017-05-10  Antti Koivisto  <antti@apple.com>

        REGRESSION (r207372) Visibility property is not inherited when used in an animation
        https://bugs.webkit.org/show_bug.cgi?id=171883
        <rdar://problem/32086550>

        Reviewed by Simon Fraser.

        * animations/animation-initial-inheritance-expected.html: Added.
        * animations/animation-initial-inheritance.html: Added.

2017-05-10  Per Arne Vollan  <pvollan@apple.com>

        LayoutTest http/tests/media/track-in-band-hls-metadata-crash.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=167749

        Reviewed by Eric Carlson.

        This is a speculative fix of the test. I have not been able to reproduce the timeout.
        When the test times out, the 'addtrack' event is never received. In case the event
        was dispatched before we added the event listener, the event listener is added before
        the video source is set. In case the test will continue to time out, a couple of
        error event callbacks have been added to get more information. Also, video playback
        will begin when the 'canplaythrough' event is received.
 
        * http/tests/media/track-in-band-hls-metadata-crash-expected.txt:
        * http/tests/media/track-in-band-hls-metadata-crash.html:

2017-05-10  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r216578.
        https://bugs.webkit.org/show_bug.cgi?id=171920

        Broke the GTK+ build with Wayland enabled (Requested by KaL on
        #webkit).

        Reverted changeset:

        "[GTK] Bump GTK+ and its dependencies in jhbuild"
        https://bugs.webkit.org/show_bug.cgi?id=171918
        http://trac.webkit.org/changeset/216578

2017-05-10  Carlos Garcia Campos  <cgarcia@igalia.com>

        [GTK] Bump GTK+ and its dependencies in jhbuild
        https://bugs.webkit.org/show_bug.cgi?id=171918

        Reviewed by Carlos Alberto Lopez Perez.

        Rebaseline tests for new GTK+ versin.

        * platform/gtk/css1/box_properties/acid_test-expected.txt:
        * platform/gtk/css2.1/20110323/replaced-elements-001-expected.png:
        * platform/gtk/css2.1/20110323/replaced-elements-001-expected.txt:
        * platform/gtk/css2.1/t09-c5526c-display-00-e-expected.png:
        * platform/gtk/css2.1/t09-c5526c-display-00-e-expected.txt:
        * platform/gtk/css3/flexbox/button-expected.png:
        * platform/gtk/css3/flexbox/button-expected.txt:
        * platform/gtk/css3/selectors3/html/css3-modsel-161-expected.png:
        * platform/gtk/css3/selectors3/html/css3-modsel-161-expected.txt:
        * platform/gtk/css3/selectors3/html/css3-modsel-19b-expected.png:
        * platform/gtk/css3/selectors3/html/css3-modsel-19b-expected.txt:
        * platform/gtk/css3/selectors3/html/css3-modsel-23-expected.png:
        * platform/gtk/css3/selectors3/html/css3-modsel-23-expected.txt:
        * platform/gtk/css3/selectors3/html/css3-modsel-25-expected.png:
        * platform/gtk/css3/selectors3/html/css3-modsel-25-expected.txt:
        * platform/gtk/css3/selectors3/html/css3-modsel-69-expected.png:
        * platform/gtk/css3/selectors3/html/css3-modsel-69-expected.txt:
        * platform/gtk/css3/selectors3/html/css3-modsel-70-expected.png:
        * platform/gtk/css3/selectors3/html/css3-modsel-70-expected.txt:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-161-expected.png:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-161-expected.txt:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-19b-expected.png:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-19b-expected.txt:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-23-expected.png:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-23-expected.txt:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-25-expected.png:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-25-expected.txt:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-69-expected.png:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-69-expected.txt:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-70-expected.png:
        * platform/gtk/css3/selectors3/xhtml/css3-modsel-70-expected.txt:
        * platform/gtk/css3/selectors3/xml/css3-modsel-161-expected.png:
        * platform/gtk/css3/selectors3/xml/css3-modsel-161-expected.txt:
        * platform/gtk/css3/selectors3/xml/css3-modsel-19b-expected.png:
        * platform/gtk/css3/selectors3/xml/css3-modsel-19b-expected.txt:
        * platform/gtk/css3/selectors3/xml/css3-modsel-23-expected.png:
        * platform/gtk/css3/selectors3/xml/css3-modsel-23-expected.txt:
        * platform/gtk/css3/selectors3/xml/css3-modsel-25-expected.png:
        * platform/gtk/css3/selectors3/xml/css3-modsel-25-expected.txt:
        * platform/gtk/css3/selectors3/xml/css3-modsel-69-expected.png:
        * platform/gtk/css3/selectors3/xml/css3-modsel-69-expected.txt:
        * platform/gtk/css3/selectors3/xml/css3-modsel-70-expected.png:
        * platform/gtk/css3/selectors3/xml/css3-modsel-70-expected.txt:
        * platform/gtk/editing/pasteboard/4641033-expected.png:
        * platform/gtk/editing/pasteboard/4641033-expected.txt:
        * platform/gtk/editing/pasteboard/4944770-1-expected.png:
        * platform/gtk/editing/pasteboard/4944770-1-expected.txt:
        * platform/gtk/editing/pasteboard/4944770-2-expected.png:
        * platform/gtk/editing/pasteboard/4944770-2-expected.txt:
        * platform/gtk/editing/selection/3690703-2-expected.png:
        * platform/gtk/editing/selection/3690703-2-expected.txt:
        * platform/gtk/editing/selection/3690703-expected.png:
        * platform/gtk/editing/selection/3690703-expected.txt:
        * platform/gtk/editing/selection/3690719-expected.png:
        * platform/gtk/editing/selection/3690719-expected.txt:
        * platform/gtk/editing/selection/4397952-expected.png:
        * platform/gtk/editing/selection/4397952-expected.txt:
        * platform/gtk/editing/selection/5240265-expected.png:
        * platform/gtk/editing/selection/5240265-expected.txt:
        * platform/gtk/editing/selection/caret-before-select-expected.png:
        * platform/gtk/editing/selection/caret-before-select-expected.txt:
        * platform/gtk/editing/selection/replaced-boundaries-3-expected.png:
        * platform/gtk/editing/selection/replaced-boundaries-3-expected.txt:
        * platform/gtk/editing/selection/select-box-expected.png:
        * platform/gtk/editing/selection/select-box-expected.txt:
        * platform/gtk/editing/selection/select-element-paragraph-boundary-expected.png:
        * platform/gtk/editing/selection/select-element-paragraph-boundary-expected.txt:
        * platform/gtk/editing/selection/selection-button-text-expected.png:
        * platform/gtk/editing/selection/selection-button-text-expected.txt:
        * platform/gtk/fast/block/basic/011-expected.png:
        * platform/gtk/fast/block/basic/011-expected.txt:
        * platform/gtk/fast/block/float/float-avoidance-expected.png:
        * platform/gtk/fast/block/float/float-avoidance-expected.txt:
        * platform/gtk/fast/block/margin-collapse/103-expected.png:
        * platform/gtk/fast/block/margin-collapse/103-expected.txt:
        * platform/gtk/fast/block/positioning/inline-block-relposition-expected.png:
        * platform/gtk/fast/block/positioning/inline-block-relposition-expected.txt:
        * platform/gtk/fast/box-sizing/percentage-height-expected.png:
        * platform/gtk/fast/box-sizing/percentage-height-expected.txt:
        * platform/gtk/fast/css/continuationCrash-expected.png:
        * platform/gtk/fast/css/continuationCrash-expected.txt:
        * platform/gtk/fast/css/focus-ring-exists-for-search-field-expected.png:
        * platform/gtk/fast/css/focus-ring-exists-for-search-field-expected.txt:
        * platform/gtk/fast/css/input-search-padding-expected.png:
        * platform/gtk/fast/css/input-search-padding-expected.txt:
        * platform/gtk/fast/css/margin-top-bottom-dynamic-expected.png:
        * platform/gtk/fast/css/margin-top-bottom-dynamic-expected.txt:
        * platform/gtk/fast/css/non-standard-checkbox-size-expected.png:
        * platform/gtk/fast/css/non-standard-checkbox-size-expected.txt:
        * platform/gtk/fast/css/rtl-ordering-expected.png:
        * platform/gtk/fast/css/rtl-ordering-expected.txt:
        * platform/gtk/fast/css/text-input-with-webkit-border-radius-expected.png:
        * platform/gtk/fast/css/text-input-with-webkit-border-radius-expected.txt:
        * platform/gtk/fast/css/text-overflow-input-expected.png:
        * platform/gtk/fast/css/text-overflow-input-expected.txt:
        * platform/gtk/fast/css/text-transform-select-expected.png:
        * platform/gtk/fast/css/text-transform-select-expected.txt:
        * platform/gtk/fast/dom/HTMLInputElement/input-slider-update-expected.png:
        * platform/gtk/fast/dom/HTMLInputElement/input-slider-update-expected.txt:
        * platform/gtk/fast/dom/HTMLProgressElement/indeterminate-progress-001-expected.txt:
        * platform/gtk/fast/dom/HTMLProgressElement/native-progress-bar-expected.png:
        * platform/gtk/fast/dom/HTMLProgressElement/native-progress-bar-expected.txt:
        * platform/gtk/fast/dom/HTMLProgressElement/progress-bar-value-pseudo-element-expected.png:
        * platform/gtk/fast/dom/HTMLProgressElement/progress-bar-value-pseudo-element-expected.txt:
        * platform/gtk/fast/dom/HTMLProgressElement/progress-element-expected.png:
        * platform/gtk/fast/dom/HTMLProgressElement/progress-element-expected.txt:
        * platform/gtk/fast/dom/HTMLTableColElement/resize-table-using-col-width-expected.png:
        * platform/gtk/fast/dom/HTMLTableColElement/resize-table-using-col-width-expected.txt:
        * platform/gtk/fast/dom/HTMLTextAreaElement/reset-textarea-expected.png:
        * platform/gtk/fast/dom/HTMLTextAreaElement/reset-textarea-expected.txt:
        * platform/gtk/fast/dynamic/positioned-movement-with-positioned-children-expected.txt:
        * platform/gtk/fast/forms/001-expected.png:
        * platform/gtk/fast/forms/001-expected.txt:
        * platform/gtk/fast/forms/003-expected.png:
        * platform/gtk/fast/forms/003-expected.txt:
        * platform/gtk/fast/forms/004-expected.png:
        * platform/gtk/fast/forms/004-expected.txt:
        * platform/gtk/fast/forms/basic-buttons-expected.png:
        * platform/gtk/fast/forms/basic-buttons-expected.txt:
        * platform/gtk/fast/forms/basic-inputs-expected.png:
        * platform/gtk/fast/forms/basic-inputs-expected.txt:
        * platform/gtk/fast/forms/basic-selects-expected.png:
        * platform/gtk/fast/forms/basic-selects-expected.txt:
        * platform/gtk/fast/forms/blankbuttons-expected.png:
        * platform/gtk/fast/forms/blankbuttons-expected.txt:
        * platform/gtk/fast/forms/box-shadow-override-expected.png:
        * platform/gtk/fast/forms/box-shadow-override-expected.txt:
        * platform/gtk/fast/forms/button-align-expected.png:
        * platform/gtk/fast/forms/button-align-expected.txt:
        * platform/gtk/fast/forms/button-cannot-be-nested-expected.png:
        * platform/gtk/fast/forms/button-cannot-be-nested-expected.txt:
        * platform/gtk/fast/forms/button-default-title-expected.png:
        * platform/gtk/fast/forms/button-default-title-expected.txt:
        * platform/gtk/fast/forms/button-generated-content-expected.png:
        * platform/gtk/fast/forms/button-generated-content-expected.txt:
        * platform/gtk/fast/forms/button-inner-block-reuse-expected.png:
        * platform/gtk/fast/forms/button-inner-block-reuse-expected.txt:
        * platform/gtk/fast/forms/button-positioned-expected.png:
        * platform/gtk/fast/forms/button-positioned-expected.txt:
        * platform/gtk/fast/forms/button-sizes-expected.png:
        * platform/gtk/fast/forms/button-sizes-expected.txt:
        * platform/gtk/fast/forms/button-style-color-expected.png:
        * platform/gtk/fast/forms/button-style-color-expected.txt:
        * platform/gtk/fast/forms/button-table-styles-expected.png:
        * platform/gtk/fast/forms/button-table-styles-expected.txt:
        * platform/gtk/fast/forms/button-text-transform-expected.png:
        * platform/gtk/fast/forms/button-text-transform-expected.txt:
        * platform/gtk/fast/forms/button-white-space-expected.png:
        * platform/gtk/fast/forms/button-white-space-expected.txt:
        * platform/gtk/fast/forms/control-clip-expected.png:
        * platform/gtk/fast/forms/control-clip-expected.txt:
        * platform/gtk/fast/forms/control-clip-overflow-expected.png:
        * platform/gtk/fast/forms/control-clip-overflow-expected.txt:
        * platform/gtk/fast/forms/control-restrict-line-height-expected.png:
        * platform/gtk/fast/forms/control-restrict-line-height-expected.txt:
        * platform/gtk/fast/forms/disabled-select-change-index-expected.png:
        * platform/gtk/fast/forms/disabled-select-change-index-expected.txt:
        * platform/gtk/fast/forms/file/file-input-direction-expected.png:
        * platform/gtk/fast/forms/file/file-input-direction-expected.txt:
        * platform/gtk/fast/forms/file/file-input-disabled-expected.png:
        * platform/gtk/fast/forms/file/file-input-disabled-expected.txt:
        * platform/gtk/fast/forms/form-element-geometry-expected.png:
        * platform/gtk/fast/forms/form-element-geometry-expected.txt:
        * platform/gtk/fast/forms/formmove-expected.png:
        * platform/gtk/fast/forms/formmove-expected.txt:
        * platform/gtk/fast/forms/formmove2-expected.png:
        * platform/gtk/fast/forms/formmove2-expected.txt:
        * platform/gtk/fast/forms/formmove3-expected.png:
        * platform/gtk/fast/forms/formmove3-expected.txt:
        * platform/gtk/fast/forms/indeterminate-expected.png:
        * platform/gtk/fast/forms/indeterminate-expected.txt:
        * platform/gtk/fast/forms/input-appearance-height-expected.png:
        * platform/gtk/fast/forms/input-appearance-height-expected.txt:
        * platform/gtk/fast/forms/input-button-sizes-expected.png:
        * platform/gtk/fast/forms/input-button-sizes-expected.txt:
        * platform/gtk/fast/forms/input-first-letter-expected.png:
        * platform/gtk/fast/forms/input-first-letter-expected.txt:
        * platform/gtk/fast/forms/input-number-click-expected.txt: Added.
        * platform/gtk/fast/forms/input-value-expected.png:
        * platform/gtk/fast/forms/input-value-expected.txt:
        * platform/gtk/fast/forms/menulist-deselect-update-expected.png:
        * platform/gtk/fast/forms/menulist-deselect-update-expected.txt:
        * platform/gtk/fast/forms/menulist-narrow-width-expected.png:
        * platform/gtk/fast/forms/menulist-narrow-width-expected.txt:
        * platform/gtk/fast/forms/menulist-no-overflow-expected.png:
        * platform/gtk/fast/forms/menulist-no-overflow-expected.txt:
        * platform/gtk/fast/forms/menulist-restrict-line-height-expected.png:
        * platform/gtk/fast/forms/menulist-restrict-line-height-expected.txt:
        * platform/gtk/fast/forms/menulist-separator-painting-expected.png:
        * platform/gtk/fast/forms/menulist-separator-painting-expected.txt:
        * platform/gtk/fast/forms/menulist-style-color-expected.png:
        * platform/gtk/fast/forms/menulist-style-color-expected.txt:
        * platform/gtk/fast/forms/menulist-width-change-expected.png:
        * platform/gtk/fast/forms/menulist-width-change-expected.txt:
        * platform/gtk/fast/forms/number/number-appearance-rtl-expected.png:
        * platform/gtk/fast/forms/number/number-appearance-rtl-expected.txt:
        * platform/gtk/fast/forms/number/number-appearance-spinbutton-disabled-readonly-expected.png:
        * platform/gtk/fast/forms/number/number-appearance-spinbutton-disabled-readonly-expected.txt:
        * platform/gtk/fast/forms/number/number-appearance-spinbutton-layer-expected.png:
        * platform/gtk/fast/forms/number/number-appearance-spinbutton-layer-expected.txt:
        * platform/gtk/fast/forms/number/number-spinbutton-change-and-input-events-expected.txt: Added.
        * platform/gtk/fast/forms/number/number-spinbutton-click-in-iframe-expected.txt: Added.
        * platform/gtk/fast/forms/number/number-spinbutton-gets-disabled-or-readonly-expected.txt: Added.
        * platform/gtk/fast/forms/option-script-expected.png:
        * platform/gtk/fast/forms/option-script-expected.txt:
        * platform/gtk/fast/forms/option-strip-whitespace-expected.png:
        * platform/gtk/fast/forms/option-strip-whitespace-expected.txt:
        * platform/gtk/fast/forms/option-text-clip-expected.png:
        * platform/gtk/fast/forms/option-text-clip-expected.txt:
        * platform/gtk/fast/forms/placeholder-position-expected.png:
        * platform/gtk/fast/forms/placeholder-position-expected.txt:
        * platform/gtk/fast/forms/placeholder-pseudo-style-expected.png:
        * platform/gtk/fast/forms/placeholder-pseudo-style-expected.txt:
        * platform/gtk/fast/forms/range/input-appearance-range-expected.png:
        * platform/gtk/fast/forms/range/input-appearance-range-expected.txt:
        * platform/gtk/fast/forms/range/slider-padding-expected.png:
        * platform/gtk/fast/forms/range/slider-padding-expected.txt:
        * platform/gtk/fast/forms/range/slider-thumb-shared-style-expected.png:
        * platform/gtk/fast/forms/range/slider-thumb-shared-style-expected.txt:
        * platform/gtk/fast/forms/range/slider-transformed-expected.txt:
        * platform/gtk/fast/forms/range/thumbslider-no-parent-slider-expected.png:
        * platform/gtk/fast/forms/range/thumbslider-no-parent-slider-expected.txt:
        * platform/gtk/fast/forms/search-cancel-button-style-sharing-expected.png:
        * platform/gtk/fast/forms/search-cancel-button-style-sharing-expected.txt:
        * platform/gtk/fast/forms/search-display-none-cancel-button-expected.png:
        * platform/gtk/fast/forms/search-display-none-cancel-button-expected.txt:
        * platform/gtk/fast/forms/search-input-rtl-expected.png:
        * platform/gtk/fast/forms/search-input-rtl-expected.txt: Added.
        * platform/gtk/fast/forms/search-rtl-expected.png:
        * platform/gtk/fast/forms/search-rtl-expected.txt:
        * platform/gtk/fast/forms/search-styled-expected.png:
        * platform/gtk/fast/forms/search-styled-expected.txt:
        * platform/gtk/fast/forms/search/search-size-with-decorations-expected.png:
        * platform/gtk/fast/forms/search/search-size-with-decorations-expected.txt:
        * platform/gtk/fast/forms/searchfield-heights-expected.png:
        * platform/gtk/fast/forms/searchfield-heights-expected.txt:
        * platform/gtk/fast/forms/select-align-expected.png:
        * platform/gtk/fast/forms/select-align-expected.txt:
        * platform/gtk/fast/forms/select-background-none-expected.png:
        * platform/gtk/fast/forms/select-background-none-expected.txt:
        * platform/gtk/fast/forms/select-baseline-expected.png:
        * platform/gtk/fast/forms/select-baseline-expected.txt:
        * platform/gtk/fast/forms/select-change-listbox-to-popup-expected.png:
        * platform/gtk/fast/forms/select-change-listbox-to-popup-expected.txt:
        * platform/gtk/fast/forms/select-dirty-parent-pref-widths-expected.png:
        * platform/gtk/fast/forms/select-dirty-parent-pref-widths-expected.txt:
        * platform/gtk/fast/forms/select-disabled-appearance-expected.png:
        * platform/gtk/fast/forms/select-disabled-appearance-expected.txt:
        * platform/gtk/fast/forms/select-element-focus-ring-expected.png: Added.
        * platform/gtk/fast/forms/select-element-focus-ring-expected.txt:
        * platform/gtk/fast/forms/select-initial-position-expected.png:
        * platform/gtk/fast/forms/select-initial-position-expected.txt:
        * platform/gtk/fast/forms/select-non-native-rendering-direction-expected.png: Added.
        * platform/gtk/fast/forms/select-non-native-rendering-direction-expected.txt: Added.
        * platform/gtk/fast/forms/select-selected-expected.png:
        * platform/gtk/fast/forms/select-selected-expected.txt:
        * platform/gtk/fast/forms/select-style-expected.png:
        * platform/gtk/fast/forms/select-style-expected.txt:
        * platform/gtk/fast/forms/select-visual-hebrew-expected.png:
        * platform/gtk/fast/forms/select-visual-hebrew-expected.txt:
        * platform/gtk/fast/forms/select-writing-direction-natural-expected.png:
        * platform/gtk/fast/forms/select-writing-direction-natural-expected.txt:
        * platform/gtk/fast/forms/select/optgroup-rendering-expected.png:
        * platform/gtk/fast/forms/select/optgroup-rendering-expected.txt:
        * platform/gtk/fast/forms/selectlist-minsize-expected.png:
        * platform/gtk/fast/forms/selectlist-minsize-expected.txt:
        * platform/gtk/fast/forms/stuff-on-my-optgroup-expected.png:
        * platform/gtk/fast/forms/stuff-on-my-optgroup-expected.txt:
        * platform/gtk/fast/forms/targeted-frame-submission-expected.png:
        * platform/gtk/fast/forms/targeted-frame-submission-expected.txt:
        * platform/gtk/fast/forms/validation-message-appearance-expected.png:
        * platform/gtk/fast/forms/validation-message-appearance-expected.txt:
        * platform/gtk/fast/html/details-replace-summary-child-expected.png:
        * platform/gtk/fast/html/details-replace-summary-child-expected.txt:
        * platform/gtk/fast/html/details-replace-text-expected.png:
        * platform/gtk/fast/html/details-replace-text-expected.txt:
        * platform/gtk/fast/html/keygen-expected.png:
        * platform/gtk/fast/html/keygen-expected.txt:
        * platform/gtk/fast/inline/positionedLifetime-expected.png:
        * platform/gtk/fast/inline/positionedLifetime-expected.txt:
        * platform/gtk/fast/invalid/014-expected.png:
        * platform/gtk/fast/invalid/014-expected.txt:
        * platform/gtk/fast/overflow/scroll-nested-positioned-layer-in-overflow-expected.png:
        * platform/gtk/fast/overflow/scroll-nested-positioned-layer-in-overflow-expected.txt:
        * platform/gtk/fast/overflow/scrollRevealButton-expected.png:
        * platform/gtk/fast/overflow/scrollRevealButton-expected.txt:
        * platform/gtk/fast/parser/bad-xml-slash-expected.png:
        * platform/gtk/fast/parser/bad-xml-slash-expected.txt:
        * platform/gtk/fast/parser/document-write-option-expected.png:
        * platform/gtk/fast/parser/document-write-option-expected.txt:
        * platform/gtk/fast/repaint/search-field-cancel-expected.png:
        * platform/gtk/fast/repaint/search-field-cancel-expected.txt:
        * platform/gtk/fast/repaint/slider-thumb-drag-release-expected.png:
        * platform/gtk/fast/repaint/slider-thumb-drag-release-expected.txt:
        * platform/gtk/fast/replaced/replaced-breaking-expected.png:
        * platform/gtk/fast/replaced/replaced-breaking-expected.txt:
        * platform/gtk/fast/replaced/replaced-breaking-mixture-expected.png:
        * platform/gtk/fast/replaced/replaced-breaking-mixture-expected.txt:
        * platform/gtk/fast/replaced/three-selects-break-expected.png:
        * platform/gtk/fast/replaced/three-selects-break-expected.txt:
        * platform/gtk/fast/replaced/width100percent-button-expected.png:
        * platform/gtk/fast/replaced/width100percent-button-expected.txt:
        * platform/gtk/fast/replaced/width100percent-menulist-expected.png:
        * platform/gtk/fast/replaced/width100percent-menulist-expected.txt:
        * platform/gtk/fast/replaced/width100percent-searchfield-expected.png:
        * platform/gtk/fast/replaced/width100percent-searchfield-expected.txt:
        * platform/gtk/fast/scrolling/overflow-scrollable-after-back-expected.txt: Added.
        * platform/gtk/fast/table/append-cells2-expected.png:
        * platform/gtk/fast/table/append-cells2-expected.txt:
        * platform/gtk/fast/table/remove-td-display-none-expected.png:
        * platform/gtk/fast/table/remove-td-display-none-expected.txt:
        * platform/gtk/fast/text/international/bidi-menulist-expected.png:
        * platform/gtk/fast/text/international/bidi-menulist-expected.txt:
        * platform/gtk/fast/text/international/hindi-spacing-expected.png:
        * platform/gtk/fast/text/international/hindi-spacing-expected.txt:
        * platform/gtk/fast/text/international/pop-up-button-text-alignment-and-direction-expected.png:
        * platform/gtk/fast/text/international/pop-up-button-text-alignment-and-direction-expected.txt:
        * platform/gtk/fast/text/textIteratorNilRenderer-expected.png:
        * platform/gtk/fast/text/textIteratorNilRenderer-expected.txt:
        * platform/gtk/fast/text/whitespace/normal-after-nowrap-breaking-expected.png:
        * platform/gtk/fast/text/whitespace/normal-after-nowrap-breaking-expected.txt:
        * platform/gtk/http/tests/navigation/javascriptlink-frames-expected.png:
        * platform/gtk/http/tests/navigation/javascriptlink-frames-expected.txt:
        * platform/gtk/svg/custom/foreign-object-skew-expected.png:
        * platform/gtk/svg/custom/foreign-object-skew-expected.txt:
        * platform/gtk/svg/custom/inline-svg-in-xhtml-expected.png:
        * platform/gtk/svg/custom/inline-svg-in-xhtml-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug1188-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug1188-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug1318-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug1318-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug138725-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug138725-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug18359-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug18359-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug2479-2-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug2479-2-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug2479-3-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug2479-3-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug2479-4-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug26178-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug26178-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug28928-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug28928-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug29326-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug29326-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug33855-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug33855-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug39209-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug39209-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug4382-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug4382-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug4429-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug4429-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug44505-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug44505-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug4527-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug4527-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug46368-1-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug46368-1-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug46368-2-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug46368-2-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug51037-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug51037-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug51727-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug51727-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug52505-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug52505-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug52506-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug52506-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug60749-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug60749-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug68912-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug68912-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug7342-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug7342-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug92647-2-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug92647-2-expected.txt:
        * platform/gtk/tables/mozilla/bugs/bug96334-expected.png:
        * platform/gtk/tables/mozilla/bugs/bug96334-expected.txt:
        * platform/gtk/tables/mozilla/collapsing_borders/bug41262-4-expected.png:
        * platform/gtk/tables/mozilla/collapsing_borders/bug41262-4-expected.txt:
        * platform/gtk/tables/mozilla/core/margins-expected.png:
        * platform/gtk/tables/mozilla/core/margins-expected.txt:
        * platform/gtk/tables/mozilla/dom/tableDom-expected.png:
        * platform/gtk/tables/mozilla/dom/tableDom-expected.txt:
        * platform/gtk/tables/mozilla/other/move_row-expected.png:
        * platform/gtk/tables/mozilla/other/move_row-expected.txt:
        * platform/gtk/tables/mozilla_expected_failures/bugs/bug1725-expected.png:
        * platform/gtk/tables/mozilla_expected_failures/bugs/bug1725-expected.txt:
        * platform/gtk/tables/mozilla_expected_failures/bugs/bug2479-5-expected.png:
        * platform/gtk/tables/mozilla_expected_failures/bugs/bug2479-5-expected.txt:
        * platform/gtk/tables/mozilla_expected_failures/bugs/bug58402-2-expected.png:
        * platform/gtk/tables/mozilla_expected_failures/bugs/bug58402-2-expected.txt:
        * platform/gtk/tables/mozilla_expected_failures/collapsing_borders/bug41262-5-expected.png:
        * platform/gtk/tables/mozilla_expected_failures/collapsing_borders/bug41262-5-expected.txt:
        * platform/gtk/tables/mozilla_expected_failures/collapsing_borders/bug41262-6-expected.png:
        * platform/gtk/tables/mozilla_expected_failures/collapsing_borders/bug41262-6-expected.txt:
        * platform/gtk/tables/mozilla_expected_failures/core/captions1-expected.png:
        * platform/gtk/tables/mozilla_expected_failures/core/captions1-expected.txt:
        * platform/gtk/tables/mozilla_expected_failures/core/captions2-expected.png:
        * platform/gtk/tables/mozilla_expected_failures/core/captions2-expected.txt:
        * platform/gtk/transforms/2d/zoom-menulist-expected.png:
        * platform/gtk/transforms/2d/zoom-menulist-expected.txt:

2017-05-08  Sergio Villar Senin  <svillar@igalia.com>

        [css-grid] Remove Blink-specific code for handling orthogonal grid items
        https://bugs.webkit.org/show_bug.cgi?id=171807

        Reviewed by Darin Adler.

        Updated the expectations. They should now be compatible with Firefox and Chrome.

        * fast/css-grid-layout/grid-track-sizing-with-orthogonal-flows.html:
        * fast/css-grid-layout/grid-track-sizing-with-percentages-and-orthogonal-flows.html:
        * fast/css-grid-layout/repeating-layout-must-produce-the-same-results.html:

2017-05-09  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] deviceId constraint doesn't work with getUserMedia
        https://bugs.webkit.org/show_bug.cgi?id=171877
        <rdar://problem/31899730>

        Reviewed by Jer Noble.

        * fast/mediastream/get-user-media-device-id-expected.txt: Added.
        * fast/mediastream/get-user-media-device-id.html: Added.

2017-05-09  Matt Lewis  <jlewis3@apple.com>

        Mark webrtc/libwebrtc/release-while-setting-local-description.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171899

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-09  Matt Lewis  <jlewis3@apple.com>

        Mark webrtc/audio-replace-track.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171895

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-09  Sam Weinig  <sam@webkit.org>

        Implement Subresource Integrity (SRI)
        https://bugs.webkit.org/show_bug.cgi?id=148363
        <rdar://problem/18945879>

        Reviewed by Youenn Fablet.

        Add tests for Subresource Integrity for Fetch based off the ones from Web 
        Platform Tests. Additional tests for more CORS combinations have been added.

        * http/tests/subresource-integrity/resources/crossorigin-anon-resource.txt: Added.
        * http/tests/subresource-integrity/resources/crossorigin-creds-resource.txt: Added.
        * http/tests/subresource-integrity/resources/crossorigin-ineligible-resource.txt: Added.
        * http/tests/subresource-integrity/resources/resource.txt: Added.
        * http/tests/subresource-integrity/sri-fetch-expected.txt: Added.
        * http/tests/subresource-integrity/sri-fetch-worker-expected.txt: Added.
        * http/tests/subresource-integrity/sri-fetch-worker.html: Added.
        * http/tests/subresource-integrity/sri-fetch.html: Added.
        * http/tests/subresource-integrity/sri-fetch.js: Added.

2017-05-09  Matt Lewis  <jlewis3@apple.com>

        Marked webrtc/captureCanvas-webrtc.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170870

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-09  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r216545.
        https://bugs.webkit.org/show_bug.cgi?id=171889

        Caused a test failure (Requested by eric_carlson on #webkit).

        Reverted changeset:

        "[MediaStream] deviceId constraint doesn't work with
        getUserMedia"
        https://bugs.webkit.org/show_bug.cgi?id=171877
        http://trac.webkit.org/changeset/216545

2017-05-09  Zalan Bujtas  <zalan@apple.com>

        resetFlowThreadContainingBlockAndChildInfoIncludingDescendants should not ignore RenderElement subtrees.
        https://bugs.webkit.org/show_bug.cgi?id=171873
        <rdar://problem/32004954>

        Reviewed by Simon Fraser.

        * fast/multicol/crash-when-column-inside-table-expected.txt: Added.
        * fast/multicol/crash-when-column-inside-table.html: Added.

2017-05-09  Ryan Haddad  <ryanhaddad@apple.com>

        [iOS Simulator] Flaky failure LayoutTest/webrtc/libwebrtc/release-while-setting-local-description.html
        https://bugs.webkit.org/show_bug.cgi?id=171742

        Reviewed by Youenn Fablet.

        Silence the console messages for unhandled rejections in this test.

        * webrtc/libwebrtc/release-while-setting-local-description-expected.txt:
        * webrtc/libwebrtc/release-while-setting-local-description.html:

2017-05-09  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] deviceId constraint doesn't work with getUserMedia
        https://bugs.webkit.org/show_bug.cgi?id=171877
        <rdar://problem/31899730>

        Reviewed by Jer Noble.

        * fast/mediastream/get-user-media-device-id-expected.txt: Added.
        * fast/mediastream/get-user-media-device-id.html: Added.

2017-05-09  Matt Lewis  <jlewis3@apple.com>

        Marked multiple test flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171886

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:
        * platform/mac/TestExpectations:

2017-05-09  Chris Dumez  <cdumez@apple.com>

        Introduce DocumentAndElementEventHandlers IDL interface
        https://bugs.webkit.org/show_bug.cgi?id=171879

        Reviewed by Simon Fraser and Ryosuke Niwa.

        * fast/events/DocumentAndElementEventHandlers-expected.txt: Added.
        * fast/events/DocumentAndElementEventHandlers.html: Added.
        Add layout test coverage.

        * js/dom/dom-static-property-for-in-iteration-expected.txt:
        Rebaseline now that those event handlers are enumerable.

2017-05-10  Dean Jackson  <dino@apple.com>

        Restrict SVG filters to accessible security origins
        https://bugs.webkit.org/show_bug.cgi?id=118689
        <rdar://problem/27362159>

        Reviewed by Brent Fulgham.

        Add a test that shows safe frames, unsafe frames, and
        then a safe frame that itself has an unsafe frame, to
        show that the security requirements are being forwarded
        down the tree.

        * http/tests/css/filters-on-iframes-expected.html: Added.
        * http/tests/css/filters-on-iframes.html: Added.
        * http/tests/css/resources/blank.html: Added.
        * http/tests/css/resources/references-external.html: Added.
        * http/tests/css/resources/solid-red.html: Added.

2017-05-09  Chris Dumez  <cdumez@apple.com>

        Move onanimation* EventHandlers to GlobalEventHandlers
        https://bugs.webkit.org/show_bug.cgi?id=171874

        Reviewed by Simon Fraser.

        * fast/css/onanimation-eventhandlers-expected.txt: Added.
        * fast/css/onanimation-eventhandlers.html: Added.
        Add layout test coverage.

        * fast/dom/event-handler-attributes-expected.txt:
        * fast/dom/event-handler-attributes.html:
        * js/dom/dom-static-property-for-in-iteration-expected.txt:
        Rebaseline existing tests to reflect behavior change.

2017-05-09  Matt Lewis  <jlewis3@apple.com>

        Fixed a typo in expectations file.
        https://bugs.webkit.org/show_bug.cgi?id=162710

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-09  Javier Fernandez  <jfernandez@igalia.com>

        space-evenly misbehaves with flexbox
        https://bugs.webkit.org/show_bug.cgi?id=170445

        Reviewed by David Hyatt.

        Added test cases for the 'space-evenly' value for align-content and justify-content.

        * css3/flexbox/alignContent-applies-with-flexWrap-wrap-with-single-line-expected.txt:
        * css3/flexbox/alignContent-applies-with-flexWrap-wrap-with-single-line.html:
        * css3/flexbox/css-properties-expected.txt:
        * css3/flexbox/css-properties.html:
        * css3/flexbox/flex-justify-content-expected.txt:
        * css3/flexbox/flex-justify-content.html:
        * css3/flexbox/multiline-align-content-expected.txt:
        * css3/flexbox/multiline-align-content-horizontal-column-expected.txt:
        * css3/flexbox/multiline-align-content-horizontal-column.html:
        * css3/flexbox/multiline-align-content.html:
        * css3/flexbox/resources/flexbox.css:
        (.align-content-space-around):
        (.justify-content-space-around):
        * css3/flexbox/true-centering-expected.txt:
        * css3/flexbox/true-centering.html:

2017-05-09  Matt Lewis  <jlewis3@apple.com>

        Unreviewed, rolling out r216508.

        The layout test enabled in this change is failing on Sierra.

        Reverted changeset:

        "Invalid MediaSource duration value should throw TyperError
        instead of InvalidStateError"
        https://bugs.webkit.org/show_bug.cgi?id=171653
        http://trac.webkit.org/changeset/216508

2017-05-09  Matt Lewis  <jlewis3@apple.com>

        Marked media/element-containing-pip-video-going-into-fullscreen.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=162710

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-09  Myles C. Maxfield  <mmaxfield@apple.com>

        font-stretch: normal selects expanded fonts instead of condensed fonts
        https://bugs.webkit.org/show_bug.cgi?id=171838
        <rdar://problem/31005481>

        Reviewed by Jon Lee.

        * fast/text/font-width-100-expected.html: Added.
        * fast/text/font-width-100.html: Added.

2017-05-09  Matt Lewis  <jlewis3@apple.com>

        Mark storage/indexeddb/modern/idbtransaction-objectstore-failures.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171862

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-09  Romain Bellessort  <romain.bellessort@crf.canon.fr>

        [Readable Streams API] Enable creation of ReadableStreamBYOBReader
        https://bugs.webkit.org/show_bug.cgi?id=171665

        Reviewed by Youenn Fablet.
        
        Added test to check the creation of ReadableStreamBYOBReader. Also check
        that created object has the right methods and properties.

        * streams/readable-stream-byob-reader-expected.txt: Added.
        * streams/readable-stream-byob-reader.html: Added.
        * streams/readable-stream-byob-reader.js: Added.

2017-05-09  Frederic Wang  <fwang@igalia.com>

        Print more properties in the output of scrolling trees
        https://bugs.webkit.org/show_bug.cgi?id=171858

        Reviewed by Simon Fraser.

        Update text expectations to include new properties.

        * fast/scrolling/ios/remove-scrolling-role-expected.txt:
        * fast/visual-viewport/tiled-drawing/zoomed-fixed-scrolled-down-expected.txt:
        * fast/visual-viewport/tiled-drawing/zoomed-fixed-scrolled-down-then-up-expected.txt:
        * fast/visual-viewport/tiled-drawing/zoomed-fixed-scrolling-layers-state-expected.txt:
        * tiled-drawing/scrolling/clamp-out-of-bounds-scrolls-expected.txt:
        * tiled-drawing/scrolling/fixed/absolute-inside-fixed-expected.txt:
        * tiled-drawing/scrolling/fixed/absolute-inside-out-of-view-fixed-expected.txt:
        * tiled-drawing/scrolling/fixed/fixed-in-overflow-expected.txt:
        * tiled-drawing/scrolling/fixed/fixed-position-out-of-view-expected.txt:
        * tiled-drawing/scrolling/fixed/fixed-position-out-of-view-negative-zindex-expected.txt:
        * tiled-drawing/scrolling/fixed/four-bars-expected.txt:
        * tiled-drawing/scrolling/fixed/four-bars-with-header-and-footer-expected.txt:
        * tiled-drawing/scrolling/fixed/four-bars-zoomed-expected.txt:
        * tiled-drawing/scrolling/fixed/negative-scroll-offset-expected.txt:
        * tiled-drawing/scrolling/fixed/negative-scroll-offset-in-view-expected.txt:
        * tiled-drawing/scrolling/fixed/nested-fixed-expected.txt:
        * tiled-drawing/scrolling/fixed/percentage-inside-fixed-expected.txt:
        * tiled-drawing/scrolling/frames/coordinated-frame-expected.txt:
        * tiled-drawing/scrolling/frames/coordinated-frame-gain-scrolling-ancestor-expected.txt:
        * tiled-drawing/scrolling/frames/coordinated-frame-in-fixed-expected.txt:
        * tiled-drawing/scrolling/frames/coordinated-frame-lose-scrolling-ancestor-expected.txt:
        * tiled-drawing/scrolling/frames/fixed-inside-frame-expected.txt:
        * tiled-drawing/scrolling/frames/remove-coordinated-frame-expected.txt:
        * tiled-drawing/scrolling/frames/scroll-region-after-frame-layout-expected.txt:
        * tiled-drawing/scrolling/scrolling-tree-after-scroll-expected.txt:
        * tiled-drawing/scrolling/scrolling-tree-slow-scrolling-expected.txt:
        * tiled-drawing/scrolling/sticky/negative-scroll-offset-expected.txt:
        * tiled-drawing/scrolling/sticky/sticky-horizontal-expected.txt:
        * tiled-drawing/scrolling/sticky/sticky-vertical-expected.txt:

2017-05-09  Chris Dumez  <cdumez@apple.com>

        ontransitionend eventHandler should be in GlobalEventHandlers
        https://bugs.webkit.org/show_bug.cgi?id=171836

        Reviewed by Ryosuke Niwa.

        * fast/css/ontransitionend-eventhandler-expected.txt: Added.
        * fast/css/ontransitionend-eventhandler.html: Added.
        Add layout test coverage.

        * fast/dom/event-handler-attributes-expected.txt:
        * fast/dom/event-handler-attributes.html:
        * js/dom/dom-static-property-for-in-iteration-expected.txt:
        Rebaseline existing tests to reflect behavior change.

2017-05-09  Nael Ouedraogo  <nael.ouedraogo@crf.canon.fr>

        Invalid MediaSource duration value should throw TyperError instead of InvalidStateError
        https://bugs.webkit.org/show_bug.cgi?id=171653

        Reviewed by Youenn Fablet.

        Modify MediaSource::setDuration to throw a TypeError when duration value is invalid as per MSE specification
        (https://www.w3.org/TR/2016/REC-media-source-20161117/#dom-mediasource-duration).

        Update expectation of corresponding WPT test.

        * platform/gtk/TestExpectations:
        * platform/gtk/imported/w3c/web-platform-tests/media-source/mediasource-duration-boundaryconditions-expected.txt: Added.
        * platform/mac/TestExpectations:
        * platform/mac/imported/w3c/web-platform-tests/media-source/mediasource-duration-boundaryconditions-expected.txt: Added.

2017-05-09  Yusuke Suzuki  <utatane.tea@gmail.com>

        Handle IDLPromise<> properly
        https://bugs.webkit.org/show_bug.cgi?id=166752

        Reviewed by Youenn Fablet.

        * js/dom/promise-rejection-event-should-follow-webidl-promise-conversion-rule-expected.txt: Added.
        * js/dom/promise-rejection-event-should-follow-webidl-promise-conversion-rule.html: Added.

2017-05-09  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed. Landing the WPE layout test baselines.

        Baseline filenames are omitted for brevity.

        * platform/wpe/TestExpectations: Added.
        * platform/wpe/animations/: Added.
        * platform/wpe/css1/: Added.
        * platform/wpe/css2.1/: Added.
        * platform/wpe/css3/: Added.
        * platform/wpe/fast/: Added.
        * platform/wpe/ietestcenter/: Added.
        * platform/wpe/js/: Added.
        * platform/wpe/scrollbars/: Added.
        * platform/wpe/security/: Added.
        * platform/wpe/sputnik/: Added.
        * platform/wpe/tables/: Added.
        * platform/wpe/transforms/: Added.
        * platform/wpe/transitions/: Added.

2017-05-08  Frederic Wang  <fwang@igalia.com>

        Simplify ScrollingStateNode::scrollingStateTreeAsText
        https://bugs.webkit.org/show_bug.cgi?id=171802

        Reviewed by Simon Fraser.

        Update references due to minor format changes in text ouput of scrolling state trees.

        * fast/scrolling/ios/remove-scrolling-role-expected.txt:
        * fast/visual-viewport/tiled-drawing/zoomed-fixed-scrolled-down-expected.txt:
        * fast/visual-viewport/tiled-drawing/zoomed-fixed-scrolled-down-then-up-expected.txt:
        * fast/visual-viewport/tiled-drawing/zoomed-fixed-scrolling-layers-state-expected.txt:
        * tiled-drawing/scrolling/clamp-out-of-bounds-scrolls-expected.txt:
        * tiled-drawing/scrolling/fixed/absolute-inside-fixed-expected.txt:
        * tiled-drawing/scrolling/fixed/absolute-inside-out-of-view-fixed-expected.txt:
        * tiled-drawing/scrolling/fixed/fixed-in-overflow-expected.txt:
        * tiled-drawing/scrolling/fixed/fixed-position-out-of-view-expected.txt:
        * tiled-drawing/scrolling/fixed/fixed-position-out-of-view-negative-zindex-expected.txt:
        * tiled-drawing/scrolling/fixed/four-bars-expected.txt:
        * tiled-drawing/scrolling/fixed/four-bars-with-header-and-footer-expected.txt:
        * tiled-drawing/scrolling/fixed/four-bars-zoomed-expected.txt:
        * tiled-drawing/scrolling/fixed/negative-scroll-offset-expected.txt:
        * tiled-drawing/scrolling/fixed/negative-scroll-offset-in-view-expected.txt:
        * tiled-drawing/scrolling/fixed/nested-fixed-expected.txt:
        * tiled-drawing/scrolling/fixed/percentage-inside-fixed-expected.txt:
        * tiled-drawing/scrolling/frames/coordinated-frame-expected.txt:
        * tiled-drawing/scrolling/frames/coordinated-frame-gain-scrolling-ancestor-expected.txt:
        * tiled-drawing/scrolling/frames/coordinated-frame-in-fixed-expected.txt:
        * tiled-drawing/scrolling/frames/coordinated-frame-lose-scrolling-ancestor-expected.txt:
        * tiled-drawing/scrolling/frames/fixed-inside-frame-expected.txt:
        * tiled-drawing/scrolling/frames/remove-coordinated-frame-expected.txt:
        * tiled-drawing/scrolling/frames/scroll-region-after-frame-layout-expected.txt:
        * tiled-drawing/scrolling/scrolling-tree-after-scroll-expected.txt:
        * tiled-drawing/scrolling/scrolling-tree-slow-scrolling-expected.txt:
        * tiled-drawing/scrolling/sticky/negative-scroll-offset-expected.txt:
        * tiled-drawing/scrolling/sticky/sticky-horizontal-expected.txt:
        * tiled-drawing/scrolling/sticky/sticky-vertical-expected.txt:

2017-05-08  Michael Catanzaro  <mcatanzaro@igalia.com>

        Unreviewed GTK expectations gardening

        * platform/gtk/TestExpectations:
        * webaudio/codec-tests/wav/24bit-22khz-resample-expected.wav:

2017-05-08  Matt Lewis  <jlewis3@apple.com>

        Marked http/tests/security/storage-blocking-loosened-plugin.html as flaky
        https://bugs.webkit.org/show_bug.cgi?id=171837

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-08  Chris Dumez  <cdumez@apple.com>

        Move offsetParent / offsetLeft / offsetTop / offsetWidth / offsetHeight from Element to HTMLElement
        https://bugs.webkit.org/show_bug.cgi?id=171829

        Reviewed by Simon Fraser.

        * fast/css/htmlelement-offset-properties-expected.txt:
        * fast/css/htmlelement-offset-properties.html:
        Add layout test coverage.

        * editing/pasteboard/drag-link-with-data-transfer-adds-trusted-link-to-pasteboard.html:
        * fast/css-grid-layout/grid-item-display.html:
        * js/dom/dom-static-property-for-in-iteration-expected.txt:
        * mathml/presentation/menclose-notation-no-overlap-expected.txt:
        * mathml/presentation/menclose-notation-no-overlap.html:
        * platform/mac/inspector/model/remote-object-expected.txt:
        * svg/dynamic-updates/resources/SVGTestCase.js:
        (clickAt):
        * svg/text/inline-text-destroy-attributes-crash.xhtml:
        Use getClientBoundingRect() instead of offset* properties for non-HTML elements.

2017-05-08  Matt Lewis  <jlewis3@apple.com>

        Marked imported/w3c/web-platform-tests/XMLHttpRequest/timeout-multiple-fetches.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=169637

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-08  Jonathan Bedard  <jbedard@apple.com>

        Implement PlatformWebView::windowSnapshotImage and createBitmapContextFromWebView for iOS devices
        https://bugs.webkit.org/show_bug.cgi?id=169421
        <rdar://problem/30950171>

        Reviewed by Tim Horton.

        * platform/ios-device/TestExpectations: Mark compositing tests as failures, this
        is due to a bug tracked in https://bugs.webkit.org/show_bug.cgi?id=170772.

2017-05-08  Chris Dumez  <cdumez@apple.com>

        Drop non-standard document.implementation.createCSSStyleSheet() API
        https://bugs.webkit.org/show_bug.cgi?id=171825

        Reviewed by Simon Fraser.

        * fast/css/DOMImplementation.createCSSStyleSheet-obsolete-expected.txt:
        * fast/css/DOMImplementation.createCSSStyleSheet-obsolete.html:
        Add layout test coverage.

        * fast/dom/StyleSheet/gc-parent-rule-expected.txt:
        * fast/dom/StyleSheet/gc-parent-rule.html:
        * fast/dom/StyleSheet/gc-parent-stylesheet-expected.txt:
        * fast/dom/StyleSheet/gc-parent-stylesheet.html:
        Add utility functions to construct a CSSStyleSheet object and use it instead
        of document.implementation.createCSSStyleSheet().

2017-05-08  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: don't expose empty roledescription
        https://bugs.webkit.org/show_bug.cgi?id=163647

        Reviewed by Chris Fleizach.

        * accessibility/aria-roledescription-expected.txt: New test cases, updated expectations.
        * accessibility/aria-roledescription.html: New test cases, updated expectations.
        * platform/gtk/accessibility/aria-roledescription-expected.txt: New test cases, updated expectations.

2017-05-08  Chris Dumez  <cdumez@apple.com>

        Drop non-standard Element.scrollByLines() / scrollByPages()
        https://bugs.webkit.org/show_bug.cgi?id=171820

        Reviewed by Simon Fraser.

        * LayoutTests/fast/css/element-scrollByLines-scrollByPages-obsolete-expected.txt:
        * LayoutTests/fast/css/element-scrollByLines-scrollByPages-obsolete.html:
        Add layout test coverage.

        * fast/dom/non-numeric-values-numeric-parameters-expected.txt:
        * fast/dom/script-tests/non-numeric-values-numeric-parameters.js:
        * fast/events/scroll-event-does-not-bubble.html:
        * fast/layers/scroll-overflow-no-layer-expected.txt: Renamed from LayoutTests/fast/layers/scrollByLines-overflow-no-layer-expected.txt.
        * fast/layers/scroll-overflow-no-layer.html: Renamed from LayoutTests/fast/layers/scrollByLines-overflow-no-layer.html.
        Update existing tests to stop relying on the API.

2017-05-08  Matt Lewis  <jlewis3@apple.com>

        Marked http/tests/websocket/tests/hybi/workers/close.html is flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171830

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-08  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/status-label/status-label-font.html as flaky on mac-wk1.
        https://bugs.webkit.org/show_bug.cgi?id=171828

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-05-08  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: Setting aria-orientation="horizontal" on a listbox is being overridden on the Mac
        https://bugs.webkit.org/show_bug.cgi?id=171821

        Reviewed by Chris Fleizach.

        * accessibility/aria-orientation-expected.txt: New test case.
        * accessibility/aria-orientation.html: New test case.

2017-05-08  Said Abou-Hallawa  <sabouhallawa@apple.com>

        [CG] To decode an image frame asynchronously, pass the native size of the image to CGImageSourceCreateThumbnailAtIndex() if it's smaller than the sizeForDrawing
        https://bugs.webkit.org/show_bug.cgi?id=170864

        Reviewed by Simon Fraser.

        * fast/images/async-image-background-image-repeated-expected.html:
        * fast/images/async-image-background-image-repeated.html:
        * fast/images/resources/sprite-sheet-red-green-blue.png:
        * fast/images/sprite-sheet-image-draw-expected.html:
        * fast/images/sprite-sheet-image-draw.html:
        Change the sprite image to be 200x33100 instead of 200x2100 and use it in drawing.
        If the maxPixelSize is not passed to CGImageSourceCreateThumbnailAtIndex(), the
        decoded farme of this image will be 30x5000 pixels (15% of the original size).

2017-05-08  Beth Dakin  <bdakin@apple.com>

        WebKit should default to using sRGB with NSColor conversion instead of device 
        color space
        https://bugs.webkit.org/show_bug.cgi?id=171745
        -and corresponding-
        rdar://problem/28314183

        Reviewed by Tim Horton.

        * editing/mac/attributed-string/anchor-element-expected.txt:
        * editing/mac/attributed-string/basic-expected.txt:
        * editing/mac/attributed-string/comment-cdata-section-expected.txt:
        * editing/mac/attributed-string/font-size-expected.txt:
        * editing/mac/attributed-string/font-style-variant-effect-expected.txt:
        * editing/mac/attributed-string/font-weight-expected.txt:
        * editing/mac/attributed-string/letter-spacing-expected.txt:
        * editing/mac/attributed-string/text-decorations-expected.txt:
        * editing/mac/attributed-string/vertical-align-expected.txt:

2017-05-04  Jiewen Tan  <jiewen_tan@apple.com>

        Search events should not fire synchronously for search type input elements with incremental attribute set
        https://bugs.webkit.org/show_bug.cgi?id=171376
        <rdar://problem/31863296>

        Reviewed by Chris Dumez.

        * fast/forms/search/search-incremental-crash-expected.txt: Added.
        * fast/forms/search/search-incremental-crash.html: Added.

2017-05-08  Zalan Bujtas  <zalan@apple.com>

        Text overlaps on http://www.duden.de/rechtschreibung/Acre
        https://bugs.webkit.org/show_bug.cgi?id=171796
        <rdar://problem/31036028>

        Reviewed by Simon Fraser.

        * fast/text/simple-line-layout-fallback-space-glyph-expected.html: Added.
        * fast/text/simple-line-layout-fallback-space-glyph.html: Added.

2017-05-08  Michael Catanzaro  <mcatanzaro@igalia.com>

        Unreviewed, rolling out r216419.

        Broke 70 layout tests on GTK bot

        Reverted changeset:

        "Ensure clean tree before AX cache update."
        https://bugs.webkit.org/show_bug.cgi?id=171546
        http://trac.webkit.org/changeset/216419

2017-05-08  Antti Koivisto  <antti@apple.com>

        ComposedTreeIterator does not traverse all slotted children if the traversal root is a slot element.
        https://bugs.webkit.org/show_bug.cgi?id=171375
        <rdar://problem/31863184>

        Reviewed by Zalan Bujtas.

        * fast/html/details-flow-thread-expected.txt: Added.
        * fast/html/details-flow-thread.html: Added.
        * fast/shadow-dom/composed-tree-slots-expected.txt:
        * fast/shadow-dom/composed-tree-slots.html:

            Expand the test so it also prints out slot subtrees using slots as traversal roots.

2017-05-08  Chris Dumez  <cdumez@apple.com>

        Move 'style' from Element to HTMLElement / SVGElement and make it settable
        https://bugs.webkit.org/show_bug.cgi?id=171795

        Reviewed by Alex Christensen.

        * accessibility/roles-exposed.html:
        Add null check for element.style.

        * fast/css/Element-style-expected.txt: Added.
        * fast/css/Element-style.html: Added.
        Add layout test coverage.

        * fast/forms/input-width-height-attributes-without-renderer-loaded-image-expected.txt:
        Rebaseline test that was setting HTMLElement.style which was a no-op until this patch. Now that it actually
        does something, the input element actually looses its renderer. This found a bug which I fixed in this
        patch.

        * js/dom/dom-static-property-for-in-iteration-expected.txt:
        Rebaseline as property enumeration order has changed.

2017-05-08  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: Propagate aria-readonly to grid descendants
        https://bugs.webkit.org/show_bug.cgi?id=171189

        Reviewed by Chris Fleizach.

        Add new test cases to aria-readonly.html. In addition, because the platform-specific
        test expectations seem due to how platforms treat whitespace from the test file, hide
        the test cases after the test is run so that there are no extraneous characters and
        a single expectations file can be shared.

        * accessibility/aria-readonly-expected.txt: Updated.
        * accessibility/aria-readonly.html: Updated.
        * accessibility/gtk/aria-readonly-propagated-expected.txt: Added.
        * accessibility/gtk/aria-readonly-propagated.html: Added.
        * platform/mac-elcapitan/accessibility/aria-readonly-expected.txt: Removed.
        * platform/mac/accessibility/aria-readonly-expected.txt: Removed.
        * platform/win/accessibility/aria-readonly-expected.txt: Removed.

2017-05-06  Zalan Bujtas  <zalan@apple.com>

        Ensure clean tree before AX cache update.
        https://bugs.webkit.org/show_bug.cgi?id=171546
        <rdar://problem/31934942>

        Reviewed by Chris Fleizach.

        * accessibility/crash-when-render-tree-is-not-clean.html: Added.

2017-05-08  Myles C. Maxfield  <mmaxfield@apple.com>

        Unprefix unicode-bidi CSS values
        https://bugs.webkit.org/show_bug.cgi?id=171761

        Reviewed by Simon Fraser.

        Import W3C's internationalization tests from
        https://www.w3.org/International/tests/repo/results/writing-modes-bidi

        * fast/css/default-bidi-css-rules-expected.txt: Updating expected results.
        * fast/css/default-bidi-css-rules.html: Ditto.
        * fast/css/unicode-bidi-computed-value-expected.txt: Ditto.
        * fast/css/unicode-bidi-computed-value.html: Ditto.
        * fast/text/bidi-unprefix-expected.txt: Added. Test unprefixing.
        * fast/text/bidi-unprefix.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-001-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-001.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-002-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-002.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-003-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-003.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-004-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-004.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-005-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-005.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-006-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-006.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-007-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-007.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-008-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-008.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-009-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-009.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-010-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-010.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-011-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-embed-011.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-001-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-001.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-002-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-002.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-003-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-003.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-004-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-004.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-005-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-005.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-006-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-006.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-007-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-007.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-008-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-008.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-009-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-009.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-010-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-010.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-011-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-011.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-001-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-001.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-002-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-002.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-003-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-003.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-004-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-004.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-005-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-005.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-006-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-006.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-007-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-007.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-008-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-008.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-009-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-009.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-010-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-010.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-011-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-011.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-012-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-isolate-override-012.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-001-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-001.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-002-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-002.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-003-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-003.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-004-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-004.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-005-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-005.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-006-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-006.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-007-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-007.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-008-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-008.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-009-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-009.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-010-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-010.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-011-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-normal-011.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-001-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-001.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-002-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-002.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-003-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-003.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-004-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-004.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-005-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-005.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-006-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-006.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-007-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-007.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-008-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-008.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-009-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-009.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-010-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-010.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-011-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-011.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-012-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-override-012.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-001-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-001.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-003-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-003.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-005-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-005.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-006-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-006.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-007-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-007.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-008-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-008.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-009-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-009.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-010-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-010.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-011-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-plaintext-011.html: Added.
        * imported/w3c/i18n/bidi/bidi-table-001-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-table-001.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-001-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-001.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-002-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-002.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-003-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-003.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-004-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-004.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-005-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-005.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-006-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-006.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-007-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-007.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-008-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-008.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-009-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-009.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-010-expected.html: Added.
        * imported/w3c/i18n/bidi/bidi-unset-010.html: Added.
        * imported/w3c/i18n/bidi/block-embed-001-expected.html: Added.
        * imported/w3c/i18n/bidi/block-embed-001.html: Added.
        * imported/w3c/i18n/bidi/block-embed-002-expected.html: Added.
        * imported/w3c/i18n/bidi/block-embed-002.html: Added.
        * imported/w3c/i18n/bidi/block-embed-003-expected.html: Added.
        * imported/w3c/i18n/bidi/block-embed-003.html: Added.
        * imported/w3c/i18n/bidi/block-override-001-expected.html: Added.
        * imported/w3c/i18n/bidi/block-override-001.html: Added.
        * imported/w3c/i18n/bidi/block-override-002-expected.html: Added.
        * imported/w3c/i18n/bidi/block-override-002.html: Added.
        * imported/w3c/i18n/bidi/block-override-003-expected.html: Added.
        * imported/w3c/i18n/bidi/block-override-003.html: Added.
        * imported/w3c/i18n/bidi/block-override-004-expected.html: Added.
        * imported/w3c/i18n/bidi/block-override-004.html: Added.
        * imported/w3c/i18n/bidi/block-override-isolate-001-expected.html: Added.
        * imported/w3c/i18n/bidi/block-override-isolate-001.html: Added.
        * imported/w3c/i18n/bidi/block-override-isolate-002-expected.html: Added.
        * imported/w3c/i18n/bidi/block-override-isolate-002.html: Added.
        * imported/w3c/i18n/bidi/block-override-isolate-003-expected.html: Added.
        * imported/w3c/i18n/bidi/block-override-isolate-003.html: Added.
        * imported/w3c/i18n/bidi/block-override-isolate-004-expected.html: Added.
        * imported/w3c/i18n/bidi/block-override-isolate-004.html: Added.
        * imported/w3c/i18n/bidi/block-plaintext-001-expected.html: Added.
        * imported/w3c/i18n/bidi/block-plaintext-001.html: Added.
        * imported/w3c/i18n/bidi/block-plaintext-002-expected.html: Added.
        * imported/w3c/i18n/bidi/block-plaintext-002.html: Added.
        * imported/w3c/i18n/bidi/block-plaintext-003-expected.html: Added.
        * imported/w3c/i18n/bidi/block-plaintext-003.html: Added.
        * imported/w3c/i18n/bidi/block-plaintext-004-expected.html: Added.
        * imported/w3c/i18n/bidi/block-plaintext-004.html: Added.
        * imported/w3c/i18n/bidi/block-plaintext-005-expected.html: Added.
        * imported/w3c/i18n/bidi/block-plaintext-005.html: Added.
        * imported/w3c/i18n/bidi/block-plaintext-006-expected.html: Added.
        * imported/w3c/i18n/bidi/block-plaintext-006.html: Added.
        * imported/w3c/i18n/bidi/resources/sileot-webfont.woff: Added.
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:

2017-05-08  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of several tests.

        * platform/gtk/TestExpectations:

2017-05-07  Simon Fraser  <simon.fraser@apple.com>

        [iOS] REGRESSION (r209409): getBoundingClientRect is wrong for fixed-position elements in resize/orientationchange
        https://bugs.webkit.org/show_bug.cgi?id=171140

        Reviewed by Sam Weinig.

        Tests that fetch the dimensions of a fixed element in resize and orientationchange handlers,
        which is a proxy for reading the layout viewport.

        * fast/events/ios/rotation/layout-viewport-during-rotation-expected.txt: Added.
        * fast/events/ios/rotation/layout-viewport-during-rotation.html: Added.
        * fast/events/ios/rotation/layout-viewport-during-safari-type-rotation-expected.txt: Added.
        * fast/events/ios/rotation/layout-viewport-during-safari-type-rotation.html: Added.
        * fast/events/ios/rotation/resources/rotation-utils.js: Added.
        (stringFromRect):
        (accumulateLog):
        (logFixedObject):
        (logFixedAndViewports):
        (doTest):

2017-05-07  Youenn Fablet  <youenn@apple.com>

        [MediaStream] r216197 caused some webrtc tests to fail
        https://bugs.webkit.org/show_bug.cgi?id=171728

        Reviewed by Eric Carlson.

        * platform/ios-wk2/TestExpectations:

2017-05-07  Sam Weinig  <sam@webkit.org>

        Implement Subresource Integrity (SRI)
        https://bugs.webkit.org/show_bug.cgi?id=148363
        <rdar://problem/18945879>

        Reviewed by Daniel Bates.

        Add tests for Subresource Integrity based off the ones from Web 
        Platform Tests. They have been changed to:
        - Split <link> and <script> testing.
        - Add additional tests:
            - Integrity hashes using base64URL encoding.
            - Integrity hashes using mixed base64 and base64URL encoding.
            - Integrity metadata that does not conform to the grammar at all.
            - Multiple valid, but only one matching, integrity hashes.
            - Non-matching integrity hash with options.
        - Run one at a time, so console output is consistent.
        
        We can/should upstream these changes, but this avoids the possibility that
        an update of the imported web-platform-tests could cause these tests to fail.
        
        Also adds tests that show the Subresource Integrity setting works correctly.

        * http/tests/subresource-integrity: Added.
        * http/tests/subresource-integrity/.htaccess: Added.
        * http/tests/subresource-integrity/resources: Added.
        * http/tests/subresource-integrity/resources/alternate.css: Added.
        * http/tests/subresource-integrity/resources/crossorigin-anon-script.js: Added.
        * http/tests/subresource-integrity/resources/crossorigin-anon-style.css: Added.
        * http/tests/subresource-integrity/resources/crossorigin-creds-script.js: Added.
        * http/tests/subresource-integrity/resources/crossorigin-creds-style.css: Added.
        * http/tests/subresource-integrity/resources/crossorigin-ineligible-script.js: Added.
        * http/tests/subresource-integrity/resources/crossorigin-ineligible-style.css: Added.
        * http/tests/subresource-integrity/resources/matching-digest.js: Added.
        * http/tests/subresource-integrity/resources/non-matching-digest.js: Added.
        * http/tests/subresource-integrity/resources/sri-utilities.js: Added.
        * http/tests/subresource-integrity/resources/style.css: Added.
        * http/tests/subresource-integrity/sri-disabled-with-setting-expected.txt: Added.
        * http/tests/subresource-integrity/sri-disabled-with-setting.html: Added.
        * http/tests/subresource-integrity/sri-enabled-with-setting-expected.txt: Added.
        * http/tests/subresource-integrity/sri-enabled-with-setting.html: Added.
        * http/tests/subresource-integrity/sri-script-expected.txt: Added.
        * http/tests/subresource-integrity/sri-script.html: Added.
        * http/tests/subresource-integrity/sri-style-expected.txt: Added.
        * http/tests/subresource-integrity/sri-style.html: Added.

2017-05-06  Myles C. Maxfield  <mmaxfield@apple.com>

        [Cocoa] CTFontDescriptorCreateMatchingFontDescriptor() is not case insensitive
        https://bugs.webkit.org/show_bug.cgi?id=171636
        <rdar://problem/30811218>

        Reviewed by Dean Jackson.

        * fast/text/lastResort-expected.html: Added.
        * fast/text/lastResort.html: Added.

2017-05-06  Chris Dumez  <cdumez@apple.com>

        Implement the concept of cookie-averse document
        https://bugs.webkit.org/show_bug.cgi?id=171746
        <rdar://problem/32004466>

        Reviewed by Sam Weinig.

        Add layout test coverage.

        * fast/cookies/cookie-averse-document-expected.txt: Added.
        * fast/cookies/cookie-averse-document.html: Added.

2017-05-06  Chris Dumez  <cdumez@apple.com>

        Align our IDL files with the latest DOM specification
        https://bugs.webkit.org/show_bug.cgi?id=171777

        Reviewed by Sam Weinig.

        Rebaseline a few tests.

        * fast/dom/Document/adoptNode-null-expected.txt:
        * fast/dom/Document/adoptNode-null.html:
        * fast/dom/Document/importNode-null-expected.txt:
        * fast/dom/Document/importNode-null.html:
        * fast/dom/Range/range-intersectsNode-expected.txt:
        * fast/text/text-combine-crash-expected.txt:

2017-05-06  Alexey Proskuryakov  <ap@apple.com>

        Mark http/tests/loading/resourceLoadStatistics/prevalent-resource-without-user-interaction.html as flaky
        https://bugs.webkit.org/show_bug.cgi?id=171785

        * platform/wk2/TestExpectations:

2017-05-06  Alexey Proskuryakov  <ap@apple.com>

        REGRESSION (r216294): The new test fails on WebKit1
        https://bugs.webkit.org/show_bug.cgi?id=171780

        Rolling back https://trac.webkit.org/r216294, https://trac.webkit.org/r216296,
        https://trac.webkit.org/216299, https://trac.webkit.org/216330

        * http/tests/css/filters-on-iframes-expected.html: Removed.
        * http/tests/css/filters-on-iframes.html: Removed.
        * http/tests/css/resources/blank.html: Removed.
        * http/tests/css/resources/references-external.html: Removed.
        * http/tests/css/resources/solid-red.html: Removed.

2017-05-06  Simon Fraser  <simon.fraser@apple.com>

        [iOS WK2] Make rotation tests more reliable
        https://bugs.webkit.org/show_bug.cgi?id=171778

        Reviewed by Tim Horton.

        New baseline.

        * fast/events/ios/rotation/zz-no-rotation-expected.txt:
        * fast/events/ios/rotation/zz-no-rotation.html:

2017-05-06  Chris Dumez  <cdumez@apple.com>

        Unreviewed, rolling out r216333.

        Caused layout test failures

        Reverted changeset:

        "Implement the concept of cookie-averse document"
        https://bugs.webkit.org/show_bug.cgi?id=171746
        http://trac.webkit.org/changeset/216333

2017-05-06  Chris Dumez  <cdumez@apple.com>

        Implement the concept of cookie-averse document
        https://bugs.webkit.org/show_bug.cgi?id=171746
        <rdar://problem/32004466>

        Reviewed by Sam Weinig.

        Add layout test coverage.

        * fast/cookies/cookie-averse-document-expected.txt: Added.
        * fast/cookies/cookie-averse-document.html: Added.

2017-05-06  Myles C. Maxfield  <mmaxfield@apple.com>

        REGERSSION(r213499): Emoji with Fitzpatrick modifiers are drawn as two separate glyphs
        https://bugs.webkit.org/show_bug.cgi?id=171750
        <rdar://problem/31122612>

        Reviewed by Zalan Bujtas.

        * fast/text/fitzpatrick-combination-expected.html: Added.
        * fast/text/fitzpatrick-combination.html: Added.

2017-05-05  Zalan Bujtas  <zalan@apple.com>

        Renderers being destroyed should not be added to AX's deferred list.
        https://bugs.webkit.org/show_bug.cgi?id=171768
        <rdar://problem/31955660>

        Reviewed by Simon Fraser.

        * accessibility/crash-when-renderers-are-added-back-to-deferred-list-expected.txt: Added.
        * accessibility/crash-when-renderers-are-added-back-to-deferred-list.html: Added.

2017-05-05  Matt Lewis  <jlewis3@apple.com>

        Mark compositing/tiling/non-active-window-tiles-size.html as flaky
        https://bugs.webkit.org/show_bug.cgi?id=171763

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-05  Oliver Hunt  <oliver@apple.com>

        Move trivial String prototype functions to JS builtins
        https://bugs.webkit.org/show_bug.cgi?id=171737

        Reviewed by Saam Barati.

        Updated output

        * js/dom/string-anchor-expected.txt:
        * js/dom/string-anchor.html:
        * js/dom/string-fontcolor-expected.txt:
        * js/dom/string-fontcolor.html:
        * js/dom/string-fontsize-expected.txt:
        * js/dom/string-fontsize.html:
        * js/dom/string-link-expected.txt:
        * js/dom/string-link.html:

2017-05-05  Dean Jackson  <dino@apple.com>

        Restrict SVG filters to accessible security origins
        https://bugs.webkit.org/show_bug.cgi?id=118689
        <rdar://problem/27362159>

        Reviewed by Brent Fulgham.

        Add a test that shows safe frames, unsafe frames, and
        then a safe frame that itself has an unsafe frame, to
        show that the security requirements are being forwarded
        down the tree.

        * http/tests/css/filters-on-iframes-expected.html: Added.
        * http/tests/css/filters-on-iframes.html: Added.
        * http/tests/css/resources/blank.html: Added.
        * http/tests/css/resources/references-external.html: Added.
        * http/tests/css/resources/solid-red.html: Added.

2017-05-05  Simon Fraser  <simon.fraser@apple.com>

        Make it possible to test rotation in iOS WebKitTestRunner
        https://bugs.webkit.org/show_bug.cgi?id=171755

        Reviewed by Tim Horton.

        Two rotation tests and one that comes last to ensure that the device was not left in a rotated state.

        * fast/events/ios/rotation/basic-rotation-expected.txt: Added.
        * fast/events/ios/rotation/basic-rotation.html: Added.
        * fast/events/ios/rotation/safari-like-rotation-expected.txt: Added.
        * fast/events/ios/rotation/safari-like-rotation.html: Added.
        * fast/events/ios/rotation/zz-no-rotation-expected.txt: Added.
        * fast/events/ios/rotation/zz-no-rotation.html: Added.

2017-05-05  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/loading/resourceLoadStatistics/prevalent-resource-without-user-interaction.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171756

        Unreviewed test gardening.

        * platform/wk2/TestExpectations:

2017-05-05  Matt Lewis  <jlewis3@apple.com>

        Mark test http/tests/security/module-correct-mime-types.html slow.
        https://bugs.webkit.org/show_bug.cgi?id=164960

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-05  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r216275.

        This change broke internal builds.

        Reverted changeset:

        "[Cocoa] CTFontDescriptorCreateMatchingFontDescriptor() is not
        case insensitive"
        https://bugs.webkit.org/show_bug.cgi?id=171636
        http://trac.webkit.org/changeset/216275

2017-05-05  Myles C. Maxfield  <mmaxfield@apple.com>

        [Cocoa] CTFontDescriptorCreateMatchingFontDescriptor() is not case insensitive
        https://bugs.webkit.org/show_bug.cgi?id=171636
        <rdar://problem/30811218>

        Reviewed by Dean Jackson.

        * fast/text/lastResort-expected.html: Added.
        * fast/text/lastResort.html: Added.

2017-05-05  Ryan Haddad  <ryanhaddad@apple.com>

        Unskip media/click-placeholder-not-pausing.html.

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-05  Joseph Pecoraro  <pecoraro@apple.com>

        REGRESSION: LayoutTest streams/reference-implementation/readable-stream-templated.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=171580
        <rdar://problem/32009647>

        Rubber-stamped by Alexey Proskuryakov.

        * TestExpectations:
        * streams/reference-implementation/pipe-to-expected.txt:
        Rebaseline expectations. This test was previously flakey so the results were
        missed unless the test was run with --force.

        * streams/reference-implementation/readable-stream-templated-expected.txt:
        * streams/reference-implementation/readable-stream-templated.html:
        Silence unhandled rejections. This test did not expect unhandled promise
        rejections to affect test results, so ignore them.

2017-05-05  Joseph Pecoraro  <pecoraro@apple.com>

        [macOS Sierra] LayoutTest http/tests/inspector/network/resource-request-headers.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170702
        <rdar://problem/31616643>

        Rubber-stamped by Brian Burg.

        * platform/mac-wk2/TestExpectations:
        * http/tests/inspector/network/resource-request-headers.html:
        Make this test unflakey by ensuring we wait for the load to complete.

2017-05-05  Chris Dumez  <cdumez@apple.com>

        Attr Nodes should not have children
        https://bugs.webkit.org/show_bug.cgi?id=171688
        <rdar://problem/31998412>

        Reviewed by Andreas Kling.

        * fast/dom/Attr/cannot-have-children-expected.txt: Added.
        * fast/dom/Attr/cannot-have-children.html: Added.
        Add layout test coverage. I have verified that this test passes in both
        Firefox and Chrome.

        * dom/html/level1/*: Removed legacy / outdated tests.
        * dom/xhtml/level1/*: Removed legacy / outdated tests.

        * fast/dom/Attr/child-nodes-cache-expected.txt: Removed.
        * fast/dom/Attr/child-nodes-cache.html: Removed.
        * fast/dom/Attr/child-nodes-length-cache-expected.txt: Removed.
        * fast/dom/Attr/child-nodes-length-cache.html: Removed.
        * fast/dom/Attr/invalidate-nodelist-after-attr-setvalue-expected.txt: Removed.
        * fast/dom/Attr/invalidate-nodelist-after-attr-setvalue.html: Removed.
        * fast/dom/attribute-change-on-mutate-expected.txt: Removed.
        * fast/dom/attribute-change-on-mutate.html: Removed.
        * svg/custom/image-with-attr-change-after-delete-crash-expected.txt: Removed.
        * svg/custom/image-with-attr-change-after-delete-crash.html: Removed.
        * traversal/moz-bug590771-expected.txt: Removed.
        * traversal/moz-bug590771.html: Removed.
        Removed some outdated tests.

        * fast/custom-elements/reactions-for-webkit-extensions-expected.txt:
        * fast/custom-elements/reactions-for-webkit-extensions.html:
        * fast/dom/Attr/change-id-via-attr-node-value-expected.txt:
        * fast/dom/Attr/change-id-via-attr-node-value.html:
        * fast/dom/Element/normalize-crash.html:
        * fast/dom/Element/normalize-crash2.html:
        * fast/dom/HTMLLinkElement/event-while-removing-attribute-expected.txt:
        * fast/dom/HTMLLinkElement/event-while-removing-attribute.html:
        * fast/dom/MutationObserver/observe-attributes-expected.txt:
        * fast/dom/MutationObserver/observe-attributes.html:
        * fast/dom/import-attribute-node.html:
        * fast/dom/insertedIntoDocument-child.html:
        * fast/dom/insertedIntoDocument-sibling.html:
        * fast/dom/no-assert-for-malformed-js-url-attribute-expected.txt:
        * fast/dom/no-assert-for-malformed-js-url-attribute.html:
        * fast/dom/normalize-attributes-mutation-event-crash.html:
        * fast/dom/serialize-nodes.xhtml:
        * http/tests/security/xss-DENIED-iframe-src-alias-expected.txt:
        Update existing tests so they stop relying on Attr Node having Text children.

2017-05-05  Ryan Haddad  <ryanhaddad@apple.com>

        Mark w3c test persisted-user-state-restoration/scroll-restoration-fragment-scrolling-cross-origin.html as flaky on mac-wk1.
        https://bugs.webkit.org/show_bug.cgi?id=161360

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-05-05  Matt Lewis  <jlewis3@apple.com>

        Mark 2 webrtc test as failing.
        https://bugs.webkit.org/show_bug.cgi?id=171728

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-05  Chris Dumez  <cdumez@apple.com>

        Refactor / Clean up Element.idl
        https://bugs.webkit.org/show_bug.cgi?id=171734

        Reviewed by Sam Weinig.

        Rebaseline a couple of tests due to Element properties being enumerated in a slightly
        different order and because exception messages have changed slightly.

        * fast/dom/Element/attr-param-typechecking-expected.txt:
        * js/dom/dom-static-property-for-in-iteration-expected.txt:

2017-05-05  Jeremy Jones  <jeremyj@apple.com>

        REGRESSION (r215951): LayoutTest media/modern-media-controls/placard-support/placard-support-pip.html is a flaky crash
        https://bugs.webkit.org/show_bug.cgi?id=171610
        <rdar://problem/31976820>

        Reviewed by Eric Carlson.

        enable test: media/modern-media-controls/pip-support/pip-support-click.html

        * platform/mac-wk1/TestExpectations:

2017-05-05  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of tests failing after GST upgrade to 1.10.4.

        * platform/gtk/TestExpectations:

2017-05-05  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Rebaseline several tests.

        * platform/gtk/editing/simple-line-layout-caret-is-gone-expected.txt: Added.
        * platform/gtk/fast/repaint/mutate-non-visible-expected.txt: Added.
        * platform/gtk/fast/visual-viewport/rubberbanding-viewport-rects-extended-background-expected.txt:
        * platform/gtk/http/tests/security/video-cross-origin-accessfailure-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/fetch/http-cache/cc-request-expected.txt: Added.

2017-05-05  Zan Dobersek  <zdobersek@igalia.com>

        Unreviewed GTK+ gardening.

        * platform/gtk/TestExpectations: Enable already-passing Web Crypto layout tests
        for the GTK+ port. Also update expectations for the imported W3C Web Crypto tests.

2017-05-04  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r216206.
        https://bugs.webkit.org/show_bug.cgi?id=171714

        Multiple LayoutTests crashing in Document::page() (Requested
        by ap on #webkit).

        Reverted changeset:

        "Remove support for legacy Notifications"
        https://bugs.webkit.org/show_bug.cgi?id=171487
        http://trac.webkit.org/changeset/216206

2017-05-04  Chris Dumez  <cdumez@apple.com>

        Element.slot should be marked as [Unscopable]
        https://bugs.webkit.org/show_bug.cgi?id=171683

        Reviewed by Darin Adler.

        Add layout test coverage. This test is passing in Firefox and Chrome.

        * fast/shadow-dom/Element-slot-unscopable-expected.txt: Added.
        * fast/shadow-dom/Element-slot-unscopable.html: Added.

2017-05-04  Said Abou-Hallawa  <sabouhallawa@apple.com>

        Change the asynchronous image decoding tests to use the event webkitImageFrameReady
        https://bugs.webkit.org/show_bug.cgi?id=171634

        Reviewed by Simon Fraser.

        To test the async image decoding reliably we need to do the following:

        -- Make sure to load the image before setting its src to the element.
        -- Call document.body.offsetHeight to force layout.
        -- Call testRunner.display() to force the first paint.
        -- Use the webkitImageFrameReady to reliably know when an image frame is ready.
        -- When webkitImageFrameReady is fired call testRunner.notifyDone(). This
           will force the second paint.

        * fast/images/async-image-background-image-repeated.html:
        * fast/images/async-image-background-image.html:
        * fast/images/sprite-sheet-image-draw.html:

2017-05-04  Matt Lewis  <jlewis3@apple.com>

        Mark webrtc/libwebrtc/descriptionGetters.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171703

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-04  Said Abou-Hallawa  <sabouhallawa@apple.com>

        Rename testRunner.displayAndTrackRepaints() to testRunner.displayAndTrackRepaints()
        https://bugs.webkit.org/show_bug.cgi?id=171641

        Reviewed by Simon Fraser.

        Replace all the calls to testRunner.displayAndTrackRepaints() by testRunner.displayAndTrackRepaints()
        Replace all the calls to testRunner.displayInvalidatedRegion() by
        testRunner.displayAndTrackRepaints() since the former is a copy of the later.

        * compositing/clip-change.html:
        * compositing/geometry/foreground-offset-change.html:
        * compositing/geometry/limit-layer-bounds-transformed-overflow.html:
        * compositing/iframes/become-composited-nested-iframes.html:
        * compositing/iframes/become-overlapped-iframe.html:
        * compositing/iframes/connect-compositing-iframe-delayed.html:
        * compositing/iframes/connect-compositing-iframe.html:
        * compositing/iframes/connect-compositing-iframe2.html:
        * compositing/iframes/connect-compositing-iframe3.html:
        * compositing/iframes/enter-compositing-iframe.html:
        * compositing/iframes/iframe-content-flipping.html:
        * compositing/iframes/iframe-resize.html:
        * compositing/iframes/iframe-size-to-zero.html:
        * compositing/iframes/iframe-src-change.html:
        * compositing/iframes/invisible-nested-iframe-hide.html:
        * compositing/iframes/invisible-nested-iframe-show.html:
        * compositing/iframes/leave-compositing-iframe.html:
        * compositing/iframes/overlapped-iframe-iframe.html:
        * compositing/iframes/overlapped-iframe.html:
        * compositing/iframes/overlapped-nested-iframes.html:
        * compositing/iframes/repaint-after-losing-scrollbars.html:
        * compositing/iframes/resources/fixed-position-subframe.html:
        * compositing/iframes/resources/fixed-position-transformed-subframe.html:
        * compositing/iframes/resources/scrollgrandchild-inner.html:
        * compositing/iframes/scrolling-iframe.html:
        * compositing/overflow/content-gains-scrollbars.html:
        * compositing/overflow/content-loses-scrollbars.html:
        * compositing/overflow/do-not-paint-outline-into-composited-scrolling-contents.html:
        * compositing/overflow/overflow-scrollbar-layers.html:
        * compositing/overflow/paint-neg-z-order-descendants-into-scrolling-contents-layer.html:
        * compositing/overflow/repaint-after-losing-scrollbars.html:
        * compositing/patterns/direct-pattern-compositing-add-text-expected.html:
        * compositing/patterns/direct-pattern-compositing-add-text.html:
        * compositing/patterns/direct-pattern-compositing-change-expected.html:
        * compositing/patterns/direct-pattern-compositing-change.html:
        * compositing/patterns/direct-pattern-compositing-load-expected.html:
        * compositing/patterns/direct-pattern-compositing-load.html:
        * compositing/plugins/invalidate_rect.html:
        * compositing/repaint/iframes/composited-iframe-with-fixed-background-doc-repaint.html:
        * compositing/repaint/iframes/compositing-iframe-scroll-repaint.html:
        * compositing/repaint/iframes/compositing-iframe-with-fixed-background-doc-repaint.html:
        * compositing/repaint/newly-composited-on-scroll.html:
        * compositing/repaint/newly-composited-repaint-rect.html:
        * compositing/repaint/page-scale-repaint.html:
        * compositing/repaint/requires-backing-repaint.html:
        * compositing/repaint/transform-style-change.html:
        * compositing/rtl/rtl-overflow-invalidation.html:
        * compositing/scroll-painted-composited-content.html:
        * compositing/tiling/huge-layer-resize.html:
        * compositing/video-page-visibility.html:
        * compositing/video/video-with-invalid-source.html:
        * compositing/webgl/webgl-repaint.html:
        * css3/filters/multiple-filters-invalidation.html:
        * css3/flexbox/repaint-column-reverse.html:
        * css3/flexbox/repaint-during-resize-no-flex.html:
        * css3/flexbox/repaint-rtl-column.html:
        * css3/flexbox/repaint.html:
        * displaylists/canvas-display-list.html:
        * displaylists/resources/dump-target-display-list.js:
        (doTest):
        * displaylists/resources/dump-target-replay-list.js:
        (doTest):
        * fast/animation/request-animation-frame-detach-element.html:
        * fast/animation/request-animation-frame-detach-element2.html:
        * fast/animation/request-animation-frame-during-modal.html:
        * fast/animation/request-animation-frame-iframe.html:
        * fast/animation/request-animation-frame-iframe2.html:
        * fast/animation/script-tests/request-animation-frame-cancel.js:
        * fast/animation/script-tests/request-animation-frame-cancel2.js:
        * fast/animation/script-tests/request-animation-frame-disabled.js:
        * fast/animation/script-tests/request-animation-frame-prefix.js:
        (window.webkitRequestAnimationFrame):
        (window.testRunner.window.setTimeout):
        * fast/animation/script-tests/request-animation-frame-time-unit.js:
        (window.requestAnimationFrame):
        * fast/animation/script-tests/request-animation-frame-timestamps-advance.js:
        (window.requestAnimationFrame):
        (window.testRunner.window.setTimeout):
        * fast/animation/script-tests/request-animation-frame-timestamps.js:
        * fast/animation/script-tests/request-animation-frame-within-callback.js:
        * fast/animation/script-tests/request-animation-frame.js:
        * fast/backgrounds/obscured-background-child-style-change-expected.html:
        * fast/backgrounds/obscured-background-child-style-change.html:
        * fast/backgrounds/solid-color-context-restore.html:
        * fast/canvas/canvas-as-image-incremental-repaint.html:
        * fast/canvas/canvas-incremental-repaint-2.html:
        * fast/canvas/canvas-incremental-repaint.html:
        * fast/canvas/canvas-resize-after-paint.html:
        * fast/canvas/resources/repaint.js:
        (runRepaintTest):
        * fast/canvas/script-tests/canvas-imageSmoothingEnabled-repaint.js:
        (TestControllerPaint):
        * fast/canvas/webgl/canvas-test.html:
        * fast/canvas/webgl/webgl-layer-update.html:
        * fast/css/pseudostyle-anonymous-text.html:
        * fast/css/relative-positioned-block-crash.html:
        * fast/dom/Window/post-message-crash.html:
        * fast/dom/Window/web-timing-minimal-performance-now.html:
        * fast/dynamic/containing-block-change.html:
        * fast/dynamic/layer-no-longer-paginated.html:
        * fast/events/touch/gesture/pad-gesture-cancel.js:
        * fast/events/touch/gesture/pad-gesture-fling.js:
        * fast/forms/hidden-listbox.html:
        * fast/forms/listbox-clip.html:
        * fast/frames/inline-object-inside-frameset.html:
        * fast/frames/transparent-scrollbar.html:
        * fast/images/animated-background-image-crash.html:
        * fast/layers/add-layer-with-nested-stacking.html:
        * fast/layers/inline-dirty-z-order-lists.html:
        * fast/layers/layer-content-visibility-change.html:
        * fast/layers/nested-layers-1.html:
        * fast/layers/nested-layers-2.html:
        * fast/layers/nested-layers-3.html:
        * fast/layers/nested-layers-4.html:
        * fast/layers/remove-layer-with-nested-stacking.html:
        * fast/overflow/hidden-scrollbar-resize.html:
        * fast/reflections/inline-crash.html:
        * fast/repaint/animation-after-layer-scroll.html:
        * fast/repaint/background-shorthand-with-gradient-and-height-changes.html:
        * fast/repaint/fixed-child-move-after-scroll.html:
        * fast/repaint/fixed-child-of-fixed-move-after-scroll.html:
        * fast/repaint/fixed-child-of-transformed-move-after-scroll.html:
        * fast/repaint/fixed-move-after-scroll.html:
        * fast/repaint/no-animation-outside-viewport-subframe.html:
        * fast/repaint/no-animation-outside-viewport.html:
        * fast/repaint/obscured-background-no-repaint.html:
        * fast/repaint/overflow-hidden-in-overflow-hidden-scrolled.html:
        * fast/repaint/renderer-destruction-by-invalidateSelection-crash.html:
        * fast/repaint/repaint-during-scroll-with-zoom.html:
        * fast/repaint/resources/fixed-move-after-keyboard-scroll-iframe.html:
        * fast/repaint/resources/iframe-scroll-repaint-iframe.html:
        * fast/repaint/resources/line-flow-with-floats.js:
        (beginTest):
        * fast/repaint/resources/repaint.js:
        (runRepaintTest):
        * fast/repaint/table-overflow-hidden-in-overflow-hidden-scrolled.html:
        * fast/replaced/width100percent-textarea.html:
        * fast/scrolling/scrollbar-tickmarks-hittest.html:
        * fast/table/border-collapsing/cached-69296.html:
        * fast/table/border-collapsing/cached-cell-append.html:
        * fast/table/border-collapsing/cached-cell-remove.html:
        * fast/table/border-collapsing/cached-change-cell-border-color.html:
        * fast/table/border-collapsing/cached-change-cell-border-width.html:
        * fast/table/border-collapsing/cached-change-cell-sl-border-color.html:
        * fast/table/border-collapsing/cached-change-col-border-color.html:
        * fast/table/border-collapsing/cached-change-col-border-width.html:
        * fast/table/border-collapsing/cached-change-colgroup-border-color.html:
        * fast/table/border-collapsing/cached-change-colgroup-border-width.html:
        * fast/table/border-collapsing/cached-change-row-border-color.html:
        * fast/table/border-collapsing/cached-change-row-border-width.html:
        * fast/table/border-collapsing/cached-change-table-border-color.html:
        * fast/table/border-collapsing/cached-change-table-border-width.html:
        * fast/table/border-collapsing/cached-change-tbody-border-color.html:
        * fast/table/border-collapsing/cached-change-tbody-border-width.html:
        * fast/table/empty-section-crash.html:
        * fast/text/font-initial.html:
        * fast/text/international/harfbuzz-runs-with-no-glyph.html:
        * fast/text/text-shadow-extreme-value.html:
        * http/tests/misc/slow-loading-image-in-pattern.html:
        * media/audio-repaint.html:
        * media/media-document-audio-repaint.html:
        * plugins/windowless_plugin_paint_test.html:
        * scrollbars/scrollbar-percent-padding-crash.html:
        * svg/custom/non-scaling-stroke-update.svg:
        * svg/custom/stale-resource-data-crash.svg:

2017-05-04  Chris Dumez  <cdumez@apple.com>

        Reformat / Clean up Node.idl to match the specification
        https://bugs.webkit.org/show_bug.cgi?id=171686

        Reviewed by Sam Weinig.

        Rebaseline existing test now that the Node properties are enumerated in a
        slightly different order.

        * js/dom/dom-static-property-for-in-iteration-expected.txt:

2017-05-04  Sam Weinig  <sam@webkit.org>

        Remove support for legacy Notifications
        https://bugs.webkit.org/show_bug.cgi?id=171487

        Reviewed by Jon Lee.

        - Remove fast/notifications/. It was skipped on all platforms and use legacy Notifications API.
        - Remove http/notifications/legacy. It tested the legacy API.
        - Update two tests in fast/history to use the non-legacy API to test page cache + notifications.
        - Update TestExpectations for removals.

        * TestExpectations:
        * platform/gtk/TestExpectations:
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:
        * platform/win/TestExpectations:
        * fast/history/page-cache-notification-non-suspendable.html:
        * fast/history/page-cache-notification-suspendable.html:
        * fast/notifications: Removed.
        * fast/notifications/notification-after-close-expected.txt: Removed.
        * fast/notifications/notification-after-close.html: Removed.
        * fast/notifications/notification-permisssion-deletable-expected.txt: Removed.
        * fast/notifications/notification-permisssion-deletable.html: Removed.
        * fast/notifications/notifications-cancel-request-permission-expected.txt: Removed.
        * fast/notifications/notifications-cancel-request-permission.html: Removed.
        * fast/notifications/notifications-check-permission-expected.txt: Removed.
        * fast/notifications/notifications-check-permission.html: Removed.
        * fast/notifications/notifications-click-event-expected.txt: Removed.
        * fast/notifications/notifications-click-event-focus-expected.txt: Removed.
        * fast/notifications/notifications-click-event-focus.html: Removed.
        * fast/notifications/notifications-click-event.html: Removed.
        * fast/notifications/notifications-constructor-request-permission-expected.txt: Removed.
        * fast/notifications/notifications-constructor-request-permission.html: Removed.
        * fast/notifications/notifications-constructor-with-permission-expected.txt: Removed.
        * fast/notifications/notifications-constructor-with-permission.html: Removed.
        * fast/notifications/notifications-constructor-without-permission-expected.txt: Removed.
        * fast/notifications/notifications-constructor-without-permission.html: Removed.
        * fast/notifications/notifications-display-close-events-expected.txt: Removed.
        * fast/notifications/notifications-display-close-events.html: Removed.
        * fast/notifications/notifications-document-close-crash-expected.txt: Removed.
        * fast/notifications/notifications-document-close-crash.html: Removed.
        * fast/notifications/notifications-event-stop-propagation-expected.txt: Removed.
        * fast/notifications/notifications-event-stop-propagation.html: Removed.
        * fast/notifications/notifications-multi-events-expected.txt: Removed.
        * fast/notifications/notifications-multi-events.html: Removed.
        * fast/notifications/notifications-no-icon-expected.txt: Removed.
        * fast/notifications/notifications-no-icon.html: Removed.
        * fast/notifications/notifications-permission-expected.txt: Removed.
        * fast/notifications/notifications-permission.html: Removed.
        * fast/notifications/notifications-replace-expected.txt: Removed.
        * fast/notifications/notifications-replace.html: Removed.
        * fast/notifications/notifications-request-permission-expected.txt: Removed.
        * fast/notifications/notifications-request-permission-optional-expected.txt: Removed.
        * fast/notifications/notifications-request-permission-optional.html: Removed.
        * fast/notifications/notifications-request-permission.html: Removed.
        * fast/notifications/notifications-rtl-expected.txt: Removed.
        * fast/notifications/notifications-rtl.html: Removed.
        * fast/notifications/notifications-sandbox-permission-expected.txt: Removed.
        * fast/notifications/notifications-sandbox-permission.html: Removed.
        * fast/notifications/notifications-window-close-crash-expected.txt: Removed.
        * fast/notifications/notifications-window-close-crash.html: Removed.
        * fast/notifications/notifications-with-permission-expected.txt: Removed.
        * fast/notifications/notifications-with-permission.html: Removed.
        * fast/notifications/notifications-without-permission-expected.txt: Removed.
        * fast/notifications/notifications-without-permission.html: Removed.
        * fast/notifications/request-notification-permission-while-reloading-expected.txt: Removed.
        * fast/notifications/request-notification-permission-while-reloading.html: Removed.
        * fast/notifications/resources: Removed.
        * fast/notifications/resources/notifications-cancel-request-permission.html: Removed.
        * fast/notifications/resources/notifications-iframe.html: Removed.
        * http/tests/notifications/legacy: Removed.
        * http/tests/notifications/legacy/double-show-expected.txt: Removed.
        * http/tests/notifications/legacy/double-show.html: Removed.
        * http/tests/notifications/legacy/events-expected.txt: Removed.
        * http/tests/notifications/legacy/events.html: Removed.
        * http/tests/notifications/legacy/notification-request-permission-then-navigate-expected.txt: Removed.
        * http/tests/notifications/legacy/notification-request-permission-then-navigate.html: Removed.
        * http/tests/notifications/legacy/request-expected.txt: Removed.
        * http/tests/notifications/legacy/request-no-callback-expected.txt: Removed.
        * http/tests/notifications/legacy/request-no-callback.html: Removed.
        * http/tests/notifications/legacy/request.html: Removed.
        * http/tests/notifications/legacy/resources: Removed.
        * http/tests/notifications/legacy/resources/notify-opener-done.html: Removed.
        * http/tests/notifications/legacy/resources/request-permission-then-navigate.html: Removed.
        * http/tests/notifications/legacy/show-expected.txt: Removed.
        * http/tests/notifications/legacy/show.html: Removed.
        * http/tests/notifications/legacy/window-show-on-click-expected.txt: Removed.
        * http/tests/notifications/legacy/window-show-on-click.html: Removed.

2017-05-04  Matt Lewis  <jlewis3@apple.com>

        Marked http/tests/xmlhttprequest/workers/methods-async.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=160368

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-04  Antti Koivisto  <antti@apple.com>

        REGRESSION (Safari 10.1): When 'transition' contains -ms-transform, transform-origin is also transitioned
        https://bugs.webkit.org/show_bug.cgi?id=171250
        <rdar://problem/31827243>

        Reviewed by Geoffrey Garen.

        * transitions/transition-unknown-property-ignore-expected.txt: Added.
        * transitions/transition-unknown-property-ignore.html: Added.
        * transitions/transitions-parsing-expected.txt:
        * transitions/transitions-parsing.html:

            Update the roundtrip expectations for unknown properties. The new results match Blink and Gecko.

2017-05-04  Chris Dumez  <cdumez@apple.com>

        Reformat / clean up Event.idl
        https://bugs.webkit.org/show_bug.cgi?id=171675

        Reviewed by Sam Weinig.

        Rebaseline test now that the Event properties are in a slightly different order.

        * inspector/model/remote-object-get-properties-expected.txt:

2017-05-04  Daniel Bates  <dabates@apple.com>

        importScripts() should respect X-Content-Type-Options: nosniff
        https://bugs.webkit.org/show_bug.cgi?id=171248
        <rdar://problem/31819023>

        Reviewed by Andy Estes.

        Unskip web-platform-tests/fetch/nosniff/importscripts as it now passes.

        * TestExpectations:

2017-05-04  Said Abou-Hallawa  <sabouhallawa@apple.com>

        Unreviewed: Replace Windows line ending (CRLF) by Unix line ending (CR).

        * plugins/windowless_plugin_paint_test.html:

2017-05-04  Said Abou-Hallawa  <sabouhallawa@apple.com>

        Unreviewed: Replace Windows line ending (CRLF) by Unix line ending (CR).

        * compositing/video/video-with-invalid-source.html:

2017-05-04  Ryan Haddad  <ryanhaddad@apple.com>

        Skip media/modern-media-controls/pip-support/pip-support-click.html on mac-wk1.
        https://bugs.webkit.org/show_bug.cgi?id=171610

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-05-04  Dave Hyatt  <hyatt@apple.com>

        REGRESSION(STP): rgb() with calc() containing variables doesn't work
        https://bugs.webkit.org/show_bug.cgi?id=169939

        Reviewed by Zalan Bujtas.

        * fast/css/variables/calc-float-to-int-expected.html: Added.
        * fast/css/variables/calc-float-to-int.html: Added.

2017-05-04  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed gardening. Update main expectations of http/tests/inspector/network/resource-request-headers.html.

        And add platform specific results for mac-wk2.

        * http/tests/inspector/network/resource-request-headers-expected.txt:
        * platform/mac-wk2/http/tests/inspector/network/resource-request-headers-expected.txt: Copied from LayoutTests/http/tests/inspector/network/resource-request-headers-expected.txt.

2017-05-03  John Wilander  <wilander@apple.com>

        Resource Load Statistics: Remove all statistics for modifiedSince website data removals
        https://bugs.webkit.org/show_bug.cgi?id=171584
        <rdar://problem/24702576>

        Reviewed by Brent Fulgham.

        * http/tests/loading/resourceLoadStatistics/clear-in-memory-and-persistent-store-one-hour-expected.txt: Added.
        * http/tests/loading/resourceLoadStatistics/clear-in-memory-and-persistent-store-one-hour.html: Added.

2017-05-03  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: aria-rowspan value should be ignored if td/th rowspan value is provided
        https://bugs.webkit.org/show_bug.cgi?id=171214

        Reviewed by Chris Fleizach.

        * accessibility/aria-cellspans-with-native-cellspans-expected.txt: Added.
        * accessibility/aria-cellspans-with-native-cellspans.html: Added.

2017-05-03  Matt Lewis  <jlewis3@apple.com>

        Mark http/tests/xmlhttprequest/methods.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171638

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-03  Ryan Haddad  <ryanhaddad@apple.com>

        Mark scrollingcoordinator/ios/nested-fixed-layer-positions.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171628

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-03  Zalan Bujtas  <zalan@apple.com>

        SearchInputType could end up with a mismatched renderer.
        https://bugs.webkit.org/show_bug.cgi?id=171547
        <rdar://problem/31935047>

        Reviewed by Antti Koivisto.

        * fast/forms/change-input-type-and-submit-form-crash-expected.txt: Added.
        * fast/forms/change-input-type-and-submit-form-crash.html: Added.

2017-05-03  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/slider/slider-styles.html as flaky on mac-wk1.
        https://bugs.webkit.org/show_bug.cgi?id=171629

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-05-03  Joseph Pecoraro  <pecoraro@apple.com>

        LayoutTest http/tests/inspector/network/fetch-network-data.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=166038
        <rdar://problem/29488489>

        Reviewed by Matt Baker.

        * platform/mac/TestExpectations:
        * http/tests/inspector/network/fetch-network-data.html:
        * http/tests/inspector/network/xhr-request-data-encoded-correctly.html:
        Use singleFireEventListener instead of awaitEvent so that the follow-up event handlers
        can be added synchronously instead of in a microtask. When the microtask happened later
        than other incoming events then the follow-up handlers would have been added too late.

2017-05-03  Matt Lewis  <jlewis3@apple.com>

        Mark imported/w3c/web-platform-tests/html/webappapis/timers/negative-settimeout.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170699.

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-03  Simon Fraser  <simon.fraser@apple.com>

        Have WKWebView call _updateVisibleContentRects for the current transaction if possible, rather than always delaying
        https://bugs.webkit.org/show_bug.cgi?id=171619
        https://bugs.webkit.org/show_bug.cgi?id=170153

        Reviewed by Tim Horton.

        These tests need to wait a bit for the scrolling state of the document to be updated.

        * fast/scrolling/ios/touch-scroll-pointer-events-none.html:
        * fast/scrolling/ios/touch-scroll-visibility-hidden.html:
        * platform/ios-wk2/TestExpectations:

2017-05-03  Yoav Weiss  <yoav@yoav.ws>

        Link preload HTMLPreloadScanner support
        https://bugs.webkit.org/show_bug.cgi?id=170747

        Reviewed by Youenn Fablet.

        * http/tests/preload/preloadscanner_download_resources-expected.txt: Added.
        * http/tests/preload/preloadscanner_download_resources.html: Added.

2017-05-03  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/preload/single_download_preload.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171331

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-03  Matt Lewis  <jlewis3@apple.com>

        Mark perf/object-keys.html as flaky
        https://bugs.webkit.org/show_bug.cgi?id=171617

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-03  Keith Miller  <keith_miller@apple.com>

        Different behaviour with the .sort(callback) method (unlike Firefox & Chrome)
        https://bugs.webkit.org/show_bug.cgi?id=47825

        Reviewed by Saam Barati.

        Fix broken test.

        * http/tests/inspector/worker/blob-script-with-cross-domain-imported-scripts-expected.txt:

2017-05-03  Matt Lewis  <jlewis3@apple.com>

        Mark http/tests/xmlhttprequest/supported-xml-content-types.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171613

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-03  Nan Wang  <n_wang@apple.com>

        AX: VO skips cells after cell with aria-colspan
        https://bugs.webkit.org/show_bug.cgi?id=171579

        Reviewed by Chris Fleizach.

        * accessibility/mac/aria-grid-column-span-expected.txt: Added.
        * accessibility/mac/aria-grid-column-span.html: Added.

2017-05-03  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/websocket/tests/hybi/inspector/binary.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171553

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-03  Daniel Bates  <dabates@apple.com>

        Detach frame from document when entering page cache
        https://bugs.webkit.org/show_bug.cgi?id=166774
        <rdar://problem/29904368>

        Reviewed by Chris Dumez.

        * TestExpectations: Unskip tests.
        * fast/history/page-cache-after-window-open-expected.txt: Update expected result.
        * fast/history/page-cache-after-window-open.html: Ditto.
        * fast/history/page-cache-with-opener-expected.txt: Ditto.
        * fast/history/page-cache-with-opener.html: Update test given its new expected behavior.
        * fast/history/resources/page-cache-window-with-opener.html: Ditto.
        * http/tests/security/xss-DENIED-click-and-form-submission-from-inactive-domwindow-expected.txt: Added.
        * http/tests/security/xss-DENIED-click-and-form-submission-from-inactive-domwindow.html: Added.
        * http/tests/security/xss-DENIED-script-inject-into-inactive-window-expected.txt: Added.
        * http/tests/security/xss-DENIED-script-inject-into-inactive-window.html: Added.
        * http/tests/security/xss-DENIED-script-inject-into-inactive-window2-expected.txt: Added.
        * http/tests/security/xss-DENIED-script-inject-into-inactive-window2.html: Added.
        * http/tests/security/xss-DENIED-script-inject-into-inactive-window3-expected.txt: Added.
        * http/tests/security/xss-DENIED-script-inject-into-inactive-window3.html: Added.

2017-05-03  Matt Lewis  <jlewis3@apple.com>

        Marking three imported/w3c/web-platform-tests/webrtc test as flaky failures.
        https://bugs.webkit.org/show_bug.cgi?id=171605

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-03  Matt Lewis  <jlewis3@apple.com>

        Marked test http/tests/local/blob/send-sliced-data-blob.html as flaky failure and timeout.
        https://bugs.webkit.org/show_bug.cgi?id=171564

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-03  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: Treat cells with ARIA table cell properties as cells
        https://bugs.webkit.org/show_bug.cgi?id=171178

        Reviewed by Chris Fleizach.

        * accessibility/minimal-table-with-aria-is-data-table-expected.txt: Added.
        * accessibility/minimal-table-with-aria-is-data-table.html: Added.
        * platform/gtk/accessibility/minimal-table-with-aria-is-data-table-expected.txt: Added.

2017-05-03  Andy VanWagoner  <thetalecrafter@gmail.com>

        [INTL] Support dashed values in unicode locale extensions
        https://bugs.webkit.org/show_bug.cgi?id=171480

        Reviewed by JF Bastien.

        Added tests for calendar locale extensions that contain '-'.

        * js/intl-datetimeformat-expected.txt:
        * js/script-tests/intl-datetimeformat.js:

2017-05-03  Daniel Bates  <dabates@apple.com>

        Abandon the current load once the provisional loader detaches from the frame
        https://bugs.webkit.org/show_bug.cgi?id=171577
        <rdar://problem/31581227>

        Reviewed by Brent Fulgham.

        * fast/loader/inner-iframe-loads-data-url-into-parent-on-unload-crash-expected.txt: Added.
        * fast/loader/inner-iframe-loads-data-url-into-parent-on-unload-crash.html: Added.

2017-05-03  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of several tests.

        * platform/gtk/TestExpectations:

2017-05-03  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Rebaseline inspector resource size tests.

        Libsoup doesn't provide the required information to fill all those size metrics.

        * platform/gtk/http/tests/inspector/network/resource-sizes-memory-cache-expected.txt: Added.
        * platform/gtk/http/tests/inspector/network/resource-sizes-network-expected.txt: Added.

2017-05-02  Simon Fraser  <simon.fraser@apple.com>

        Dynamically added position:fixed element is in the wrong place
        https://bugs.webkit.org/show_bug.cgi?id=170280
        rdar://problem/31374008

        Reviewed by Tim Horton.

        * scrollingcoordinator/ios/nested-fixed-layer-positions-expected.html: Added.
        * scrollingcoordinator/ios/nested-fixed-layer-positions.html: Added.

2017-05-02  Ryan Haddad  <ryanhaddad@apple.com>

        Move flaky expectation for svg/animations/getCurrentTime-pause-unpause.html ios-wk1 to ios TestExpectations file.

        Unreviewed test gardening.

        * platform/ios-wk1/TestExpectations:
        * platform/ios/TestExpectations:

2017-05-02  Ryan Haddad  <ryanhaddad@apple.com>

        Mark imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/hkdf.worker.html as flaky on macOS.
        https://bugs.webkit.org/show_bug.cgi?id=170907

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-02  Zalan Bujtas  <zalan@apple.com>

        Defer AX cache update when text content changes until after layout is finished.
        https://bugs.webkit.org/show_bug.cgi?id=171429
        <rdar://problem/31885984>

        Reviewed by Simon Fraser.

        * accessibility/crash-while-adding-text-child-with-transform-expected.txt: Added.
        * accessibility/crash-while-adding-text-child-with-transform.html: Added.

2017-05-02  David Kilzer  <ddkilzer@apple.com>

        check-webkit-style should keep JavaScript test functions in sync
        <https://webkit.org/b/171424>

        Reviewed by Joseph Pecoraro.

        This change attempts to fix all whitespace issues in these two
        files (which are now identical and will be kept in sync by
        check-webkit-style):

            LayoutTests/http/tests/resources/js-test-pre.js
            LayoutTests/resources/js-test-pre.js

        It also syncs the implementation of shouldBe(), shouldNotBe(),
        shouldNotThrow() and shouldThrow() across the following files:

            JSTests/stress/resources/standalone-pre.js
            LayoutTests/http/tests/resources/js-test-pre.js
            LayoutTests/resources/js-test-pre.js
            LayoutTests/resources/js-test.js
            LayoutTests/resources/standalone-pre.js

        Only interesting (non-whitespace) changes are listed below.

        * http/tests/resources/js-test-pre.js: Copy from resources/js-test-pre.js.
        (shouldBe): Prefix 'exception' and 'quiet' variables with
        underscore.
        (shouldNotBe): Ditto.

        * resources/js-test-pre.js:
        (shouldBe): Prefix 'exception' and 'quiet' variables with
        underscore.
        (shouldNotBe): Ditto.

        * resources/js-test.js:
        (shouldBe): Prefix 'quiet' variable with underscore.  Use
        stringify() when printing '_bv' value.

        * resources/standalone-pre.js:
        (shouldBe): Prefix 'exception' and 'quiet' variables with
        underscore.
        (shouldNotBe): Ditto.

2017-05-02  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: Update implementation of aria-orientation
        https://bugs.webkit.org/show_bug.cgi?id=171166

        Reviewed by Chris Fleizach.

        Moved the mac aria-orientation.html test to the shared tests and add several
        new test cases to it. Update the orientation-related assertion in two tests
        to reflect the ARIA 1.1 behavior.

        * accessibility/aria-orientation-expected.txt: Renamed from LayoutTests/accessibility/mac/aria-orientation-expected.txt.
        * accessibility/aria-orientation.html: Renamed from LayoutTests/accessibility/mac/aria-orientation.html.
        * accessibility/mac/slider-supports-actions.html: Updated.
        * accessibility/gtk/combobox-descendants-orientation-crash-expected.txt: Updated.

2017-05-02  Myles C. Maxfield  <mmaxfield@apple.com>

        REGRESSION (r211382): Partial right-to-left text runs are painted at an offset (breaks Find indicators, Look Up, and custom ::selection style)
        https://bugs.webkit.org/show_bug.cgi?id=169517
        <rdar://problem/30652443>

        Reviewed by Dean Jackson.

        * fast/text/complex-text-selection-expected.html: Added.
        * fast/text/complex-text-selection.html: Added.
        * platform/ios/TestExpectations:

2017-05-02  Joseph Pecoraro  <pecoraro@apple.com>

        [Mac] WK1: http/tests/inspector/network/resource-sizes tests are failing

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:
        Skip these tests on WebKit1. They depend on the NSURLSession
        loading path which is not used in WebKit1.

2017-05-02  Chris Dumez  <cdumez@apple.com>

        [macOS] Flaky Crash under EventTarget::fireEventListeners on imported/blink/paint/deprecatedpaintlayer/non-self-painting-layer-overrides-visibility.html
        https://bugs.webkit.org/show_bug.cgi?id=171406
        <rdar://problem/30945281>

        Reviewed by Eric Carlson.

        Unskip test.

        * platform/mac/TestExpectations:

2017-05-02  Matt Lewis  <jlewis3@apple.com>

        Marked test svg/animations/animated-svg-image-removed-from-document-paused.html as flaky failure.
        https://bugs.webkit.org/show_bug.cgi?id=171559

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-02  Matt Lewis  <jlewis3@apple.com>

        Marked test imported/w3c/web-platform-tests/webrtc/rtcpeerconnection/setRemoteDescription.html as flaky failure.
        https://bugs.webkit.org/show_bug.cgi?id=170818

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-02  Myles C. Maxfield  <mmaxfield@apple.com>

        Font Loading API specifies font is loaded but sizing of font after load reports inconsistent values
        https://bugs.webkit.org/show_bug.cgi?id=168533

        Reviewed by Zalan Bujtas.

        * fast/text/font-loading-local-expected.txt: Added.
        * fast/text/font-loading-local.html: Added.
        * fast/text/web-font-load-fallback-during-loading.html:

2017-05-02  Youenn Fablet  <youenn@apple.com>

        Allow media stream based videos with sound autoplay if the page is already playing sound
        https://bugs.webkit.org/show_bug.cgi?id=171447

        Reviewed by Eric Carlson.

        * http/tests/media/autoplay-if-audio-is-playing-expected.txt: Added.
        * http/tests/media/autoplay-if-audio-is-playing.html: Added.
        * http/tests/media/resources/test-25fps.mp4: Added.

2017-05-02  Matt Lewis  <jlewis3@apple.com>

        Marked test http/tests/xmlhttprequest/methods-async.html as flaky timeout.
        https://bugs.webkit.org/show_bug.cgi?id=171530

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-01  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] ECDSA signing and verification support
        https://bugs.webkit.org/show_bug.cgi?id=171103

        Reviewed by Carlos Garcia Campos.

        * platform/gtk/TestExpectations: Enable the passing ECDSA tests under
        crypto/subtle/. The ECDSA tests that utilize PKCS #8 and SPKI remain
        skipped since support for that hasn't landed yet.

2017-05-01  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] HKDF bit derivation support
        https://bugs.webkit.org/show_bug.cgi?id=171074

        Reviewed by Michael Catanzaro.

        The crypto/subtle/hkdf-derive-bits-length-limits.html test is added, testing the
        corner-case length values for which the bit derivation operation must succeed or
        fail for any specified SHA hash algorithm. With HashLen as the algorithm's output
        length, the operation should reject for lengths of 0 or above 255 * HashLen * 8.
        The operation should resolve for lengths between the two limits, with testing
        performed on lengths of 8 (the minimum output length), HashLen * 8 (matching the
        output length of the hash algorithm), and 255 * HashLen * 8 (the maximum
        derivation output length).

        * crypto/subtle/hkdf-derive-bits-length-limits-expected.txt: Added.
        * crypto/subtle/hkdf-derive-bits-length-limits.html: Added.
        * platform/gtk/TestExpectations: Enable the HKDF tests under crypto/subtle/.

2017-05-01  Zan Dobersek  <zdobersek@igalia.com>

        [GCrypt] ECDH bit derivation support
        https://bugs.webkit.org/show_bug.cgi?id=171070

        Reviewed by Michael Catanzaro.

        The crypto/subtle/ecdh-derive-bits-length-limits.html test is added, testing the
        corner-case length values for which the bit derivation operation must succeed or
        fail. When specifying 0 as the length, the returned result must match the EC key
        size in length. 8, tested as the minimum non-zero value, and the key size for
        each key must also correctly resolve and return a resulting ArrayBuffer whose
        length in bytes must match the requested length. Derivations for byte-aligned
        values should start rejecting immediately for length values that are bigger than
        the EC key's length.

        * crypto/subtle/ecdh-derive-bits-length-limits-expected.txt: Added.
        * crypto/subtle/ecdh-derive-bits-length-limits.html: Added.
        * platform/gtk/TestExpectations: Enable Web Crypto ECDH tests under crypto/subtle/
        that are passing now that the proper implementation has been added. The remaining
        failing ECDH tests use PKCS #8 and SPKI key import/export formats, which are not
        supported yet.

2017-05-01  Saam Barati  <sbarati@apple.com>

        REGRESSION: LayoutTest workers/wasm-hashset-many.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=171449

        Unreviewed.

        * platform/win/TestExpectations: Skip Wasm tests on Windows.
        * workers/wasm-hashset-many-expected.txt:
        * workers/wasm-hashset/many-test.js: Make wasm-hashset-many run fewer workers.

2017-05-01  Youenn Fablet  <youenn@apple.com>

        Ensure RealtimeOutgoingVideoSource sends a black frame when its related source is muted
        https://bugs.webkit.org/show_bug.cgi?id=171497

        Reviewed by Eric Carlson.

        * webrtc/video-mute.html: Updating the test to make debugging clearer.

2017-05-01  Matt Lewis  <jlewis3@apple.com>

        Marked LayoutTest/http/tests/preload/not_delaying_window_onload_before_discovery.html as flaky failure.
        https://bugs.webkit.org/show_bug.cgi?id=171528

        Unreviewed test Gardening.

        * platform/ios-wk2/TestExpectations:

2017-05-01  Timothy Horton  <timothy_horton@apple.com>

        Expose viewport-fit instead of clip-to-safe-area
        https://bugs.webkit.org/show_bug.cgi?id=171503
        <rdar://problem/31918249>

        Reviewed by Simon Fraser.

        * TestExpectations:
        * fast/css/variables/constants/ios/safe-area-inset-set-expected.html:
        * fast/css/variables/constants/ios/safe-area-inset-set.html:
        * fast/viewport/ios/viewport-fit-auto-expected.txt: Added.
        * fast/viewport/ios/viewport-fit-auto.html: Added.
        * fast/viewport/ios/viewport-fit-contain-expected.txt: Added.
        * fast/viewport/ios/viewport-fit-contain.html: Added.
        * fast/viewport/ios/viewport-fit-cover-expected.txt: Added.
        * fast/viewport/ios/viewport-fit-cover.html: Added.
        * tiled-drawing/ios/viewport-clip-to-safe-area-no-gets-margin-tiles-expected.txt: Removed.
        * tiled-drawing/ios/viewport-clip-to-safe-area-no-gets-margin-tiles.html: Removed.
        * tiled-drawing/ios/viewport-clip-to-safe-area-yes-gets-no-margin-tiles-expected.txt: Removed.
        * tiled-drawing/ios/viewport-clip-to-safe-area-yes-gets-no-margin-tiles.html: Removed.
        Remove clip-to-safe-area tests and add some viewport-fit tests. Also, adjust
        safe-area-inset-set to use the new UIScriptController setSafeAreaInset method.

2017-05-01  Chris Dumez  <cdumez@apple.com>

        Documents created using DOMParser.parseFromString should inherit their context document's origin / URL
        https://bugs.webkit.org/show_bug.cgi?id=171499

        Reviewed by Sam Weinig.

        Add layout test coverage. I have verified that this test passes in both Firefox and Chrome.

        * fast/dom/domparser-parsefromstring-origin-expected.txt: Added.
        * fast/dom/domparser-parsefromstring-origin.html: Added.

2017-05-01  Ryan Haddad  <ryanhaddad@apple.com>

        Mark inspector/debugger/tail-recursion.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=168387

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-05-01  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline two fast/visual-viewport tests for iOS.

        Unreviewed test gardening.

        * platform/ios/fast/visual-viewport/zoomed-fixed-expected.txt:
        * platform/ios/fast/visual-viewport/zoomed-fixed-header-and-footer-expected.txt:

2017-05-01  Joseph Pecoraro  <pecoraro@apple.com>

        [GTK] Two test started to fail after due to unhandled promise rejection reported after r215916
        https://bugs.webkit.org/show_bug.cgi?id=171491

        Unreviewed test gardening.

        * js/promises-tests/promises-tests-2-3-3.html:
        Silence unhandled expectation messages for this test.

        * media/video-fullscreen-restriction-removed-expected.txt:
        Rebaseline expected results with unhandled expectation message.

        * platform/gtk/TestExpectations:

2017-05-01  Chris Fleizach  <cfleizach@apple.com>

        AX: Support time@datetime for verbosity clarification of dates, times, and durations
        https://bugs.webkit.org/show_bug.cgi?id=171498
        <rdar://problem/12985540>

        Reviewed by Joanmarie Diggs.

        * accessibility/datetime-attribute.html: Added.
        * accessibility/roles-computedRoleString-expected.txt:
        * platform/gtk/accessibility/datetime-attribute-expected.txt: Added.
        * platform/gtk/accessibility/roles-exposed-expected.txt:
        * platform/mac/accessibility/datetime-attribute-expected.txt: Added.
        * platform/mac/accessibility/roles-computedRoleString-expected.txt:
        * platform/mac/accessibility/roles-exposed-expected.txt:

2017-05-01  Matt Lewis  <jlewis3@apple.com>

        Marked fast/mediastream/getUserMedia-webaudio.html as flaky timeout.
        https://bugs.webkit.org/show_bug.cgi?id=170960

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-05-01  Joseph Pecoraro  <pecoraro@apple.com>

        RejectedPromiseTracker should produce better callstacks and avoid capturing callstacks unless there is a debugger/inspector
        https://bugs.webkit.org/show_bug.cgi?id=171416
        <rdar://problem/31899425>

        Reviewed by Saam Barati and Brian Burg.

        * inspector/console/message-stack-trace-expected.txt: Added.
        * inspector/console/message-stack-trace.html: Added.
        Test console stack traces from various places where console messages
        are generated and the stacks are important.

        * inspector/console/resources/log-console-stack-trace.js: Added.
        (TestPage.registerInitializer.logCallFrame):
        (TestPage.registerInitializer.window.logConsoleMessageStackTrace):
        Like the logger for Debugger StackTrace but for Console StackTrace.

        * inspector/debugger/break-on-exception-throw-in-promise-expected.txt:
        * inspector/debugger/break-on-uncaught-exception-throw-in-promise-expected.txt:
        * fast/mediastream/MediaStream-MediaElement-setObject-null-expected.txt:
        * http/tests/security/video-cross-origin-caching-expected.txt:
        * js/dom/unhandled-promise-rejection-bindings-type-error-expected.txt:
        * js/dom/unhandled-promise-rejection-console-report-expected.txt:
        * js/promises-tests/promises-tests-2-2-6-expected.txt:
        * streams/reference-implementation/pipe-to-options-expected.txt:
        * streams/reference-implementation/readable-stream-templated-expected.txt:
        * streams/reference-implementation/writable-stream-abort-expected.txt:
        * streams/reference-implementation/writable-stream-expected.txt:
        * webrtc/libwebrtc/release-while-creating-offer-expected.txt:
        * webrtc/libwebrtc/release-while-setting-local-description-expected.txt:
        Rebaseline results. Better stack trace for errors includes correct line numbers.
        Explicit rejections with a value do not include backtraces without a debugger.

2017-05-01  Joseph Pecoraro  <pecoraro@apple.com>

        LayoutTest/imported/w3c/web-platform-tests/resource-timing/rt-revalidate-requests.html is a flaky failure.
        https://bugs.webkit.org/show_bug.cgi?id=171511

        Unreviewed test gardening.

        * TestExpectations:

2017-05-01  Ryan Haddad  <ryanhaddad@apple.com>

        Update TestExpectations for http/tests/fetch/fetch-in-worker-crash.html.

        Unreviewed test gardening.

        * TestExpectations:

2017-05-01  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] Expose values of aria-rowcount, aria-colcount, aria-rowindex, aria-colindex, aria-rowspan, and aria-colspan as object attributes
        https://bugs.webkit.org/show_bug.cgi?id=171496

        Reviewed by Chris Fleizach.

        * platform/gtk/TestExpectations: Unskip accessibility/aria-table-attributes.html

2017-05-01  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline fast/visual-viewport/rtl-zoomed-rects.html for mac-wk1.
        https://bugs.webkit.org/show_bug.cgi?id=171500

        Unreviewed test gardening.

        * platform/mac-wk1/fast/visual-viewport/rtl-zoomed-rects-expected.txt:

2017-05-01  Matt Lewis  <jlewis3@apple.com>

        Rebaselined fast/visual-viewport/ tests.
        https://bugs.webkit.org/show_bug.cgi?id=171500

        Unreviewed test gardening.

        * platform/ios-wk2/fast/visual-viewport/nonzoomed-rects-expected.txt:
        * platform/ios-wk2/fast/visual-viewport/rtl-nonzoomed-rects-expected.txt:
        * platform/ios-wk2/fast/visual-viewport/rtl-zoomed-rects-expected.txt:
        * platform/ios-wk2/fast/visual-viewport/rubberbanding-viewport-rects-expected.txt:
        * platform/ios-wk2/fast/visual-viewport/rubberbanding-viewport-rects-extended-background-expected.txt:
        * platform/ios-wk2/fast/visual-viewport/rubberbanding-viewport-rects-header-footer-expected.txt:
        * platform/ios-wk2/fast/visual-viewport/zoomed-fixed-expected.txt: Added.
        * platform/ios-wk2/fast/visual-viewport/zoomed-fixed-header-and-footer-expected.txt: Added.
        * platform/ios-wk2/fast/visual-viewport/zoomed-rects-expected.txt:

2017-05-01  Chris Dumez  <cdumez@apple.com>

        Do not dispatch SVG load event in frameless documents
        https://bugs.webkit.org/show_bug.cgi?id=171505
        <rdar://problem/31799776>

        Reviewed by Andreas Kling.

        Add layout test coverage. I have verified that this test passes on both Firefox and Chrome.

        * fast/dom/domparser-parsefromstring-svg-load-event-expected.txt: Added.
        * fast/dom/domparser-parsefromstring-svg-load-event.html: Added.

2017-05-01  Ryan Haddad  <ryanhaddad@apple.com>

        Skip editing/execCommand/show-modal-dialog-during-execCommand.html on mac-wk1.
        https://bugs.webkit.org/show_bug.cgi?id=171501

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-05-01  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline js/dom/global-constructors-attributes.html  after r215956.

        Unreviewed test gardening.

        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-05-01  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: [GTK] Add support to query for aria-current
        https://bugs.webkit.org/show_bug.cgi?id=149016

        Reviewed by Chris Fleizach.

        * platform/gtk/TestExpectations: Unskip now-passing test.

2017-05-01  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Rebaseline giantRowspan tests after r215914.

        * platform/gtk/fast/table/giantRowspan-expected.txt:
        * platform/gtk/fast/table/giantRowspan2-expected.txt:

2017-05-01  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of several test.

        * platform/gtk/TestExpectations:

2017-05-01  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Rebaseline several WPT fetch API tests.

        * platform/gtk/imported/w3c/web-platform-tests/fetch/api/basic/request-headers.any-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/fetch/api/basic/request-headers.any.worker-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/fetch/api/basic/scheme-about.any-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any.worker-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/fetch/api/cors/cors-no-preflight.any-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/fetch/api/cors/cors-no-preflight.any.worker-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any-expected.txt: Added.
        * platform/gtk/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any.worker-expected.txt: Added.

2017-05-01  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: AccessibilityTable::ariaRowCount() and ariaColumnCount() should not return -1 unless that is the author-provided value
        https://bugs.webkit.org/show_bug.cgi?id=171475

        Reviewed by Chris Fleizach.

        * accessibility/table-detection-expected.txt: Updated.
        * accessibility/table-with-rules-expected.txt: Updated.

2017-05-01  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of several test.

        * platform/gtk/TestExpectations:

2017-05-01  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: Implement support for ARIA "figure" and "term" roles; update AXRoleDescription mapping for "feed" role
        https://bugs.webkit.org/show_bug.cgi?id=171183

        Reviewed by Chris Fleizach.

        New test cases added and expectations updated.

        * accessibility/gtk/xml-roles-exposed-expected.txt:
        * accessibility/gtk/xml-roles-exposed.html:
        * accessibility/roles-computedRoleString.html:
        * accessibility/roles-exposed.html:
        * platform/gtk/accessibility/roles-exposed-expected.txt:
        * platform/mac/accessibility/roles-computedRoleString-expected.txt:
        * platform/mac/accessibility/roles-exposed-expected.txt:

2017-04-30  Zalan Bujtas  <zalan@apple.com>

        Initialize a new layout state while bailing out of simple line layout only when needed.
        https://bugs.webkit.org/show_bug.cgi?id=171481
        <rdar://problem/31906382>

        Reviewed by Antti Koivisto.

        * fast/multicol/simple-line-layout-switch-to-normal-layout-while-inside-layout-expected.txt: Added.
        * fast/multicol/simple-line-layout-switch-to-normal-layout-while-inside-layout.html: Added.

2017-04-30  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] Implement support for aria-autocomplete
        https://bugs.webkit.org/show_bug.cgi?id=171167

        Reviewed by Chris Fleizach.

        * accessibility/gtk/aria-autocomplete-expected.txt: Added.
        * accessibility/gtk/aria-autocomplete.html: Added.

2017-04-30  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] ARIA treegrid role should be exposed as ATK_ROLE_TREE_TABLE; not ATK_ROLE_TABLE
        https://bugs.webkit.org/show_bug.cgi?id=171170

        Reviewed by Chris Fleizach.

        Add interface-table.html to verify that all roles which have tabular functionality
        implement AtkTable. Update other tests to reflect that the ARIA treegrid role maps
        to our internal TreeGridRole AccessibilityRole.

        * accessibility/gtk/interface-table-cell-expected.txt: Updated.
        * accessibility/gtk/interface-table-expected.txt: Added.
        * accessibility/gtk/interface-table.html: Added.
        * accessibility/roles-computedRoleString.html: Updated.
        * platform/gtk/accessibility/aria-selected-expected.txt: Updated.
        * platform/gtk/accessibility/roles-exposed-expected.txt: Updated.
        * platform/mac/accessibility/roles-computedRoleString-expected.txt: Updated.

2017-04-30  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] Emit object:state-changed:busy event when aria-busy value changes
        https://bugs.webkit.org/show_bug.cgi?id=171181

        Reviewed by Chris Fleizach.

        New test. Also update the expectations for menu-list-unfocused-notifications.html
        because the addition of the handler for AXElementBusyChanged results in that
        notification being output in the test results.

        * accessibility/gtk/aria-busy-changed-notification-expected.txt: Added.
        * accessibility/gtk/aria-busy-changed-notification.html: Added.
        * accessibility/gtk/menu-list-unfocused-notifications-expected.txt: Updated.

2017-04-30  Oleksandr Skachkov  <gskachkov@gmail.com>

        [ES6]. Implement Annex B.3.3 function hoisting rules for eval
        https://bugs.webkit.org/show_bug.cgi?id=163208

        Reviewed by Saam Barati.

        * inspector/runtime/evaluate-CommandLineAPI-expected.txt:
        * inspector/runtime/evaluate-CommandLineAPI.html:
        * js/parser-syntax-check-expected.txt:
        * js/script-tests/parser-syntax-check.js:

2017-04-29  Oleksandr Skachkov  <gskachkov@gmail.com>

        Deep nesting is leading to ReferenceError for hoisted function
        https://bugs.webkit.org/show_bug.cgi?id=171456

        Reviewed by Yusuke Suzuki.

        * js/function-declaration-statement-expected.txt:
        * js/script-tests/function-declaration-statement.js:
        (deepNesting.foo):
        (deepNesting):
        (deepNestingForFunctionDeclaration.foo):
        (deepNestingForFunctionDeclaration):
        (eval.deepNestingInEval.foo):
        (eval.deepNestingInEval):
        (eval.deepNestingForFunctionDeclarationInEval.foo):
        (eval.deepNestingForFunctionDeclarationInEval):

2017-04-28  Zalan Bujtas  <zalan@apple.com>

        iBooks text can overlap, sometimes columns are shifted splitting words.
        https://bugs.webkit.org/show_bug.cgi?id=171472
        <rdar://problem/31096037>

        Reviewed by Antti Koivisto.

        * fast/text/simple-line-layout-glyph-overflows-line-expected.html: Added.
        * fast/text/simple-line-layout-glyph-overflows-line.html: Added.

2017-04-28  Per Arne Vollan  <pvollan@apple.com>

        Crash under WebCore::AccessibilityRenderObject::handleAriaExpandedChanged().
        https://bugs.webkit.org/show_bug.cgi?id=171427

        Reviewed by Brent Fulgham.

        * accessibility/accessibility-crash-setattribute-expected.txt: Added.
        * accessibility/accessibility-crash-setattribute.html: Added.

2017-04-28  Wenson Hsieh  <wenson_hsieh@apple.com>

        Unreviewed test gardening (Mac WK1)

        Mark a LayoutTest as PASS on Mac WK1. This test is currently skipped globally,
        but was meant to be enabled for WK1 on Mac. Followup to r213897.

        * platform/mac-wk1/TestExpectations:

2017-04-28  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: ARIA "region" role which lacks an accessible name should not be treated as a landmark
        https://bugs.webkit.org/show_bug.cgi?id=171180

        Reviewed by Chris Fleizach.

        Add new test cases to several tests so that we have coverage for both named and
        unnamed regions, which now have different mappings. In aria-namefrom-author.html,
        the region role was replaced with the table role because the test requires elements
        which have mapped ARIA roles and lack an author-provided name. A region which lacks
        an author-provided name is no longer mapped as an ARIA role as per the spec. Table
        was introduced in ARIA 1.1 and serves the same purpose with respect to what is
        being tested.

        * accessibility/aria-namefrom-author.html:
        * accessibility/gtk/xml-roles-exposed-expected.txt:
        * accessibility/gtk/xml-roles-exposed.html:
        * accessibility/mac/aria-grouping-roles.html:
        * accessibility/roles-computedRoleString.html:
        * accessibility/roles-exposed.html:
        * platform/gtk/accessibility/roles-exposed-expected.txt:
        * platform/mac/accessibility/roles-computedRoleString-expected.txt:
        * platform/mac/accessibility/roles-exposed-expected.txt:

2017-04-28  Joseph Pecoraro  <pecoraro@apple.com>

        LayoutTests/js/dom/Promise-static-all/race.html are flakey - Unhandled Promise Rejection messages
        https://bugs.webkit.org/show_bug.cgi?id=171445

        Unreviewed test gardening.

        * js/dom/Promise-static-all.html:
        Fix an accidentally commented out line.

2017-04-28  Matt Lewis  <jlewis3@apple.com>

        Marked media/track/track-in-band-style.html as flaky timeout.
        https://bugs.webkit.org/show_bug.cgi?id=171465

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-28  Dean Jackson  <dino@apple.com>

        App crashing: Dispatch queue: com.apple.root.user-interactive-qos / vBoxConvolve / WebCore::FEGaussianBlur::platformApplySoftware()
        https://bugs.webkit.org/show_bug.cgi?id=171461
        <rdar://problem/30534722>

        Reviewed by Eric Carlson.

        Test a bunch of blurs a frame at a time.

        * css3/filters/blur-various-radii-expected.html: Added.
        * css3/filters/blur-various-radii.html: Added.

2017-04-28  Chris Dumez  <cdumez@apple.com>

        Stop using legacy ClientRect / ClientRectList in Internals
        https://bugs.webkit.org/show_bug.cgi?id=171412

        Reviewed by Simon Fraser.

        Rebaseline existing tests as DOMRect has more properties than ClientRect.

        * fast/visual-viewport/nonzoomed-rects-expected.txt:
        * fast/visual-viewport/rtl-nonzoomed-rects-expected.txt:
        * fast/visual-viewport/rtl-zoomed-rects-expected.txt:
        * fast/visual-viewport/rubberbanding-viewport-rects-expected.txt:
        * fast/visual-viewport/rubberbanding-viewport-rects-extended-background-expected.txt:
        * fast/visual-viewport/rubberbanding-viewport-rects-header-footer-expected.txt:
        * fast/visual-viewport/zoomed-fixed-expected.txt:
        * fast/visual-viewport/zoomed-fixed-header-and-footer-expected.txt:
        * fast/visual-viewport/zoomed-rects-expected.txt:
        * inspector/dom/hideHighlight-expected.txt:
        * inspector/dom/highlightQuad-expected.txt:
        * inspector/dom/highlightRect-expected.txt:

2017-04-28  Jeremy Jones  <jeremyj@apple.com>

        ARGUMENT BAD: time, time >= 0
        https://bugs.webkit.org/show_bug.cgi?id=164336
        rdar://problem/29314891

        Reviewed by Eric Carlson.

        Remove workaround that affected other tests.

        * media/modern-media-controls/pip-support/pip-support-click.html:

2017-04-28  Chris Dumez  <cdumez@apple.com>

        Range.getClientRects() / getBoundingClientRect() should return DOMRect types
        https://bugs.webkit.org/show_bug.cgi?id=171393

        Reviewed by Simon Fraser.

        Add layout test coverage.

        * fast/dom/Range/getBoundingClientRect-getClientRects-return-type-expected.txt: Added.
        * fast/dom/Range/getBoundingClientRect-getClientRects-return-type.html: Added.

2017-04-28  Joseph Pecoraro  <pecoraro@apple.com>

        LayoutTests/js/dom/Promise-static-all/race.html are flakey - Unhandled Promise Rejection messages
        https://bugs.webkit.org/show_bug.cgi?id=171445

        Reviewed by Saam Barati.

        * js/dom/Promise-static-all.html:
        * js/dom/Promise-static-race.html:
        Silence the console messages for unhandled rejections in this test.
        There are unhandled rejections and messages sometimes appear
        depending on the order of events on the page. The messages are not
        important for this test so just mute them.

2017-04-28  Chris Dumez  <cdumez@apple.com>

        Unreviewed, skip imported/w3c/web-platform-tests/html/semantics/tabular-data/processing-model-1/span-limits.html in Debug builds

        This test is slow.

        * TestExpectations:

2017-04-28  Ryan Haddad  <ryanhaddad@apple.com>

        Mark imported/w3c/web-platform-tests/webrtc/rtcpeerconnection/rtcpeerconnection-idl.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171094

        Unreviewed test gardening.

        * TestExpectations:

2017-04-28  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] aria-modal="true" should be exposed via ATK_STATE_MODAL
        https://bugs.webkit.org/show_bug.cgi?id=171188

        Reviewed by Chris Fleizach.

        * accessibility/gtk/aria-modal-state-exposed-expected.txt: Added.
        * accessibility/gtk/aria-modal-state-exposed.html: Added.

2017-04-28  Matt Lewis  <jlewis3@apple.com>

        Rebaselining test after r215916.
        https://bugs.webkit.org/show_bug.cgi?id=171438

        Unreviewed test gardening.

        * js/dom/global-constructors-attributes-dedicated-worker-expected.txt:
        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-04-28  Eric Carlson  <eric.carlson@apple.com>

        Implement ondevicechange
        https://bugs.webkit.org/show_bug.cgi?id=169872
        <rdar://problem/28945035>

        Reviewed by Jer Noble.

        * fast/mediastream/device-change-event-expected.txt: Added.
        * fast/mediastream/device-change-event.html: Added.

2017-04-28  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: Implement aria-value support for focusable separators
        https://bugs.webkit.org/show_bug.cgi?id=171169

        Reviewed by Chris Fleizach.

        * accessibility/separator-values-expected.txt: Added.
        * accessibility/separator-values.html: Added.

2017-04-28  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] GridCellRole should implement AtkTableCell (regression?)
        https://bugs.webkit.org/show_bug.cgi?id=171179

        Reviewed by Chris Fleizach.

        * accessibility/gtk/interface-table-cell-expected.txt: Added.
        * accessibility/gtk/interface-table-cell.html: Added.

2017-04-28  Miguel Gomez  <magomez@igalia.com>

        REGRESSION(r215211): [GTK] Several webgl related tests are failing
        https://bugs.webkit.org/show_bug.cgi?id=170730

        Reviewed by Said Abou-Hallawa.

        Adjust test expectations for the tests that were failing. They must pass now.

        * platform/gtk/TestExpectations:

2017-04-27  Andy VanWagoner  <thetalecrafter@gmail.com>

        [INTL] Implement the caseFirst option for Intl.Collator
        https://bugs.webkit.org/show_bug.cgi?id=158188

        Reviewed by Geoffrey Garen.

        Updates the Intl.Collator tests to check caseFirst support.
        The caseFirst option or unicode locale extension lets the user explicitly
        set if lower or upper case characters should be first in order.

        * js/intl-collator-expected.txt:
        * js/script-tests/intl-collator.js:
        (testCollator):

2017-04-27  Joseph Pecoraro  <pecoraro@apple.com>

        Support for promise rejection events (unhandledrejection)
        https://bugs.webkit.org/show_bug.cgi?id=150358
        <rdar://problem/28441651>

        Reviewed by Saam Barati.

        Patch by Joseph Pecoraro and Yusuke Suzuki.

        * js/dom/unhandled-promise-rejection-basic-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-basic.html: Added.
        * js/dom/unhandled-promise-rejection-bindings-type-error-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-bindings-type-error.html: Added.
        * js/dom/unhandled-promise-rejection-console-no-report-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-console-no-report.html: Added.
        * js/dom/unhandled-promise-rejection-console-report-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-console-report.html: Added.
        * js/dom/unhandled-promise-rejection-handle-during-event-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-handle-during-event.html: Added.
        * js/dom/unhandled-promise-rejection-handle-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-handle-in-handler-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-handle-in-handler.html: Added.
        * js/dom/unhandled-promise-rejection-handle.html: Added.
        * js/dom/unhandled-promise-rejection-order-expected.txt: Added.
        * js/dom/unhandled-promise-rejection-order.html: Added.
        New tests specific to the `onunhandledrejection` and `onrejectionhandled` events.

        * resources/testharnessreport.js:
        (self.testRunner.add_completion_callback.sanitize):
        (self.testRunner.add_completion_callback):
        Report results immediately and then finish the test after a turn. This way
        if the test ends with a pass, but may get unhandled rejections after
        completing which should not make the test appear as if it failed. Some tests
        have unhandled promise rejections but are expected to pass. Likewise some
        tests perform cleanup in their own completion callbacks, which happen after
        this initial completion callback, and we want to report results after all
        the work is done as it may eliminate non-deterministic debug test output.

        * TestExpectations:
        Mark some tests as flakey that have sometimes have unhandled promise rejections.
        These tests are all various imported tests that use the testharness.

        * fast/mediastream/MediaStream-MediaElement-setObject-null-expected.txt:
        * http/tests/security/video-cross-origin-caching-expected.txt:
        * inspector/debugger/break-on-exception-throw-in-promise-expected.txt:
        * inspector/debugger/break-on-uncaught-exception-throw-in-promise-expected.txt:
        * inspector/worker/resources-in-worker-expected.txt:
        * js/dom/dom-static-property-for-in-iteration-expected.txt:
        * js/dom/global-constructors-attributes-dedicated-worker-expected.txt:
        * js/promises-tests/promises-tests-2-2-6-expected.txt:
        * platform/mac/inspector/model/remote-object-expected.txt:
        * webrtc/libwebrtc/release-while-creating-offer-expected.txt:
        * webrtc/libwebrtc/release-while-setting-local-description-expected.txt:
        Update tests with unhandled promise rejection messages.

        * media/W3C/audio/events/event_pause_manual.html:
        * media/audio-playback-restriction-play-expected.txt:
        * media/audio-playback-restriction-play.html:
        * media/click-volume-bar-not-pausing.html:
        * media/remote-control-command-is-user-gesture-expected.txt:
        * media/remote-control-command-is-user-gesture.html:
        * media/track/track-mode.html:
        * media/video-autoplay-allowed-but-fullscreen-required.html:
        * media/video-display-none-crash.html:
        * media/video-main-content-deny-display-none.html:
        * media/video-main-content-deny-not-in-dom.html:
        * media/video-main-content-deny-not-visible.html:
        * media/video-main-content-deny-obscured.html:
        * media/video-main-content-deny-too-small.html:
        * media/video-multiple-concurrent-playback-expected.txt:
        * media/video-play-audio-require-user-gesture-expected.txt:
        * media/video-play-audio-require-user-gesture.html:
        * media/video-play-pause-events-expected.txt:
        * media/video-play-pause-events.html:
        * media/video-play-pause-exception-expected.txt:
        * media/video-play-pause-exception.html:
        * media/video-play-require-user-gesture-expected.txt:
        * media/video-play-require-user-gesture.html:
        * media/video-preload-expected.txt:
        * media/video-preload.html:
        * media/video-test.js:
        (handlePromise.handle):
        Snuff many possible unhandled promise rejections in media via media.play().

        * streams/reference-implementation/pipe-to-expected.txt:
        * streams/reference-implementation/pipe-to-options-expected.txt:
        * streams/reference-implementation/readable-stream-templated-expected.txt:
        * streams/reference-implementation/writable-stream-abort-expected.txt:
        * streams/reference-implementation/writable-stream-expected.txt:
        These stream tests are out of date and produce unhandled rejections.

        * streams/shadowing-Promise.html:
        Update non-imported tests to prevent unhandled rejection messages.

2017-04-27  Chris Dumez  <cdumez@apple.com>

        Align colspan/rowspan limits with the latest HTML specification
        https://bugs.webkit.org/show_bug.cgi?id=171322

        Reviewed by Darin Adler.

        Rebaseline a couple of rowspan tests now that our max limit has changed.

        * fast/table/giantRowspan2-expected.txt:
        * platform/ios/fast/table/giantRowspan-expected.txt:
        * platform/ios/imported/w3c/web-platform-tests/html/dom/reflection-embedded-expected.txt:
        * platform/mac/fast/table/giantRowspan-expected.txt:

2017-04-27  Matt Lewis  <jlewis3@apple.com>

        Mark fast/mediacapturefromelement/CanvasCaptureMediaStream-2d-events.html as a flaky failure.
        https://bugs.webkit.org/show_bug.cgi?id=170835

        Unreviewed test gardening.

        * TestExpectations:

2017-04-27  Matt Lewis  <jlewis3@apple.com>

        Mark imported/blink/paint/deprecatedpaintlayer/non-self-painting-layer-overrides-visibility.html as a flaky crash.
        https://bugs.webkit.org/show_bug.cgi?id=171406

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-27  Ryan Haddad  <ryanhaddad@apple.com>

        Add missing expected file for fast/inline/simple-line-layout-16bit-content.html.
        https://bugs.webkit.org/show_bug.cgi?id=171379

        Unreviewed test gardening.

        * fast/inline/simple-line-layout-16bit-content-expected-mismatch.html: Added.

2017-04-27  David Kilzer  <ddkilzer@apple.com>

        Enhance shouldBe()/shouldNotBe() to accept anonymous function arguments
        <https://webkit.org/b/171362>
        <rdar://problem/31867686>

        Reviewed by Joseph Pecoraro.

        This change makes it possible to pass either the first or second
        argument (or both) as anonymous functions into shouldBe() and
        shouldNotBe() to make it easy to capture local variables when
        writing tests.  This is similar to the change in r202609 for Bug
        159232 for shouldThrow() and shouldNotThrow().

        Note that shouldBe()/shouldNotBe() from the following files were
        NOT updated since they were imported from other projects and did
        share the full WebKit history of resources/js-test-pre.js:

            http/tests/webgl/1.0.2/resources/webgl_test_files/resources/js-test-pre.js
            js/mozilla/resources/js-test-pre.js
            webgl/1.0.2/resources/webgl_test_files/resources/js-test-pre.js
            webgl/1.0.3/resources/webgl_test_files/resources/js-test-pre.js

        However, these files WERE brought up-to-date with the ability to
        pass anonymous functions into shouldBe()/shouldNotBe() for this
        bug, and shouldThrow()/shouldNotThrow() which should have
        originally been fixed with Bug 159232:

            http/tests/resources/js-test-pre.js
            resources/standalone-pre.js

        * css3/scroll-snap/resources/iframe-content.html: Drive-by fix
        to debug message for copy-paste error.  Found by searching
        LayoutTests directory for "expects string arguments".

        * fast/canvas/webgl/array-unit-tests-expected.txt: Update test
        results.
        * fast/canvas/webgl/array-unit-tests.html: Fix warning by making
        second argument to shouldBe() a string.

        * fast/css/script-tests/image-set-parsing.js:
        (testImageSetRule): Remove comment by changing second argument
        to shouldBe() into an anonymous function.

        * http/tests/resources/js-test-pre.js:
        (evalAndLog):
        (evalAndLogResult):
        (shouldBe):
        (shouldNotBe):
        (shouldEvaluateTo):
        - Made a full copy of resources/js-test-pre.js to bring this up
          to speed.  Needs a checker written for it to keep them in sync.
        * http/tests/security/xssAuditor/block-does-not-leak-location-expected.txt:
        * http/tests/security/xssAuditor/block-does-not-leak-referrer-expected.txt:
        - Update line numbers after updating http/tests/resources/js-test-pre.js.

        * js/function-declarations-in-switch-statement-expected.txt:
        - Update results after fixing warnings.
        * js/script-tests/function-declarations-in-switch-statement.js:
        - Fix warnings by passing in strings to shouldBe().

        * js/script-tests/stack-unwinding.js:
        - Update results after fixing warnings.
        * js/stack-unwinding-expected.txt:
        - Fix warnings by passing in strings to shouldBe().

        * resources/js-test-pre.js:
        (shouldBe):
        (shouldNotBe):
        * resources/js-test.js:
        (shouldBe):
        (shouldNotBe):
        - Update shouldBe()/shouldNotBe() to accept anonymous function
          arguments.

        * resources/standalone-pre.js:
        (shouldBe):
        (shouldNotBe):
        (shouldNotThrow):
        (shouldThrow):
        - Update shouldBe()/shouldNotBe() to accept anonymous function
          arguments.
        - Also fix shouldThrow()/shouldNotThrow() to accept anonymous
          function arguments (which were missed in r202609 for Bug
          159232).

2017-04-27  Chris Dumez  <cdumez@apple.com>

        Element.getBoundingClientRect() / getClientRects() should return a DOMRect types
        https://bugs.webkit.org/show_bug.cgi?id=171226

        Reviewed by Simon Fraser.

        Update existing tests to reflect behavior change.

        * TestExpectations:
        * css3/flexbox/align-absolute-child-expected.txt:
        * fast/css/ClientRect-attributes-prototype-expected.txt: Removed.
        * fast/css/ClientRect-attributes-prototype.html: Removed.
        * fast/css/ClientRect-serialization-expected.txt: Removed.
        * fast/css/ClientRect-serialization.html: Removed.
        * fast/css/DOMRect-attributes-prototype-expected.txt: Added.
        * fast/css/DOMRect-attributes-prototype.html: Added.
        * fast/css/DOMRect-serialization-expected.txt: Added.
        * fast/css/DOMRect-serialization.html: Added.
        * fast/dom/Element/getClientRects-return-type-expected.txt: Added.
        * fast/dom/Element/getClientRects-return-type.html: Added.
        * fast/dom/collection-iterators-expected.txt:
        * fast/dom/collection-iterators.html:
        * fast/visual-viewport/zoomed-fixed-expected.txt:
        * fast/visual-viewport/zoomed-fixed-header-and-footer-expected.txt:
        * fast/zooming/client-rect-in-fixed-zoomed-expected.txt:
        * fast/zooming/client-rect-in-fixed-zoomed.html:
        * js/resources/JSON-stringify.js:

2017-04-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/fullscreen-button/fullscreen-button.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171391

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/security/contentSecurityPolicy/source-list-parsing-05.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171389

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-04-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/xmlhttprequest/workers/methods.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170181

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-04-27  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: Expose elements with the ARIA "feed" role
        https://bugs.webkit.org/show_bug.cgi?id=171184

        Reviewed by Chris Fleizach.

        Add "feed" role to roles-exposed.html, xml-roles-exposed.html, and
        roles-computedRoleString.html. Update expectations accordingly.

        * accessibility/gtk/xml-roles-exposed-expected.txt:
        * accessibility/gtk/xml-roles-exposed.html:
        * accessibility/roles-computedRoleString.html:
        * accessibility/roles-exposed.html:
        * platform/gtk/accessibility/roles-exposed-expected.txt:
        * platform/mac/accessibility/roles-computedRoleString-expected.txt:
        * platform/mac/accessibility/roles-exposed-expected.txt:

2017-04-27  Myles C. Maxfield  <mmaxfield@apple.com>

        REGRESSION(r214572): Update fast/text/variations/advances.html to understand normalized variation widths
        https://bugs.webkit.org/show_bug.cgi?id=171356
        <rdar://problem/28670085>

        Reviewed by Dean Jackson.

        Unspecified 'wdth' axis values are being normalized because the font is a GX font. However, this
        font assumes no normalization, which means one of the comparisons in the test is bogus.

        * fast/text/variations/advances-expected.txt:
        * fast/text/variations/advances.html:
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:

2017-04-27  Antti Koivisto  <antti@apple.com>

        Skip css3/viewport-percentage-lengths/vh-auto-size.html on WK1.

        Looks like use of auto-sizing leaves state behind in DRT.

        * platform/mac-wk1/TestExpectations:

2017-04-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/buttons-container/buttons-container-buttons-property.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=167371

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark webgl/1.0.2/conformance/glsl/misc/shader-with-reserved-words.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170877

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-27  Zalan Bujtas  <zalan@apple.com>

        Use text-shadow to visualize simple line layout coverage.
        https://bugs.webkit.org/show_bug.cgi?id=171379

        Reviewed by Antti Koivisto.

        * fast/inline/simple-line-layout-16bit-content-expected-mismatch.html: Added.
        * fast/inline/simple-line-layout-16bit-content-expected.html: Removed.
        * fast/inline/simple-line-layout-16bit-content.html:

2017-04-27  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] ARIA alertdialogs should be exposed with ROLE_DIALOG
        https://bugs.webkit.org/show_bug.cgi?id=171187

        Reviewed by Chris Fleizach.

        * accessibility/aria-mappings-expected.txt: Updated.
        * accessibility/gtk/xml-roles-exposed-expected.txt: Updated.
        * platform/gtk/accessibility/roles-exposed-expected.txt: Updated.

2017-04-27  Myles C. Maxfield  <mmaxfield@apple.com>

        Make fast/text/complex-small-caps-non-bmp-capitalize.html more robust
        https://bugs.webkit.org/show_bug.cgi?id=171366
        <rdar://problem/30060323>

        Reviewed by Alex Christensen.

        This test needs a font which supports Deseret but doesn't support small caps.
        Geneva is a better choice for such a font.

        * fast/text/complex-small-caps-non-bmp-capitalize-expected.html:
        * fast/text/complex-small-caps-non-bmp-capitalize.html:

2017-04-27  Antti Koivisto  <antti@apple.com>

        Repeated layouts in Mail due to viewport units being used with auto-sizing
        https://bugs.webkit.org/show_bug.cgi?id=171371
        <rdar://problem/28780084>

        Reviewed by Zalan Bujtas.

        * css3/viewport-percentage-lengths/vh-auto-size-expected.html: Added.
        * css3/viewport-percentage-lengths/vh-auto-size.html: Added.

2017-04-27  Joanmarie Diggs  <jdiggs@igalia.com>

        AX: Inconsistent exposure of ARIA "button" role with non-false value of aria-haspopup
        https://bugs.webkit.org/show_bug.cgi?id=171204

        Reviewed by Chris Fleizach.

        It turns out that this bug was fixed as a side effect of the changes made
        to fix WebKitGtk bug 171164 (r215821). But we didn't realize it due to the
        lack of an existing layout test covering the mappings for other platforms.
        The test created for the WebKitGtk port was modified and moved to the shared
        tests. Shared expectations are based on the Mac's mappings.

        * accessibility/button-with-aria-haspopup-role-expected.txt: Added.
        * accessibility/button-with-aria-haspopup-role.html: Renamed from LayoutTests/accessibility/gtk/button-with-aria-haspopup-is-not-a-combobox.html.
        * accessibility/gtk/button-with-aria-haspopup-is-not-a-combobox-expected.txt: Removed.
        * platform/gtk/accessibility/button-with-aria-haspopup-role-expected.txt: Added.

2017-04-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/local/blob/send-hybrid-blob-using-open-panel.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171353

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-04-27  Frederic Wang  <fwang@igalia.com>

        Fix some tests from platform-tests/cssom-view/cssom-view/
        https://bugs.webkit.org/show_bug.cgi?id=171228

        Reviewed by Youenn Fablet.

        * TestExpectations: Unskip media-query-list-interface.

2017-04-27  Zalan Bujtas  <zalan@apple.com>

        Text gets cut off when bailing out of simple line layout with widows.
        https://bugs.webkit.org/show_bug.cgi?id=171370
        <rdar://problem/31563414>

        Reviewed by Antti Koivisto.

        * fast/multicol/simple-line-layout-widows-when-switching-over-to-normal-line-layout-expected.html: Added.
        * fast/multicol/simple-line-layout-widows-when-switching-over-to-normal-line-layout.html: Added.

2017-04-26  Chris Dumez  <cdumez@apple.com>

        Unreviewed, remove unnecessary expected result in platform/ios-wk2

        * platform/ios-wk2/imported/w3c/web-platform-tests/html/dom/reflection-embedded-expected.txt: Removed.
        * platform/ios/imported/w3c/web-platform-tests/html/dom/reflection-embedded-expected.txt:

2017-04-26  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Uint8ClampedArray should be treated like an array, not an object
        https://bugs.webkit.org/show_bug.cgi?id=171364
        <rdar://problem/10873037>

        Reviewed by Sam Weinig.

        * inspector/model/remote-object-expected.txt:
        * inspector/model/remote-object.html:
        * platform/mac/inspector/model/remote-object-expected.txt:
        Test a Uint8ClampedArray is treated like an array.

2017-04-26  Saam Barati  <sbarati@apple.com>

        ASSERTION FAILED: inIndex != notFound in JSC::invalidParameterInSourceAppender()
        https://bugs.webkit.org/show_bug.cgi?id=170924
        <rdar://problem/31721052>

        Reviewed by Mark Lam.

        * js/let-syntax-expected.txt:

2017-04-26  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] ARIA buttons which have a popup should be ATK_ROLE_PUSH_BUTTON; not ATK_ROLE_COMBO_BOX
        https://bugs.webkit.org/show_bug.cgi?id=171182

        Reviewed by Chris Fleizach.

        * accessibility/gtk/button-with-aria-haspopup-is-not-a-combobox-expected.txt: Added.
        * accessibility/gtk/button-with-aria-haspopup-is-not-a-combobox.html: Added.

2017-04-26  Tim Horton  <timothy_horton@apple.com>

        Should not drag x-apple-data-detectors links
        https://bugs.webkit.org/show_bug.cgi?id=171352
        <rdar://problem/31309081>

        Reviewed by Beth Dakin.

        * fast/events/do-not-drag-and-drop-data-detectors-link-expected.txt: Added.
        * fast/events/do-not-drag-and-drop-data-detectors-link.html: Added.

2017-04-26  Tim Horton  <timothy_horton@apple.com>

        Revert accidentally smushed commit.

        * TestExpectations:
        * fast/events/do-not-drag-and-drop-data-detectors-link-expected.txt: Removed.
        * fast/events/do-not-drag-and-drop-data-detectors-link.html: Removed.
        * platform/mac/TestExpectations:

2017-04-26  Matt Lewis  <jlewis3@apple.com>

        Re-baseline inspector/dom/getAccessibilityPropertiesForNode.html after r215821
        https://bugs.webkit.org/show_bug.cgi?id=171346

        Unreviewed test gardening.

        * inspector/dom/getAccessibilityPropertiesForNode-expected.txt:

2017-04-26  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] Elements with a defined, non-false value for aria-current should expose ATK_STATE_ACTIVE
        https://bugs.webkit.org/show_bug.cgi?id=171163

        Reviewed by Chris Fleizach.

        * accessibility/gtk/aria-current-changed-notification-expected.txt: Added.
        * accessibility/gtk/aria-current-changed-notification.html: Added.
        * accessibility/gtk/aria-current-expected.txt: Added.
        * accessibility/gtk/aria-current.html: Added.

2017-04-26  Youenn Fablet  <youenn@apple.com>

        LayoutTest webrtc/datachannel/bufferedAmountLowThreshold.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170701

        Reviewed by Eric Carlson.

        * platform/mac-wk1/TestExpectations: Removing flaky expectation.
        * webrtc/datachannel/bufferedAmountLowThreshold-expected.txt:
        * webrtc/datachannel/bufferedAmountLowThreshold.html:

2017-04-26  Said Abou-Hallawa  <sabouhallawa@apple.com>

        Restrict WebKit image formats to a known whitelist
        https://bugs.webkit.org/show_bug.cgi?id=170700

        Reviewed by Tim Horton.

        * fast/images/image-formats-support-expected.txt: Added.
        * fast/images/image-formats-support.html: Added.
        * fast/images/resources/100x100-red-psd-renamed.png: Added.
        * fast/images/resources/100x100-red-tga-renamed.png: Added.
        * fast/images/resources/100x100-red.psd: Added.
        * fast/images/resources/100x100-red.tga: Added.

2017-04-26  Matt Lewis  <jlewis3@apple.com>

        Mark swipe/main-frame-pinning-requirement.html as a flaky failure on mac-wk2.
        https://bugs.webkit.org/show_bug.cgi?id=170484

        Reviewed by Alexey Proskuryakov.

        * platform/mac-wk2/TestExpectations:

2017-04-26  Chris Dumez  <cdumez@apple.com>

        Re-sync html/browsers/the-window-object web-platform-tests from upstream
        https://bugs.webkit.org/show_bug.cgi?id=171313

        Reviewed by Alex Christensen.

        * tests-options.json:

2017-04-26  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] Implement support for new ARIA 1.1 values of aria-haspopup
        https://bugs.webkit.org/show_bug.cgi?id=171164

        Reviewed by Chris Fleizach.

        In addition to the new test, update xml-roles-exposed.html's expectations
        because the implicit value of aria-haspopup for the combobox role is now
        listbox, and that value should be exposed via an AtkObject attribute.

        * accessibility/gtk/aria-haspopup-expected.txt: Added.
        * accessibility/gtk/aria-haspopup.html: Added.
        * accessibility/gtk/xml-roles-exposed-expected.txt:

2017-04-26  Simon Fraser  <simon.fraser@apple.com>

        http/tests/frame-throttling tests failing on iOS
        https://bugs.webkit.org/show_bug.cgi?id=171314
        rdar://problem/31691134

        Reviewed by Chris Dumez.

        The tests use UIHelper.activateAt(), which in DumpRenderTree dispatches mouse events via EventSender, and in iOS WK2 uses
        UIScriptController to dispatch touch events. The former just use standard hit testing, which works fine.
        The latter go via Frame::qualifyingNodeAtViewportLocation(), which calls ancestorRespondingToClickEvents()
        and does area hit testing, and this fails to find anything clickable inside the <iframe>s.

        Fix by putting a div with an onlick handler inside the iframes, and adjusting the click
        locations.

        * http/tests/frame-throttling/raf-throttle-in-cross-origin-subframe.html:
        * http/tests/frame-throttling/resources/requestAnimationFrame-frame.html:
        * http/tests/frame-throttling/resources/timer-throttling-frame.html:
        * http/tests/frame-throttling/timer-throttle-in-cross-origin-subframe.html:

2017-04-26  Matt Lewis  <jlewis3@apple.com>

        Removing Flaky timeout expectation for swipe/main-frame-pinning-requirement.html.
        https://bugs.webkit.org/show_bug.cgi?id=161887

        Reviewed by Tim Horton.

        * platform/mac-wk2/TestExpectations:

2017-04-25  Dean Jackson  <dino@apple.com>

        [Color] Make gradients work with ExtendedColors
        https://bugs.webkit.org/show_bug.cgi?id=171315
        <rdar://problems/31830177>

        Reviewed by Antoine Quint.

        Test for gradients using the color() syntax. Unfortunately,
        due to rounding errors, we can't use a ref test for some
        transparent colors, so comment them out for the moment.
        These can be re-enabled when we can specify a tolerance
        value for image comparison in the testing framework.

        * css3/color/gradients-expected.html: Added.
        * css3/color/gradients.html: Added.

2017-04-26  Zalan Bujtas  <zalan@apple.com>

        Forced page break on :after triggers infinite loop in column balancing
        https://bugs.webkit.org/show_bug.cgi?id=171309
        rdar://problem/26285884

        Reviewed by David Hyatt.

        * fast/multicol/infinite-loop-when-forced-break-expected.txt: Added.
        * fast/multicol/infinite-loop-when-forced-break.html: Added.

2017-04-26  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r215767.

        The LayoutTest for this change is a flaky failure.

        Reverted changeset:

        "Restrict WebKit image formats to a known whitelist"
        https://bugs.webkit.org/show_bug.cgi?id=170700
        http://trac.webkit.org/changeset/215767

2017-04-24  Sergio Villar Senin  <svillar@igalia.com>

        [css-grid] Remove most of the usage of SizingOperation
        https://bugs.webkit.org/show_bug.cgi?id=171225

        Reviewed by Darin Adler.

        Added a new test case which was working correctly but that was not properly tested before.

        * fast/css-grid-layout/grid-track-sizing-with-percentages-and-orthogonal-flows-expected.txt:
        * fast/css-grid-layout/grid-track-sizing-with-percentages-and-orthogonal-flows.html:

2017-04-25  Joseph Pecoraro  <pecoraro@apple.com>

        [mac-wk1 Debug] LayoutTest http/tests/inspector/network/resource-sizes-network.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170953

        Reviewed by Brian Burg.

        * http/tests/inspector/network/resource-sizes-disk-cache.html:
        * http/tests/inspector/network/resource-sizes-network.html:
        Read the entire data to ensure the load is complete before we notify the frontend.

        * platform/mac-wk1/TestExpectations:
        * platform/mac-wk2/TestExpectations:
        Unflake these tests, they should be more reliable now.

2017-04-25  Youenn Fablet  <youenn@apple.com>

        fast/mediastream/RTCPeerConnection-icecandidate-event.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=171242

        Reviewed by Alex Christensen.

        * TestExpectations:
        * fast/mediastream/RTCPeerConnection-icecandidate-event-expected.txt:
        * fast/mediastream/RTCPeerConnection-icecandidate-event.html: Updating test to be more deterministic.

2017-04-25  Brent Fulgham  <bfulgham@apple.com>

        Relax the event firing ASSERT for Attr changes
        https://bugs.webkit.org/show_bug.cgi?id=171236
        <rdar://problem/30516349>

        Reviewed by Dean Jackson.

        * fast/dom/HTMLLinkElement/event-while-removing-attribute-expected.txt: Added.
        * fast/dom/HTMLLinkElement/event-while-removing-attribute.html: Added.

2017-04-25  Dean Jackson  <dino@apple.com>

        REGRESSION (r214129): fast/media/mq-prefers-reduced-motion.html fails
        https://bugs.webkit.org/show_bug.cgi?id=171303
        <rdar://problem/31434879>

        Reviewed by Brent Fulgham.

        This particular test was calling notifyDone() from within
        a callback triggered by the UIScriptController script, which
        meant that by the time the controller tried to call its callback,
        the test had finished.

        * fast/media/mq-prefers-reduced-motion-matchMedia.html: Make sure
        notifyDone is called after both the callback-like functions have
        triggered.

2017-04-25  John Wilander  <wilander@apple.com>

        Resource Load Statistics: Introduce shorter time-to-live for cookie partition whitelisting
        https://bugs.webkit.org/show_bug.cgi?id=171295
        <rdar://problem/31823818>

        Reviewed by Brent Fulgham.

        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-deletion.html:
            Changed a TestRunner function name to
            statisticsFireShouldPartitionCookiesHandlerForOneDomain().
        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-with-partitioning-timeout-expected.txt: Added.
        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-with-partitioning-timeout.html: Added.
        * http/tests/loading/resourceLoadStatistics/partitioned-cookies-with-and-without-user-interaction.html:
            Changed a TestRunner function name to
            statisticsFireShouldPartitionCookiesHandlerForOneDomain().

2017-04-25  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r215476.
        https://bugs.webkit.org/show_bug.cgi?id=171304

        "It broke JSBench" (Requested by saamyjoon on #webkit).

        Reverted changeset:

        "[ES6]. Implement Annex B.3.3 function hoisting rules for
        eval"
        https://bugs.webkit.org/show_bug.cgi?id=163208
        http://trac.webkit.org/changeset/215476

2017-04-25  Saam Barati  <sbarati@apple.com>

        JSArray::isArrayPrototypeIteratorProtocolFastAndNonObservable is wrong because it does not do the necessary checks on the base object
        https://bugs.webkit.org/show_bug.cgi?id=171150
        <rdar://problem/31771880>

        Reviewed by Sam Weinig.

        * js/sequence-iterator-protocol-2-expected.txt: Added.
        * js/sequence-iterator-protocol-2.html: Added.
        * js/sequence-iterator-protocol-expected.txt: Added.
        * js/sequence-iterator-protocol.html: Added.

2017-04-25  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/pip-support/pip-support-click.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=165311

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-25  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/security/contentSecurityPolicy/1.1/module-scriptnonce-invalidnonce.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171301

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-04-25  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r215730.

        The LayoutTest for this change is a flaky timeout on mac-wk1
        debug.

        Reverted changeset:

        "Enable expired-only reload policy on Mac and iOS"
        https://bugs.webkit.org/show_bug.cgi?id=171264
        http://trac.webkit.org/changeset/215730

2017-04-25  Said Abou-Hallawa  <sabouhallawa@apple.com>

        Restrict WebKit image formats to a known whitelist
        https://bugs.webkit.org/show_bug.cgi?id=170700

        Reviewed by Tim Horton.

        * fast/images/image-formats-support-expected.txt: Added.
        * fast/images/image-formats-support.html: Added.
        * fast/images/resources/100x100-red-psd-renamed.png: Added.
        * fast/images/resources/100x100-red-tga-renamed.png: Added.
        * fast/images/resources/100x100-red.psd: Added.
        * fast/images/resources/100x100-red.tga: Added.

2017-04-25  Tim Horton  <timothy_horton@apple.com>

        Deduplicate some lines in the toplevel TestExpectations

        * TestExpectations:
        Remove a duplicate line and consolidate another.

2017-04-25  Chris Dumez  <cdumez@apple.com>

        Element.dataset.name incorrectly returns undefined
        https://bugs.webkit.org/show_bug.cgi?id=161454
        <rdar://problem/31818563>

        Reviewed by Mark Lam.

        Add layout test for JS caching bug on DOMStringMap that was fixed as part
        of a large named property getter refactoring in r210667.

        * fast/dom/dataset-caching-bug-expected.txt: Added.
        * fast/dom/dataset-caching-bug.html: Added.

2017-04-25  Myles C. Maxfield  <mmaxfield@apple.com>

        Supplementary Multilingual Plane Complex Scripts Rendered Incorrectly
        https://bugs.webkit.org/show_bug.cgi?id=171272
        <rdar://problem/30966764>

        Reviewed by Zalan Bujtas.

        * fast/text/kaithi-expected.html: Added.
        * fast/text/kaithi.html: Added.
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:

2017-04-25  Daniel Bates  <dabates@apple.com>

        [Cocoa][Win] Enable of X-Content-Type-Options: nosniff header
        https://bugs.webkit.org/show_bug.cgi?id=136452
        <rdar://problem/23412620>

        Reviewed by Brent Fulgham.

        Unskip nosniff tests on Mac, iOS and Windows and update expected results now that
        we support X-Content-Type-Options: nosniff.

        Merge Blink test from <https://src.chromium.org/viewvc/blink?revision=168570&view=revision>.

        * TestExpectations: Unskip all nosniff tests except imported/w3c/web-platform-tests/fetch/nosniff/importscripts.html.
        We need to fix <https://bugs.webkit.org/show_bug.cgi?id=171248> before we can unskip it.
        When running the nosniff Web Platform Tests (WPT) dump console messages to standard error
        to avoid a difference of console message ordering due to the non-determinism of the WPT
        tests from affecting the matching of the expected result.
        * http/tests/security/contentTypeOptions/nosniff-dynamic-script-blocked-expected.txt: Added.
        * http/tests/security/contentTypeOptions/nosniff-dynamic-script-blocked.html: Copied from LayoutTests/http/tests/security/contentTypeOptions/nosniff-script-blocked.html.
        * http/tests/security/contentTypeOptions/nosniff-script-blocked-expected.txt: Update expected result.
        * http/tests/security/contentTypeOptions/nosniff-script-blocked.html: Substitute the not executable
        MIME type "text/xx-javascript" for "text/x-javascript" as the latter is an acceptable MIME type for
        JavaScript scripts as per the Fetch standard, <https://html.spec.whatwg.org/multipage/scripting.html#javascript-mime-type> (30 March 2017).
        * http/tests/security/contentTypeOptions/nosniff-script-without-content-type-blocked-expected.txt: Update
        expected result.
        * platform/gtk/TestExpectations: Skip the nosniff tests as GTK does not enable ENABLE(NOSNIFF).
        * platform/ios/TestExpectations: Unskip nosniff tests.
        * platform/mac/TestExpectations: Ditto.
        * platform/win/TestExpectations: Ditto.
        * platform/wk2/TestExpectations: Ditto.

2017-04-25  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/inspector/network/resource-sizes-disk-cache.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170971

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-04-25  Chris Dumez  <cdumez@apple.com>

        Content-Disposition header filename is ignored when 'download' attribute is specified in HTML
        https://bugs.webkit.org/show_bug.cgi?id=171239
        <rdar://problem/31789855>

        Reviewed by Alex Christensen.

        * http/tests/security/anchor-download-allow-sameorigin.html:
        Stop using attachment.php as resource for this download attribute test because attachment.php
        returns a Content-Disposition header with a filename. Given the behavior change in this patch,
        this resource is no longer suitable for testing the download attribute.

        * http/tests/download/anchor-download-attribute-content-disposition-expected.txt: Added.
        * http/tests/download/anchor-download-attribute-content-disposition.html: Added.
        * http/tests/download/resources/content-disposition-pass.php: Added.
        Add layout test coverage.

        * platform/ios-wk2/TestExpectations:
        * platform/mac-wk1/TestExpectations:
        * platform/win/TestExpectations:
        Skip new test on platforms where the download attribute is not supported.

2017-04-25  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline fast/canvas/canvas-crash.html for ios-simulator.
        https://bugs.webkit.org/show_bug.cgi?id=171238

        Unreviewed test gardening.

        * platform/ios-simulator/fast/canvas/canvas-crash-expected.txt: Added.

2017-04-25  Antti Koivisto  <antti@apple.com>

        Enable expired-only reload policy on Mac and iOS
        https://bugs.webkit.org/show_bug.cgi?id=171264
        <rdar://problem/31807637>

        Reviewed by Andreas Kling.

        * fast/loader/display-image-unset-can-block-image-and-can-reload-in-place.html:

        WebKitDisplayImages preference blocks loads, it does not prevent images already in memory cache from displaying.
        Modify the test to clear the memory cache so it still tests what it is supposed to.

2017-04-25  Frederic Wang  <fwang@igalia.com>

        Import W3C tests for the CSSOM View module
        https://bugs.webkit.org/show_bug.cgi?id=171215

        Reviewed by Youenn Fablet.

        * TestExpectations: Skip some completely failing CSSOM View tests.
        * platform/ios-simulator/imported/w3c/web-platform-tests/cssom-view/Screen-pixelDepth-Screen-colorDepth001-actual.txt: Added. Add an expectation for iOS simulator, differing from other platform.
        * platform/ios-simulator/imported/w3c/web-platform-tests/cssom-view/scrolling-quirks-vs-nonquirks-expected.txt: Added. Ditto.

2017-04-24  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/language/expressions/object/method-definition/early-errors-object-method-duplicate-parameters.js
        https://bugs.webkit.org/show_bug.cgi?id=171190

        Reviewed by Saam Barati.

        * js/parser-syntax-check-expected.txt:
        * js/script-tests/parser-syntax-check.js:
        Extend to cover method duplicate parameter cases.

2017-04-24  Jiewen Tan  <jiewen_tan@apple.com>

        LayoutTests crypto/subtle/ecdsa-generate-key-sign-verify-p384.html and crypto/subtle/ecdsa-generate-key-sign-verify-p256.html are flaky failures
        https://bugs.webkit.org/show_bug.cgi?id=171059
        <rdar://problem/31734958>

        Reviewed by Brent Fulgham.

        * TestExpectations:
        Remove test expectations.

2017-04-24  Manuel Rego Casasnovas  <rego@igalia.com>

        [selectors4] :focus-within should use the flat tree
        https://bugs.webkit.org/show_bug.cgi?id=170899

        Reviewed by Antti Koivisto.

        * TestExpectations: Remove test that is passing now.

2017-04-24  Nan Wang  <n_wang@apple.com>

        AX: Crash at WebCore::AXObjectCache::characterOffsetForIndex(int, WebCore::AccessibilityObject const*) + 703
        https://bugs.webkit.org/show_bug.cgi?id=171247

        Reviewed by Chris Fleizach.

        * accessibility/mac/input-string-for-range-crash-expected.txt: Added.
        * accessibility/mac/input-string-for-range-crash.html: Added.

2017-04-24  Youenn Fablet  <youenn@apple.com>

        Set defaults video getUserMedia constraints
        https://bugs.webkit.org/show_bug.cgi?id=171127

        Reviewed by Eric Carlson.

        * fast/mediastream/getUserMedia-default-expected.txt: Added.
        * fast/mediastream/getUserMedia-default.html: Added.

2017-04-24  Chris Dumez  <cdumez@apple.com>

        createElementNS() should now throw only InvalidCharacterError, not NamespaceError
        https://bugs.webkit.org/show_bug.cgi?id=171052

        Reviewed by Sam Weinig.

        Updated / rebaselined existing tests to reflect behavior change.

        * fast/dom/DOMImplementation/createDocument-namespace-err-expected.txt:
        * fast/dom/DOMImplementation/createDocumentType-err-expected.txt:
        * fast/dom/DOMImplementation/script-tests/createDocument-namespace-err.js:
        * fast/dom/DOMImplementation/script-tests/createDocumentType-err.js:
        * fast/dom/Document/createAttributeNS-namespace-err-expected.txt:
        * fast/dom/Document/createElementNS-namespace-err-expected.txt:
        * fast/dom/Document/script-tests/createAttributeNS-namespace-err.js:
        * fast/dom/Document/script-tests/createElementNS-namespace-err.js:
        * fast/dom/Element/script-tests/setAttributeNS-namespace-err.js:
        * fast/dom/Element/setAttributeNS-namespace-err-expected.txt:

2017-04-24  Chris Dumez  <cdumez@apple.com>

        REGRESSION (214503): Webkit crash under RenderElement::repaintForPausedImageAnimationsIfNeeded() when scrolling giphy pages
        https://bugs.webkit.org/show_bug.cgi?id=171243
        <rdar://problem/31715572>

        Reviewed by Antti Koivisto.

        Add layout test coverage.

        * fast/images/animated-gif-scrolling-crash-expected.txt: Added.
        * fast/images/animated-gif-scrolling-crash.html: Added.

2017-04-24  Saam Barati  <sbarati@apple.com>

        [mac debug] LayoutTest workers/wasm-long-compile-many.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=171120
        <rdar://problem/31781889>

        Rubber stamped by Mark Lam.

        Make the wasm binary we compile close to 50% smaller.

        * workers/wasm-resources/long-compile-many.js:
        (i.async.run):
        (i.worker.onmessage):
        * workers/wasm-resources/long-compile-worker.js:
        * workers/wasm-resources/long-compile.js:
        (async.run):
        (worker.onmessage):

2017-04-24  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/scrubber-support/scrubber-support-click.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171245

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-24  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/language/computed-property-names/class/static/getter-prototype.js
        https://bugs.webkit.org/show_bug.cgi?id=170897

        Reviewed by Saam Barati.

        * js/class-syntax-declaration-expected.txt:
        * js/script-tests/class-syntax-declaration.js:
        Extend tests for static and non-static methods named "constructor" and "prototype".

2017-04-24  Joseph Pecoraro  <pecoraro@apple.com>

        Address some FIXMEs in JavaScript tests for bugs that have been fixed
        https://bugs.webkit.org/show_bug.cgi?id=171191

        Reviewed by JF Bastien.

        * js/dom/custom-constructors-expected.txt:
        * js/dom/script-tests/custom-constructors.js:
        * js/script-tests/keyword-method-names.js:

2017-04-24  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/language/expressions/generators/yield-as-label.js
        https://bugs.webkit.org/show_bug.cgi?id=170979

        Reviewed by Saam Barati.

        * js/object-literal-shorthand-construction-expected.txt:
        * js/script-tests/object-literal-shorthand-construction.js:
        Extend this test to cover object literal shorthand with keywords.

        * js/dom/reserved-words-as-property-expected.txt:
        * js/let-syntax-expected.txt:
        * js/parser-syntax-check-expected.txt:
        Improved error messages.

2017-04-23  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r215674.
        https://bugs.webkit.org/show_bug.cgi?id=171212

        Possible unintended commit. This patch was on the wrong bug.
        (Requested by JoePeck on #webkit).

        Reverted changeset:

        "test262: test262/test/language/expressions/generators/yield-
        as-label.js"
        https://bugs.webkit.org/show_bug.cgi?id=170979
        http://trac.webkit.org/changeset/215674

2017-04-23  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/language/expressions/generators/yield-as-label.js
        https://bugs.webkit.org/show_bug.cgi?id=170979

        Reviewed by Saam Barati.

        * js/object-literal-shorthand-construction-expected.txt:
        * js/script-tests/object-literal-shorthand-construction.js:
        Extend this test to cover object literal shorthand with keywords.

        * js/dom/reserved-words-as-property-expected.txt:
        * js/let-syntax-expected.txt:
        * js/parser-syntax-check-expected.txt:
        Improved error messages.

2017-04-21  Zalan Bujtas  <zalan@apple.com>

        REGRESSION(r205374): <li> content inside <ul> should mid-word wrap when word-break: break-word is present.
        https://bugs.webkit.org/show_bug.cgi?id=171108
        <rdar://problem/30271747>

        Reviewed by Dan Bernstein.

        * fast/replaced/ul-li-word-break-break-word-expected.html: Added.
        * fast/replaced/ul-li-word-break-break-word.html: Added.
        * fast/replaced/zero-width-image-force-linebreak-expected.html: Added.
        * fast/replaced/zero-width-image-force-linebreak.html: Added.

2017-04-21  Aaron Chu  <aaron_chu@apple.com>

        AX: FKA: Buttons need a visible focus indicator
        https://bugs.webkit.org/show_bug.cgi?id=171040
        <rdar://problem/30922548>

        Reviewed by Antoine Quint.

        * TestExpectations:
        * media/modern-media-controls/icon-button/icon-button-focus-state-expected.txt: Added.
        * media/modern-media-controls/icon-button/icon-button-focus-state.html: Added.
        * platform/mac/TestExpectations:

2017-04-21  Ryan Haddad  <ryanhaddad@apple.com>

        Mark inspector/debugger/tail-deleted-frames-this-value.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=169119

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-21  Chris Dumez  <cdumez@apple.com>

        Regression(r206240): XMLSerializer.serializeToString() does not properly escape '<' / '>' in attribute values
        https://bugs.webkit.org/show_bug.cgi?id=171132
        <rdar://problem/31426752>

        Reviewed by Ryosuke Niwa.

        Add layout test coverage. This test is passing in both Firefox and Chrome.

        * fast/dom/XMLSerializer-serializeToString-entities-expected.txt: Added.
        * fast/dom/XMLSerializer-serializeToString-entities.html: Added.

2017-04-21  Youenn Fablet  <youenn@apple.com>

        [ios-simulator] LayoutTest webrtc/multi-video.html is a flaky crash
        https://bugs.webkit.org/show_bug.cgi?id=170823
        <rdar://problem/31611583>

        Unreviewed.

        * TestExpectations: Reactivating test.

2017-04-21  Daniel Bates  <dabates@apple.com>

        [iOS] Skip http/tests/security/contentSecurityPolicy/{audio, video}-redirect-allowed2.html
        <rdar://problem/31690952>

        Rubber-stamped by Jer Noble.

        We can enable these tests again once we fix <rdar://problem/25780035>.

        * platform/ios/TestExpectations:

2017-04-21  Per Arne Vollan  <pvollan@apple.com>

        Validate vImage arguments
        https://bugs.webkit.org/show_bug.cgi?id=171109

        Reviewed by Brent Fulgham.

        * fast/canvas/canvas-crash-expected.txt: Added.
        * fast/canvas/canvas-crash.html: Added.

2017-04-21  Ryan Haddad  <ryanhaddad@apple.com>

        Mark webrtc/datachannel/bufferedAmountLowThreshold.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170701

        Unreviewed test gardening.

        * TestExpectations:

2017-04-21  Andy VanWagoner  <thetalecrafter@gmail.com>

        [INTL] Implement Intl.DateTimeFormat.prototype.formatToParts
        https://bugs.webkit.org/show_bug.cgi?id=169458

        Reviewed by JF Bastien.

        Add tests for formatToParts

        * js/intl-datetimeformat-expected.txt:
        * js/script-tests/intl-datetimeformat.js:

2017-04-21  Timothy Horton  <timothy_horton@apple.com>

        Expose obscured insets to web content (as "safe area insets")
        https://bugs.webkit.org/show_bug.cgi?id=171013
        <rdar://problem/31564652>

        Reviewed by Wenson Hsieh and Dave Hyatt.

        * TestExpectations:
        * fast/css/variables/constants/invalid-constant-name-fallback-expected.html: Added.
        * fast/css/variables/constants/invalid-constant-name-fallback.html: Added.
        * fast/css/variables/constants/ios/safe-area-inset-set-expected.html: Added.
        * fast/css/variables/constants/ios/safe-area-inset-set.html: Added.
        * fast/css/variables/constants/safe-area-inset-cannot-override-expected.html: Added.
        * fast/css/variables/constants/safe-area-inset-cannot-override.html: Added.
        * fast/css/variables/constants/safe-area-inset-zero-expected.html: Added.
        * fast/css/variables/constants/safe-area-inset-zero.html: Added.
        * platform/ios-wk2/TestExpectations:

2017-04-20  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r215597.
        https://bugs.webkit.org/show_bug.cgi?id=171102

        Made all tests crash under GuardMalloc (Requested by ap on
        #webkit).

        Reverted changeset:

        "Expose obscured insets to web content (as "safe area
        insets")"
        https://bugs.webkit.org/show_bug.cgi?id=171013
        http://trac.webkit.org/changeset/215597

2017-04-20  Timothy Horton  <timothy_horton@apple.com>

        Expose obscured insets to web content (as "safe area insets")
        https://bugs.webkit.org/show_bug.cgi?id=171013
        <rdar://problem/31564652>

        Reviewed by Wenson Hsieh and Dave Hyatt.

        * TestExpectations:
        * fast/css/variables/constants/invalid-constant-name-fallback-expected.html: Added.
        * fast/css/variables/constants/invalid-constant-name-fallback.html: Added.
        * fast/css/variables/constants/ios/safe-area-inset-set-expected.html: Added.
        * fast/css/variables/constants/ios/safe-area-inset-set.html: Added.
        * fast/css/variables/constants/safe-area-inset-cannot-override-expected.html: Added.
        * fast/css/variables/constants/safe-area-inset-cannot-override.html: Added.
        * fast/css/variables/constants/safe-area-inset-zero-expected.html: Added.
        * fast/css/variables/constants/safe-area-inset-zero.html: Added.
        * platform/ios-wk2/TestExpectations:

2017-04-20  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/tracks-support/tracks-support-click-track-in-panel.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=169109

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-20  Ryan Haddad  <ryanhaddad@apple.com>

        Mark imported/w3c/web-platform-tests/WebCryptoAPI/sign_verify/ecdsa.worker.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170921

        Unreviewed test gardening.

        * TestExpectations:

2017-04-20  Matt Baker  <mattbaker@apple.com>

        Web Inspector: Add regular expression support to XHR breakpoints
        https://bugs.webkit.org/show_bug.cgi?id=170099
        <rdar://problem/31558082>

        Reviewed by Joseph Pecoraro.

        Update tests and expectations for new XHR breakpoint type.

        * inspector/dom-debugger/xhr-breakpoints-expected.txt:
        * inspector/dom-debugger/xhr-breakpoints.html:

2017-04-20  Wenson Hsieh  <wenson_hsieh@apple.com>

        Inline anchor elements cannot be dragged when starting the drag from a block descendant
        https://bugs.webkit.org/show_bug.cgi?id=171062
        <rdar://problem/31697835>

        Reviewed by Tim Horton.

        Adds a new test on WK1 Mac to verify that link dragging succeeds when the link's anchor element is inline and
        the drag is started from a block element under the link.

        * fast/events/drag-and-drop-link-containing-block-expected.txt: Added.
        * fast/events/drag-and-drop-link-containing-block.html: Added.
        * platform/ios/TestExpectations:
        * platform/mac-wk2/TestExpectations:

        Skip the test on iOS and Mac WK2.

2017-04-20  Aaron Chu  <aaron_chu@apple.com>

        AX: Modern Media Controls Timeline slider should be operable
        https://bugs.webkit.org/show_bug.cgi?id=170250

        Reviewed by Antoine Quint.

        * media/modern-media-controls/scrubber/scrubber-has-correct-ax-label-expected.txt: Added.
        * media/modern-media-controls/scrubber/scrubber-has-correct-ax-label.html: Added.

2017-04-18  Filip Pizlo  <fpizlo@apple.com>

        Optimize SharedArrayBuffer in the DFG+FTL
        https://bugs.webkit.org/show_bug.cgi?id=164108

        Reviewed by Saam Barati.
        
        Add a test of futex performance.

        * workers/sab/cascade_lock-worker.js: Added.
        (onmessage):
        * workers/sab/cascade_lock.html: Added.
        * workers/sab/worker-resources.js:
        (cascadeLockSlow):
        (cascadeLock):
        (cascadeUnlock):

2017-04-20  Jon Lee  <jonlee@apple.com>

        Update pip placard to "picture in picture"
        https://bugs.webkit.org/show_bug.cgi?id=171036
        rdar://problem/30201536

        Reviewed by Antoine Quint.

        * media/modern-media-controls/pip-placard/pip-placard-expected.txt: Updated expected results.
        * media/modern-media-controls/pip-placard/pip-placard.html:

2017-04-20  Ryan Haddad  <ryanhaddad@apple.com>

        Mark two crypto/subtle/ecdsa LayoutTests as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=171059

        Unreviewed test gardening.

        * TestExpectations:

2017-04-20  Ryan Haddad  <ryanhaddad@apple.com>

        Mark memory/memory-pressure-simulation.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170629

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-04-20  Carlos Alberto Lopez Perez  <clopez@igalia.com>

        [GTK] Update layout tests expectations after r215556
        https://bugs.webkit.org/show_bug.cgi?id=170942

        Unreviewed gardening.

        * platform/gtk/TestExpectations:

2017-04-20  Youenn Fablet  <youenn@apple.com>

        RTCPeerConnection is stopping its backend twice sometimes
        https://bugs.webkit.org/show_bug.cgi?id=171043

        Reviewed by Eric Carlson.

        * webrtc/closing-peerconnection-expected.txt: Added.
        * webrtc/closing-peerconnection.html: Added.

2017-04-20  Joanmarie Diggs  <jdiggs@igalia.com>

        [ATK] Implement support for DPub ARIA roles
        https://bugs.webkit.org/show_bug.cgi?id=170679

        Reviewed by Chris Fleizach.

        Update tests and expectations to reflect the modified WebCore Accessibility
        role mappings, and the corresponding changes for the platforms.

        * accessibility/gtk/xml-roles-exposed-expected.txt:
        * accessibility/gtk/xml-roles-exposed.html:
        * accessibility/roles-exposed.html:
        * inspector/dom/getAccessibilityPropertiesForNode-expected.txt:
        * platform/gtk/TestExpectations:
        * platform/gtk/accessibility/roles-exposed-expected.txt:
        * platform/mac/accessibility/roles-exposed-expected.txt:

2017-04-19  Ryan Haddad  <ryanhaddad@apple.com>

        Mark imported/w3c/web-platform-tests/WebCryptoAPI/derive_bits_keys/hkdf.worker.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170907

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-04-19  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline imported/w3c/web-platform-tests/html/dom/reflection-embedded.html.

        Unreviewed test gardening.

        * platform/ios-wk2/imported/w3c/web-platform-tests/html/dom/reflection-embedded-expected.txt:

2017-04-19  Ryan Haddad  <ryanhaddad@apple.com>

        Mark imported/w3c/web-platform-tests/XMLHttpRequest/getallresponseheaders-cl.htm as failing.
        https://bugs.webkit.org/show_bug.cgi?id=171031

        Unreviewed test gardening.

        * TestExpectations:

2017-04-19  Ryan Haddad  <ryanhaddad@apple.com>

        Remove two tests after r215515.
        https://bugs.webkit.org/show_bug.cgi?id=171014

        Unreviewed test gardening.

        * TestExpectations:

2017-04-19  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline tests after r215515.
        https://bugs.webkit.org/show_bug.cgi?id=171014

        Unreviewed test gardening.

        * TestExpectations:
        * platform/ios-wk2/imported/w3c/web-platform-tests/html/dom/reflection-embedded-expected.txt:
        * platform/ios/imported/w3c/web-platform-tests/html/browsers/browsing-the-web/history-traversal/persisted-user-state-restoration/scroll-restoration-fragment-scrolling-cross-origin-expected.txt:
        * platform/ios/imported/w3c/web-platform-tests/html/dom/reflection-embedded-expected.txt:

2017-04-19  Alex Christensen  <achristensen@webkit.org>

        Parsing large XML strings fails
        https://bugs.webkit.org/show_bug.cgi?id=170999
        <rdar://problem/17336267>

        Reviewed by Brady Eidson.

        * fast/dom/xml-large-expected.txt: Added.
        * fast/dom/xml-large.html: Added.

2017-04-19  Chris Fleizach  <cfleizach@apple.com>

        AX: <hr> should use a different role description than interactive separators
        https://bugs.webkit.org/show_bug.cgi?id=170317
        <rdar://problem/31363024>

        Reviewed by Joanmarie Diggs.

        * accessibility/mac/hr-element-expected.txt:
        * accessibility/mac/hr-element.html:

2017-04-19  JF Bastien  <jfbastien@apple.com>

        Unreviewed, rolling out r215520.

        Broke Debian 8

        Reverted changeset:

        "[INTL] Implement Intl.DateTimeFormat.prototype.formatToParts"
        https://bugs.webkit.org/show_bug.cgi?id=169458
        http://trac.webkit.org/changeset/215520

2017-04-19  Andy VanWagoner  <thetalecrafter@gmail.com>

        [INTL] Implement Intl.DateTimeFormat.prototype.formatToParts
        https://bugs.webkit.org/show_bug.cgi?id=169458

        Reviewed by JF Bastien.

        Add tests for formatToParts

        * js/intl-datetimeformat-expected.txt:
        * js/script-tests/intl-datetimeformat.js:

2017-04-19  Youenn Fablet  <youenn@apple.com>

        Import web-platform-tests/tools
        https://bugs.webkit.org/show_bug.cgi?id=170718

        Reviewed by Alex Christensen.

        * TestExpectations:
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-basic.any.worker-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-no-preflight.any-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-no-preflight.any.worker-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/cors/cors-origin.any.worker-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/api/request/request-cache-only-if-cached-expected.txt: Renamed from LayoutTests/platform/mac/imported/w3c/web-platform-tests/fetch/api/request/request-cache-only-if-cached-expected.txt.
        * tests-options.json:

2017-04-19  Antti Koivisto  <antti@apple.com>

        Avoid repaints for invisible animations on tumblr.com/search/aww
        https://bugs.webkit.org/show_bug.cgi?id=170986
        <rdar://problem/28644580>

        Reviewed by Andreas Kling.

        * fast/repaint/mutate-non-visible-expected.txt: Added.
        * fast/repaint/mutate-non-visible.html: Added.

2017-04-18  John Wilander  <wilander@apple.com>

        Resource Load Statistics: Check both origins and cookieHostNames for domain matches in data removal
        https://bugs.webkit.org/show_bug.cgi?id=170763
        <rdar://problem/31573091>

        Reviewed by Alex Christensen.

        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-deletion-expected.txt: Added.
        * http/tests/loading/resourceLoadStatistics/partitioned-and-unpartitioned-cookie-deletion.html: Added.

2017-04-18  Dean Jackson  <dino@apple.com>

        Update ANGLE
        https://bugs.webkit.org/show_bug.cgi?id=170941
        <rdar://problem/31633999>

        Reviewed by Alex Christensen.

        * fast/canvas/webgl/fragment-shader-assertion-expected.txt:

2017-04-18  Brent Fulgham  <bfulgham@apple.com>

        Correct handling of isolatedWorld in event handling
        https://bugs.webkit.org/show_bug.cgi?id=65589
        <rdar://problem/24097804>

        Reviewed by Geoffrey Garen.

        This following test cases are from the following Blink change:
        https://src.chromium.org/viewvc/blink?revision=152377&view=revision

        * fast/dom/event-attrs-isolated-world-expected.txt: Added.
        * fast/dom/event-attrs-isolated-world.html: Added.
        * http/tests/security/isolatedWorld/onclick-attribute-expected.txt: Added.
        * http/tests/security/isolatedWorld/onclick-attribute.html: Added.

2017-04-18  Wenson Hsieh  <wenson_hsieh@apple.com>

        [WK2] Cannot select text on nytimes.com when the selection granularity is WKSelectionGranularityCharacter
        https://bugs.webkit.org/show_bug.cgi?id=170968
        <rdar://problem/31692560>

        Reviewed by Dan Bernstein.

        Adds a new layout test checking that text within a node with a click handler can be selected when using
        character selection granularity.

        * editing/selection/character-granularity-select-text-with-click-handler-expected.txt: Added.
        * editing/selection/character-granularity-select-text-with-click-handler.html: Added.

2017-04-18  Joseph Pecoraro  <pecoraro@apple.com>

        [mac-wk1 Debug] LayoutTest http/tests/inspector/network/resource-sizes-network.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170953

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:
        Mark a flakey test in WebKit1.

2017-04-17  Sam Weinig  <sam@webkit.org>

        [WebIDL] Make annotated types first class allowing them to be used in sequences and unions
        https://bugs.webkit.org/show_bug.cgi?id=170926

        Reviewed by Chris Dumez.

        * js/dom/webidl-type-mapping-expected.txt:
        * js/dom/webidl-type-mapping.html:
        Update test to account for testDictionary now being an attribute,
        and test that the annotated type members behave correctly.

2017-04-18  Oleksandr Skachkov  <gskachkov@gmail.com>

        [ES6]. Implement Annex B.3.3 function hoisting rules for eval
        https://bugs.webkit.org/show_bug.cgi?id=163208

        Reviewed by Saam Barati.

        * inspector/runtime/evaluate-CommandLineAPI-expected.txt:
        * inspector/runtime/evaluate-CommandLineAPI.html:
        * js/parser-syntax-check-expected.txt:
        * js/script-tests/parser-syntax-check.js:

2017-04-18  Antti Koivisto  <antti@apple.com>

        Enable optimized layer flushes on iOS
        https://bugs.webkit.org/show_bug.cgi?id=170938
        <rdar://problem/31677395>

        Reviewed by Simon Fraser.

        Add test verifying that tiles get created for touch overflow scrolling.

        * compositing/ios/overflow-scroll-touch-tiles-expected.txt: Added.
        * compositing/ios/overflow-scroll-touch-tiles.html: Added.

2017-04-18  Ryan Haddad  <ryanhaddad@apple.com>

        Update TestExpectations for "selectors4" tests on mac-wk1.
        https://trac.webkit.org/changeset/215457/webkit

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-18  Manuel Rego Casasnovas  <rego@igalia.com>

        [css-grid] Add support for percentage gaps
        https://bugs.webkit.org/show_bug.cgi?id=170764

        Reviewed by Sergio Villar Senin.

        Import tests from Blink.

        * fast/css-grid-layout/grid-gutters-as-percentage-expected.txt: Added.
        * fast/css-grid-layout/grid-gutters-as-percentage.html: Added.
        * fast/css-grid-layout/grid-gutters-get-set-expected.txt:
        * fast/css-grid-layout/grid-gutters-get-set.html:

2017-04-18  Miguel Gomez  <magomez@igalia.com>

        [GTK+] Crash in WebCore::ImageFrame::ImageFrame()
        https://bugs.webkit.org/show_bug.cgi?id=170332

        Reviewed by Carlos Garcia Campos.

        Added a test to ensure that the browser doesn't crash when loading a PNG image which
        reports a wrong number of frames.

        * fast/images/bad-png-missing-fdat-expected.txt: Added.
        * fast/images/bad-png-missing-fdat.html: Added.
        * fast/images/resources/bad-png-missing-fdAT.png: Added.

2017-04-18  Manuel Rego Casasnovas  <rego@igalia.com>

        [selectors4] Import W3C Test Suite
        https://bugs.webkit.org/show_bug.cgi?id=170898

        Reviewed by Youenn Fablet.

        * TestExpectations: Mark a few tests as failure linking to the related bugs.
        * platform/mac-wk1/TestExpectations: Marking some tests that have issues on WK1.

2017-04-18  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Add several test expectations.

        * platform/gtk/TestExpectations:

2017-04-17  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Doesn't show size of compressed content correctly
        https://bugs.webkit.org/show_bug.cgi?id=155112
        <rdar://problem/25006728>

        Reviewed by Alex Christensen and Timothy Hatcher.

        * http/tests/inspector/network/resource-sizes-disk-cache-expected.txt: Added.
        * http/tests/inspector/network/resource-sizes-disk-cache.html: Added.
        * http/tests/inspector/network/resource-sizes-memory-cache-expected.txt: Added.
        * http/tests/inspector/network/resource-sizes-memory-cache.html: Added.
        * http/tests/inspector/network/resource-sizes-network-expected.txt: Added.
        * http/tests/inspector/network/resource-sizes-network.html: Added.
        Test resource sizes under different load conditions.

        * platform/mac/http/tests/inspector/network/resource-sizes-memory-cache-expected.txt: Added.
        * platform/mac/http/tests/inspector/network/resource-sizes-network-expected.txt: Added.
        Older versions of macOS will not have the new metrics, but test their output anyways.

        * http/tests/inspector/network/resources/404.php: Added.
        * http/tests/inspector/network/resources/gzipped-lorem-no-content-length.php: Added.
        * http/tests/inspector/network/resources/gzipped-lorem.php: Added.
        * http/tests/inspector/network/resources/lorem.txt: Added.
        Different resources with fixed sizes (text, gzipped, 404 with fixed response).

        * http/tests/inspector/network/resources/resource-size-test.js: Added.
        (TestPage.registerInitializer.InspectorTest.gracefulExpectEquals):
        (TestPage.registerInitializer.window.addResourceSizeTest):
        (TestPage.registerInitializer):
        Shared test code for resource sizes.

        * platform/mac-wk1/TestExpectations:
        * platform/win/TestExpectations:

2017-04-17  Youenn Fablet  <youenn@apple.com>

        Enable video autoplay when getUserMedia is on
        https://bugs.webkit.org/show_bug.cgi?id=170919

        Reviewed by Geoffrey Garen.

        * webrtc/video-autoplay-expected.txt: Added.
        * webrtc/video-autoplay.html: Added.

2017-04-17  Ryan Haddad  <ryanhaddad@apple.com>

        Skip webrtc/multi-video.html.
        https://bugs.webkit.org/show_bug.cgi?id=170823

        Unreviewed test gardening.

        * TestExpectations:

2017-04-17  Youenn Fablet  <youenn@apple.com>

        LayoutTest webrtc/video-mute.html is a flaky failure
        https://bugs.webkit.or
        g/show_bug.cgi?id=170704

        Reviewed by Eric Carlson.

        * webrtc/video-mute.html: Another try at making the test not flaky.

2017-04-17  Tim Horton  <timothy_horton@apple.com>

        Provide a viewport parameter to disable clipping to the safe area
        https://bugs.webkit.org/show_bug.cgi?id=170766
        <rdar://problem/31564634>

        Reviewed by Beth Dakin.

        * tiled-drawing/ios/viewport-clip-to-safe-area-no-gets-margin-tiles-expected.txt: Added.
        * tiled-drawing/ios/viewport-clip-to-safe-area-no-gets-margin-tiles.html: Added.
        * tiled-drawing/ios/viewport-clip-to-safe-area-yes-gets-no-margin-tiles-expected.txt: Added.
        * tiled-drawing/ios/viewport-clip-to-safe-area-yes-gets-no-margin-tiles.html: Added.

2017-04-14  Jiewen Tan  <jiewen_tan@apple.com>

        [WebCrypto] Add support for ECDSA
        https://bugs.webkit.org/show_bug.cgi?id=170789
        <rdar://problem/31588604>

        Reviewed by Brent Fulgham.

        * crypto/subtle/ec-generate-key-malformed-parameters-expected.txt:
        * crypto/subtle/ec-generate-key-malformed-parameters.html:
        * crypto/subtle/ec-import-key-malformed-parameters-expected.txt:
        * crypto/subtle/ec-import-key-malformed-parameters.html:
        * crypto/subtle/ecdh-generate-export-key-pkcs8-p256-expected.txt: Renamed from LayoutTests/crypto/subtle/ecdh-generate-export-pkcs8-p256-expected.txt.
        * crypto/subtle/ecdh-generate-export-key-pkcs8-p256.html: Renamed from LayoutTests/crypto/subtle/ecdh-generate-export-pkcs8-p256.html.
        * crypto/subtle/ecdh-generate-export-key-pkcs8-p384-expected.txt: Renamed from LayoutTests/crypto/subtle/ecdh-generate-export-pkcs8-p384-expected.txt.
        * crypto/subtle/ecdh-generate-export-key-pkcs8-p384.html: Renamed from LayoutTests/crypto/subtle/ecdh-generate-export-pkcs8-p384.html.
        * crypto/subtle/ecdsa-generate-export-jwk-key-expected.txt: Added.
        * crypto/subtle/ecdsa-generate-export-jwk-key.html: Added.
        * crypto/subtle/ecdsa-generate-export-key-pkcs8-expected.txt: Added.
        * crypto/subtle/ecdsa-generate-export-key-pkcs8.html: Added.
        * crypto/subtle/ecdsa-generate-export-key-raw-expected.txt: Added.
        * crypto/subtle/ecdsa-generate-export-key-raw.html: Added.
        * crypto/subtle/ecdsa-generate-export-key-spki-expected.txt: Added.
        * crypto/subtle/ecdsa-generate-export-key-spki.html: Added.
        * crypto/subtle/ecdsa-generate-key-expected.txt: Added.
        * crypto/subtle/ecdsa-generate-key-sign-verify-p256-expected.txt: Added.
        * crypto/subtle/ecdsa-generate-key-sign-verify-p256.html: Added.
        * crypto/subtle/ecdsa-generate-key-sign-verify-p384-expected.txt: Added.
        * crypto/subtle/ecdsa-generate-key-sign-verify-p384.html: Added.
        * crypto/subtle/ecdsa-generate-key.html: Added.
        * crypto/subtle/ecdsa-import-jwk-private-key-expected.txt: Added.
        * crypto/subtle/ecdsa-import-jwk-private-key.html: Added.
        * crypto/subtle/ecdsa-import-jwk-public-key-alg-256-expected.txt: Added.
        * crypto/subtle/ecdsa-import-jwk-public-key-alg-256.html: Added.
        * crypto/subtle/ecdsa-import-jwk-public-key-alg-384-expected.txt: Added.
        * crypto/subtle/ecdsa-import-jwk-public-key-alg-384.html: Added.
        * crypto/subtle/ecdsa-import-jwk-public-key-expected.txt: Added.
        * crypto/subtle/ecdsa-import-jwk-public-key.html: Added.
        * crypto/subtle/ecdsa-import-key-sign-p256-expected.txt: Added.
        * crypto/subtle/ecdsa-import-key-sign-p256.html: Added.
        * crypto/subtle/ecdsa-import-key-sign-p384-expected.txt: Added.
        * crypto/subtle/ecdsa-import-key-sign-p384.html: Added.
        * crypto/subtle/ecdsa-import-key-verify-p256-expected.txt: Added.
        * crypto/subtle/ecdsa-import-key-verify-p256.html: Added.
        * crypto/subtle/ecdsa-import-key-verify-p384-expected.txt: Added.
        * crypto/subtle/ecdsa-import-key-verify-p384.html: Added.
        * crypto/subtle/ecdsa-import-pkcs8-key-expected.txt: Added.
        * crypto/subtle/ecdsa-import-pkcs8-key.html: Added.
        * crypto/subtle/ecdsa-import-raw-key-expected.txt: Added.
        * crypto/subtle/ecdsa-import-raw-key.html: Added.
        * crypto/subtle/ecdsa-import-spki-key-expected.txt: Added.
        * crypto/subtle/ecdsa-import-spki-key.html: Added.
        * crypto/subtle/ecdsa-verify-malformed-parameters-expected.txt: Added.
        * crypto/subtle/ecdsa-verify-malformed-parameters.html: Added.
        * crypto/workers/subtle/ecdsa-import-key-sign-expected.txt: Added.
        * crypto/workers/subtle/ecdsa-import-key-sign.html: Added.
        * crypto/workers/subtle/ecdsa-import-key-verify-expected.txt: Added.
        * crypto/workers/subtle/ecdsa-import-key-verify.html: Added.
        * crypto/workers/subtle/resources/ecdsa-import-key-sign.js: Added.
        * crypto/workers/subtle/resources/ecdsa-import-key-verify.js: Added.

2017-04-17  Youenn Fablet  <youenn@apple.com>

        LayoutTestwebrtc/audio-replace-track.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170837

        Reviewed by Eric Carlson.

        * webrtc/audio-replace-track.html: Updating the test to be less flaky.

2017-04-17  Youenn Fablet  <youenn@apple.com>

        RTCPeerConnection addTrack does not require a stream parameter
        https://bugs.webkit.org/show_bug.cgi?id=170894

        Reviewed by Alex Christensen.

        * webrtc/video-addTrack-expected.txt: Added.
        * webrtc/video-addTrack.html: Added.

2017-04-16  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/built-ins/Object/prototype/toLocaleString/primitive_this_value.js
        https://bugs.webkit.org/show_bug.cgi?id=170882

        Reviewed by Saam Barati.

        * js/dom/object-prototype-toLocaleString-expected.txt:
        * js/dom/script-tests/object-prototype-toLocaleString.js:
        Test the case of toLocaleString where toString does not exist.

2017-04-16  Chris Dumez  <cdumez@apple.com>

        CMD+R / CMD+Q is considered as user interaction and beforeunload alert is shown
        https://bugs.webkit.org/show_bug.cgi?id=169995
        <rdar://problem/23798897>

        Reviewed by Sam Weinig.

        Add layout test coverage.

        * fast/events/beforeunload-alert-handled-keydown-expected.txt: Added.
        * fast/events/beforeunload-alert-handled-keydown.html: Added.
        * fast/events/beforeunload-alert-unhandled-keydown-expected.txt: Added.
        * fast/events/beforeunload-alert-unhandled-keydown.html: Added.

2017-04-16  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/built-ins/Object/getOwnPropertyNames/15.2.3.4-4-44.js
        https://bugs.webkit.org/show_bug.cgi?id=170879

        Reviewed by Saam Barati.

        * js/Object-getOwnPropertyNames-expected.txt:
        * js/script-tests/Object-getOwnPropertyNames.js:

2017-04-14  Nikita Vasilyev  <nvasilyev@apple.com>

        Web Inspector: WebSockets: messages with non-latin letters are displayed incorrectly
        https://bugs.webkit.org/show_bug.cgi?id=170760

        Reviewed by Joseph Pecoraro.

        Test sending and receiving text and binary (blob and array buffer) data.

        * http/tests/websocket/tests/hybi/inspector/binary-expected.txt: Added.
        * http/tests/websocket/tests/hybi/inspector/binary.html: Added.
        * http/tests/websocket/tests/hybi/inspector/binary_wsh.py: Added.
        (web_socket_do_extra_handshake):
        (web_socket_transfer_data):
        (all_distinct_bytes):
        * http/tests/websocket/tests/hybi/inspector/send-and-receive-expected.txt: Added.
        * http/tests/websocket/tests/hybi/inspector/send-and-receive.html: Added.
        * http/tests/websocket/tests/hybi/inspector/send-and-receive_wsh.py: Added.
        (web_socket_do_extra_handshake):
        (web_socket_transfer_data):

2017-04-14  Jiewen Tan  <jiewen_tan@apple.com>

        [WebCrypto] Support HKDF
        https://bugs.webkit.org/show_bug.cgi?id=170636
        <rdar://problem/23539827>

        Reviewed by Brent Fulgham.

        * TestExpectations:
        * crypto/subtle/ecdh-import-key-derive-hkdf-key-expected.txt: Added.
        * crypto/subtle/ecdh-import-key-derive-hkdf-key.html: Added.
        * crypto/subtle/hkdf-derive-bits-malformed-parametrs-expected.txt: Added.
        * crypto/subtle/hkdf-derive-bits-malformed-parametrs.html: Added.
        * crypto/subtle/hkdf-import-key-derive-bits-expected.txt: Added.
        * crypto/subtle/hkdf-import-key-derive-bits.html: Added.
        * crypto/subtle/hkdf-import-key-derive-hmac-key-expected.txt: Added.
        * crypto/subtle/hkdf-import-key-derive-hmac-key.html: Added.
        * crypto/subtle/hkdf-import-key-expected.txt: Added.
        * crypto/subtle/hkdf-import-key-malformed-parameters-expected.txt: Added.
        * crypto/subtle/hkdf-import-key-malformed-parameters.html: Added.
        * crypto/subtle/hkdf-import-key.html: Added.
        * crypto/workers/subtle/hkdf-import-key-derive-bits-expected.txt: Added.
        * crypto/workers/subtle/hkdf-import-key-derive-bits.html: Added.
        * crypto/workers/subtle/hkdf-import-key-derive-hmac-key-expected.txt: Added.
        * crypto/workers/subtle/hkdf-import-key-derive-hmac-key.html: Added.
        * crypto/workers/subtle/hkdf-import-key-expected.txt: Added.
        * crypto/workers/subtle/hkdf-import-key.html: Added.
        * crypto/workers/subtle/resources/hkdf-import-key-derive-bits.js: Added.
        * crypto/workers/subtle/resources/hkdf-import-key-derive-hmac-key.js: Added.
        * crypto/workers/subtle/resources/hkdf-import-key.js: Added.

2017-04-14  Ryan Haddad  <ryanhaddad@apple.com>

        Skip workers/wasm-* LayoutTests on ios-simulator.

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-04-14  Zalan Bujtas  <zalan@apple.com>

        text-align start / end failure in table cells
        https://bugs.webkit.org/show_bug.cgi?id=141417
        <rdar://problem/31051672>

        Reviewed by Antti Koivisto.

        * fast/table/center-th-when-parent-has-initial-text-align-expected.html: Added.
        * fast/table/center-th-when-parent-has-initial-text-align.html: Added.

2017-04-13  Saam Barati  <sbarati@apple.com>

        WebAssembly: We should be able to postMessage a JSWebAssemblyModule
        https://bugs.webkit.org/show_bug.cgi?id=170573

        Reviewed by Filip Pizlo.

        * storage/indexeddb/resources/wasm-exceptions.js: Added.
        (const._fail):
        (const.isNotA.assert.isNotA):
        (const):
        (switch.typeof):
        (Builder):
        (Builder.prototype.setChecked):
        (Builder.prototype.setPreamble):
        (Builder.prototype._functionIndexSpaceKeyHash):
        (Builder.prototype._registerFunctionToIndexSpace):
        (Builder.prototype._getFunctionFromIndexSpace):
        (Builder.prototype._registerSectionBuilders.const.section.in.WASM.description.section.switch.section.case.string_appeared_here.this.section):
        (Builder.prototype._registerSectionBuilders.const.section.in.WASM.description.section.switch.section.const.codeBuilder.End.switch.case.string_appeared_here.e):
        (Builder.prototype._registerSectionBuilders.this.Unknown):
        (prepareDatabase):
        (testDatabase):
        * storage/indexeddb/wasm-exceptions-expected.txt: Added.
        * storage/indexeddb/wasm-exceptions.html: Added.
        * workers/wasm-hashset: Added.
        * workers/wasm-hashset-expected.txt: Added.
        * workers/wasm-hashset-many-expected.txt: Added.
        * workers/wasm-hashset-many.html: Added.
        * workers/wasm-hashset.html: Added.
        * workers/wasm-hashset/many-test.js: Added.
        (reallyDone):
        (console.log):
        (console.error):
        (console.assert):
        (i.worker.onmessage):
        (Module.print):
        (Module.printErr):
        (Module.canvas):
        (Module.setStatus):
        (Module):
        (setValue):
        (getValue):
        (allocate):
        (getMemory):
        (Pointer_stringify):
        (AsciiToString):
        (stringToAscii):
        (UTF8ArrayToString):
        (UTF8ToString):
        (stringToUTF8Array):
        (stringToUTF8):
        (lengthBytesUTF8):
        (demangle):
        (demangleAll):
        (stackTrace):
        (alignUp):
        (updateGlobalBuffer):
        (updateGlobalBufferViews):
        (abortOnCannotGrowMemory):
        (enlargeMemory):
        (getTotalMemory):
        (callRuntimeCallbacks):
        (preRun):
        (ensureInitRuntime):
        (preMain):
        (exitRuntime):
        (postRun):
        (addOnPreRun):
        (addOnInit):
        (addOnPreMain):
        (addOnExit):
        (addOnPostRun):
        (intArrayFromString):
        (intArrayToString):
        (writeStringToMemory):
        (writeArrayToMemory):
        (writeAsciiToMemory):
        (Math.string_appeared_here):
        (addRunDependency):
        (removeRunDependency):
        (integrateWasmJS.asm2wasmImports.string_appeared_here):
        (integrateWasmJS.lookupImport):
        (integrateWasmJS.mergeMemory):
        (integrateWasmJS.fixImports):
        (integrateWasmJS.getBinary):
        (integrateWasmJS.doJustAsm):
        (integrateWasmJS.receiveInstance):
        (integrateWasmJS.):
        (integrateWasmJS.doNativeWasm):
        (integrateWasmJS.doWasmPolyfill):
        (integrateWasmJS.Module.string_appeared_here):
        (integrateWasmJS):
        (___setErrNo):
        (__ZSt18uncaught_exceptionv):
        (EXCEPTIONS.deAdjust):
        (EXCEPTIONS.addRef):
        (EXCEPTIONS.decRef):
        (EXCEPTIONS.clearRef):
        (___cxa_find_matching_catch):
        (___gxx_personality_v0):
        (___lock):
        (_emscripten_memcpy_big):
        (_gettimeofday):
        (_abort):
        (SYSCALLS):
        (SYSCALLS.get getStr):
        (SYSCALLS.get64):
        (SYSCALLS.getZero):
        (try.___syscall146.printChar):
        (___syscall146):
        (___syscall54):
        (___unlock):
        (___syscall6):
        (invoke_ii):
        (invoke_iiii):
        (invoke_v):
        (_malloc.Module.string_appeared_here):
        (getTempRet0.Module.string_appeared_here):
        (_free.Module.string_appeared_here):
        (_main.Module.string_appeared_here):
        (setTempRet0.Module.string_appeared_here):
        (establishStackSpace.Module.string_appeared_here):
        (stackSave.Module.string_appeared_here):
        (_memset.Module.string_appeared_here):
        (_sbrk.Module.string_appeared_here):
        (_emscripten_get_global_libc.Module.string_appeared_here):
        (_memcpy.Module.string_appeared_here):
        (___errno_location.Module.string_appeared_here):
        (setThrew.Module.string_appeared_here):
        (_fflush.Module.string_appeared_here):
        (stackAlloc.Module.string_appeared_here):
        (stackRestore.Module.string_appeared_here):
        (_llvm_bswap_i32.Module.string_appeared_here):
        (runPostSets.Module.string_appeared_here):
        (dynCall_ii.Module.string_appeared_here):
        (dynCall_iiii.Module.string_appeared_here):
        (dynCall_v.Module.string_appeared_here):
        (else.applyMemoryInitializer):
        (else):
        (else.useRequest):
        (ExitStatus):
        (dependenciesFulfilled):
        (Module.string_appeared_here.Module.callMain.callMain.pad):
        (Module.string_appeared_here.Module.callMain):
        (run.doRun):
        (run):
        (exit):
        * workers/wasm-hashset/many-worker.js: Added.
        (console.log):
        (console.error):
        (console.assert):
        (Module.print):
        (Module.printErr):
        (Module.canvas):
        (Module.setStatus):
        (Module):
        (setValue):
        (getValue):
        (allocate):
        (getMemory):
        (Pointer_stringify):
        (AsciiToString):
        (stringToAscii):
        (UTF8ArrayToString):
        (UTF8ToString):
        (stringToUTF8Array):
        (stringToUTF8):
        (lengthBytesUTF8):
        (demangle):
        (demangleAll):
        (stackTrace):
        (alignUp):
        (updateGlobalBuffer):
        (updateGlobalBufferViews):
        (abortOnCannotGrowMemory):
        (enlargeMemory):
        (getTotalMemory):
        (callRuntimeCallbacks):
        (preRun):
        (ensureInitRuntime):
        (preMain):
        (exitRuntime):
        (postRun):
        (addOnPreRun):
        (addOnInit):
        (addOnPreMain):
        (addOnExit):
        (addOnPostRun):
        (intArrayFromString):
        (intArrayToString):
        (writeStringToMemory):
        (writeArrayToMemory):
        (writeAsciiToMemory):
        (Math.string_appeared_here):
        (addRunDependency):
        (removeRunDependency):
        (integrateWasmJS.asm2wasmImports.string_appeared_here):
        (integrateWasmJS.lookupImport):
        (integrateWasmJS.mergeMemory):
        (integrateWasmJS.fixImports):
        (integrateWasmJS.getBinary):
        (integrateWasmJS.doJustAsm):
        (integrateWasmJS.receiveInstance):
        (integrateWasmJS.doNativeWasm):
        (integrateWasmJS.doWasmPolyfill):
        (integrateWasmJS.Module.string_appeared_here):
        (integrateWasmJS):
        (___setErrNo):
        (__ZSt18uncaught_exceptionv):
        (EXCEPTIONS.deAdjust):
        (EXCEPTIONS.addRef):
        (EXCEPTIONS.decRef):
        (EXCEPTIONS.clearRef):
        (___cxa_find_matching_catch):
        (___gxx_personality_v0):
        (___lock):
        (_emscripten_memcpy_big):
        (_gettimeofday):
        (_abort):
        (SYSCALLS):
        (SYSCALLS.get getStr):
        (SYSCALLS.get64):
        (SYSCALLS.getZero):
        (try.___syscall146.printChar):
        (___syscall146):
        (___syscall54):
        (___unlock):
        (___syscall6):
        (invoke_ii):
        (invoke_iiii):
        (invoke_v):
        (_malloc.Module.string_appeared_here):
        (getTempRet0.Module.string_appeared_here):
        (_free.Module.string_appeared_here):
        (_main.Module.string_appeared_here):
        (setTempRet0.Module.string_appeared_here):
        (establishStackSpace.Module.string_appeared_here):
        (stackSave.Module.string_appeared_here):
        (_memset.Module.string_appeared_here):
        (_sbrk.Module.string_appeared_here):
        (_emscripten_get_global_libc.Module.string_appeared_here):
        (_memcpy.Module.string_appeared_here):
        (___errno_location.Module.string_appeared_here):
        (setThrew.Module.string_appeared_here):
        (_fflush.Module.string_appeared_here):
        (stackAlloc.Module.string_appeared_here):
        (stackRestore.Module.string_appeared_here):
        (_llvm_bswap_i32.Module.string_appeared_here):
        (runPostSets.Module.string_appeared_here):
        (dynCall_ii.Module.string_appeared_here):
        (dynCall_iiii.Module.string_appeared_here):
        (dynCall_v.Module.string_appeared_here):
        (else.applyMemoryInitializer):
        (else):
        (else.useRequest):
        (ExitStatus):
        (dependenciesFulfilled):
        (Module.string_appeared_here.Module.callMain.callMain.pad):
        (Module.string_appeared_here.Module.callMain):
        (run.doRun):
        (run):
        (exit):
        * workers/wasm-hashset/test.js: Added.
        (reallyDone):
        (console.log):
        (console.error):
        (console.assert):
        (Module.print):
        (Module.printErr):
        (Module.canvas):
        (Module.setStatus):
        (Module):
        (setValue):
        (getValue):
        (allocate):
        (getMemory):
        (Pointer_stringify):
        (AsciiToString):
        (stringToAscii):
        (UTF8ArrayToString):
        (UTF8ToString):
        (stringToUTF8Array):
        (stringToUTF8):
        (lengthBytesUTF8):
        (demangle):
        (demangleAll):
        (stackTrace):
        (alignUp):
        (updateGlobalBuffer):
        (updateGlobalBufferViews):
        (abortOnCannotGrowMemory):
        (enlargeMemory):
        (getTotalMemory):
        (callRuntimeCallbacks):
        (preRun):
        (ensureInitRuntime):
        (preMain):
        (exitRuntime):
        (postRun):
        (addOnPreRun):
        (addOnInit):
        (addOnPreMain):
        (addOnExit):
        (addOnPostRun):
        (intArrayFromString):
        (intArrayToString):
        (writeStringToMemory):
        (writeArrayToMemory):
        (writeAsciiToMemory):
        (Math.string_appeared_here):
        (addRunDependency):
        (removeRunDependency):
        (integrateWasmJS.asm2wasmImports.string_appeared_here):
        (integrateWasmJS.lookupImport):
        (integrateWasmJS.mergeMemory):
        (integrateWasmJS.fixImports):
        (integrateWasmJS.getBinary):
        (integrateWasmJS.doJustAsm):
        (integrateWasmJS.receiveInstance):
        (integrateWasmJS.doNativeWasm):
        (integrateWasmJS.doWasmPolyfill):
        (integrateWasmJS.Module.string_appeared_here):
        (integrateWasmJS):
        (___setErrNo):
        (__ZSt18uncaught_exceptionv):
        (EXCEPTIONS.deAdjust):
        (EXCEPTIONS.addRef):
        (EXCEPTIONS.decRef):
        (EXCEPTIONS.clearRef):
        (___cxa_find_matching_catch):
        (___gxx_personality_v0):
        (___lock):
        (_emscripten_memcpy_big):
        (_gettimeofday):
        (_abort):
        (SYSCALLS):
        (SYSCALLS.get getStr):
        (SYSCALLS.get64):
        (SYSCALLS.getZero):
        (try.___syscall146.printChar):
        (___syscall146):
        (___syscall54):
        (___unlock):
        (___syscall6):
        (invoke_ii):
        (invoke_iiii):
        (invoke_v):
        (_malloc.Module.string_appeared_here):
        (getTempRet0.Module.string_appeared_here):
        (_free.Module.string_appeared_here):
        (_main.Module.string_appeared_here):
        (setTempRet0.Module.string_appeared_here):
        (establishStackSpace.Module.string_appeared_here):
        (stackSave.Module.string_appeared_here):
        (_memset.Module.string_appeared_here):
        (_sbrk.Module.string_appeared_here):
        (_emscripten_get_global_libc.Module.string_appeared_here):
        (_memcpy.Module.string_appeared_here):
        (___errno_location.Module.string_appeared_here):
        (setThrew.Module.string_appeared_here):
        (_fflush.Module.string_appeared_here):
        (stackAlloc.Module.string_appeared_here):
        (stackRestore.Module.string_appeared_here):
        (_llvm_bswap_i32.Module.string_appeared_here):
        (runPostSets.Module.string_appeared_here):
        (dynCall_ii.Module.string_appeared_here):
        (dynCall_iiii.Module.string_appeared_here):
        (dynCall_v.Module.string_appeared_here):
        (else.applyMemoryInitializer):
        (else):
        (else.useRequest):
        (ExitStatus):
        (dependenciesFulfilled):
        (Module.string_appeared_here.Module.callMain.callMain.pad):
        (Module.string_appeared_here.Module.callMain):
        (run.doRun):
        (run):
        (exit):
        * workers/wasm-hashset/worker.js: Added.
        (console.log):
        (console.error):
        (console.assert):
        (Module.print):
        (Module.printErr):
        (Module.canvas):
        (Module.setStatus):
        (Module):
        (setValue):
        (getValue):
        (allocate):
        (getMemory):
        (Pointer_stringify):
        (AsciiToString):
        (stringToAscii):
        (UTF8ArrayToString):
        (UTF8ToString):
        (stringToUTF8Array):
        (stringToUTF8):
        (lengthBytesUTF8):
        (demangle):
        (demangleAll):
        (stackTrace):
        (alignUp):
        (updateGlobalBuffer):
        (updateGlobalBufferViews):
        (abortOnCannotGrowMemory):
        (enlargeMemory):
        (getTotalMemory):
        (callRuntimeCallbacks):
        (preRun):
        (ensureInitRuntime):
        (preMain):
        (exitRuntime):
        (postRun):
        (addOnPreRun):
        (addOnInit):
        (addOnPreMain):
        (addOnExit):
        (addOnPostRun):
        (intArrayFromString):
        (intArrayToString):
        (writeStringToMemory):
        (writeArrayToMemory):
        (writeAsciiToMemory):
        (Math.string_appeared_here):
        (addRunDependency):
        (removeRunDependency):
        (integrateWasmJS.asm2wasmImports.string_appeared_here):
        (integrateWasmJS.lookupImport):
        (integrateWasmJS.mergeMemory):
        (integrateWasmJS.fixImports):
        (integrateWasmJS.getBinary):
        (integrateWasmJS.doJustAsm):
        (integrateWasmJS.receiveInstance):
        (integrateWasmJS.):
        (integrateWasmJS.doNativeWasm):
        (integrateWasmJS.doWasmPolyfill):
        (integrateWasmJS.Module.string_appeared_here):
        (integrateWasmJS):
        (___setErrNo):
        (__ZSt18uncaught_exceptionv):
        (EXCEPTIONS.deAdjust):
        (EXCEPTIONS.addRef):
        (EXCEPTIONS.decRef):
        (EXCEPTIONS.clearRef):
        (___cxa_find_matching_catch):
        (___gxx_personality_v0):
        (___lock):
        (_emscripten_memcpy_big):
        (_gettimeofday):
        (_abort):
        (SYSCALLS):
        (SYSCALLS.get getStr):
        (SYSCALLS.get64):
        (SYSCALLS.getZero):
        (try.___syscall146.printChar):
        (___syscall146):
        (___syscall54):
        (___unlock):
        (___syscall6):
        (invoke_ii):
        (invoke_iiii):
        (invoke_v):
        (_malloc.Module.string_appeared_here):
        (getTempRet0.Module.string_appeared_here):
        (_free.Module.string_appeared_here):
        (_main.Module.string_appeared_here):
        (setTempRet0.Module.string_appeared_here):
        (establishStackSpace.Module.string_appeared_here):
        (stackSave.Module.string_appeared_here):
        (_memset.Module.string_appeared_here):
        (_sbrk.Module.string_appeared_here):
        (_emscripten_get_global_libc.Module.string_appeared_here):
        (_memcpy.Module.string_appeared_here):
        (___errno_location.Module.string_appeared_here):
        (setThrew.Module.string_appeared_here):
        (_fflush.Module.string_appeared_here):
        (stackAlloc.Module.string_appeared_here):
        (stackRestore.Module.string_appeared_here):
        (_llvm_bswap_i32.Module.string_appeared_here):
        (runPostSets.Module.string_appeared_here):
        (dynCall_ii.Module.string_appeared_here):
        (dynCall_iiii.Module.string_appeared_here):
        (dynCall_v.Module.string_appeared_here):
        (else.applyMemoryInitializer):
        (else):
        (else.useRequest):
        (ExitStatus):
        (dependenciesFulfilled):
        (Module.string_appeared_here.Module.callMain.callMain.pad):
        (Module.string_appeared_here.Module.callMain):
        (run.doRun):
        (run):
        (exit):
        * workers/wasm-long-compile-expected.txt: Added.
        * workers/wasm-long-compile-many-expected.txt: Added.
        * workers/wasm-long-compile-many.html: Added.
        * workers/wasm-long-compile.html: Added.
        * workers/wasm-resources: Added.
        * workers/wasm-resources/long-compile-many.js: Added.
        (done):
        (i.async.run):
        (i.worker.onmessage):
        * workers/wasm-resources/long-compile-worker.js: Added.
        (const._fail):
        (const.isNotA.assert.isNotA):
        (const):
        (switch.typeof):
        (Builder):
        (Builder.prototype.setChecked):
        (Builder.prototype.setPreamble):
        (Builder.prototype._functionIndexSpaceKeyHash):
        (Builder.prototype._registerFunctionToIndexSpace):
        (Builder.prototype._getFunctionFromIndexSpace):
        (Builder.prototype._registerSectionBuilders.const.section.in.WASM.description.section.switch.section.case.string_appeared_here.this.section):
        (Builder.prototype._registerSectionBuilders.const.section.in.WASM.description.section.switch.section.const.codeBuilder.End.switch.case.string_appeared_here.e):
        (Builder.prototype._registerSectionBuilders.this.Unknown):
        * workers/wasm-resources/long-compile.js: Added.
        (done):
        (async.run):
        (worker.onmessage):

2017-04-13  Dean Jackson  <dino@apple.com>

        Large negative animation-delays may not work depending on machine uptime
        https://bugs.webkit.org/show_bug.cgi?id=166962
        <rdar://problem/30091526>

        Reviewed by Tim Horton.

        * animations/large-negative-delay-expected.txt: Added.
        * animations/large-negative-delay.html: Added.

2017-04-13  Andy VanWagoner  <thetalecrafter@gmail.com>

        Change Intl prototypes to plain objects
        https://bugs.webkit.org/show_bug.cgi?id=168178

        Reviewed by JF Bastien.

        * js/intl-collator-expected.txt:
        * js/intl-datetimeformat-expected.txt:
        * js/intl-numberformat-expected.txt:
        * js/script-tests/intl-collator.js:
        * js/script-tests/intl-datetimeformat.js:
        * js/script-tests/intl-numberformat.js:

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/mediacapturefromelement/CanvasCaptureMediaStream-request-frame-events.html as flaky on iOS.
        https://bugs.webkit.org/show_bug.cgi?id=169719

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-04-13  Antti Koivisto  <antti@apple.com>

        Don't invalidate composition for style changes in non-composited layers
        https://bugs.webkit.org/show_bug.cgi?id=170805
        <rdar://problem/31606185>

        Reviewed by Simon Fraser.

        * compositing/updates/animation-non-composited-expected.txt: Added.
        * compositing/updates/animation-non-composited.html: Added.

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Mark webrtc/video-mute.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170704

        Unreviewed test gardening.

        * TestExpectations:

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/media-controls-timeline-updates-when-hovered.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=165553

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/track/track-cue-rendering-rtl.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170831

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Mark inspector/sampling-profiler/named-function-expression.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170830

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Add ios-simulator baseline for imported/w3c/web-platform-tests/fetch/api/request/request-cache-only-if-cached.html.

        Unreviewed test gardening.

        * platform/ios-simulator/imported/w3c/web-platform-tests/fetch/api/request/request-cache-only-if-cached-expected.txt: Added.

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/inspector/network/resource-request-headers.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170702

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-04-13  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/volume-support/volume-support-click.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=164229

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-13  Chris Dumez  <cdumez@apple.com>

        LayoutTest svg/animations/animated-svg-image-outside-viewport-paused.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170745

        Reviewed by Tim Horton.

        Test was relying on a setTimeout(30) and was flaky. Now use shouldBecomeEqual() to make the
        test more robust.

        * svg/animations/animated-svg-image-outside-viewport-paused-expected.txt:
        * svg/animations/animated-svg-image-outside-viewport-paused.html:

2017-04-13  Youenn Fablet  <youenn@apple.com>

        Remove RTCSignalingState::Closed
        https://bugs.webkit.org/show_bug.cgi?id=170811

        Reviewed by Eric Carlson.

        * webrtc/connection-state.html:

2017-04-13  Jonathan Bedard  <jbedard@apple.com>

        Remove compositing/masks/solid-color-masked.html expectation
        https://bugs.webkit.org/show_bug.cgi?id=168054

        Unreviewed test gardening.

        * platform/ios/TestExpectations: Remove compositing/masks/solid-color-masked.html.

2017-04-13  Youenn Fablet  <youenn@apple.com>

        Add some more WebRTC tests
        https://bugs.webkit.org/show_bug.cgi?id=170796

        Reviewed by Eric Carlson.

        * webrtc/multi-video-expected.txt: Added.
        * webrtc/multi-video.html: Added.
        * webrtc/video-with-data-channel-expected.txt: Added.
        * webrtc/video-with-data-channel.html: Added.

2017-04-13  Romain Bellessort  <romain.bellessort@crf.canon.fr>

        [Readable Streams API] Implement cloneArrayBuffer in WebCore
        https://bugs.webkit.org/show_bug.cgi?id=170008

        Reviewed by Youenn Fablet.

        Added test to check cloneArrayBuffer behaviour. 

        * streams/clone-array-buffer-expected.txt: Added.
        * streams/clone-array-buffer.html: Added.

2017-04-13  Youenn Fablet  <youenn@apple.com>

        onnegotiationneeded should only be called once
        https://bugs.webkit.org/show_bug.cgi?id=170785

        Reviewed by Alex Christensen.

        * webrtc/negotiatedneeded-event-addStream.html:

2017-04-13  Dave Hyatt  <hyatt@apple.com>

        Rendering flexbox children across columns
        https://bugs.webkit.org/show_bug.cgi?id=164166
        <rdar://problem/29055587>

        Reviewed by Zalan Bujtas.

        * fast/multicol/flexbox-rows-expected.html: Added.
        * fast/multicol/flexbox-rows.html: Added.

2017-04-13  Antti Koivisto  <antti@apple.com>

        Try to unflake a test.

        * http/tests/cache/disk-cache/disk-cache-media-small.html:

2017-04-12  Brady Eidson  <beidson@apple.com>

        QuotaExceededError when saving to localStorage in private mode.
        https://bugs.webkit.org/show_bug.cgi?id=157010

        Reviewed by Alex Christensen.

        * platform/mac-wk2/TestExpectations:
        * storage/domstorage/localstorage/private-browsing-affects-storage-expected.txt:
        * storage/domstorage/localstorage/private-browsing-affects-storage.html:
        * storage/domstorage/localstorage/resources/private-browsing-1.html: Added.
        * storage/domstorage/localstorage/resources/private-browsing-2.html: Added.
        * storage/domstorage/localstorage/resources/private-browsing-3.html: Added.
        * storage/domstorage/localstorage/resources/private-browsing-storage-2.html: Added.
        * storage/domstorage/sessionstorage/private-browsing-affects-storage-expected.txt: Removed.
        * storage/domstorage/sessionstorage/private-browsing-affects-storage.html: Removed.

2017-04-12  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/built-ins/NativeErrors/EvalError/proto.js
        https://bugs.webkit.org/show_bug.cgi?id=170668

        Reviewed by Keith Miller.

        * ietestcenter/Javascript/15.2.3.2-2-12-expected.txt:
        * ietestcenter/Javascript/15.2.3.2-2-13-expected.txt:
        * ietestcenter/Javascript/15.2.3.2-2-14-expected.txt:
        * ietestcenter/Javascript/15.2.3.2-2-15-expected.txt:
        * ietestcenter/Javascript/15.2.3.2-2-16-expected.txt:
        * ietestcenter/Javascript/15.2.3.2-2-17-expected.txt:
        These tests are now out of date.

2017-04-12  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/language/literals/regexp/u-dec-esc.js
        https://bugs.webkit.org/show_bug.cgi?id=170687

        Reviewed by Michael Saboff.

        * js/regexp-unicode-expected.txt:
        * js/script-tests/regexp-unicode.js:
        Extend test to test invalid backreferences.

2017-04-12  Jonathan Bedard  <jbedard@apple.com>

        Move expectation for compositing/iframes/iframe-size-from-zero.htm to top level

        Unreviewed test gardening.

        * TestExpectations: Marked compositing/iframes/iframe-size-from-zero.html as flaky.
        * platform/ios-wk1/TestExpectations: Move test expectation to top level.
        * platform/mac-wk1/TestExpectations: Ditto.
        * platform/win/TestExpectations: Ditto.
        * platform/wk2/TestExpectations: Ditto.

2017-04-11  Dean Jackson  <dino@apple.com>

        canvas/2d.gradient.* LayoutTests failing
        https://bugs.webkit.org/show_bug.cgi?id=170757
        <rdar://problem/31177990>

        Reviewed by Antoine Quint.

        Add a fudge factor to the gradient tests, since we can
        now produce noisy (nicer looking) gradients. There might
        be 1 or 2 bits of difference per pixel.

        * canvas/philip/tests.js:
        (_assertPixelWithGradientNoise):
        * canvas/philip/tests/2d.gradient.linear.transform.1.html:
        * canvas/philip/tests/2d.gradient.linear.transform.2.html:
        * canvas/philip/tests/2d.gradient.linear.transform.3.html:
        * canvas/philip/tests/2d.gradient.radial.cone.bottom.html:
        * canvas/philip/tests/2d.gradient.radial.cone.cylinder.html:
        * canvas/philip/tests/2d.gradient.radial.cone.front.html:
        * canvas/philip/tests/2d.gradient.radial.cone.shape1.html:
        * canvas/philip/tests/2d.gradient.radial.cone.top.html:
        * canvas/philip/tests/2d.gradient.radial.inside1.html:
        * canvas/philip/tests/2d.gradient.radial.inside2.html:
        * canvas/philip/tests/2d.gradient.radial.inside3.html:
        * canvas/philip/tests/2d.gradient.radial.outside1.html:
        * canvas/philip/tests/2d.gradient.radial.outside2.html:
        * canvas/philip/tests/2d.gradient.radial.outside3.html:
        * canvas/philip/tests/2d.gradient.radial.touch2.html:
        * fast/canvas/script-tests/canvas-gradient-on-compositing.js:
        * fast/canvas/canvas-gradient-on-compositing-expected.html:

2017-04-12  Myles C. Maxfield  <mmaxfield@apple.com>

        Well-known variations should clamp to the values listed in the @font-face block
        https://bugs.webkit.org/show_bug.cgi?id=169260

        Reviewed by Dean Jackson.

        * fast/text/variations/font-face-clamp-expected.html: Added.
        * fast/text/variations/font-face-clamp.html: Added.

2017-04-12  Jonathan Bedard  <jbedard@apple.com>

        Remove two passing canvas tests from ios expectations

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-04-12  Youenn Fablet  <youenn@apple.com>

        REGRESSION: LayoutTest webrtc/negotiatedneeded-event-addStream.html is frequently crashing
        https://bugs.webkit.org/show_bug.cgi?id=170754
        <rdar://problem/31573169>

        Unreviewed.

        * TestExpectations: Marking test as crashing.

2017-04-12  Manuel Rego Casasnovas  <rego@igalia.com>

        [css-grid] Replaced elements don't properly resolve percentage heights
        https://bugs.webkit.org/show_bug.cgi?id=159670

        Reviewed by Darin Adler.

        The issue was fixed in r213149 (bug #168657), but the Blink test was not imported.
        This patch only adds the test to avoid regressions in the future.

        * fast/css-grid-layout/grid-item-with-percent-height-replaced-element-expected.txt: Added.
        * fast/css-grid-layout/grid-item-with-percent-height-replaced-element.html: Added.

2017-04-10  Antti Koivisto  <antti@apple.com>

        Cache small media resources in disk cache
        https://bugs.webkit.org/show_bug.cgi?id=170676
        <rdar://problem/31532649>

        Reviewed by Andreas Kling.

        * http/tests/cache/disk-cache/disk-cache-media-small-expected.txt: Added.
        * http/tests/cache/disk-cache/disk-cache-media-small.html: Added.

2017-04-12  Per Arne Vollan  <pvollan@apple.com>

        Implement stroke-color CSS property.
        https://bugs.webkit.org/show_bug.cgi?id=169352

        Reviewed by Jon Lee.

        * fast/css/stroke-color-expected.html: Added.
        * fast/css/stroke-color-fallback-expected.html: Added.
        * fast/css/stroke-color-fallback.html: Added.
        * fast/css/stroke-color.html: Added.
        * fast/css/visited-link-stroke-color-expected.html: Added.
        * fast/css/visited-link-stroke-color.html: Added.

2017-04-11  Youenn Fablet  <youenn@apple.com>

        LayoutTest webrtc/video-mute.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170704

        Reviewed by Eric Carlson.

        * webrtc/video-mute.html: Trying to make it less flaky.

2017-04-11  Youenn Fablet  <youenn@apple.com>

        [WK1] Add captureStream test with webrtc
        https://bugs.webkit.org/show_bug.cgi?id=170746

        Reviewed by Eric Carlson.

        * platform/mac-wk1/TestExpectations: Activating this new test in WK1.
        * webrtc/captureCanvas-webrtc-expected.txt: Added.
        * webrtc/captureCanvas-webrtc.html: Added.

2017-04-11  Youenn Fablet  <youenn@apple.com>

        Migrating webrtc tests to latest API
        https://bugs.webkit.org/show_bug.cgi?id=170709

        Reviewed by Eric Carlson.

        * webrtc/audio-peer-connection-webaudio.html:
        * webrtc/libwebrtc/descriptionGetters.html:
        * webrtc/negotiatedneeded-event-addStream.html:
        * webrtc/peer-connection-audio-mute.html:
        * webrtc/peer-connection-audio-mute2.html:
        * webrtc/peer-connection-remote-audio-mute.html:
        * webrtc/peer-connection-remote-audio-mute2.html:
        * webrtc/release-after-getting-track.html:
        * webrtc/video-disabled-black.html:
        * webrtc/video-mute.html:
        * webrtc/video-remote-mute.html:
        * webrtc/video-with-receiver.html:
        * webrtc/video.html:

2017-04-11  Youenn Fablet  <youenn@apple.com>

        Activate WebRTC data channel tests for WK1
        https://bugs.webkit.org/show_bug.cgi?id=170710

        Reviewed by Eric Carlson.

        * platform/mac-wk1/TestExpectations:

2017-04-11  Youenn Fablet  <youenn@apple.com>

        MediaStream id should be equal to msid
        https://bugs.webkit.org/show_bug.cgi?id=170712

        Reviewed by Eric Carlson.

        Removing no longer needed/Adding needed calls to useMockRTCPeerConnectionFactory.

        * fast/mediastream/RTCPeerConnection-inspect-answer.html:
        * fast/mediastream/RTCPeerConnection-inspect-offer.html:
        * fast/mediastream/RTCPeerConnection-legacy-stream-based-api.html:
        * fast/mediastream/RTCPeerConnection-media-setup-single-dialog.html:
        * fast/mediastream/RTCPeerConnection-remotely-assigned-transceiver-mid.html:
        * fast/mediastream/RTCPeerConnection-setLocalDescription-offer.html:
        * fast/mediastream/RTCPeerConnection-setRemoteDescription-offer.html:
        * webrtc/audio-peer-connection-webaudio.html:
        * webrtc/audio-replace-track.html:
        * webrtc/connection-state.html:
        * webrtc/datachannel/basic.html:
        * webrtc/datachannel/bufferedAmountLowThreshold.html:
        * webrtc/datachannel/datachannel-gc.html:
        * webrtc/datachannel/datachannel-stats.html:
        * webrtc/datachannel/filter-ice-candidate.html:
        * webrtc/ephemeral-certificates-and-cnames.html:
        * webrtc/libwebrtc/descriptionGetters.html:
        * webrtc/negotiatedneeded-event-addStream.html:
        * webrtc/no-port-zero-in-upd-candidates.html:
        * webrtc/peer-connection-audio-mute.html:
        * webrtc/peer-connection-audio-mute2.html:
        * webrtc/peer-connection-remote-audio-mute.html:
        * webrtc/peer-connection-remote-audio-mute2.html:
        * webrtc/release-after-getting-track.html:
        * webrtc/video-disabled-black.html:
        * webrtc/video-getParameters.html:
        * webrtc/video-mediastreamtrack-stats.html:
        * webrtc/video-mute.html:
        * webrtc/video-remote-mute.html:
        * webrtc/video-replace-track-to-null.html:
        * webrtc/video-replace-track.html:
        * webrtc/video-stats.html:
        * webrtc/video-with-receiver.html:
        * webrtc/video.html:

2017-04-11  Chris Fleizach  <cfleizach@apple.com>

        AX: Web article navigation does not work (article rotor for Facebook, Twitter, Messages etc.)
        https://bugs.webkit.org/show_bug.cgi?id=170330
        <rdar://problem/31366105>

        Reviewed by Joanmarie Diggs.

        * accessibility/mac/search-predicate-article-expected.txt:
        * accessibility/mac/search-predicate-article.html:

2017-04-11  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/annexB/language/comments/multi-line-html-close.js
        https://bugs.webkit.org/show_bug.cgi?id=170648

        Reviewed by Keith Miller.

        * js/parser-xml-close-comment-expected.txt:
        * js/script-tests/parser-xml-close-comment.js:
        Update test coverage for JavaScript HTML comments.

2017-04-11  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/built-ins/Array/S15.4.3_A2.2.js
        https://bugs.webkit.org/show_bug.cgi?id=170652

        Reviewed by Michael Saboff.

        * ietestcenter/Javascript/15.2.3.3-4-186-expected.txt:
        * ietestcenter/Javascript/15.2.3.3-4-191-expected.txt:
        * ietestcenter/Javascript/15.2.3.3-4-194-expected.txt:
        * ietestcenter/Javascript/15.2.3.3-4-201-expected.txt:
        * ietestcenter/Javascript/15.3.3.2-1-expected.txt:
        * sputnik/Conformance/15_Native_Objects/15.4_Array/15.4.3/S15.4.3_A2.2-expected.txt:
        * sputnik/Conformance/15_Native_Objects/15.9_Date/15.9.5/15.9.5.1_Date.prototype.constructor/S15.9.5.1_A3_T2-expected.txt:
        These tests expected the opposite, they are now out of date.

2017-04-11  Yoav Weiss  <yoav@yoav.ws>

        [link preload] Double downloads of preloaded content when it's in MemoryCache
        https://bugs.webkit.org/show_bug.cgi?id=170122

        Reviewed by Antti Koivisto.

        * TestExpectations: Removed flakiness label from the header preload charset test.
        * fast/loader/cache-encoding-expected.txt: Changed expectation.
        * fast/loader/cache-encoding.html: Modified behavior to stick with the first decoded string.
        * http/tests/preload/preload-encoding-expected.txt: Changed expectation.
        * http/tests/preload/preload-encoding.html: Modified behavior to stick with the first decoded string.
        * imported/w3c/web-platform-tests/html/semantics/scripting-1/the-script-element/script-charset-01-expected.txt: This test refers to the same file
        twice and expects different decoding for it each time. This is the behavior that we modified, and therefore the test expectation is changed as well.

2017-04-11  Manuel Rego Casasnovas  <rego@igalia.com>

        [css-grid] Fix fast/css-grid-layout/grid-simplified-layout-positioned.html
        https://bugs.webkit.org/show_bug.cgi?id=167538

        Reviewed by Darin Adler.

        fast/css-grid-layout/grid-simplified-layout-positioned.html was flacky
        as the caret was not always painted in the test runner.
        The test was checking for a crash in simplified layout (see bug #163450)
        and has nothing to do with the caret or "autofocus" behavior.
        "autofocus" was needed to get the crash, so this change modifies
        the test to blur the element, so the caret is not painted anymore.

        * fast/css-grid-layout/grid-simplified-layout-positioned-expected.html:
        Don't focus the input element.
        * fast/css-grid-layout/grid-simplified-layout-positioned.html: Blur
        the input element to avoid showing the caret.
        * platform/mac-wk2/TestExpectations: Remove file from expectations.

2017-04-10  Jiewen Tan  <jiewen_tan@apple.com>

        Unreviewed, test expectations update

        * platform/wk2/TestExpectations:

2017-04-10  Ryan Haddad  <ryanhaddad@apple.com>

        Mark two newly imported web-platform-tests as failing.

        Unreviewed test gardening.

        * TestExpectations:

2017-04-10  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/volume-slider/volume-slider-value.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=167475

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-10  Wenson Hsieh  <wenson_hsieh@apple.com>

        REGRESSION (r214403): fast/events/drag-to-navigate.html and fast/events/only-valid-drop-targets-receive-file-drop.html failing
        https://bugs.webkit.org/show_bug.cgi?id=170677
        <rdar://problem/31512633>

        Reviewed by Tim Horton.

        Turn enableDragDestinationActionLoad on in these two LayoutTests via WKTR options.

        * fast/events/drag-to-navigate.html:
        * fast/events/only-valid-drop-targets-receive-file-drop.html:

2017-04-10  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/volume-up-support/volume-up-support.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170682

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-10  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline js/dom/global-constructors-attributes.html after r215131.

        Unreviewed test gardening.

        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-04-10  Andreas Kling  <akling@apple.com>

        Don't generate extra scrolling tiles for non-visible pages.
        https://bugs.webkit.org/show_bug.cgi?id=167213
        <rdar://problem/30105774>

        Reviewed by Antti Koivisto.

        * TestExpectations:
        * compositing/tiling/non-visible-window-tile-coverage-expected.txt: Added.
        * compositing/tiling/non-visible-window-tile-coverage.html: Added.
        * platform/mac-wk2/TestExpectations:

2017-04-10  Carlos Garcia Campos  <cgarcia@igalia.com>

        REGRESSION(r214426): [GTK] Test media/video-click-dblckick-standalone.html started to fail in the bots after r214426
        https://bugs.webkit.org/show_bug.cgi?id=170667

        Reviewed by Žan Doberšek.

        Unskip then test that is passing now.

        * platform/gtk/TestExpectations:

2017-04-10  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Mark several tests as failing/timing out.

        * platform/gtk/TestExpectations:

2017-04-10  Miguel Gomez  <magomez@igalia.com>

        REGRESSION(r205841): [GTK] Test fast/images/animated-png.html is failing since r205841
        https://bugs.webkit.org/show_bug.cgi?id=168425

        Reviewed by Said Abou-Hallawa.

        Adjusted expectation for fast/images/animated-png.html. It must pass now.

        * platform/gtk/TestExpectations:

2017-04-09  Devin Rousso  <webkit@devinrousso.com>

        Web Inspector: tabbing in Styles sidebar is broken when additional ":" and ";" are in the property value
        https://bugs.webkit.org/show_bug.cgi?id=170184

        Reviewed by Matt Baker.

        * inspector/unit-tests/text-utilities-expected.txt: Added.
        * inspector/unit-tests/text-utilities.html: Added.

2017-04-09  Youenn Fablet  <youenn@apple.com>

        Resync WPT tests up to 23cd07d4685d81024b7440e042f8bbdb33e7ddec
        https://bugs.webkit.org/show_bug.cgi?id=170647

        Reviewed by Sam Weinig.

        * TestExpectations:
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/http-cache/304-update-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/http-cache/cc-request-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/http-cache/heuristic-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/http-cache/invalidate-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/fetch/http-cache/status-expected.txt: Added.
        * platform/mac-wk1/imported/w3c/web-platform-tests/html/browsers/windows/browsing-context-expected.txt: Added.
        * platform/mac/TestExpectations:
        * tests-options.json:

2017-04-09  Joseph Pecoraro  <pecoraro@apple.com>

        test262: test262/test/annexB/language/literals/regexp/identity-escape.js
        https://bugs.webkit.org/show_bug.cgi?id=170651

        Reviewed by Saam Barati.

        * js/regexp-no-extensions-expected.txt:
        * js/script-tests/regexp-no-extensions.js:
        Update existing test for these edge cases.

2017-04-08  Myles C. Maxfield  <mmaxfield@apple.com>

        [Variation Fonts] Width values of GX fonts are not mapped correctly
        https://bugs.webkit.org/show_bug.cgi?id=170367

        Reviewed by Simon Fraser.

        * fast/text/variations/font-selection-properties-expected.html:
        * fast/text/variations/gx-width-expected.html: Added.
        * fast/text/variations/gx-width.html: Added.

2017-04-08  Said Abou-Hallawa  <sabouhallawa@apple.com>

        A synchronous DecodingOptions should be compatible with any asynchronous sizeForDrawing DecodingOptions
        https://bugs.webkit.org/show_bug.cgi?id=170577

        Reviewed by Simon Fraser.

        * fast/images/async-image-background-image-repeated-expected.html: Added.
        * fast/images/async-image-background-image-repeated.html: Added.

2017-04-08  Simon Fraser  <simon.fraser@apple.com>

        Unprefix CSS cursor values grab and grabbing
        https://bugs.webkit.org/show_bug.cgi?id=170543

        Reviewed by Jon Lee.

        Enhanced the cursor test to check round-tripping of all values.

        * fast/css/cursor-parsing-expected.txt:
        * fast/css/cursor-parsing.html:

2017-04-08  Youenn Fablet  <youenn@apple.com>

        WebRTC tests gardening
        https://bugs.webkit.org/show_bug.cgi?id=170508

        Reviewed by Eric Carlson.

        * platform/ios-wk1/TestExpectations:
        * platform/ios-wk2/TestExpectations:
        * platform/ios/TestExpectations:

2017-04-08  Youenn Fablet  <youenn@apple.com>

        MediaStreamTrack id should be preserved by PeerConnection
        https://bugs.webkit.org/show_bug.cgi?id=170624

        Reviewed by Eric Carlson.

        * webrtc/video.html:

2017-04-07  Chris Dumez  <cdumez@apple.com>

        Unreviewed, update 2 media tests after r215120 so they work on iOS.

        Setting the volume is a no-op on iOS so mute the video instead.

        * media/video-restricted-invisible-autoplay-allowed-when-visible.html:
        * media/video-restricted-invisible-autoplay-not-allowed.html:

2017-04-07  Yuichiro Kikura  <y.kikura@gmail.com>

        WebGPU: implement ComputeCommandEncoder and related components    
        https://bugs.webkit.org/show_bug.cgi?id=170444

        Reviewed by Alex Christensen.

        Added a test case to ensure ComputeCommandEncoder is dispatched successfully

        * fast/canvas/webgpu/webgpu-dispatch-expected.txt: Added.
        * fast/canvas/webgpu/webgpu-dispatch.html: Added.

2017-04-07  Zalan Bujtas  <zalan@apple.com>

        Simple line layout: FlowContents::segmentIndexForRunSlow skips empty runs.
        https://bugs.webkit.org/show_bug.cgi?id=170552

        Reviewed by Antti Koivisto.

        * fast/text/simple-line-layout-hover-over-subsequent-linebreaks-expected.txt: Added.
        * fast/text/simple-line-layout-hover-over-subsequent-linebreaks.html: Added.

2017-04-07  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/media-controller/media-controller-auto-hide-mouse-leave-after-play.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=168540

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-07  Ryan Haddad  <ryanhaddad@apple.com>

        Mark inspector/codemirror/prettyprinting-css.html as a flaky timeout.
        https://bugs.webkit.org/show_bug.cgi?id=170615

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-07  Chris Dumez  <cdumez@apple.com>

        Audible autoplay videos should not get paused when outside the viewport
        https://bugs.webkit.org/show_bug.cgi?id=170610
        <rdar://problem/31505984>

        Reviewed by Eric Carlson.

        Add layout test coverage.

        * media/video-restricted-invisible-autoplay-allowed-if-audible-expected.txt: Added.
        * media/video-restricted-invisible-autoplay-allowed-if-audible.html: Copied from LayoutTests/media/video-restricted-invisible-autoplay-not-allowed.html.
        * media/video-restricted-invisible-autoplay-allowed-when-visible.html:
        * media/video-restricted-invisible-autoplay-not-allowed.html:

2017-04-07  Chris Dumez  <cdumez@apple.com>

        Throttle / Align DOM Timers in cross-origin iframes to 30fps
        https://bugs.webkit.org/show_bug.cgi?id=170613
        <rdar://problem/31506444>

        Reviewed by Simon Fraser.

        Add layout test coverage.

        * http/tests/frame-throttling/resources/timer-throttling-frame.html: Added.
        * http/tests/frame-throttling/timer-throttle-in-cross-origin-subframe-expected.txt: Added.
        * http/tests/frame-throttling/timer-throttle-in-cross-origin-subframe.html: Added.

2017-04-07  Brent Fulgham  <bfulgham@apple.com>

        Rebaseline additional tests after r215096.
        https://bugs.webkit.org/show_bug.cgi?id=170561
        <rdar://problem/7415154>

        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-cross-in-cross-none-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-cross-in-cross-self-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-cross-in-same-none-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-cross-in-same-self-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-same-in-cross-none-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-same-in-cross-self-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-nested-same-in-same-none-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-none-block-expected.txt:
        * http/tests/security/contentSecurityPolicy/1.1/frame-ancestors/frame-ancestors-self-block-expected.txt:
        * http/tests/security/no-popup-from-sandbox-top-expected.txt:
        * http/tests/xmlhttprequest/origin-exact-matching-expected.txt:

2017-04-07  Brent Fulgham  <bfulgham@apple.com>

        WebKit should percent encode single quotes in query strings
        https://bugs.webkit.org/show_bug.cgi?id=170561
        <rdar://problem/7415154>

        Reviewed by Alex Christensen.

        Rebaseline tests after change.

        * fast/events/popup-blocked-from-unique-frame-via-window-open-named-sibling-frame-expected.txt:
        * fast/frames/xss-auditor-handles-file-urls-expected.txt:
        * http/tests/security/xssAuditor/base-href-control-char-expected.txt:
        * http/tests/security/xssAuditor/base-href-expected.txt:
        * http/tests/security/xssAuditor/base-href-null-char-expected.txt:
        * http/tests/security/xssAuditor/base-href-scheme-relative-expected.txt:
        * http/tests/security/xssAuditor/embed-tag-control-char-expected.txt:
        * http/tests/security/xssAuditor/embed-tag-expected.txt:
        * http/tests/security/xssAuditor/embed-tag-javascript-url-expected.txt:
        * http/tests/security/xssAuditor/embed-tag-null-char-expected.txt:
        * http/tests/security/xssAuditor/form-action-expected.txt:
        * http/tests/security/xssAuditor/formaction-on-button-expected.txt:
        * http/tests/security/xssAuditor/formaction-on-input-expected.txt:
        * http/tests/security/xssAuditor/frameset-injection-expected.txt:
        * http/tests/security/xssAuditor/full-block-base-href-expected.txt:
        * http/tests/security/xssAuditor/full-block-link-onclick-expected.txt:
        * http/tests/security/xssAuditor/full-block-object-tag-expected.txt:
        * http/tests/security/xssAuditor/full-block-script-tag-with-source-expected.txt:
        * http/tests/security/xssAuditor/iframe-injection-expected.txt:
        * http/tests/security/xssAuditor/iframe-javascript-url-more-encoding-expected.txt:
        * http/tests/security/xssAuditor/img-onerror-non-ASCII-char-default-encoding-expected.txt:
        * http/tests/security/xssAuditor/img-onerror-non-ASCII-char-expected.txt:
        * http/tests/security/xssAuditor/link-onclick-ampersand-expected.txt:
        * http/tests/security/xssAuditor/link-onclick-control-char-expected.txt:
        * http/tests/security/xssAuditor/link-onclick-entities-expected.txt:
        * http/tests/security/xssAuditor/link-onclick-expected.txt:
        * http/tests/security/xssAuditor/link-onclick-null-char-expected.txt:
        * http/tests/security/xssAuditor/object-embed-tag-control-char-expected.txt:
        * http/tests/security/xssAuditor/object-embed-tag-expected.txt:
        * http/tests/security/xssAuditor/object-embed-tag-null-char-expected.txt:
        * http/tests/security/xssAuditor/object-tag-expected.txt:
        * http/tests/security/xssAuditor/object-tag-javascript-url-expected.txt:
        * http/tests/security/xssAuditor/script-tag-expression-follows-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-16bit-unicode4-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-16bit-unicode5-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-comma-01-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-source-control-char-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-source-entities-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-source-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-source-null-char-expected.txt:
        * http/tests/security/xssAuditor/script-tag-with-source-same-host-with-query-expected.txt:
        * http/tests/security/xssAuditor/svg-animate-expected.txt:
        * http/tests/security/xssAuditor/svg-script-tag-expected.txt:
        * http/tests/security/xssAuditor/xss-filter-bypass-big5-expected.txt:
        * http/tests/security/xssAuditor/xss-filter-bypass-sjis-expected.txt:

2017-04-07  Youenn Fablet  <youenn@apple.com>

        Improve some WebRTC flaky tests
        https://bugs.webkit.org/show_bug.cgi?id=170584

        Reviewed by Alex Christensen.

        * webrtc/libwebrtc/descriptionGetters.html:
        * webrtc/video-replace-track-to-null.html:

2017-04-07  Zalan Bujtas  <zalan@apple.com>

        Text insertion cursor disappears after pressing enter
        https://bugs.webkit.org/show_bug.cgi?id=169291
        <rdar://problem/30899611>

        Reviewed by Tim Horton.

        * editing/simple-line-layout-caret-is-gone-expected.txt: Added.
        * editing/simple-line-layout-caret-is-gone.html: Added.

2017-04-06  Myles C. Maxfield  <mmaxfield@apple.com>

        Make FontWithFeatures test font pass OTS
        https://bugs.webkit.org/show_bug.cgi?id=169788

        Reviewed by Tim Horton.

        Updated font to the one which passes the tests.

        * css3/resources/FontWithFeatures.otf:

2017-04-06  Jiewen Tan  <jiewen_tan@apple.com>

        LayoutTest crypto/subtle/aes-ctr-encrypt-malformed-parameters.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=170571

        Unreviewed.

        * crypto/subtle/aes-ctr-encrypt-malformed-parameters-expected.txt:
        * crypto/subtle/aes-ctr-encrypt-malformed-parameters.html:

2017-04-06  Wenson Hsieh  <wenson_hsieh@apple.com>

        Scroll offset jumps after a programmatic scroll in an overflow container with scroll snapping
        https://bugs.webkit.org/show_bug.cgi?id=170560
        <rdar://problem/31484693>

        Reviewed by Tim Horton.

        Add a test verifying that programmatically changing the scroll offset of an overflow container does not cause the
        scroll offset to jump back to the last active snap position. See WebCore ChangeLog for more details.

        * css3/scroll-snap/scroll-snap-programmatic-overflow-scroll-expected.txt: Added.
        * css3/scroll-snap/scroll-snap-programmatic-overflow-scroll.html: Added.

2017-04-05  Simon Fraser  <simon.fraser@apple.com>

        Throttle requestAnimationFrame in cross-origin iframes to 30fps
        https://bugs.webkit.org/show_bug.cgi?id=170534

        Reviewed by Dan Bates.

        * http/tests/frame-throttling/raf-throttle-in-cross-origin-subframe-expected.txt: Added.
        * http/tests/frame-throttling/raf-throttle-in-cross-origin-subframe.html: Added.
        * http/tests/frame-throttling/resources/requestAnimationFrame-frame.html: Added.

2017-04-06  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r215041.

        The LayoutTest for this change is failing on ios-simulator.

        Reverted changeset:

        "Rendering flexbox children across columns"
        https://bugs.webkit.org/show_bug.cgi?id=164166
        http://trac.webkit.org/changeset/215041

2017-04-06  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r215046.

        This change broke internal builds.

        Reverted changeset:

        "WebRTC tests gardening"
        https://bugs.webkit.org/show_bug.cgi?id=170508
        http://trac.webkit.org/changeset/215046

2017-04-06  Ryan Haddad  <ryanhaddad@apple.com>

        Skip a test that was accidentally enabled with r214982.

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-04-06  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Show all headers in the Request Headers section of the Resource details sidebar
        https://bugs.webkit.org/show_bug.cgi?id=16531
        <rdar://problem/5712895>

        Reviewed by Timothy Hatcher.

        * http/tests/inspector/network/resource-request-headers-expected.txt: Added.
        * http/tests/inspector/network/resource-request-headers.html: Added.
        * http/tests/inspector/network/resources/basic-auth.php: Added.
        Test coverage for Cookie and Basic Authentication headers.

        * platform/mac/TestExpectations:
        * platform/mac-wk1/TestExpectations:
        * platform/win/TestExpectations:
        Mark the test as expected to fail on WebKit1 CFNetwork based platforms,
        and ElCapitan which uses the legacy non-NSURLSession loading path.

2017-04-06  Youenn Fablet  <youenn@apple.com>

        LayoutTest fast/mediastream/getUserMedia-webaudio.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=167513

        Reviewed by Eric Carlson.

        * fast/mediastream/getUserMedia-webaudio.html: Removing unecessary flaky check.

2017-04-06  Zalan Bujtas  <zalan@apple.com>

        Simple line layout: Hittest always returns the first renderer in the block.
        https://bugs.webkit.org/show_bug.cgi?id=170520
        <rdar://problem/30979175>

        Reviewed by Antti Koivisto.

        * fast/dom/Document/CaretRangeFromPoint/simple-line-layout-hittest-with-caret-range-from-point-expected.html: Added.
        * fast/dom/Document/CaretRangeFromPoint/simple-line-layout-hittest-with-caret-range-from-point.html: Added.

2017-03-31  Jiewen Tan  <jiewen_tan@apple.com>

        [WebCrypto] Add support for AES-CTR
        https://bugs.webkit.org/show_bug.cgi?id=169761
        <rdar://problem/31331321>

        Reviewed by Brent Fulgham.

        * crypto/subtle/aes-ctr-encrypt-malformed-parameters-expected.txt: Added.
        * crypto/subtle/aes-ctr-encrypt-malformed-parameters.html: Added.
        * crypto/subtle/aes-ctr-generate-export-key-jwk-length-128-expected.txt: Added.
        * crypto/subtle/aes-ctr-generate-export-key-jwk-length-128.html: Added.
        * crypto/subtle/aes-ctr-generate-export-key-jwk-length-192-expected.txt: Added.
        * crypto/subtle/aes-ctr-generate-export-key-jwk-length-192.html: Added.
        * crypto/subtle/aes-ctr-generate-export-key-jwk-length-256-expected.txt: Added.
        * crypto/subtle/aes-ctr-generate-export-key-jwk-length-256.html: Added.
        * crypto/subtle/aes-ctr-generate-export-raw-key-expected.txt: Added.
        * crypto/subtle/aes-ctr-generate-export-raw-key.html: Added.
        * crypto/subtle/aes-ctr-generate-key-encrypt-decrypt-expected.txt: Added.
        * crypto/subtle/aes-ctr-generate-key-encrypt-decrypt.html: Added.
        * crypto/subtle/aes-ctr-generate-key-expected.txt: Added.
        * crypto/subtle/aes-ctr-generate-key.html: Added.
        * crypto/subtle/aes-ctr-import-jwk-key-length-128-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-jwk-key-length-128.html: Added.
        * crypto/subtle/aes-ctr-import-jwk-key-length-192-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-jwk-key-length-192.html: Added.
        * crypto/subtle/aes-ctr-import-jwk-key-length-256-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-jwk-key-length-256.html: Added.
        * crypto/subtle/aes-ctr-import-key-decrypt-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-key-decrypt.html: Added.
        * crypto/subtle/aes-ctr-import-key-encrypt-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-key-encrypt.html: Added.
        * crypto/subtle/aes-ctr-import-key-unwrap-jwk-key-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-key-unwrap-jwk-key.html: Added.
        * crypto/subtle/aes-ctr-import-key-unwrap-raw-key-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-key-unwrap-raw-key.html: Added.
        * crypto/subtle/aes-ctr-import-key-wrap-jwk-key-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-key-wrap-jwk-key.html: Added.
        * crypto/subtle/aes-ctr-import-key-wrap-raw-key-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-key-wrap-raw-key.html: Added.
        * crypto/subtle/aes-ctr-import-raw-key-expected.txt: Added.
        * crypto/subtle/aes-ctr-import-raw-key.html: Added.
        * crypto/subtle/aes-generate-key-malformed-parameters-expected.txt:
        * crypto/subtle/aes-generate-key-malformed-parameters.html:
        * crypto/subtle/aes-import-key-malformed-parameters-expected.txt:
        * crypto/subtle/aes-import-key-malformed-parameters.html:
        * crypto/workers/subtle/aes-ctr-import-key-decrypt-expected.txt: Added.
        * crypto/workers/subtle/aes-ctr-import-key-decrypt.html: Added.
        * crypto/workers/subtle/aes-ctr-import-key-encrypt-expected.txt: Added.
        * crypto/workers/subtle/aes-ctr-import-key-encrypt.html: Added.
        * crypto/workers/subtle/aes-ctr-import-key-unwrap-key-expected.txt: Added.
        * crypto/workers/subtle/aes-ctr-import-key-unwrap-key.html: Added.
        * crypto/workers/subtle/aes-ctr-import-key-wrap-key-expected.txt: Added.
        * crypto/workers/subtle/aes-ctr-import-key-wrap-key.html: Added.
        * crypto/workers/subtle/resources/aes-ctr-import-key-decrypt.js: Added.
        * crypto/workers/subtle/resources/aes-ctr-import-key-encrypt.js: Added.
        * crypto/workers/subtle/resources/aes-ctr-import-key-unwrap-key.js: Added.
        * crypto/workers/subtle/resources/aes-ctr-import-key-wrap-key.js: Added.

2017-04-06  Ryan Haddad  <ryanhaddad@apple.com>

        Mark inspector/codemirror/prettyprinting-css-rules.html as flaky on release.
        https://bugs.webkit.org/show_bug.cgi?id=153460

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-06  Youenn Fablet  <youenn@apple.com>

        WebRTC tests gardening
        https://bugs.webkit.org/show_bug.cgi?id=170508

        Reviewed by Eric Carlson.

        * platform/ios-wk1/TestExpectations:
        * platform/ios-wk2/TestExpectations:
        * platform/ios/TestExpectations:

2017-04-06  Antti Koivisto  <antti@apple.com>

        Implement testing mode for disk cache
        https://bugs.webkit.org/show_bug.cgi?id=170547

        Reviewed by Andreas Kling.

        Enable a few disabled tests to see how it goes.

        * platform/mac-wk2/TestExpectations:

2017-04-06  Romain Bellessort  <romain.bellessort@crf.canon.fr>

        [Readable Streams API] Implement ReadableStreamBYOBRequest respondWithNewView()
        https://bugs.webkit.org/show_bug.cgi?id=170339

        Reviewed by Youenn Fablet.

        Added new tests addressing respondWithNewView() behaviour.

        * streams/readable-stream-byob-request-expected.txt: Updated.
        * streams/readable-stream-byob-request.js: Added new tests.

2017-04-06  Dave Hyatt  <hyatt@apple.com>

        Rendering flexbox children across columns
        https://bugs.webkit.org/show_bug.cgi?id=164166
        <rdar://problem/29055587>

        Reviewed by Zalan Bujtas.

        * fast/multicol/flexbox-rows-expected.html: Added.
        * fast/multicol/flexbox-rows.html: Added.

2017-04-05  Simon Fraser  <simon.fraser@apple.com>

        Set lastHandledUserGestureTimestamp on all ancestor documents, not just the top document
        https://bugs.webkit.org/show_bug.cgi?id=170479

        Reviewed by Sam Weinig.

        * fast/frames/user-gesture-timestamp-propagation-expected.txt: Added.
        * fast/frames/user-gesture-timestamp-propagation.html: Added.
        * platform/ios/TestExpectations:

2017-04-05  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] Host application should be able to mute and unmute media streams
        https://bugs.webkit.org/show_bug.cgi?id=170519
        <rdar://problem/31174326>

        Reviewed by Youenn Fablet.

        * fast/mediastream/MediaStream-page-muted-expected.txt:
        * fast/mediastream/MediaStream-page-muted.html:

2017-04-05  Javier Fernandez  <jfernandez@igalia.com>

        [css-align] Implement the place-items shorthand
        https://bugs.webkit.org/show_bug.cgi?id=168847

        Reviewed by David Hyatt.

        Regression tests for the new place-content alignment shorthand.

        * css3/parse-place-items.html: Added.

2017-04-05  Carlos Alberto Lopez Perez  <clopez@igalia.com>

        [WebRTC][OpenWebRTC] Add support for SDP BUNDLE ("a:group:BUNDLE" and "a=bundle-only" lines)
        https://bugs.webkit.org/show_bug.cgi?id=170157

        Reviewed by Alejandro G. Castro.

        The test fast/mediastream/RTCPeerConnection-inspect-offer-bundlePolicy-bundle-only.html
        is used to check that we generate the "a=bundle-only" lines on the "m=" sections
        according to the bundlePolicy. The 3 possible values of bundlePolicy are tested.
        To properly test bundlePolicy:"balanced" we generate 5 extra tracks (6 in total)
        for each one of the audio media type and video media type.

        * TestExpectations: Set RTCPeerConnection-inspect-offer-bundlePolicy-bundle-only.html
        as failing in the general TestExpectations, because the libwebrtc backend currently
        doesn't generate the expected a=bundle-only lines.
        On the GTK+ port TestExpectations file this is overriden, and the test is marked to pass.
        The whole fast/mediastream directory is already overriden to pass.
        * fast/mediastream/RTCPeerConnection-inspect-offer-bundlePolicy-bundle-only-expected.txt: Added.
        * fast/mediastream/RTCPeerConnection-inspect-offer-bundlePolicy-bundle-only.html: Added.
        * fast/mediastream/resources/sdp-utils.js:
        (printComparableSessionDescription): Validate the a=group:BUNDLE line to contain the required MID identifiers.
        * platform/gtk/fast/mediastream/RTCPeerConnection-inspect-answer-expected.txt: Added. Rebaseline with the expected a=group:BUNDLE line.
        * platform/gtk/fast/mediastream/RTCPeerConnection-inspect-offer-expected.txt: Added. Rebaseline with the expected a=group:BUNDLE line.

2017-04-05  Jer Noble  <jer.noble@apple.com>

        [MSE] Seeks to currentTime=0 will fail if currentTime is already 0.
        https://bugs.webkit.org/show_bug.cgi?id=170510

        Reviewed by Eric Carlson.

        * media/media-source/media-source-unnecessary-seek-seeked-expected.txt: Added.
        * media/media-source/media-source-unnecessary-seek-seeked.html: Added.

2017-04-05  Matt Baker  <mattbaker@apple.com>

        Web Inspector: XHR breakpoints should be global
        https://bugs.webkit.org/show_bug.cgi?id=170033

        Reviewed by Joseph Pecoraro..

        * inspector/dom-debugger/xhr-breakpoints.html:
        Update for XHRBreakpoint constructor change.

2017-04-05  Chris Dumez  <cdumez@apple.com>

        <input type="range"> changing to disabled while active breaks all pointer events
        https://bugs.webkit.org/show_bug.cgi?id=170447
        <rdar://problem/31442875>

        Reviewed by Geoffrey Garen.

        Add layout test coverage.

        * fast/forms/range/disabled-while-dragging-expected.txt: Added.
        * fast/forms/range/disabled-while-dragging.html: Added.

2017-04-05  Jiewen Tan  <jiewen_tan@apple.com>

        Unreviewed, rebasing crypto/subtle/rsa-import-key-malformed-parameters.html
        <rdar://problem/31322400>

        * crypto/subtle/rsa-import-key-malformed-parameters-expected.txt:
        * crypto/subtle/rsa-import-key-malformed-parameters.html:

2017-04-05  Youenn Fablet  <youenn@apple.com>

        Deprecate and remove URL.createObjectURL(mediastream)
        https://bugs.webkit.org/show_bug.cgi?id=167518
        <rdar://problem/31149607>

        Reviewed by Eric Carlson.

        * fast/mediacapturefromelement/CanvasCaptureMediaStream-2d-events.html:
        * fast/mediacapturefromelement/CanvasCaptureMediaStream-request-frame-events.html:
        * fast/mediacapturefromelement/CanvasCaptureMediaStream-webgl-events.html:
        * fast/mediastream/MediaStream-video-element-displays-buffer-expected.txt:
        * fast/mediastream/MediaStream-video-element-displays-buffer.html:
        * fast/mediastream/MediaStream-video-element-expected.txt:
        * fast/mediastream/MediaStream-video-element-track-stop-expected.txt:
        * fast/mediastream/MediaStream-video-element-track-stop.html:
        * fast/mediastream/MediaStream-video-element-video-tracks-disabled-then-enabled-expected.txt:
        * fast/mediastream/MediaStream-video-element-video-tracks-disabled.html:
        * fast/mediastream/MediaStream-video-element.html:
        * fast/mediastream/resources/getUserMedia-helper.js:
        (setupVideoElementWithStream):

2017-04-05  Javier Fernandez  <jfernandez@igalia.com>

        [GTK] Unreviewed tests gardening
        https://bugs.webkit.org/show_bug.cgi?id=170497

        Unreviewed test gardening. Rebaseline tests after r214712.

        * platform/gtk/fast/multicol/table-vertical-align-expected.txt:


2017-04-04  Alexey Proskuryakov  <ap@apple.com>

        Mark imported/w3c/web-platform-tests/fetch/api/response/response-trailer.html as flaky
        for https://bugs.webkit.org/show_bug.cgi?id=170493

        * platform/mac/TestExpectations:

2017-04-04  Youenn Fablet  <youenn@apple.com>

        Canvas is tainted when painting a video with MediaStreamTrack
        https://bugs.webkit.org/show_bug.cgi?id=170486

        Reviewed by Eric Carlson.

        * http/tests/media/media-stream/getusermedia-with-canvas-expected.txt: Added.
        * http/tests/media/media-stream/getusermedia-with-canvas.html: Added.
        * http/tests/media/media-stream/resources/getUserMedia-helper.js: Added.
        (reject):
        (getUserMedia):
        (defaultRejectOrCatch):
        (setupVideoElementWithStream):

2017-04-04  Youenn Fablet  <youenn@apple.com>

        [Mac] Add back web audio support for getUserMedia MediaStreamTrack
        https://bugs.webkit.org/show_bug.cgi?id=170482

        Reviewed by Eric Carlson.

        * TestExpectations:

2017-04-04  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/images/slower-animation-than-decoding-image.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=168390

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-04  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/images/reset-image-animation.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170177

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-04-04  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/airplay-button/airplay-button.html as flaky on mac-wk1 Release.
        https://bugs.webkit.org/show_bug.cgi?id=168409

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-04  Brent Fulgham  <bfulgham@apple.com>

        Do not assert when CharacterData representing an Attr fires events
        https://bugs.webkit.org/show_bug.cgi?id=170454
        <rdar://problem/30979320>

        Reviewed by Ryosuke Niwa.

        * fast/dom/no-assert-for-malformed-js-url-attribute-expected.txt: Added.
        * fast/dom/no-assert-for-malformed-js-url-attribute.html: Added.

2017-04-04  Youenn Fablet  <youenn@apple.com>

        LayoutTest webrtc/libwebrtc/descriptionGetters.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=169481

        Reviewed by Eric Carlson.

        * platform/mac-wk2/TestExpectations: Removing flaky expectation.
        * webrtc/datachannel/basic.html:

2017-04-04  Ryan Haddad  <ryanhaddad@apple.com>

        Add back results that were accidentally removed with r214848.
        https://bugs.webkit.org/show_bug.cgi?id=169301

        Unreviewed test gardening.

        * platform/mac/fast/text/international/synthesized-italic-vertical-latin-expected.png: Added.
        * platform/mac/fast/text/international/synthesized-italic-vertical-latin-expected.txt: Added.

2017-04-04  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/macos-inline-media-controls/macos-inline-media-controls-buttons-styles.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170456

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-04-04  Youenn Fablet  <youenn@apple.com>

        webrtc/peer-connection-audio-mute.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=170451

        Reviewed by Eric Carlson.

        * TestExpectations: Removed flaky expectation for webrtc/peer-connection-audio-mute.html.
        * webrtc/peer-connection-remote-audio-mute.html: Added timer to ensure setting enable propagates.
        Decreasing time spent at detecting hum or not.
        * webrtc/peer-connection-remote-audio-mute2.html: Ditto (but keeping flakiness expectation for now).

2017-04-04  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/images/animated-gif-webkit-transform.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170410

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:

2017-04-03  Alexey Proskuryakov  <ap@apple.com>

        Re-adding flaky timeout expectation for http/tests/loading/resourceLoadStatistics/non-prevalent-resource-with-user-interaction.html

        This test still times out, most of the time.

        * platform/wk2/TestExpectations:

2017-04-03  Javier Fernandez  <jfernandez@igalia.com>

        [css-align] Adapt place-content alignment shorthand to the new baseline syntax
        https://bugs.webkit.org/show_bug.cgi?id=170340

        Reviewed by David Hyatt.

        Added additional test cases to evaluate the new baseline-alignment syntax.

        * css3/parse-place-content-expected.txt:
        * css3/parse-place-content.html:

2017-04-03  Nan Wang  <n_wang@apple.com>

        AX: Expose link children when doing search predication on iOS
        https://bugs.webkit.org/show_bug.cgi?id=170424
        <rdar://problem/31413335>

        Reviewed by Chris Fleizach.

        * accessibility/ios-simulator/ios-search-predicate-link-children-expected.txt: Added.
        * accessibility/ios-simulator/ios-search-predicate-link-children.html: Added.

2017-04-03  Dave Hyatt  <hyatt@apple.com>

        Japanese fonts in vertical text should support synthesized italics
        https://bugs.webkit.org/show_bug.cgi?id=169301

        Reviewed by Simon Fraser.

        * fast/text/international/synthesized-italic-vertical-expected.html:
        * fast/text/international/synthesized-italic-vertical.html:
        * platform/mac/fast/text/international/synthesized-italic-vertical-latin-expected.png: Removed.
        * platform/mac/fast/text/international/synthesized-italic-vertical-latin-expected.txt: Removed.

2017-04-03  Chris Dumez  <cdumez@apple.com>

        REGRESSION (r206744): CSS background-image in style attribute ignored when using createHTMLDocument method of DOM parsing
        https://bugs.webkit.org/show_bug.cgi?id=170285
        <rdar://problem/31378543>

        Reviewed by Andy Estes.

        Add layout test coverage.

        * fast/images/background-image-relative-url-changes-document-expected.html: Added.
        * fast/images/background-image-relative-url-changes-document.html: Added.

2017-04-03  John Wilander  <wilander@apple.com>

        Remove timeout expectations after bug fix
        https://bugs.webkit.org/show_bug.cgi?id=168262

        Unreviewed test gardening.

        Remove timeout expectations after bug fix in
        https://bugs.webkit.org/show_bug.cgi?id=170400

        * platform/wk2/TestExpectations:
            Remove expected timeout for the first five test cases
            under http/tests/loading/resourceLoadStatistics/.

2017-04-03  Antti Koivisto  <antti@apple.com>

        REGRESSION (r207669): FileMaker Pro Help pages do not render correctly
        https://bugs.webkit.org/show_bug.cgi?id=170402
        <rdar://problem/31004344>

        Reviewed by Simon Fraser.

        * fast/css/document-stylesheets-dynamic-expected.html: Added.
        * fast/css/document-stylesheets-dynamic.html: Added.

2017-04-03  Jeremy Jones  <jeremyj@apple.com>

        LayoutTest pointer-lock/mouse-event-delivery.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=167965

        Reviewed by Jon Lee.

        Wait for wheel event before doing next step of test. The wheel event is delivered asynchronously and
        can therefore be delivered later than expected by the test. This is already done for the first one,
        do this for the second one also.

        * platform/mac-wk2/TestExpectations:
        * pointer-lock/mouse-event-delivery.html:

2017-04-01  Simon Fraser  <simon.fraser@apple.com>

        Clean up touch event handler registration when moving nodes between documents
        https://bugs.webkit.org/show_bug.cgi?id=170384
        rdar://problem/30816694

        Reviewed by Chris Dumez.

        Tests for moving nodes with various listener/handler combinations between documents.

        * fast/events/touch/ios/gesture-node-move-between-documents-expected.txt: Added.
        * fast/events/touch/ios/gesture-node-move-between-documents.html: Added.
        * fast/events/touch/ios/overflow-node-move-between-documents-expected.txt: Added.
        * fast/events/touch/ios/overflow-node-move-between-documents.html: Added.
        * fast/events/touch/ios/slider-node-move-between-documents-expected.txt: Added.
        * fast/events/touch/ios/slider-node-move-between-documents.html: Added.
        * fast/events/touch/ios/touch-node-move-between-documents-expected.txt: Added.
        * fast/events/touch/ios/touch-node-move-between-documents.html: Added.

2017-04-03  Carlos Garcia Campos  <cgarcia@igalia.com>

        [SOUP] URI Fragment is lost after redirect
        https://bugs.webkit.org/show_bug.cgi?id=170058

        Reviewed by Michael Catanzaro.

        Add tests to check we correctly handle fragment identifiers on server redirections.

        * http/tests/navigation/redirect-preserves-fragment-expected.txt: Added.
        * http/tests/navigation/redirect-preserves-fragment.html: Added.
        * http/tests/navigation/redirect-to-fragment-expected.txt: Added.
        * http/tests/navigation/redirect-to-fragment.html: Added.
        * http/tests/navigation/redirect-to-fragment2-expected.txt: Added.
        * http/tests/navigation/redirect-to-fragment2.html: Added.
        * http/tests/navigation/resources/redirect-preserves-fragment.php: Added.
        * http/tests/navigation/resources/redirect-to-fragment.php: Added.
        * http/tests/navigation/resources/redirect-to-fragment2.php: Added.
        * platform/ios/TestExpectations:
        * platform/mac/TestExpectations:

2017-04-03  Youenn Fablet  <youenn@apple.com>

        captureStream is getting black frames with webgl canvas
        https://bugs.webkit.org/show_bug.cgi?id=170325

        Reviewed by Dean Jackson.

        * fast/mediastream/captureStream/canvas3d-expected.txt: Added.
        * fast/mediastream/captureStream/canvas3d.html: Added.

2017-04-03  Per Arne Vollan  <pvollan@apple.com>

        Implement stroke-miterlimit.
        https://bugs.webkit.org/show_bug.cgi?id=169078

        Reviewed by Dean Jackson.

        * fast/css/stroke-miterlimit-default-expected.html: Added.
        * fast/css/stroke-miterlimit-default.html: Added.
        * fast/css/stroke-miterlimit-large-expected-mismatch.html: Added.
        * fast/css/stroke-miterlimit-large.html: Added.
        * fast/css/stroke-miterlimit-zero-expected-mismatch.html: Added.
        * fast/css/stroke-miterlimit-zero.html: Added.

2017-04-02  Alexey Proskuryakov  <ap@apple.com>

        Remove accidentally added DumpJSConsoleLogInStdErr from http/tests/fetch/fetch-in-worker-crash.html expectation.

        * TestExpectations:

2017-04-02  Alexey Proskuryakov  <ap@apple.com>

        Build fix for
        Add missing text styles
        https://bugs.webkit.org/show_bug.cgi?id=170295

        * platform/ios/ios/fast/text/opticalFontWithTextStyle-expected.txt:

2017-04-02  Alexey Proskuryakov  <ap@apple.com>

        Fix lint errors.

        * TestExpectations:
        * platform/ios-wk1/TestExpectations:
        * platform/ios-wk2/TestExpectations:
        * platform/ios/TestExpectations:
        * platform/mac-wk1/TestExpectations:

2017-04-02  Alexey Proskuryakov  <ap@apple.com>

        Mark http/tests/fetch/fetch-in-worker-crash.html and imported/w3c/web-platform-tests/fetch/api/cors/cors-preflight-status.html as flaky.

        For https://bugs.webkit.org/show_bug.cgi?id=170395
        rdar://problem/30975761, rdar://problem/31394017

        * TestExpectations:

2017-04-01  Per Arne Vollan  <pvollan@apple.com>

        Add test for expected fallback behavior between stroke-width and -webkit-text-stroke-width.
        https://bugs.webkit.org/show_bug.cgi?id=169466

        Reviewed by Jon Lee.

        Now that we have added support for stroke-width, we should have a test for expected fallback behavior between
        stroke-width and -webkit-text-stroke-width. Currently, stroke-width is always preferred, also when inherited,
        and when -webkit-text-stroke-width is declared inline. When stroke-width is not specified, we fall back to
        -webkit-text-stroke-width.

        * fast/css/stroke-width-fallback-expected.html: Added.
        * fast/css/stroke-width-fallback.html: Added.

2017-04-01  Jon Lee  <jonlee@apple.com>

        Add missing text styles
        https://bugs.webkit.org/show_bug.cgi?id=170295
        rdar://problem/30219503

        Reviewed by Dean Jackson.

        * platform/ios/ios/fast/text/opticalFontWithTextStyle.html: Update test to include title0 and title4.

2017-04-01  Chris Dumez  <cdumez@apple.com>

        We should pause silent WebAudio rendering in background tabs
        https://bugs.webkit.org/show_bug.cgi?id=170299
        <rdar://problem/31289132>

        Reviewed by Eric Carlson.

        Add layout test coverage.

        * webaudio/silent-audio-interrupted-in-background-expected.txt: Added.
        * webaudio/silent-audio-interrupted-in-background.html: Added.

2017-04-01  Alexey Proskuryakov  <ap@apple.com>

        Rolling back http://trac.webkit.org/r214663 - memory corruption

        * streams/readable-stream-byob-request-expected.txt:
        * streams/readable-stream-byob-request.js:
        (self.importScripts.test): Deleted.

2017-03-31  Zalan Bujtas  <zalan@apple.com>

        <table>: Including <caption>, <thead> or <tbody> causes clipping across page breaks
        https://bugs.webkit.org/show_bug.cgi?id=170348
        <rdar://problem/24727151>

        Reviewed by David Hyatt.

        * fast/multicol/table-section-page-break-expected.html: Added.
        * fast/multicol/table-section-page-break.html: Added.

2017-03-31  Chris Dumez  <cdumez@apple.com>

        LayoutTest fast/images/animated-gif-restored-from-bfcache.html is a flaky failure
        https://bugs.webkit.org/show_bug.cgi?id=162510
        <rdar://problem/31380650>

        Reviewed by Alexey Proskuryakov.

        The test restores a page from PageCache and wants to check that an animated
        GIF is properly animating. To do so, it store the data of the current image
        frame, and then checks in a 100ms timer that the current image frame is
        different. This is flaky by nature since the image only has 10 frames and
        you therefore have a 1/10 chance that the new frame will be the same as the
        previous one, even if the image is properly animating.

        To address the problem, do a setInterval instead of a setTimeout and check
        until the frame becomes different.

        * fast/images/animated-gif-restored-from-bfcache.html:
        * platform/mac/TestExpectations:

2017-03-31  Wenson Hsieh  <wenson_hsieh@apple.com>

        [WK2] Tapping away to dismiss the selection does not update the selected DOM range using character granularity
        https://bugs.webkit.org/show_bug.cgi?id=170328
        <rdar://problem/30904558>

        Reviewed by Tim Horton.

        Adds a new layout test verifying that when a user taps away to clear the current selection in character
        granularity selection mode, the selected DOM range in the web process does not fall out of sync with UIKit's
        selection views, which are dismissed.

        * editing/selection/character-granularity-selected-range-after-dismissing-selection-expected.txt: Added.
        * editing/selection/character-granularity-selected-range-after-dismissing-selection.html: Added.

2017-03-31  Youenn Fablet  <youenn@apple.com>

        Add a test to ensure webrtc generated certificates and names are ephemeral
        https://bugs.webkit.org/show_bug.cgi?id=170225

        Reviewed by Jon Lee.

        * webrtc/ephemeral-certificates-and-cnames-expected.txt: Added.
        * webrtc/ephemeral-certificates-and-cnames.html: Added.

2017-03-31  Wenson Hsieh  <wenson_hsieh@apple.com>

        [WK2] Tapping editable text inside of a range selection no longer changes the selection to a caret
        https://bugs.webkit.org/show_bug.cgi?id=170327
        <rdar://problem/31363816>

        Reviewed by Tim Horton.

        Adds a new WK2 interaction test for iOS verifying that tapping a selection in editable content sets the selection
        to a caret, rather than maintaining the range selection. This test is disabled in OpenSource, since it relies on
        synthetic touch events.

        * TestExpectations:
        * editing/selection/caret-after-tap-in-editable-selection-expected.txt: Added.
        * editing/selection/caret-after-tap-in-editable-selection.html: Added.

2017-03-31  Alexey Proskuryakov  <ap@apple.com>

        Mark fast/mediastream/MediaStream-page-muted.html as flaky for
        https://bugs.webkit.org/show_bug.cgi?id=170355

        * TestExpectations:

2017-03-31  Alexey Proskuryakov  <ap@apple.com>

        Correction for the previous change - this is an image failure.

        * platform/mac-wk2/TestExpectations:

2017-03-31  Alexey Proskuryakov  <ap@apple.com>

        Mark fast/images/animated-image-different-dest-size.html as flaky for
        https://bugs.webkit.org/show_bug.cgi?id=170203

        * platform/mac-wk2/TestExpectations:

2017-03-31  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of several tests.

        Also rebaseline fast/css/getComputedStyle/computed-style-font-family.html after r214394, it also requires variation
        fonts.

        * platform/gtk/TestExpectations:
        * platform/gtk/fast/css/getComputedStyle/computed-style-font-family-expected.txt: Added.

2017-03-31  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Rebaseline several tests after r214546.

        GTK+ port doesn't support variation fonts. Also mark canvas/philip/tests/2d.pattern.animated.gif.html as failing
        after r214503.

        * platform/gtk/TestExpectations:
        * platform/gtk/fast/text/font-selection-font-loading-api-parse-expected.txt: Added.
        * platform/gtk/fast/text/font-stretch-parse-expected.txt: Added.
        * platform/gtk/fast/text/font-style-parse-expected.txt: Added.
        * platform/gtk/fast/text/font-weight-parse-expected.txt: Added.

2017-03-31  Romain Bellessort  <romain.bellessort@crf.canon.fr>

        [Readable Streams API] Implement cloneArrayBuffer in WebCore
        https://bugs.webkit.org/show_bug.cgi?id=170008

        Reviewed by Youenn Fablet.

        Added test to check cloneArrayBuffer behaviour. 

        * streams/readable-stream-byob-request.js:

2017-03-31  Oleksandr Skachkov  <gskachkov@gmail.com>

        String.prototype.replace incorrectly applies "special replacement parameters" when passed a function
        https://bugs.webkit.org/show_bug.cgi?id=170151

        Reviewed by Saam Barati.

        * js/script-tests/string_replace_function.js: Added.
        * js/script-tests/string_replace_regexp.js: Renamed from LayoutTests/js/script-tests/string_replace.js.
        * js/string_replace_function-expected.txt: Added.
        * js/string_replace_function.html: Copied from LayoutTests/js/string_replace.html.
        * js/string_replace_regexp-expected.txt: Renamed from LayoutTests/js/string_replace-expected.txt.
        * js/string_replace_regexp.html: Renamed from LayoutTests/js/string_replace.html.

2017-03-31  Manuel Rego Casasnovas  <rego@igalia.com>

        [css-grid] Update W3C Test Suite
        https://bugs.webkit.org/show_bug.cgi?id=170170

        Reviewed by Youenn Fablet.

        Update path to tests in TestExpectations as the CSS Grid Layout suite
        is now under web-platform-tests.

        * TestExpectations:

2017-03-31  Antoine Quint  <graouts@apple.com>

        [mac-wk1] LayoutTest media/modern-media-controls/airplay-button/airplay-button.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=168409
        <rdar://problem/30799198>

        Unreviewed. Capture new logging events.

        * media/modern-media-controls/airplay-button/airplay-button.html:

2017-03-30  Matt Baker  <mattbaker@apple.com>

        Unreviewed. Update test expectations after https://bugs.webkit.org/show_bug.cgi?id=170279.

        * inspector/css/getAllStyleSheets-expected.txt:

2017-03-30  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline js/dom/global-constructors-attributes.html.

        Unreviewed test gardening.

        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-03-30  Simon Fraser  <simon.fraser@apple.com>

        Rename a touch event function, and new touch region test results
        https://bugs.webkit.org/show_bug.cgi?id=170309
        rdar://problem/31329520

        Reviewed by Chris Dumez.

        A code change in WebKitAdditions progresses this test result.

        * fast/events/touch/ios/touch-event-regions/iframes-expected.txt:

2017-03-30  Said Abou-Hallawa  <sabouhallawa@apple.com>

        REGRESSION (r213764): Background image from sprite sheet incorrectly scaled
        https://bugs.webkit.org/show_bug.cgi?id=169547

        Reviewed by Simon Fraser.

        * fast/images/async-image-background-image.html:
        * fast/images/resources/sprite-sheet-red-green-blue.png: Added.
        * fast/images/sprite-sheet-image-draw-expected.html: Added.
        * fast/images/sprite-sheet-image-draw.html: Added.

2017-03-30  Matt Baker  <mattbaker@apple.com>

        Web Inspector: Assertion failure in InspectorStyleProperty::setRawTextFromStyleDeclaration
        https://bugs.webkit.org/show_bug.cgi?id=170279
        <rdar://problem/30200492>

        Reviewed by David Hyatt.

        * inspector/css/getAllStyleSheets.html:
        Add stylesheet with an "unparsed" property having no final semicolon.

2017-03-30  Youenn Fablet  <youenn@apple.com>

        Clean up RTCDataChannel
        https://bugs.webkit.org/show_bug.cgi?id=169732

        Reviewed by Chris Dumez.

        * webrtc/datachannel/bufferedAmountLowThreshold-expected.txt: Added.
        * webrtc/datachannel/bufferedAmountLowThreshold.html: Added.

2017-03-30  Chris Dumez  <cdumez@apple.com>

        svg/animations/animations-paused-in-background-page.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=170290

        Reviewed by Simon Fraser.

        Fix shouldBecomeEqual() check in the test which was wrong and was passing by chance
        due to a race.

        * svg/animations/animations-paused-in-background-page-expected.txt:
        * svg/animations/animations-paused-in-background-page.html:

2017-03-30  Javier Fernandez  <jfernandez@igalia.com>

        [css-align] Adapt content-alignment properties to the new baseline syntax
        https://bugs.webkit.org/show_bug.cgi?id=170262

        Reviewed by David Hyatt.

        Added new cases to the alignment properties parsing tests so that we can verify the new
        baseline-alignment syntax is parsed as expected.
        Additionally, I modified the tests so that they use the testharness format.

        * css3/parse-align-content-expected.txt:
        * css3/parse-align-content.html:
        * css3/parse-justify-content-expected.txt:
        * css3/parse-justify-content.html:

2017-03-30  James Craig  <jcraig@apple.com>

        AX: Expose a new AXSubrole for explicit ARIA "group" role
        https://bugs.webkit.org/show_bug.cgi?id=169810
        <rdar://problem/31039693>

        Reviewed by Chris Fleizach.

        * accessibility/list-detection2-expected.txt:
        * accessibility/list-detection2.html:
        * accessibility/roles-computedRoleString.html:
        * inspector/dom/getAccessibilityPropertiesForNode-expected.txt:
        * inspector/dom/highlightFrame-expected.txt:
        * inspector/dom/highlightSelector-expected.txt:
        * platform/mac/accessibility/roles-computedRoleString-expected.txt:
        * platform/mac/accessibility/roles-exposed-expected.txt:

2017-03-30  Youenn Fablet  <youenn@apple.com>

        webrtc/video-stats.html and webrtc/video-replace-track.html are flaky
        https://bugs.webkit.org/show_bug.cgi?id=170294

        Unreviewed.

        * TestExpectations: Marking these tests as flaky.

2017-03-30  Eric Carlson  <eric.carlson@apple.com>

        [Crash] WebCore::AudioBuffer::AudioBuffer don't checking illegal value
        https://bugs.webkit.org/show_bug.cgi?id=169956

        Reviewed by Youenn Fablet.

        * webaudio/audiobuffer-crash-expected.txt: Added.
        * webaudio/audiobuffer-crash.html: Added.

2017-03-30  Simon Fraser  <simon.fraser@apple.com>

        Add some tests that dump the touch event regions with various content configurations
        https://bugs.webkit.org/show_bug.cgi?id=170216

        Followup: add missing results files, and tweak iframes.html to show that regions fail to
        take iframe borders into account.

        * fast/events/touch/ios/touch-event-regions/active-passive-nesting-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/columns-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/complex-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/document-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/iframes-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/iframes.html:
        * fast/events/touch/ios/touch-event-regions/overflow-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/range-sliders-expected.txt: Added.

2017-03-30  Per Arne Vollan  <pvollan@apple.com>

        [mac-wk1 debug] LayoutTest media/track/track-cue-rendering-with-padding.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=170188

        Reviewed by Eric Carlson.

        The textTrackDisplayElement call will fail and throw an exception if the text track display element
        has not yet been added to the text track container element. We wait until it has been added.

        * media/track/track-cue-rendering-with-padding.html:

2017-03-30  Antoine Quint  <graouts@apple.com>

        [Modern Media Controls] Invalid placard icon is not visible for short video
        https://bugs.webkit.org/show_bug.cgi?id=170277
        <rdar://problem/31327955>

        Reviewed by Eric Carlson.

        Add a new test to check that we correctly hide the invalid icon only when
        there is no space left to display it.

        * media/modern-media-controls/invalid-placard/invalid-placard-constrained-metrics-expected.txt: Added.
        * media/modern-media-controls/invalid-placard/invalid-placard-constrained-metrics.html: Added.

2017-03-27  Sergio Villar Senin  <svillar@igalia.com>

        [css-grid] Clamp the number of autorepeat tracks
        https://bugs.webkit.org/show_bug.cgi?id=170120

        Reviewed by Manuel Rego Casasnovas.

        Added a new test to check the clamping of grid tracks. It's mostly all JavaScript in order
        to allow us to run several test cases over a small number of grids in a single file quite
        fast. The other option was to statically (CSS) create several huge grids, something that
        could potentially be very expensive in terms of memory and CPU leading to timeouts.

        * fast/css-grid-layout/grid-auto-repeat-huge-grid-expected.txt: Added.
        * fast/css-grid-layout/grid-auto-repeat-huge-grid.html: Added.

2017-03-30  Antoine Quint  <graouts@apple.com>

        [mac-wk1] LayoutTest media/modern-media-controls/airplay-button/airplay-button.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=168409
        <rdar://problem/30799198>

        Unreviewed. Add logging related to visibility since document.visibility = hidden would cause the
        requestAnimationFrame() call to suspend the ScriptedAnimationController.

        * media/modern-media-controls/airplay-button/airplay-button.html:

2017-03-30  Per Arne Vollan  <pvollan@apple.com>

        REGRESSION(~r212322): LayoutTest media/track/track-cue-container-rendering-position.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=168660

        Reviewed Eric Carlson.

        The textTrackDisplayElement call will fail and throw an exception if the text track display element
        has not yet been added to the text track container element. We wait until it has been added.

        * media/track/track-cue-container-rendering-position.html:

2017-03-29  Ryosuke Niwa  <rniwa@webkit.org>

        Disconnecting a HTMLObjectElement does not always unload its content document
        https://bugs.webkit.org/show_bug.cgi?id=169606

        Reviewed by Andy Estes.

        Add a regression test.

        * fast/dom/removing-focused-object-element-expected.txt: Added.
        * fast/dom/removing-focused-object-element.html: Added.

2017-03-29  Simon Fraser  <simon.fraser@apple.com>

        Add some tests that dump the touch event regions with various content configurations
        https://bugs.webkit.org/show_bug.cgi?id=170216

        Reviewed by Dean Jackson.

        Tests for touch event regions. Some of these are modeled after tests in tiled-drawing/scrolling/non-fast-region/.

        * fast/events/touch/ios/touch-event-regions/resources/touch-regions-helper.js: Added.
        * fast/events/touch/ios/touch-event-regions/active-passive-nesting-expected.html: Added.
        * fast/events/touch/ios/touch-event-regions/active-passive-nesting.html: Added.
        * fast/events/touch/ios/touch-event-regions/columns-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/columns.html: Added.
        * fast/events/touch/ios/touch-event-regions/complex-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/complex.html: Added.
        * fast/events/touch/ios/touch-event-regions/document-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/document.html: Added.
        * fast/events/touch/ios/touch-event-regions/iframes-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/iframes.html: Added.
        * fast/events/touch/ios/touch-event-regions/overflow-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/overflow.html: Added.
        * fast/events/touch/ios/touch-event-regions/range-sliders-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions/range-sliders.html: Added.

2017-03-28  Simon Fraser  <simon.fraser@apple.com>

        Make it possible to dump touch event regions for testing
        https://bugs.webkit.org/show_bug.cgi?id=170209
        <rdar://problem/31309258>

        Reviewed by Tim Horton.

        Simple test that dumps the regions.

        * fast/events/touch/ios/touch-event-regions-expected.txt: Added.
        * fast/events/touch/ios/touch-event-regions.html: Added.

2017-03-29  Zalan Bujtas  <zalan@apple.com>

        RenderBlockFlow::addFloatsToNewParent should check if float is already added to the object list.
        https://bugs.webkit.org/show_bug.cgi?id=170259
        <rdar://problem/31300584>

        Reviewed by Simon Fraser.

        * fast/block/float/placing-multiple-floats-crash-expected.txt: Added.
        * fast/block/float/placing-multiple-floats-crash.html: Added.

2017-03-29  Tim Horton  <timothy_horton@apple.com>

        Swipe gesture tests don't work on macOS Sierra
        https://bugs.webkit.org/show_bug.cgi?id=161675
        <rdar://problem/23379930>

        Reviewed by Darin Adler.

        * platform/mac-wk2/TestExpectations:
        * swipe/basic-cached-back-swipe-expected.txt:
        * swipe/basic-cached-back-swipe.html:
        * swipe/main-frame-pinning-requirement-expected.txt:
        * swipe/main-frame-pinning-requirement.html:
        * swipe/pushState-cached-back-swipe-expected.txt:
        * swipe/pushState-cached-back-swipe.html:
        * swipe/pushState-programmatic-back-while-swiping-crash-expected.txt:
        * swipe/pushState-programmatic-back-while-swiping-crash.html:
        * swipe/resources/swipe-test.js:
        (measuredDurationShouldBeLessThan):
        (startSwipeGesture):
        (completeSwipeGesture):
        (playEventStream):
        (eventQueue.enqueueScrollEvent): Deleted.
        (eventQueue.enqueueSwipeEvent): Deleted.
        (eventQueue.hasPendingEvents): Deleted.
        (eventQueue.callAfterEventDispatch): Deleted.
        (eventQueue._processEventQueue): Deleted.
        (eventQueue._processEventQueueSoon): Deleted.
        * swipe/swipe-start-hysteresis-failures-expected.txt: Removed.
        * swipe/swipe-start-hysteresis-failures.html: Removed.

2017-03-29  Myles C. Maxfield  <mmaxfield@apple.com>

        Try to normalize variation ranges
        https://bugs.webkit.org/show_bug.cgi?id=170119

        Reviewed by Simon Fraser.

        * fast/text/variations/font-selection-properties-expected.html:

2017-03-29  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/media/modern-media-controls/time-labels-support/long-time.html as flaky on macOS.
        https://bugs.webkit.org/show_bug.cgi?id=169677

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:
        * platform/mac/TestExpectations:

2017-03-29  Javier Fernandez  <jfernandez@igalia.com>

        [css-align] Adapt self-alignment properties to the new baseline syntax
        https://bugs.webkit.org/show_bug.cgi?id=170235

        Reviewed by David Hyatt.

        Added new cases to the alignment properties parsing tests so that we can verify the new
        baseline-alignment syntax is parsed as expected.
        Additionally, I modified the tests so that they use the testharness format.

        * css3/parse-align-items-expected.txt:
        * css3/parse-align-items.html:
        * css3/parse-align-self-expected.txt:
        * css3/parse-align-self.html:
        * css3/resources/alignment-parsing-utils-th.js:
        (checkValues):
        * fast/css/parse-justify-items-expected.txt:
        * fast/css/parse-justify-items.html:
        * fast/css/parse-justify-self-expected.txt:
        * fast/css/parse-justify-self.html:
        * fast/css/resources/alignment-parsing-utils-th.js: Copied from LayoutTests/css3/resources/alignment-parsing-utils-th.js.
        (checkValues):
        (checkBadValues):
        (checkInitialValues):
        (checkInheritValues):
        (checkLegacyValues):
        (checkSupportedValues):

2017-03-29  Chris Dumez  <cdumez@apple.com>

        Animated SVG images are not paused in pages loaded in the background
        https://bugs.webkit.org/show_bug.cgi?id=170043
        <rdar://problem/31234412>

        Reviewed by Simon Fraser.

        Extend layout test coverage.

        * svg/animations/animations-paused-in-background-page-expected.txt: Added.
        * svg/animations/animations-paused-in-background-page-iframe-expected.txt: Added.
        * svg/animations/animations-paused-in-background-page-iframe.html: Added.
        * svg/animations/animations-paused-in-background-page.html: Added.
        * svg/animations/resources/iframe-with-animated-svg-image.html: Added.

2017-03-29  Myles C. Maxfield  <mmaxfield@apple.com>

        Post-commit test gardening after r214546
        https://bugs.webkit.org/show_bug.cgi?id=169518

        Unreviewed.

        * platform/mac-elcapitan/fast/text/font-selection-font-loading-api-parse-expected.txt:
        * platform/mac-elcapitan/fast/text/font-style-parse-expected.txt:

2017-03-29  Myles C. Maxfield  <mmaxfield@apple.com>

        Post-commit test gardening after r214546
        https://bugs.webkit.org/show_bug.cgi?id=169518

        Unreviewed.

        * platform/mac-elcapitan/fast/text/font-selection-font-loading-api-parse-expected.txt:
        * platform/mac-elcapitan/fast/text/font-style-parse-expected.txt:

2017-03-29  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/events/before-unload-adopt-subframe-to-outside.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170130

        Unreviewed test gardening.

        * TestExpectations:

2017-03-29  Myles C. Maxfield  <mmaxfield@apple.com>

        Variation fonts: Make sure that feature detection and preprocessor macros are right
        https://bugs.webkit.org/show_bug.cgi?id=169518

        Reviewed by Simon Fraser.

        Create platform-specific results for mac-elcapitan which doesn't support variation fonts.

        * fast/text/font-variations-feature-detection-expected.html: Added.
        * fast/text/font-variations-feature-detection.html: Added.
        * platform/ios-simulator/TestExpectations:
        * platform/mac-elcapitan/fast/text/font-selection-font-face-parse-expected.txt:
        * platform/mac-elcapitan/fast/text/font-selection-font-loading-api-parse-expected.txt: Added.
        * platform/mac-elcapitan/fast/text/font-stretch-parse-expected.txt: Added.
        * platform/mac-elcapitan/fast/text/font-style-parse-expected.txt: Added.
        * platform/mac-elcapitan/fast/text/font-weight-parse-expected.txt: Added.
        * platform/mac/TestExpectations:

2017-03-29  Antoine Quint  <graouts@apple.com>

        [Modern Media Controls] Controls bar may disappear while captions menu is visible (redux)
        https://bugs.webkit.org/show_bug.cgi?id=170239
        <rdar://problem/31320685>

        Reviewed by Dean Jackson.

        We extend an existing test to cover the case where we would hide the controls bar while the tracks panel
        is up by mousing out of the media. We also add a new test where we check that clicking over the controls
        bar to dismiss the tracks panel does not hide the controls bar. Finally, we make a small change to an
        existing test to listen to "transitionend" event on the tracks panel specifically since with this patch
        the controls bar would disappear and trigger a similar event when disappearing as the tracks panel is dismissed.

        * media/modern-media-controls/tracks-panel/tracks-panel-controls-bar-remains-visible-after-clicking-over-it-expected.txt: Added.
        * media/modern-media-controls/tracks-panel/tracks-panel-controls-bar-remains-visible-after-clicking-over-it.html: Added.
        * media/modern-media-controls/tracks-panel/tracks-panel-prevent-controls-bar-from-fading-expected.txt:
        * media/modern-media-controls/tracks-panel/tracks-panel-prevent-controls-bar-from-fading.html:
        * media/modern-media-controls/tracks-support/tracks-support-click-track-in-panel.html:

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/workers/worker-close-more.html as a flaky timeout.
        https://bugs.webkit.org/show_bug.cgi?id=169838

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-03-29  Youenn Fablet  <youenn@apple.com>

        Move DTMF WebRTC extension behind its own compile flag
        https://bugs.webkit.org/show_bug.cgi?id=170226

        Reviewed by Eric Carlson.

        * TestExpectations:
        * platform/mac-elcapitan/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-wk1/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac-yosemite/js/dom/global-constructors-attributes-expected.txt:
        * platform/mac/js/dom/global-constructors-attributes-expected.txt:

2017-03-29  Carlos Alberto Lopez Perez  <clopez@igalia.com>

        [GTK][OWR] Rebaseline fast/mediastream/RTCPeerConnection-addIceCandidate.html after r214527
        https://bugs.webkit.org/show_bug.cgi?id=170192

        Unreviewed test gardening.

        * platform/gtk/fast/mediastream/RTCPeerConnection-addIceCandidate-expected.txt:

2017-03-29  Youenn Fablet  <youenn@apple.com>

        Add test for differentiating camera versus canvas stream
        https://bugs.webkit.org/show_bug.cgi?id=169698
        <rdar://problem/31076026>

        Reviewed by Eric Carlson.

        * fast/mediastream/captureStream/canvas2d.html:

2017-03-28  Carlos Alberto Lopez Perez  <clopez@igalia.com>

        [WebRTC] Update test RTCPeerConnection-overloaded-operations-params.html after r214441
        https://bugs.webkit.org/show_bug.cgi?id=170223

        Reviewed by Youenn Fablet.

        After r214441 the arguments of addIceCandidate() are nullable.

        * fast/mediastream/RTCPeerConnection-overloaded-operations-params-expected.txt:
        * fast/mediastream/RTCPeerConnection-overloaded-operations-params.html:
        * platform/gtk/fast/mediastream/RTCPeerConnection-overloaded-operations-params-expected.txt: Removed. The expected result was the same than the general one.

2017-03-29  Antoine Quint  <graouts@apple.com>

        [mac-wk1] LayoutTest media/modern-media-controls/airplay-button/airplay-button.html is a flaky timeout
        https://bugs.webkit.org/show_bug.cgi?id=168409
        <rdar://problem/30799198>

        Reviewed by Dean Jackson.

        Opt into ScriptedAnimationController logging.

        * media/modern-media-controls/airplay-button/airplay-button-expected.txt:
        * media/modern-media-controls/airplay-button/airplay-button.html:

2017-03-28  Youenn Fablet  <youenn@apple.com>

        [WebRTC] After r214441 addIceCandidate no longer accepts an RTCIceCandidateInit dictionary
        https://bugs.webkit.org/show_bug.cgi?id=170192

        Reviewed by Jon Lee.

        * fast/mediastream/RTCIceCandidate-expected.txt:
        * fast/mediastream/RTCIceCandidate.html: Removing no longer valid tests.
        * fast/mediastream/RTCPeerConnection-addIceCandidate-expected.txt:
        * fast/mediastream/RTCPeerConnection-addIceCandidate.html: Adding more tests to cover null/undefined cases.
        Ensuring sdpMid has a valid value.
        * fast/mediastream/resources/promise-utils.js: Improving error logging.

2017-03-27  Brent Fulgham  <bfulgham@apple.com>

        Only attach Attributes to a given element one time
        https://bugs.webkit.org/show_bug.cgi?id=170125
        <rdar://problem/31279676>

        Reviewed by Chris Dumez.

        * fast/dom/Attr/make-unique-element-data-while-replacing-attr-expected.txt: Rebaselined.
        * fast/dom/Attr/make-unique-element-data-while-replacing-attr.html: Add check before setting new value.
        * fast/dom/Attr/only-attach-attr-once-expected.txt: Added.
        * fast/dom/Attr/only-attach-attr-once.html: Added.

2017-03-28  Youenn Fablet  <youenn@apple.com>

        Stop RTCDataChannel when closing page
        https://bugs.webkit.org/show_bug.cgi?id=170166

        Reviewed by Eric Carlson.

        * webrtc/datachannel/datachannel-gc-expected.txt: Added.
        * webrtc/datachannel/datachannel-gc.html: Added.

2017-03-28  Myles C. Maxfield  <mmaxfield@apple.com>

        Ranges for variation font properties are not enforced
        https://bugs.webkit.org/show_bug.cgi?id=169979

        Reviewed by David Hyatt.

        * fast/text/font-selection-font-face-parse-expected.txt:
        * fast/text/font-selection-font-face-parse.html:
        * fast/text/font-selection-font-loading-api-parse-expected.txt:
        * fast/text/font-selection-font-loading-api-parse.html:
        * fast/text/font-style-parse-expected.txt:
        * fast/text/font-style-parse.html:
        * fast/text/variations/font-loading-api-parse-ranges-expected.txt:
        * fast/text/variations/font-loading-api-parse-ranges.html:
        * fast/text/variations/out-of-bounds-selection-properties-expected.txt: Added.
        * fast/text/variations/out-of-bounds-selection-properties.html: Added.
        * platform/mac-elcapitan/fast/text/font-selection-font-face-parse-expected.txt:

2017-03-28  Andy Estes  <aestes@apple.com>

        [iOS] Crash in -[WebPreviewLoader failed] when running http/tests/multipart/policy-ignore-crash.php
        https://bugs.webkit.org/show_bug.cgi?id=170197
        <rdar://problem/30314067>

        Reviewed by Brady Eidson.

        * platform/ios/TestExpectations: Unskipped http/tests/multipart/policy-ignore-crash.php.
        * platform/ios/http/tests/multipart/policy-ignore-crash-expected.txt: Added an iOS-specific result.

2017-03-28  Chris Dumez  <cdumez@apple.com>

        Animated SVG images are not paused when outside viewport
        https://bugs.webkit.org/show_bug.cgi?id=170155
        <rdar://problem/31288893>

        Reviewed by Antti Koivisto.

        Add layout test coverage.

        * platform/mac-wk1/TestExpectations:
        * svg/animations/animated-svg-image-outside-viewport-paused-expected.txt: Added.
        * svg/animations/animated-svg-image-outside-viewport-paused.html: Added.
        * svg/animations/animated-svg-image-removed-from-document-paused-expected.txt: Added.
        * svg/animations/animated-svg-image-removed-from-document-paused.html: Added.
        * svg/animations/resources/smilAnimation.svg: Added.

2017-03-28  Antti Koivisto  <antti@apple.com>

        Missing render tree position invalidation when tearing down renderers for display:contents subtree
        https://bugs.webkit.org/show_bug.cgi?id=170199
        <rdar://problem/31260856>

        Reviewed by Zalan Bujtas.

        * fast/shadow-dom/slot-renderer-teardown-expected.txt: Added.
        * fast/shadow-dom/slot-renderer-teardown.html: Added.

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r214485.

        This change caused LayoutTest crashes.

        Reverted changeset:

        "Stop RTCDataChannel when closing page"
        https://bugs.webkit.org/show_bug.cgi?id=170166
        http://trac.webkit.org/changeset/214485

2017-03-28  Brian Burg  <bburg@apple.com>

        Web Inspector: Add "Disable Caches" option that only applies to the inspected page while Web Inspector is open
        https://bugs.webkit.org/show_bug.cgi?id=169865
        <rdar://problem/31250573>

        Reviewed by Joseph Pecoraro.

        Add tests that verify the new command works as expected when it disables resource caching.
        I also manually verified that the override setting is cleared when Web Inspector disconnects.
        This is not easy to check in a layout test since we rely on the Web Inspector to tell whether
        a load happened or not.

        * http/tests/inspector/network/set-resource-caching-disabled-disk-cache-expected.txt: Added.
        * http/tests/inspector/network/set-resource-caching-disabled-disk-cache.html: Added.
        * http/tests/inspector/network/set-resource-caching-disabled-memory-cache-expected.txt: Added.
        * http/tests/inspector/network/set-resource-caching-disabled-memory-cache.html: Added.

2017-03-28  Youenn Fablet  <youenn@apple.com>

        Update LayoutTests/fast/mediastream/RTCPeerConnection-addIceCandidate.html to get more coverage
        https://bugs.webkit.org/show_bug.cgi?id=170194

        Reviewed by Chris Dumez.

        * fast/mediastream/RTCPeerConnection-addIceCandidate-expected.txt:
        * fast/mediastream/RTCPeerConnection-addIceCandidate.html: Making test more robust to failures to get more coverage.

2017-03-28  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Inspecting a Main Resource that is JS/JSON does not format / syntax highlight it properly
        https://bugs.webkit.org/show_bug.cgi?id=166862
        <rdar://problem/29835977>

        Reviewed by Brian Burg.

        * http/tests/inspector/network/resource-mime-type-expected.txt: Added.
        * http/tests/inspector/network/resource-mime-type.html: Added.
        Test resource mime types for different resources.

        * http/tests/inspector/network/resources/json.php: Added.
        * http/tests/inspector/network/resources/script.js: Added.
        * http/tests/inspector/network/resources/script.txt: Added.
        * http/tests/inspector/network/resources/stylesheet.css: Added.
        * http/tests/inspector/network/resources/stylesheet.txt: Added.
        * http/tests/resources/square20.jpg: Added.
        Resources for various requests and different mime types.

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Mark http/tests/xmlhttprequest/simple-cross-origin-progress-events.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=168132

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Mark two fast/scrolling/ios/touch-scroll tests as failing.
        https://bugs.webkit.org/show_bug.cgi?id=170153

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Remove failure expectation for media/modern-media-controls/media-controller/media-controller-scale-factor-audio.html.

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-03-28  Youenn Fablet  <youenn@apple.com>

        Stop RTCDataChannel when closing page
        https://bugs.webkit.org/show_bug.cgi?id=170166

        Reviewed by Eric Carlson.

        * webrtc/datachannel/datachannel-gc-expected.txt: Added.
        * webrtc/datachannel/datachannel-gc.html: Added.

2017-03-28  Antoine Quint  <graouts@apple.com>

        REGRESSION (r214386): [ios-simulator] LayoutTest media/modern-media-controls/media-controller/media-controller-scale-factor-audio.html is failing
        https://bugs.webkit.org/show_bug.cgi?id=170180

        Unreviewed. Restore a value that was mistakenly changed in the fix for webkit.org/b/169962.

        * media/modern-media-controls/media-controller/media-controller-scale-factor-audio-expected.txt:
        * media/modern-media-controls/media-controller/media-controller-scale-factor-audio.html:

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Mark fast/history/ios/history-scroll-restoration.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=169558

        Unreviewed test gardening.

        * platform/ios-wk2/TestExpectations:

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/media-controller/media-controller-scale-factor-audio.html as failing on ios-simulator.
        https://bugs.webkit.org/show_bug.cgi?id=170180

        Unreviewed test gardening.

        * platform/ios/TestExpectations:

2017-03-28  Youenn Fablet  <youenn@apple.com>

        LayoutTest webrtc/video-getParameters.html is failing
        https://bugs.webkit.org/show_bug.cgi?id=170148

        Unreviewed.

        * TestExpectations: Marking webrtc/video-getParameters.html as failing.

2017-03-28  Ryan Haddad  <ryanhaddad@apple.com>

        Mark webrtc/video-replace-track-to-null.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170178

        Unreviewed test gardening.

        * TestExpectations:

2017-03-28  Jonathan Bedard  <jbedard@apple.com>

        Moved gardened ios-simulator tests to ios folders
        <rdar://problem/30948691>

        Unreviewed test re-organization.

        Moving ios-simulator test expectations to share as many expectations
        as possible with on-device testing.

        * platform/ios: Moved from platform/ios-simulator.
        * platform/ios-device: Added.
        * platform/ios-device-wk1: Added.
        * platform/ios-device-wk2: Added.
        * platform/ios-simulator: Moved to platform/ios.
        * platform/ios-simulator-wk1: Moved to platform/ios-wk1.
        * platform/ios-simulator-wk2: Moved to platform/ios-wk2.
        * platform/ios-wk1: Moved from platform/ios-simulator-wk1.
        * platform/ios-wk2: Moved from platform/ios-simulator-wk2.

2017-03-28  Yoav Weiss  <yoav@yoav.ws>

        Add a warning for unused link preloads.
        https://bugs.webkit.org/show_bug.cgi?id=165670

        Reviewed by Youenn Fablet.

        * TestExpectations: Added a "Failure Pass" for the flaky charset header test.
        * http/tests/preload/download_resources-expected.txt:
        * http/tests/preload/download_resources.html: Added references to preloaded resources.
        * http/tests/preload/onerror_event-expected.txt:
        * http/tests/preload/onerror_event.html: Added references to preloaded resources.
        * http/tests/preload/onload_event-expected.txt:
        * http/tests/preload/onload_event.html: Added references to preloaded resources.
        * http/tests/preload/single_download_preload.html: Deflaked.
        * http/tests/preload/single_download_preload_headers.php: Removed the charset to avoid double download bug.
        * http/tests/preload/single_download_preload_headers_charset-expected.txt: Added.
        * http/tests/preload/single_download_preload_headers_charset.php: Flaky test showing the double download bug when charset is declared.
        * http/tests/preload/unused_preload_warning-expected.txt: Added.
        * http/tests/preload/unused_preload_warning.html: Added.

2017-03-28  Antoine Quint  <graouts@apple.com>

        REGRESSION: Double-clicking the captions button while the captions popover is open prevents the popover from being opened again
        https://bugs.webkit.org/show_bug.cgi?id=170171
        <rdar://problem/31095500>

        Reviewed by Dean Jackson.

        Adding a new test that runs the steps to reproduce the issue, and rebaselining an existing one now that
        the "presented" property returns false immediately after calling hide() on the panel.

        * media/modern-media-controls/tracks-panel/tracks-panel-hide-expected.txt:
        * media/modern-media-controls/tracks-panel/tracks-panel-hide.html:
        * media/modern-media-controls/tracks-support/tracks-support-show-panel-then-double-click-on-tracks-button-expected.txt: Added.
        * media/modern-media-controls/tracks-support/tracks-support-show-panel-then-double-click-on-tracks-button.html: Added.

2017-03-28  Aaron Chu  <aaron_chu@apple.com>

        AX: Media controls should be able to be re-activated after faded away
        https://bugs.webkit.org/show_bug.cgi?id=170048
        <rdar://problem/30157179>

        Reviewed by Antoine Quint.

        * media/modern-media-controls/media-controls/media-controls-appear-when-focus-expected.txt: Added.
        * media/modern-media-controls/media-controls/media-controls-appear-when-focus.html: Added.

2017-03-28  Antoine Quint  <graouts@apple.com>

        [Modern Media Controls] Improve media documents across macOS, iPhone and iPad
        https://bugs.webkit.org/show_bug.cgi?id=169145
        <rdar://problem/17048858>

        Reviewed by Dean Jackson.

        We add new tests for media documents and related features that cover the following cases:
        
            - checking <video> with only audio tracks does not show the fullscreen button
            - checking <video> with only audio tracks does not show the picture-in-picture button
            - checking the size used in media documents for audio and video across macOS, iPhone and iPad

        * media/modern-media-controls/fullscreen-support/fullscreen-support-disabled-video-with-audio-tracks-only-expected.txt: Added.
        * media/modern-media-controls/fullscreen-support/fullscreen-support-disabled-video-with-audio-tracks-only.html: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-audio-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-audio-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-video-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-video-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-audio-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-audio-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-audio-mac-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-audio-mac-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-video-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-video-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-video-mac-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-video-mac-sizing.html: Added.
        * media/modern-media-controls/pip-support/pip-support-disabled-video-with-audio-tracks-only-expected.txt: Added.
        * media/modern-media-controls/pip-support/pip-support-disabled-video-with-audio-tracks-only.html: Added.
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-03-27  Said Abou-Hallawa  <sabouhallawa@apple.com>

        REGRESSION(213764): Large images should not be decoded asynchronously when they are drawn on a canvas
        https://bugs.webkit.org/show_bug.cgi?id=169771

        Reviewed by Simon Fraser.

        * fast/images/animated-image-different-dest-size-expected.html: Added.
        * fast/images/animated-image-different-dest-size.html: Added.
        This test crashes without this patch.

        * fast/images/animated-image-loop-count.html:
        Clear the memory cache so the test can be not flaky. Running it with -repeat-each was failing.

        * fast/images/async-image-background-image-expected.html: Added.
        * fast/images/async-image-background-image.html: Added.
        Ensures the background image can be drawn asynchronously if it is large.

        * fast/images/async-image-canvas-draw-image-expected.html: Added.
        * fast/images/async-image-canvas-draw-image.html: Added.
        Ensures the image is drawn synchronously on the canvas regardless of its size.

        * fast/images/ordered-animated-image-frames.html:
        Clear the memory cache so the test can be not flaky. Running it with -repeat-each was failing.

        * fast/images/reset-image-animation-expected.txt:
        * fast/images/reset-image-animation.html:
        Change how the steps of the test are ordered so the test can be not flaky.
        Running it with -repeat-each was failing.

        * fast/images/resources/red-green-blue-900-300.png: Added.

2017-03-27  Youenn Fablet  <youenn@apple.com>

        addIceCandidate should not throw if passed null or undefined
        https://bugs.webkit.org/show_bug.cgi?id=170118

        Reviewed by Eric Carlson.

        Updating test to log addIceCandidate rejection.

        * webrtc/datachannel/basic.html:
        * webrtc/routines.js:
        (iceCallback1):
        (iceCallback2):
        (onAddIceCandidateError):

2017-03-27  Ryan Haddad  <ryanhaddad@apple.com>

        Rebaseline svg/css/getComputedStyle-basic.xhtml for macOS.

        Unreviewed test gardening.

        * platform/mac-elcapitan/svg/css/getComputedStyle-basic-expected.txt: Added.
        * platform/mac/svg/css/getComputedStyle-basic-expected.txt: Added.

2017-03-27  Antti Koivisto  <antti@apple.com>

        Loading in-body stylesheets should not block rendering of elements before them
        https://bugs.webkit.org/show_bug.cgi?id=169345

        Reviewed by Simon Fraser.

        * http/tests/incremental/resources/delayed-css.php: Added.
        * http/tests/incremental/stylesheet-body-incremental-rendering-expected.html: Added.
        * http/tests/incremental/stylesheet-body-incremental-rendering.html: Added.

2017-03-27  Myles C. Maxfield  <mmaxfield@apple.com>

        Test variation font ranges in the CSS Font Loading API
        https://bugs.webkit.org/show_bug.cgi?id=170022

        Reviewed by Dean Jackson.

        * fast/text/variations/font-loading-api-parse-ranges-expected.txt: Added.
        * fast/text/variations/font-loading-api-parse-ranges.html: Added.

2017-03-27  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r214411.

        Two of the LayoutTests for this change time out on ios-
        simulator.

        Reverted changeset:

        "[Modern Media Controls] Improve media documents across macOS,
        iPhone and iPad"
        https://bugs.webkit.org/show_bug.cgi?id=169145
        http://trac.webkit.org/changeset/214411

2017-03-27  Antoine Quint  <graouts@apple.com>

        [Modern Media Controls] Clicking on the tracks button when the tracks panel is up in a media document pauses the video
        https://bugs.webkit.org/show_bug.cgi?id=168517
        <rdar://problem/30577636>

        Reviewed by Dean Jackson.

        * media/video-click-dblckick-standalone.html: We disable modern-media-controls here since we know that this test won't pass with them on.

2017-03-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/time-label/time-label-white-space-nowrap.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=169679

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-03-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark inspector/dom-debugger/dom-breakpoints.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=170127

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-03-27  Ryan Haddad  <ryanhaddad@apple.com>

        Mark media/modern-media-controls/time-label/time-label.html as flaky.
        https://bugs.webkit.org/show_bug.cgi?id=169678

        Unreviewed test gardening.

        * platform/mac-wk1/TestExpectations:

2017-03-27  Ryan Haddad  <ryanhaddad@apple.com>

        Marking two modern-media-controls tests as timeouts.
        https://bugs.webkit.org/show_bug.cgi?id=170123

        Unreviewed test gardening.

        * platform/ios-simulator/TestExpectations:

2017-03-27  Youenn Fablet  <youenn@apple.com>

        Tighten RTCDatachannel creation and parameter getters
        https://bugs.webkit.org/show_bug.cgi?id=170081

        Reviewed by Eric Carlson.

        * webrtc/datachannel/basic-expected.txt:
        * webrtc/datachannel/basic.html:

2017-03-27  Youenn Fablet  <youenn@apple.com>

        Add support for RTCRtpReceiver/RTCRtpSender getParameters
        https://bugs.webkit.org/show_bug.cgi?id=170057

        Reviewed by Alex Christensen.

        * webrtc/video-getParameters-expected.txt: Added.
        * webrtc/video-getParameters.html: Added.

2017-03-27  Myles C. Maxfield  <mmaxfield@apple.com>

        font variation properties don't need to accept numbers
        https://bugs.webkit.org/show_bug.cgi?id=169357

        Reviewed by Antti Koivisto.

        * fast/text/font-selection-font-face-parse-expected.txt:
        * fast/text/font-selection-font-face-parse.html:
        * fast/text/font-selection-font-loading-api-parse-expected.txt:
        * fast/text/font-selection-font-loading-api-parse.html:
        * fast/text/font-stretch-parse-expected.txt:
        * fast/text/font-stretch-parse.html:
        * fast/text/font-style-parse-expected.txt:
        * fast/text/font-style-parse.html:
        * fast/text/variations/font-selection-properties.html:
        * platform/mac-elcapitan/fast/text/font-selection-font-face-parse-expected.txt:

2017-03-27  Myles C. Maxfield  <mmaxfield@apple.com>

        Implement format specifier for variation fonts
        https://bugs.webkit.org/show_bug.cgi?id=169327

        Reviewed by Simon Fraser.

        * fast/text/variations/font-face-format-expected.html: Added.
        * fast/text/variations/font-face-format.html: Added.

2017-03-27  Myles C. Maxfield  <mmaxfield@apple.com>

        Make sure animation works for font-weight, font-stretch, and font-style
        https://bugs.webkit.org/show_bug.cgi?id=169683

        Reviewed by Simon Fraser.

        * animations/font-variations/font-stretch-expected.txt: Added.
        * animations/font-variations/font-stretch.html: Added.
        * animations/font-variations/font-style-expected.txt: Added.
        * animations/font-variations/font-style.html: Added.
        * animations/font-variations/font-weight-expected.txt: Added.
        * animations/font-variations/font-weight.html: Added.
        * animations/resources/animation-test-helpers.js:
        (compareFontStyle):
        (getPropertyValue):
        (comparePropertyValue):

2017-03-27  Alex Christensen  <achristensen@webkit.org>

        Make WebSockets work in network process
        https://bugs.webkit.org/show_bug.cgi?id=169930

        Reviewed by Youenn Fablet.

        * http/tests/websocket/tests/hybi/network-process-crash-error-expected.txt: Added.
        * http/tests/websocket/tests/hybi/network-process-crash-error.html: Added.
        * http/tests/websocket/tests/hybi/slow-reply_wsh.py: Added.
        (web_socket_do_extra_handshake):
        (web_socket_transfer_data):
        * platform/ios-simulator-wk1/TestExpectations:
        * platform/mac-wk1/TestExpectations:
        * platform/win/TestExpectations:

2017-03-27  Antoine Quint  <graouts@apple.com>

        [Modern Media Controls] Improve media documents across macOS, iPhone and iPad
        https://bugs.webkit.org/show_bug.cgi?id=169145
        <rdar://problem/17048858>

        Reviewed by Dean Jackson.

        We add new tests for media documents and related features that cover the following cases:
        
            - checking <video> with only audio tracks does not show the fullscreen button
            - checking <video> with only audio tracks does not show the picture-in-picture button
            - checking the size used in media documents for audio and video across macOS, iPhone and iPad

        * media/modern-media-controls/fullscreen-support/fullscreen-support-disabled-video-with-audio-tracks-only-expected.txt: Added.
        * media/modern-media-controls/fullscreen-support/fullscreen-support-disabled-video-with-audio-tracks-only.html: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-audio-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-audio-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-video-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/ipad/media-document-video-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-audio-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-audio-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-audio-mac-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-audio-mac-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-video-ios-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-video-ios-sizing.html: Added.
        * media/modern-media-controls/media-documents/media-document-video-mac-sizing-expected.txt: Added.
        * media/modern-media-controls/media-documents/media-document-video-mac-sizing.html: Added.
        * media/modern-media-controls/pip-support/pip-support-disabled-video-with-audio-tracks-only-expected.txt: Added.
        * media/modern-media-controls/pip-support/pip-support-disabled-video-with-audio-tracks-only.html: Added.
        * platform/ios-simulator/TestExpectations:
        * platform/mac/TestExpectations:

2017-03-25  Aaron Chu  <aaron_chu@apple.com>

        AX: Media controls are unlabeled
        https://bugs.webkit.org/show_bug.cgi?id=169947
        <rdar://problem/30153323>

        Reviewed by Antoine Quint.

        * media/modern-media-controls/airplay-button/airplay-button-expected.txt:
        * media/modern-media-controls/airplay-button/airplay-button.html:
        * media/modern-media-controls/forward-button/forward-button-expected.txt:
        * media/modern-media-controls/forward-button/forward-button.html:
        * media/modern-media-controls/fullscreen-button/fullscreen-button-expected.txt:
        * media/modern-media-controls/fullscreen-button/fullscreen-button.html:
        * media/modern-media-controls/icon-button/icon-button-expected.txt:
        * media/modern-media-controls/icon-button/icon-button.html:
        * media/modern-media-controls/icon-service/icon-service-expected.txt:
        * media/modern-media-controls/icon-service/icon-service.html:
        * media/modern-media-controls/mute-button/mute-button-expected.txt:
        * media/modern-media-controls/mute-button/mute-button.html:
        * media/modern-media-controls/pip-button/pip-button-expected.txt:
        * media/modern-media-controls/pip-button/pip-button.html:
        * media/modern-media-controls/play-pause-button/play-pause-button-expected.txt:
        * media/modern-media-controls/play-pause-button/play-pause-button.html:
        * media/modern-media-controls/rewind-button/rewind-button-expected.txt:
        * media/modern-media-controls/rewind-button/rewind-button.html:
        * media/modern-media-controls/skip-back-button/skip-back-button-expected.txt:
        * media/modern-media-controls/skip-back-button/skip-back-button.html:
        * media/modern-media-controls/start-button/start-button-expected.txt:
        * media/modern-media-controls/start-button/start-button.html:
        * media/modern-media-controls/tracks-button/tracks-button-expected.txt:
        * media/modern-media-controls/tracks-button/tracks-button.html:

2017-03-25  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Update expectations of several tests.

        * platform/gtk/TestExpectations:

2017-03-25  Myles C. Maxfield  <mmaxfield@apple.com>

        Post-commit test fix after r214394
        https://bugs.webkit.org/show_bug.cgi?id=170083

        Unreviewed.

        * fast/text/variations/optical-sizing.html:

2017-03-24  Myles C. Maxfield  <mmaxfield@apple.com>

        Add font-optical-sizing to CSSComputedStyleDeclaration
        https://bugs.webkit.org/show_bug.cgi?id=170083

        Reviewed by Joseph Pecoraro.

        * fast/css/getComputedStyle/computed-style-expected.txt:
        * fast/css/getComputedStyle/computed-style-font-family-expected.txt:
        * fast/css/getComputedStyle/computed-style-without-renderer-expected.txt:
        * fast/css/getComputedStyle/resources/property-names.js:
        * fast/text/variations/optical-sizing-expected.txt:
        * fast/text/variations/optical-sizing.html:
        * platform/mac-elcapitan/fast/css/getComputedStyle/computed-style-expected.txt: Added.
        * platform/mac-elcapitan/fast/css/getComputedStyle/computed-style-font-family-expected.txt: Added.
        * platform/mac-elcapitan/fast/css/getComputedStyle/computed-style-without-renderer-expected.txt: Added.

2017-03-24  Ryan Haddad  <ryanhaddad@apple.com>

        Consolidate TestExpectations for media/restore-from-page-cache.html.

        Unreviewed test gardening.

        * platform/mac/TestExpectations:

2017-03-24  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r214361.

        This change caused flakiness in http/tests/preload tests.

        Reverted changeset:

        "Add a warning for unused link preloads."
        https://bugs.webkit.org/show_bug.cgi?id=165670
        http://trac.webkit.org/changeset/214361

2017-03-24  Antoine Quint  <graouts@webkit.org>

        [Modern Media Controls] Remove placard icon if height is compressed
        https://bugs.webkit.org/show_bug.cgi?id=167935
        <rdar://problem/30397128>

        Reviewed by Dean Jackson.

        We add a new test to check that the various designed constraints to toggle display of a placard's
        icon, title and description are honored. Also, due to the old layout() method now being called
        "commit()", we refactor a relevant test.

        * media/modern-media-controls/layout-node/node-made-dirty-during-commit-expected.txt: Added.
        * media/modern-media-controls/layout-node/node-made-dirty-during-commit.html: Added.
        * media/modern-media-controls/media-controls/media-controls-placard-compressed-metrics-expected.txt: Added.
        * media/modern-media-controls/media-controls/media-controls-placard-compressed-metrics.html: Added.

2017-03-24  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] "ideal" constraints passed to getUserMedia should affect fitness score
        https://bugs.webkit.org/show_bug.cgi?id=170056

        Reviewed by Youenn Fablet.

        * fast/mediastream/MediaStream-video-element-displays-buffer-expected.txt:
        * fast/mediastream/MediaStream-video-element-displays-buffer.html:
        * fast/mediastream/MediaStreamTrack-getCapabilities-expected.txt:
        * fast/mediastream/apply-constraints-advanced-expected.txt:
        * fast/mediastream/apply-constraints-advanced.html:
        * fast/mediastream/apply-constraints-video-expected.txt:
        * fast/mediastream/apply-constraints-video.html:

2017-03-24  Dean Jackson  <dino@apple.com>

        Serialization of custom props in longhand should be "" not value of shorthand
        https://bugs.webkit.org/show_bug.cgi?id=167699
        <rdar://problem/30324200>

        Reviewed by Sam Weinig.

        * fast/css/variables/rule-property-get-expected.html:
        * fast/css/variables/rule-property-get.html:

2017-03-24  Antoine Quint  <graouts@webkit.org>

        [Modern Media Controls] Captions don't move with the appearance of the inline controls
        https://bugs.webkit.org/show_bug.cgi?id=170051
        <rdar://problem/30754428>

        Reviewed by Dean Jackson.

        Add a new test, which would have previously failed, where we check that we account for the controls bar height
        when showing captions with the controls bar visible.

        * media/modern-media-controls/tracks-support/tracks-support-captions-offset-with-controls-bar-expected.txt: Added.
        * media/modern-media-controls/tracks-support/tracks-support-captions-offset-with-controls-bar.html: Added.

2017-03-24  Brent Fulgham  <bfulgham@apple.com>

        Handle recursive calls to ProcessingInstruction::checkStyleSheet
        https://bugs.webkit.org/show_bug.cgi?id=169982
        <rdar://problem/31083051>

        Reviewed by Antti Koivisto.

        * fast/dom/beforeload/image-removed-during-before-load-expected.txt: Copied from LayoutTests/fast/dom/beforeload/image-removed-during-before-load-expected.txt.
        * fast/dom/beforeload/image-removed-during-before-load.html: Copied from LayoutTests/fast/dom/beforeload/image-removed-during-before-load.html.
        * fast/dom/beforeload/recursive-css-pi-before-load-expected.txt: Copied from LayoutTests/fast/dom/beforeload/recursive-css-pi-before-load-expected.txt.
        * fast/dom/beforeload/recursive-css-pi-before-load.html: Copied from LayoutTests/fast/dom/beforeload/recursive-css-pi-before-load.html.
        * fast/dom/beforeload/recursive-link-before-load-expected.txt: Copied from LayoutTests/fast/dom/beforeload/recursive-link-before-load-expected.txt.
        * fast/dom/beforeload/recursive-link-before-load.html: Copied from LayoutTests/fast/dom/beforeload/recursive-link-before-load.html.
        * fast/dom/beforeload/recursive-xsl-pi-before-load-expected.txt: Copied from LayoutTests/fast/dom/beforeload/recursive-xsl-pi-before-load-expected.txt.
        * fast/dom/beforeload/recursive-xsl-pi-before-load.html: Copied from LayoutTests/fast/dom/beforeload/recursive-xsl-pi-before-load.html.
        * fast/dom/beforeload/resources/content.xhtml: Copied from LayoutTests/fast/dom/beforeload/resources/content.xhtml.
        * fast/dom/beforeload/resources/pass.css: Copied from LayoutTests/fast/dom/beforeload/resources/pass.css.
        * fast/dom/beforeload/resources/test.xsl: Copied from LayoutTests/fast/dom/beforeload/resources/test.xsl.

2017-03-24  Brady Eidson  <beidson@apple.com>

        A null compound index value crashes the Databases process.
        <rdar://problem/30499831> and https://bugs.webkit.org/show_bug.cgi?id=170000

        Reviewed by Alex Christensen.

        * storage/indexeddb/modern/resources/single-entry-index-invalid-key-crash.js: Added.
        * storage/indexeddb/modern/single-entry-index-invalid-key-crash-expected.txt: Added.
        * storage/indexeddb/modern/single-entry-index-invalid-key-crash-private-expected.txt: Added.
        * storage/indexeddb/modern/single-entry-index-invalid-key-crash-private.html: Added.
        * storage/indexeddb/modern/single-entry-index-invalid-key-crash.html: Added.

2017-03-24  Ryan Haddad  <ryanhaddad@apple.com>

        Skip svg/animations/animations-paused-when-inserted-in-hidden-document* tests on ios-simulator.
        https://bugs.webkit.org/show_bug.cgi?id=170068

        Unreviewed test gardening.

        * platform/ios-simulator/TestExpectations:

2017-03-24  Ryan Haddad  <ryanhaddad@apple.com>

        Unreviewed, rolling out r214360.

        This change caused 20+ LayoutTest failures.

        Reverted changeset:

        "Handle recursive calls to
        ProcessingInstruction::checkStyleSheet"
        https://bugs.webkit.org/show_bug.cgi?id=169982
        http://trac.webkit.org/changeset/214360

2017-03-24  Youenn Fablet  <youenn@apple.com>

        Add support for qpSum in WebRTC stats
        https://bugs.webkit.org/show_bug.cgi?id=170060

        Reviewed by Eric Carlson.

        * webrtc/video-stats.html:

2017-03-24  Daniel Bates  <dabates@apple.com>

        Prevent new navigations during document unload
        https://bugs.webkit.org/show_bug.cgi?id=169934
        <rdar://problem/31247584>

        Reviewed by Chris Dumez.

        Add a test to ensure that we do not cause an assertion fail when calling setTimeout
        after starting a navigation from an onunload event handler.

        * fast/frames/frame-unload-navigate-and-setTimeout-assert-fail-expected.txt: Added.
        * fast/frames/frame-unload-navigate-and-setTimeout-assert-fail.html: Added.

2017-03-24  Myles C. Maxfield  <mmaxfield@apple.com>

        Implement font-optical-sizing
        https://bugs.webkit.org/show_bug.cgi?id=168895

        Reviewed by Dean Jackson.

        * fast/text/variations/optical-sizing-expected.txt: Added.
        * fast/text/variations/optical-sizing.html: Added.

2017-03-24  Yoav Weiss  <yoav@yoav.ws>

        Add a warning for unused link preloads.
        https://bugs.webkit.org/show_bug.cgi?id=165670

        Reviewed by Youenn Fablet.

        This adds a test for the unused preload warning, and adapts some of the other preload tests,
        to avoid warnings.

        * http/tests/preload/download_resources-expected.txt: Changed.
        * http/tests/preload/download_resources.html: Added references to preloaded resources.
        * http/tests/preload/onerrer_event-expected.txt: Changed.
        * http/tests/preload/onerror_event.html: Added references to preloaded resources.
        * http/tests/preload/onload_event.html: Added references to preloaded resources.
        * http/tests/preload/resources/single_download_preload.html: Deflaked.
        * http/tests/preload/unused_preload_warning-expected.txt: Added.
        * http/tests/preload/unused_preload_warning.html: Added.

2017-03-24  Brent Fulgham  <bfulgham@apple.com>

        Handle recursive calls to ProcessingInstruction::checkStyleSheet
        https://bugs.webkit.org/show_bug.cgi?id=169982
        <rdar://problem/31083051>

        Reviewed by Antti Koivisto.

        * fast/dom/beforeload/image-removed-during-before-load-expected.txt: Added.
        * fast/dom/beforeload/image-removed-during-before-load.html: Added.
        * fast/dom/beforeload/recursive-css-pi-before-load-expected.txt: Added.
        * fast/dom/beforeload/recursive-css-pi-before-load.html: Added.
        * fast/dom/beforeload/recursive-link-before-load-expected.txt: Added.
        * fast/dom/beforeload/recursive-link-before-load.html: Added.
        * fast/dom/beforeload/recursive-xsl-pi-before-load-expected.txt: Added.
        * fast/dom/beforeload/recursive-xsl-pi-before-load.html: Added.
        * fast/dom/beforeload/resources/content.xhtml: Added.
        * fast/dom/beforeload/resources/pass.css: Added.
        * fast/dom/beforeload/resources/test.xsl: Added.

2017-03-24  Myles C. Maxfield  <mmaxfield@apple.com>

        font-style needs a new CSSValue to make CSSRule.cssText work correctly
        https://bugs.webkit.org/show_bug.cgi?id=169258

        Reviewed by David Hyatt.

        Update tests' expected results.

        * fast/text/font-selection-font-face-parse-expected.txt:
        * fast/text/font-selection-font-face-parse.html:
        * fast/text/font-style-parse-expected.txt:
        * fast/text/font-style-parse.html:
        * platform/mac-elcapitan/fast/text/font-selection-font-face-parse-expected.txt:
        * svg/css/getComputedStyle-basic-expected.txt:

2017-03-24  Youenn Fablet  <youenn@apple.com>

        Add libwebrtc backend support for RTCRtpSender::replaceTrack
        https://bugs.webkit.org/show_bug.cgi?id=169841

        Reviewed by Alex Christensen.

        * webrtc/audio-replace-track-expected.txt: Added.
        * webrtc/audio-replace-track.html: Added.
        * webrtc/video-replace-track-expected.txt: Added.
        * webrtc/video-replace-track.html: Added.
        * webrtc/video-replace-track-to-null-expected.txt: Added.
        * webrtc/video-replace-track-to-null.html: Added.

2017-03-24  Ryan Haddad  <ryanhaddad@apple.com>

        Update TestExpectations for media/restore-from-page-cache.html.

        Unreviewed test gardening.

        * platform/mac-wk2/TestExpectations:
        * platform/mac/TestExpectations:

2017-03-24  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Mark webrtc/video-stats.html as failing.

        * platform/gtk/TestExpectations:

2017-03-24  Youenn Fablet  <youenn@apple.com>

        Add support for DataChannel and MediaStreamTrack stats
        https://bugs.webkit.org/show_bug.cgi?id=170031

        Reviewed by Eric Carlson.

        * webrtc/datachannel/datachannel-stats-expected.txt: Added.
        * webrtc/datachannel/datachannel-stats.html: Added.
        * webrtc/video-mediastreamtrack-stats-expected.txt: Added.
        * webrtc/video-mediastreamtrack-stats.html: Added.

2017-03-24  Chris Dumez  <cdumez@apple.com>

        Extend svg/animations/animations-paused-disconnected-iframe.html
        https://bugs.webkit.org/show_bug.cgi?id=170035

        Reviewed by Andreas Kling.

        Extend svg/animations/animations-paused-disconnected-iframe.html to cover more things.

        * svg/animations/animations-paused-disconnected-iframe-expected.txt:
        * svg/animations/animations-paused-disconnected-iframe.html:

2017-03-24  Youenn Fablet  <youenn@apple.com>

        Fix framesEncoded/framesDecoded RTC stats
        https://bugs.webkit.org/show_bug.cgi?id=170024

        Reviewed by Eric Carlson.

        * webrtc/video-stats-expected.txt: Added.
        * webrtc/video-stats.html: Added.

2017-03-24  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Mark media/video-load-require-user-gesture.html as failing after r214338.

        * platform/gtk/TestExpectations:

2017-03-24  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Rebaseline http/tests/inspector/network/fetch-response-body.html/xhr-response-body.html after r214338.

        We are now getting the right application/json for a file data.json. The soup network backend tries to gess the
        mime type from the extension when sniffing is not allowed and the mime type is not known. See bug
        webkit.org/b/168299, that was added actually to fix these tests, but at that time we also failed to guess the
        mime type and returned application/octet-stream.

        * platform/gtk/TestExpectations:
        * platform/gtk/http/tests/inspector/network/fetch-response-body-expected.txt: Added.
        * platform/gtk/http/tests/inspector/network/xhr-response-body-expected.txt: Added.

2017-03-24  Carlos Garcia Campos  <cgarcia@igalia.com>

        Unreviewed GTK+ gardening. Rebaseline fast/dom/HTMLAnchorElement/anchor-file-blob-convert-to-download.html after r214338.

        We are now getting a MIME type for otf files.

        * platform/gtk/fast/dom/HTMLAnchorElement/anchor-file-blob-convert-to-download-expected.txt: Added.

2017-03-24  Per Arne Vollan  <pvollan@apple.com>

        Text stroke is sometimes clipped on video captions.
        https://bugs.webkit.org/show_bug.cgi?id=170006

        Reviewed by Eric Carlson.

        * media/track/track-css-stroke-cues-expected.txt:
        * media/track/track-css-stroke-cues.html:

2017-03-24  Carlos Garcia Campos  <cgarcia@igalia.com>

        [GTK] Add MIMETypeRegistry implementation using xdgmime and remove the GTK+ one
        https://bugs.webkit.org/show_bug.cgi?id=170001

        Reviewed by Michael Catanzaro.

        Remove platform specific expectations of two test because now we do the same as other wk2 ports.

        * platform/gtk/TestExpectations:

2017-03-23  Antti Koivisto  <antti@apple.com>

        Revert r213712, caused iPad PLT regression
        https://bugs.webkit.org/show_bug.cgi?id=170040

        Unreviewed.

        * http/tests/incremental/stylesheet-body-incremental-rendering-expected.html: Removed.
        * http/tests/incremental/stylesheet-body-incremental-rendering.html: Removed.

2017-03-23  Chris Dumez  <cdumez@apple.com>

        SVG animations are not paused when their <svg> element is removed from the document
        https://bugs.webkit.org/show_bug.cgi?id=170030
        <rdar://problem/31230252>

        Reviewed by Dean Jackson.

        Add layout test coverage.

        * svg/animations/animations-paused-when-removed-from-document-expected.txt: Added.
        * svg/animations/animations-paused-when-removed-from-document.html: Added.

2017-03-22  Myles C. Maxfield  <mmaxfield@apple.com>

        font shorthand should accept variation values
        https://bugs.webkit.org/show_bug.cgi?id=168998

        Reviewed by Simon Fraser.

        * fast/text/font-style-parse-expected.txt:
        * fast/text/font-style-parse.html:
        * fast/text/font-weight-parse-expected.txt:
        * fast/text/font-weight-parse.html:

2017-03-23  Chris Dumez  <cdumez@apple.com>

        SVG animations are not paused when inserted into a hidden page
        https://bugs.webkit.org/show_bug.cgi?id=170026
        <rdar://problem/31228704>

        Reviewed by Andreas Kling.

        Add layout test coverage.

        * svg/animations/animations-paused-when-inserted-in-hidden-document-expected.txt: Added.
        * svg/animations/animations-paused-when-inserted-in-hidden-document.html: Added.
        * svg/animations/animations-paused-when-inserted-in-hidden-document2-expected.txt: Added.
        * svg/animations/animations-paused-when-inserted-in-hidden-document2.html: Added.

== Rolled over to ChangeLog-2017-03-23 ==
